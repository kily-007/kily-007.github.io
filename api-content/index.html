{"posts":[{"title":"èµ°è¿›åä¸º","content":"åä¸ºæˆç«‹äº åä¸ºå…¬å¸çš„æ„¿æ™¯ä¸ä½¿å‘½ï¼šæŠŠæ•°å­—ä¸–ç•Œå¸¦å…¥æ¯ä¸ªäººã€æ¯ä¸ªå®¶åº­ã€æ¯ä¸ªç»„ç»‡ï¼Œæ„å»ºä¸‡ç‰©äº’è”çš„æ™ºèƒ½ä¸–ç•Œã€‚ 2025å¹´äº§ä¸šå±•æœ›ï¼šå…¨çƒå°†æœ‰è¶…è¿‡1000äº¿çš„è”æ¥ï¼Œäººä¸äººã€äººä¸ç‰©ã€ç‰©ä¸ç‰©ä¹‹é—´å®ç°å…¨é¢çš„è”æ¥ã€‚ ","link":"https://kily-007.github.io/post/èµ°è¿›åä¸º/"},{"title":"æ•™å­¦-2020-07-18","content":"é¡ºåºè¡¨å’Œé“¾è¡¨çš„æ¯”è¾ƒ å­˜å–æ–¹å¼ é¡ºåºè¡¨å¯ä»¥é¡ºåºå­˜å–ï¼Œä¹Ÿå¯ä»¥éšæœºå­˜å–ï¼Œé“¾è¡¨åªèƒ½ä»è¡¨å¤´é¡ºåºå­˜å–å…ƒç´ ã€‚ é€»è¾‘ç»“æ„ä¸ç‰©ç†ç»“æ„ é‡‡ç”¨é¡ºåºå­˜å‚¨æ—¶ï¼Œé€»è¾‘ä¸Šç›¸é‚»çš„å…ƒç´ ï¼Œå¯¹åº”çš„ç‰©ç†å­˜å‚¨ä½ç½®ä¹Ÿç›¸é‚»ã€‚ é‡‡ç”¨é“¾å¼å­˜å‚¨æ—¶ï¼Œé€»è¾‘ä¸Šç›¸é‚»çš„å…ƒç´ ï¼Œç‰©ç†å­˜å‚¨ä½ç½®ä¸ä¸€å®šç›¸é‚»ï¼Œå¯¹åº”çš„é€»è¾‘å…³ç³»æ˜¯é€šè¿‡æŒ‡é’ˆæ¥è¡¨ç¤ºçš„ã€‚ æŸ¥æ‰¾ã€æ’å…¥å’Œåˆ é™¤ | null | é¡ºåºè¡¨ | é“¾è¡¨ | | æŸ¥æ‰¾ | O(n) | O(n) | | æ’å…¥ | O(n) | O(1) | | åˆ é™¤ | O(n) | O(1) | ç©ºé—´åˆ†é… é¡ºåºè¡¨æ˜¯é™æ€ç©ºé—´åˆ†é…ï¼Œé“¾è¡¨æ˜¯åŠ¨æ€ç©ºé—´åˆ†é…ã€‚ å®é™…åº”ç”¨ä¸­è¡¨çš„é€‰å– åŸºäºå­˜å‚¨è€ƒè™‘ é¡ºåºè¡¨ï¼šå¯ä»¥ä¼°è®¡çº¿æ€§è¡¨çš„é•¿åº¦æˆ–å­˜å‚¨è§„æ¨¡æ—¶é‡‡ç”¨ï¼› é“¾è¡¨ï¼šä¸ç”¨äº‹å…ˆçŸ¥é“å­˜å‚¨è§„æ¨¡ï¼Œä½†é“¾è¡¨çš„å­˜å‚¨å¯†åº¦ä½ã€‚ åŸºäºè¿ç®—è€ƒè™‘ é¡ºåºè¡¨ï¼šç»å¸¸è®¿é—®é“¾è¡¨ä¸­çš„å…ƒç´ æ—¶ä½¿ç”¨ï¼› é“¾è¡¨ï¼šç»å¸¸æ’å…¥æˆ–è€…åˆ é™¤æ—¶ä½¿ç”¨ï¼› åŸºäºç¯å¢ƒè€ƒè™‘ã€ é¡ºåºè¡¨ï¼šç›´æ¥é‡‡ç”¨æ•°ç»„ï¼Œå®¹æ˜“å®ç°ã€‚ é“¾è¡¨ï¼šåŸºäºæŒ‡é’ˆå®ç°ï¼Œç›¸å¯¹è¾ƒä¸ºç¹çã€‚ ","link":"https://kily-007.github.io/post/æ•™å­¦-2020-07-18/"},{"title":"æ•™å­¦-2020-07-09","content":"é¡ºåºè¡¨ä¸é“¾è¡¨ç»ƒä¹ é¢˜ é€‰æ‹©é¢˜ï¼š1,5,13,14,19,24ï¼Œ ç¼–ç¨‹é¢˜ï¼š1,10 é¡ºåºè¡¨ä¸é“¾è¡¨çš„æ¯”è¾ƒ å­˜å–æ–¹å¼ é€»è¾‘ç»“æ„ä¸ç‰©ç†ç»“æ„ æŸ¥æ‰¾ã€æ’å…¥å’Œåˆ é™¤ ç©ºé—´åˆ†é… å®é™…åº”ç”¨ä¸­è¡¨çš„é€‰å– åŸºäºå­˜å‚¨è€ƒè™‘ åŸºäºè¿ç®—è€ƒè™‘ åŸºäºç¯å¢ƒè€ƒè™‘ ","link":"https://kily-007.github.io/post/æ•™å­¦-2020-07-09/"},{"title":"å¦‚ä½•å°†æœ¬åœ°é¡¹ç›®åŒæ­¥åˆ°GitHub","content":"å®‰è£…Git ä¸‹è½½åœ°å€https://git-for-windows.github.io/ï¼Œå®‰è£…æ—¶é»˜è®¤å®‰è£…å°±è¡Œã€‚ æ–°å»ºè¿œç¨‹ä»“åº“ å³ä¸Šè§’ç‚¹å‡»New Repositoryï¼Œå¡«å†™Repository nameï¼Œå®Œæˆåˆ›å»ºã€‚ æ–°å»ºæœ¬åœ°ä»“åº“ æ‰“å¼€gitï¼Œè¿è¡Œmkdir Teacheæ–°å»ºåä¸ºTeachçš„æ–‡ä»¶å¤¹ï¼Œä»“åº“åä¸ºTeacheï¼Œï¼› è¿›å…¥Teachï¼Œcd Teach åˆå§‹åŒ–è¯¥ä»“åº“ï¼Œgit initï¼Œæ­¤æ—¶Teachæ–‡ä»¶å¤¹ä¸‹å›å¤šå‡º.gitæ–‡ä»¶ æ­¤æ—¶å¯ä»¥å°†é¡¹ç›®ç²˜è´´åˆ°Teachæ–‡ä»¶å¤¹ä¸‹ å°†é¡¹ç›®æ·»åŠ åˆ°ä»“åº“ï¼Œgit add. ; æŸ¥çœ‹å½“å‰çŠ¶æ€git status; #å°†æœ¬åœ°ä»“åº“åŒæ­¥åˆ°Github git push -u origin masterç”±äºæ–°å»ºçš„è¿œç¨‹ä»“åº“æ˜¯ç©ºçš„ï¼Œæ‰€ä»¥è¦åŠ ä¸Š-uè¿™ä¸ªå‚æ•°ï¼Œç­‰è¿œç¨‹ä»“åº“é‡Œé¢æœ‰äº†å†…å®¹ä¹‹åï¼Œä¸‹æ¬¡å†ä»æœ¬åœ°åº“ä¸Šä¼ å†…å®¹çš„æ—¶å€™åªéœ€ä¸‹é¢è¿™æ ·å°±å¯ä»¥äº†ï¼š $ git push origin master ","link":"https://kily-007.github.io/post/å¦‚ä½•å°†æœ¬åœ°é¡¹ç›®åŒæ­¥åˆ°GitHub/"},{"title":"æ•™å­¦-2020-07-08","content":"åŒé“¾è¡¨ è¯´æ˜ï¼šå•é“¾è¡¨ç»“ç‚¹ä¸­åªæœ‰ä¸€ä¸ªæŒ‡å‘å…¶åç»§çš„æŒ‡é’ˆï¼Œä½¿å¾—å•é“¾è¡¨åªèƒ½ä»å¤´ç»“ç‚¹ä¾æ¬¡é¡ºåºåœ°å‘åè®¿é—®ã€‚ä¸ºäº†å…‹æœå•é“¾è¡¨åªèƒ½ä»å‰å¾€åçš„è®¿é—®çš„ç¼ºé™·ï¼Œå¼•å…¥prioræŒ‡é’ˆï¼Œä½¿å¾—é“¾è¡¨å¯ä»¥å‘å‰è®¿é—®ã€‚ ç»“æ„ç¤ºæ„å›¾ï¼š å»ºè¡¨ //å°¾æ’æ³•å»ºè¡¨ public DLinkList buildDLinkList(int[] arr) { DLinkList head = new DLinkList(); head.next = null; head.prior = null; head.data = 0; DLinkList r = head; int count = 0; while (count &lt; arr.length) { DLinkList p = new DLinkList(); p.data = arr[count++]; p.next = r.next; p.prior = r; r.next = p; r = p; } return head; } æ’å…¥åˆ é™¤ //æ’å…¥ public DLinkList insert(DLinkList head,int posi,int value) { DLinkList p=head.next; int count=0; while (count&lt;posi) { p=p.next; count++; } DLinkList q=new DLinkList(); q.data=value; q.next=p.next; q.prior=p; p.next.prior=q; p.next=q; return head; } //åˆ é™¤ public DLinkList delete(DLinkList head,int posi) { DLinkList p=head; int count=0; while (count&lt;posi) { p=p.next; count++; } p.next.next.prior=p; p.next=p.next.next; return head; } å¾ªç¯é“¾è¡¨ å¾ªç¯å•é“¾è¡¨ å¾ªç¯åŒé“¾è¡¨ é™æ€é“¾è¡¨ ","link":"https://kily-007.github.io/post/æ•™å­¦-2020-07-08/"},{"title":"æ•™å­¦-2020-06-24","content":"å•é“¾è¡¨ç›¸å…³æ–¹æ³• 1. è·å–å•é“¾è¡¨é•¿åº¦ public int findLength(LinkList list) { int count=0; while(true){ count++; if(list.next==null)return count; list=list.next; } } 2. æŸ¥æ‰¾é“¾è¡¨ä¸­ç¬¬ä¸€ä¸ªå€¼ä¸ºeçš„ç»“ç‚¹ public LinkList findEByValue(LinkList list,int e) { while(list!=null) { if(list.data==e) { return list; } list=list.next; } return null; } 3. æŸ¥æ‰¾é“¾è¡¨ä¸­ç¬¬kä¸ªç»“ç‚¹çš„å€¼ public LinkList findEByNum(LinkList list,int k) { if(getLength(list)&lt;k) return null; int count=0; while (count&lt;k) { list=list.next; count++; } return list; } 4. é¢ å€’å•é“¾è¡¨å¹¶è¾“å‡º public void printReverseLinkList(LinkList list) { LinkList head=list; LinkList p=list.next; LinkList q; list.next=null; while(p!=null) { q=p.next; p.next=head.next; head.next=p; p=q; } printLinkList(head); } 5. å»æ‰å•é“¾è¡¨ä¸­é‡å¤çš„å€¼ï¼Œå¹¶è¿”å›ä¸€ä¸ªåˆ å»é‡å¤å€¼çš„å•é“¾è¡¨ public LinkList deleteSame(LinkList list) { list=list.next; LinkList haha=new LinkList(); int j=0; int len=getLength(list); int lenxixi=0; int[] arr=new int[100]; for (int i = 0; i &lt; len; i++) { arr[list.data]++; list=list.next; } System.out.println(); for (int i = 0; i &lt; arr.length; i++) { if(arr[i]!=0) { lenxixi++; } } int[] xixi=new int[lenxixi]; for (int i = 0; i &lt; arr.length; i++) { if(arr[i]!=0) { xixi[j]=i; j++; } } haha = haha.TailBuildList(xixi); return haha; } ","link":"https://kily-007.github.io/post/æ•™å­¦-2020-06-24/"},{"title":"æ•™å­¦-2020-06-22","content":"å•é“¾è¡¨ å°¾æ’æ³•å»ºç«‹å•é“¾è¡¨ // å°¾æ’æ³•å»ºç«‹å•é“¾è¡¨ public LinkList TailBuildList(int[] arr) { LinkList list = new LinkList(); list.data = 0; list.next = null; LinkList r = list; int count = 0; while (count &lt; arr.length) { LinkList p = new LinkList(); p.data = arr[count]; p.next = r.next; r.next = p; r = p; count++; } return list; } å¤´æ’æ³•å»ºç«‹å•é“¾è¡¨ // å¤´æ’æ³•å»ºç«‹å•é“¾è¡¨ public LinkList HeadBuildList(int[] arr) { LinkList head = new LinkList(); head.data = 0; head.next = null; int count = 0; while (count &lt; arr.length) { LinkList p = new LinkList(); p.data = arr[count]; p.next = head.next; head.next = p; count++; } return head; } æ’å…¥ // åœ¨ç¬¬kä¸ªä½ç½®æ’å…¥e public LinkList insert(LinkList list,int k,int e) { LinkList p=list.next; int count=0; while (count&lt;k) { p=p.next; count++; } LinkList q=new LinkList(); q.data=e; q.next=p.next; p.next=q; return list; } åˆ é™¤ //åˆ é™¤ç¬¬kä¸ªå€¼ public LinkList delete(LinkList list,int k) { int count=0; while (count&lt;k) { list=list.next; count++; } list.next=list.next.next; return list; } ","link":"https://kily-007.github.io/post/æ•™å­¦-2020-06-22/"},{"title":"æ•™å­¦-2020-06-20","content":"é¡ºåºè¡¨é¢˜è§£ â‘£åˆ é™¤æœ‰åºé¡ºåºè¡¨ä¸­æ‰€æœ‰é‡å¤çš„å€¼ï¼Œä½¿å¾—è¡¨ä¸­æ‰€æœ‰å…ƒç´ çš„å€¼å‡ä¸ç›¸åŒã€‚ //åˆ é™¤æœ‰åºé¡ºåºè¡¨ä¸­çš„é‡å¤å…ƒç´  public void deleteSame() { for (int i = 0; i &lt; len-1; i++) { if(data[i]==data[i+1]) { delete(i+1); i--; } } } â‘¤åˆ é™¤é¡ºåºè¡¨ä¸­æ‰€æœ‰é‡å¤çš„å€¼ï¼Œä½¿å¾—è¡¨ä¸­æ‰€æœ‰å…ƒç´ çš„å€¼å‡ä¸ç›¸åŒã€‚ //åˆ é™¤é¡ºåºè¡¨ä¸­çš„é‡å¤å…ƒç´  public void deleteSame2() { int[] arr=new int[23]; for (int i = 0; i &lt; len; i++) { arr[data[i]]++; } System.out.println(); for (int i = 0; i &lt; arr.length; i++) { if(arr[i]!=0) System.out.print(i+&quot; &quot;); } } å•é“¾è¡¨ å®šä¹‰ï¼šçº¿æ€§è¡¨çš„é“¾å¼å­˜å‚¨åˆç§°å•é“¾è¡¨ã€‚å®ƒæ˜¯æŒ‡é€šè¿‡ä¸€ç»„ä»»æ„çš„å­˜å‚¨å•å…ƒæ¥å­˜å‚¨çº¿æ€§è¡¨ä¸­çš„æ•°æ®å…ƒç´ ã€‚ å¼±ç‚¹ï¼šç”±äºå•é“¾è¡¨çš„å…ƒç´ ç¦»æ•£çš„åˆ†å¸ƒåœ¨å­˜å‚¨ç©ºé—´ä¸­ï¼Œæ‰€ä»¥å•é“¾è¡¨æ˜¯ä¸€ç§ééšæœºå­˜å–å¾—å­˜å‚¨ç»“æ„ã€‚å³ä¸èƒ½ç›´æ¥æ‰¾åˆ°è¡¨ä¸­æŸä¸ªç‰¹å®šçš„ç»“ç‚¹ã€‚ ","link":"https://kily-007.github.io/post/æ•™å­¦-2020-06-20/"},{"title":"æ•™å­¦-2020-06-17","content":"ä¸€ã€é¡ºåºè¡¨ ##é¡ºåºè¡¨çš„å®ç° //é¡ºåºè¡¨ class SequenceList{ int data[]; int len; } 1. æ’å…¥æ“ä½œ //æ’å…¥ public boolean insert(int p,int k) { if(p&gt;len&amp;&amp;p&lt;0) return false; if(len&gt;data.length) return false; for (int i = len; i &gt; p; i--) { data[i]=data[i-1]; } data[p]=k; len++; return true; } 2. åˆ é™¤æ“ä½œ //åˆ é™¤ public boolean delete(int p) { if(p&lt;0&amp;&amp;p&gt;len) { return false; } if(len&gt;data.length) { return false; } for(int i=p;i&lt;len;i++) { data[i]=data[i+1]; } len--; return true; } 3. æŒ‰å€¼æŸ¥æ‰¾æ“ä½œ //æŸ¥æ‰¾ public int findElem(int k) { for (int i = 0; i &lt; len; i++) { if(data[i]==k) return i; } return 0; } 4. æ—¶é—´å¤æ‚åº¦ é¢˜ç›®å·©å›ºï¼š â‘ åœ¨ä¸€ä¸ªé•¿åº¦ä¸ºnçš„é¡ºåºè¡¨ä¸­åˆ é™¤ç¬¬iä¸ªå…ƒç´ æ—¶ï¼Œéœ€è¦å‘å‰ç§»åŠ¨ï¼ˆï¼‰ä¸ªå…ƒç´ ã€‚ â‘¡æ‰¾åˆ°é¡ºåºè¡¨ä¸­æœ€å°å€¼ï¼Œå¹¶æ‰“å°ï¼› â‘¢å°†é¡ºåºè¡¨ä¸­æ‰€æœ‰å…ƒç´ é€†ç½®ï¼› â‘£åˆ é™¤æœ‰åºé¡ºåºè¡¨ä¸­æ‰€æœ‰é‡å¤çš„å€¼ï¼Œä½¿å¾—è¡¨ä¸­æ‰€æœ‰å…ƒç´ çš„å€¼å‡ä¸ç›¸åŒã€‚ //åˆ é™¤æœ‰åºé¡ºåºè¡¨ä¸­çš„é‡å¤å…ƒç´  public void deleteSame() { for (int i = 0; i &lt; len-1; i++) { if(data[i]==data[i+1]) { delete(i+1); i--; } } } â‘¤åˆ é™¤é¡ºåºè¡¨ä¸­æ‰€æœ‰é‡å¤çš„å€¼ï¼Œä½¿å¾—è¡¨ä¸­æ‰€æœ‰å…ƒç´ çš„å€¼å‡ä¸ç›¸åŒã€‚ //åˆ é™¤é¡ºåºè¡¨ä¸­çš„é‡å¤å…ƒç´  public void deleteSame2() { int[] arr=new int[23]; for (int i = 0; i &lt; len; i++) { arr[data[i]]++; } System.out.println(); for (int i = 0; i &lt; arr.length; i++) { if(arr[i]!=0) System.out.print(i+&quot; &quot;); } } ","link":"https://kily-007.github.io/post/æ•™å­¦-2020-06-17/"},{"title":"æ•™å­¦-2020-06-15","content":"æ•°æ®ç»“æ„ ä¸€ã€æ¦‚è¦ 1. æ•°æ®ç»“æ„çš„åŸºæœ¬æ¦‚å¿µ â‘ æ•°æ®ï¼šæ•°æ®æ˜¯è®¡ç®—æœºç¨‹åºåŠ å·¥çš„åŸæ–™ã€‚ â‘¡æ•°æ®å…ƒç´ ï¼šæ˜¯æ•°æ®çš„åŸºæœ¬å•ä½ã€‚ â‘¢æ•°æ®é¡¹ï¼šæ˜¯æ„æˆæ•°æ®å…ƒç´ çš„æœ€å°å•ä½ã€‚ â‘£æ•°æ®å¯¹è±¡ï¼šå…·æœ‰ç›¸åŒæ€§è´¨çš„æ•°æ®å…ƒç´ çš„é›†åˆã€‚ â‘¤æ•°æ®ç±»å‹ï¼šæ˜¯ä¸€ä¸ªå€¼å¾—é›†åˆå’Œå®šä¹‰ä¸€ç»„æ“ä½œçš„æ€»ç§°ã€‚ â‘¥æ•°æ®ç»“æ„ï¼šæ˜¯ç›¸äº’ä¹‹é—´å­˜åœ¨ä¸€ç§æˆ–è€…å¤šç§ç‰¹å®šå…³ç³»çš„æ•°æ®å…ƒç´ çš„é›†åˆã€‚ 2.æ•°æ®ç»“æ„ä¸‰è¦ç´  â‘ æ•°æ®çš„é€»è¾‘ç»“æ„ â‘¡æ•°æ®çš„å­˜å‚¨ç»“æ„ â‘¢æ•°æ®çš„è¿ç®— äºŒã€ç®—æ³•åŠè¯„ä»· 1. åŸºæœ¬æ¦‚å¿µ â‘ ç®—æ³•æ•ˆç‡çš„åº¦é‡ï¼šé€šè¿‡æ—¶é—´å¤æ‚åº¦å’Œç©ºé—´å¤æ‚åº¦æ¥æè¿°çš„ã€‚ 2. æ—¶é—´å¤æ‚åº¦å’Œç©ºé—´å¤æ‚åº¦ â‘¡æ—¶é—´å¤æ‚åº¦ï¼šæŸä¸ªè¯­å¥åœ¨è¯¥ç®—æ³•ä¸­è¢«é‡å¤æ‰§è¡Œçš„æ¬¡æ•°ã€‚ â‘¢ç©ºé—´å¤æ‚åº¦ï¼šä¸ºè¯¥ç®—æ³•æ‰€è€—è´¹çš„å­˜å‚¨ç©ºé—´ã€‚ ä¸‰ã€çº¿æ€§è¡¨ æ¦‚å¿µï¼šå…·æœ‰ç›¸åŒæ•°æ®ç±»å‹çš„nä¸ªæ•°æ®å…ƒç´ çš„æœ‰é™åºåˆ—ã€‚ L=(a1,p,a3,...,an); 1ã€é¡ºåºå­˜å‚¨ æ¦‚å¿µï¼šç”¨ä¸€ç»„åœ°å€è¿ç»­çš„å­˜å‚¨å•å…ƒä¾æ¬¡å­˜å‚¨çº¿æ€§è¡¨ä¸­çš„æ•°æ®å…ƒç´ ã€‚ typedef struct{ int data[]; int n; } 2ã€é“¾å¼å­˜å‚¨ï¼ˆå•é“¾è¡¨ã€åŒé“¾è¡¨ã€å¾ªç¯é“¾è¡¨ï¼‰ ","link":"https://kily-007.github.io/post/æ•™å­¦-2020-06-15/"},{"title":"æ•™å­¦-2020-06-14","content":" æ·»åŠ ç™¾åº¦ç»Ÿè®¡ MarkDownåŸºæœ¬è¯­æ³•å­¦ä¹  1. æ ‡é¢˜ å…¼å®¹Htmlè¯­æ³•ï¼Œæ ‡é¢˜é€æ¸å˜å°ï¼š&lt;h1&gt;content&lt;/h1&gt;-&lt;h5&gt; Markdwonè¯­æ³•ï¼Œæ ‡é¢˜é€æ¸å˜å°ï¼š # ## ### #### ##### 2. æ¢è¡Œæ ‡ç­¾ &lt;br/&gt; 3. å­—ä½“æ ·å¼ *content* æ–œä½“ **content**ç²—ä½“ ***content***ç²—æ–œä½“ 4. åˆ†å‰²çº¿ --- *** 5. åˆ é™¤çº¿ ~~åˆ’æ‰æ–‡å­—~~ 6. ä¸‹åˆ’çº¿ &lt;u&gt;ä¸‹åˆ’çº¿&lt;/u&gt; 7. æ— åºåˆ—è¡¨ + æ— åºåˆ—è¡¨ - æ— åºåˆ—è¡¨ * æ— åºåˆ—è¡¨ 8. æœ‰åºåˆ—è¡¨ 1. ç¬¬ä¸€åˆ— 2. ç¬¬äºŒåˆ— 9. åµŒå¥—æ¨¡å— &gt;ç¬¬ä¸€å±‚ &gt;&gt;ç¬¬äºŒå±‚ &gt;&gt;&gt;ç¬¬ä¸‰å±‚ 10. é“¾æ¥åœ°å€ ç›´æ¥æ˜¾ç¤ºé“¾æ¥ï¼š&lt;https://www.baidu.com&gt; éšè—é“¾æ¥ï¼š[1]:https://www.baidu.com 11. å¼•å…¥å›¾ç‰‡ ![å¤´åƒ](https://photos-1258928558.cos.ap-guangzhou.myqcloud.com/avatar_1591965590089.jpeg) 12. è¡¨æ ¼ | è¡¨å¤´ | è¡¨å¤´ | | ---- | ---- | | å•å…ƒæ ¼ | å•å…ƒæ ¼ | | å•å…ƒæ ¼ | å•å…ƒæ ¼ | 13.MarkDownèœé¸Ÿæ•™ç¨‹ https://www.runoob.com/markdown/md-tutorial.html ","link":"https://kily-007.github.io/post/æ•™å­¦-2020-06-14/"},{"title":"é›¨å¤œ","content":" çª—å¤–ï¼Œä¸‹é›¨äº†ã€‚ è¿‘å‡ æ—¥é˜´é›¨å»¶ç»µï¼Œä½†å´å¹¶ä¸å‡‰çˆ½ã€‚å…¥å¤æ—¶åˆ†ï¼Œå¾€å¾€æ˜¾å¾—ååˆ†ç‡¥çƒ­ï¼Œä¸‹è¿‡é›¨åï¼Œç©ºæ°”ä¸­çš„æ°´åˆ†è®©è¿™ä¸ªå¤å¤©æ˜¾å¾—æ›´åŠ çš„æ¹¿çƒ­ï¼Œæ¯•ä¸šç­”è¾©ä¹‹æ—¶è¿˜æœªæ›¾æœ‰è¿™èˆ¬æš‘æ°”å§ã€‚è®ºæ–‡æäº¤ä»¥æ¥ï¼Œä¾¿åƒæ˜¯åœä¸‹äº†å‰è¿›çš„è„šæ­¥ï¼Œæ¯æ—¥æˆ–æ˜¯æ•´ç‚¹å„¿åšå®¢ï¼Œæˆ–æ˜¯æ‰“ä¼šæ¸¸æˆï¼Œäº¦æˆ–æ˜¯å¹²ç‚¹å„¿å®¶åŠ¡æ´»ï¼Œå´æ˜¯å°‘äº†ä¸€ä»½åœ¨å­¦æ ¡å®éªŒå®¤å¾…ç€æ—¶çš„åŒ†å¿™ï¼Œå¤šäº†å‡ åˆ†æ‚ é—²ï¼Œå°‘äº†å‡ åˆ†æ–—å¿—ã€‚ çª—å¤–çš„é›¨æ·…æ·…æ²¥æ²¥çš„ä¸‹ç€ï¼Œå¾€å¸¸è¿™ä¸ªæ—¶å€™æˆ‘æ€»æ˜¯å–œæ¬¢èº²åˆ°è¢«çªé‡Œï¼Œå¬é›¨å¿ƒä¸­ä¼šæ˜¾å¾—æ ¼å¤–å®é™ä¸æ¸©é¦¨ã€‚ä½†ä»Šæ—¥ä¸åŒï¼Œé™¤å´é›¨å£°ï¼Œçª—å¤–å¥½ä¼¼ä¾¿æ²¡äº†åˆ«çš„å£°éŸ³ï¼Œç•™ä¸‹çš„åªæœ‰å¯‚é™ã€‚ä»”ç»†å¬ï¼Œä¾¿ä¼šå‘ç°å°‘äº†é£çš„å–§åš£ï¼Œä½¿å¾—è¿™ä¸ªé›¨å¤œæ ¼å¤–å®é™ã€‚æ²¡æœ‰å¤æ—¥çš„å‹è¿«ï¼Œä¾¿æ²¡æœ‰äº†é£ã€‚é£ï¼Œåœä¸‹äº†è¿½å¯»ï¼Œä»–ç´¯äº†ï¼Œåœ¨å°æ†©ã€‚ä»–æ€»æ˜¯åœ¨é©¬ä¸åœè¹„çš„å››å¤„å¥”èµ°ï¼Œä»–ä¸æ•¢åœä¸‹ï¼Œå› ä¸ºä¸€æ—¦åœä¸‹æ¥ï¼Œä»–ä¾¿ä¸æ˜¯ä»–äº†ã€‚æ‰€ä»¥ï¼Œå‘ç€ç›®æ ‡èµ·èº«å§ã€‚é£ï¼Œè½»è½»å‘¼è¿‡ã€‚ çª—å¤–ï¼Œèµ·é£äº†ã€‚ ","link":"https://kily-007.github.io/post/ç”Ÿæ´»-é›¨å¤œ/"},{"title":"å—åŸæ•…äºº","content":" æ— æ„ä¸­åœ¨ç½‘æ˜“äº‘éŸ³ä¹çœ‹è§è¿™ç¯‡æ–‡ç« ï¼ˆğŸ‘´æ¯’é¸¡æ±¤ï¼‰ï¼Œæœ‰æ‰€æ„Ÿï¼Œåˆ†äº«ä¸€ä¸‹ã€‚ æ‘˜è‡ªï¼šå—åŸæ•…äºº ç¬¬8æœŸ 18å²ï¼Œä½ è¯»äº†å¤§å­¦ã€‚ 20å²ï¼Œä½ å¤§äºŒç»“æŸï¼Œå¼€å§‹æ‚”æ¨ è‡ªå·±å‰ä¸¤å¹´å¹¼ç¨šçš„è¡Œä¸º äºæ˜¯å¼€å§‹åŠªåŠ› 22å²ä½ å¤§å­¦æ¯•ä¸šäº†ï¼Œå´å‘ç° æ‰¾ä¸åˆ°ä¸€ä»½ä»¤è‡ªå·±æ»¡æ„çš„å·¥ä½œ 26å²ï¼Œä½ çœ‹ç€èº«è¾¹çš„äººéƒ½ç»“äº†å©š å©šç¤¼çš„ä»½å­é’±é€å¹´é€’å¢ æ˜¥èŠ‚å›å®¶ï¼Œçˆ¶æ¯ä»å¸¦ä½ ä¸²äº²æˆš å˜æˆäº†å¸¦ä½ å»è§ç›¸äº²å¯¹è±¡ è§äº†åå‡ ä¸ªå§‘å¨˜ ä½ æ¯æ¬¡éƒ½è§‰å¾—å’Œé‚£ä¸ªå¥¹æ¯” å·®äº†ä¸€ç‚¹ 28å²é‚£å¹´ï¼Œä½ é‡åˆ°äº†ä¸€ä¸ªå’Œä½ é­é‡å·®ä¸å¤šçš„å§‘å¨˜ ä½ ä»¬æœ‰ä¸€æ­æ²¡ä¸€æ­çš„èŠç€ å¥¹è¯´ï¼šä½ è¿˜ä¸é”™ ä½ å–äº†ä¸€å£å¯ä¹è¯´ï¼šä½ ä¹Ÿæ˜¯ ä½ è¿˜ä¸ç¡®å®šå–œä¸å–œæ¬¢å¥¹ åŒæ–¹å®¶é•¿å°±å·²ç»æ‘†å¥½äº†è®¢å©šå®´ ç»“å©šçš„å‰ä¸€å‘¨ï¼Œä½ å’Œæœ‹å‹å‡ºå»å–é…’ ä½ è¯´ï¼Œä¸æƒ³ç»“å©š æœ‹å‹è¯´ï¼Œä½ å•Šï¼Œå°±æ˜¯æƒ³å¤ªå¤šã€‚è°ä¸æ˜¯è¿™ä¹ˆè¿‡æ¥çš„ï¼Ÿ åˆ†å‰²çº¿ 29å²ï¼Œä½ ä»¬ç»ˆäºç»“äº†å©š å©šç¤¼åŠçš„ä¸å¤§ä¸å°ï¼Œæœ‹å‹æ¥çš„ä¸å¤šä¸å°‘ æ”’äº†å‡ å¹´æƒ³è¦å»å®ç°ç†æƒ³çš„é’± æ­åœ¨äº†è¿™ä¸€åœºç™¾äººçš„ç§äººåº™ä¼šä¸Š å©šç¤¼è¿›è¡Œåˆ°ä¸­é—´ å¸ä»ªå¸¦ç€æ ‡å‡†çš„å•†ä¸šåŒ–å¾®ç¬‘ å¯¹ç€å°ä¸‹çš„äº²æœ‹å–Šé“ è¦ä¸è¦è®©ä»–ä»¬äº²ä¸€ä¸ªï¼ å°ä¸‹é‚£äº›äººè·Ÿç€ä¸€èµ·èµ·å“„ ä¸çŸ¥é“ä¸ºä»€ä¹ˆ ä½ ç®€ç®€å•å•çš„äº²äº†ä¸€å£ ä¿©äººæ¢å¤åˆ°äº†ä¸€å¼€å§‹çš„ç«™ä½ ä½ å°å£°è¯´äº†ä¸€å¥ï¼šæˆ‘çˆ±ä½  é‚£ä¸ªæ˜¨å¤©è¿˜çœ‹ä¸æƒ¯ä½ å€’è…¾æ¨¡å‹çš„æ–°å¨˜ æ„£äº†ä¸€ä¸‹è¯´ï¼šæˆ‘ä¹Ÿçˆ±ä½  ä½ ä¸ç¡®å®šå¥¹æ˜¯ä¸æ˜¯å¯¹ä½ è¯´çš„ å°±åƒä½ ä¸ç¡®å®šæ˜¯ä¸æ˜¯å¯¹å¥¹è¯´çš„ä¸€æ · å©šç¤¼ç»“æŸåï¼Œå¹¶æ²¡æœ‰ä½ æƒ³è±¡çš„æµªæ¼« ä½ å¬ç€å¤–å±‹çš„æ–°å¨˜ä¸€ç¬”ä¸€ç¬”çš„ç®—ç€ä»½å­é’± æƒ³ç€ä¸è¿‡æ‰ä¸¤å¹´ï¼Œæ€ä¹ˆå°±å˜æˆè¿™æ ·äº† æƒ³ç€æƒ³ç€ï¼Œæ´æˆ¿å¤œå°±ç¡ç€äº† åˆ†å‰²çº¿ 30å²ï¼Œå¥¹æ€€å­•äº† è¾æ‰äº†å·¥ä½œï¼Œåœ¨å®¶å…»èƒ ä½ åœ¨å…¬å¸é€æ¸æœ‰äº†ç‚¹åœ°ä½ æ‰‹é‡Œç®¡ç€åæ¥ä¸ªäºº ç‹¬ç«‹è´Ÿè´£ä¸€ä¸ªé¡¹ç›® ç»“å©šå‰é™ªå«çš„é‚£è¾†20ä¸‡å·¦å³çš„è½¦ ä¹Ÿå˜æˆäº†ä½ ä¸€ä¸ªäººçš„ç‹¬äº« ä½†ä½ ä¾ç„¶ä¸æ•¢æ”¾æ¾ æ¯æ¬¡åŠ ç­ ç”µè¯é‚£å¤´éƒ½æ˜¯æŠ±æ€¨ä¸å§”å±ˆ ä½†ä½ ä¸èƒ½äº‰è¾©ä»€ä¹ˆ è°è®©å¥¹æ€€äº†ä½ çš„å­©å­ åœ¨è¿™ä¸€åˆ» ä¸è®ºæ˜¯å¥¹çš„çˆ¶æ¯è¿˜æ˜¯ä½ çš„çˆ¶æ¯ éƒ½æ— æ¡ä»¶çš„ç«™åœ¨è¿™ä¸€è¾¹ 31å²ï¼Œå­©å­è½åœ°äº† å‰å‰ååè¿å­•æ£€å¸¦ä½é™¢è´¹èŠ±äº†10ä¸‡å—é’± ä¸è¿‡æ— æ‰€è°“ ä½ çœ‹ç€ä½ çš„å­©å­ï¼Œæ€ä¹ˆçœ‹æ€ä¹ˆå–œæ¬¢ é«˜å…´çš„ä»¿ä½›è¿™æ˜¯ä½ çš„æ–°ç”Ÿ 32å²ï¼Œè¿™æ˜¯äººç”Ÿæœ€ä¸æ„¿æ„é‡å¤çš„ä¸€å¹´ å¹³å‡ç¡çœ 3å°æ—¶ å­©å­æ¯ä¸€ä¸ªå°æ—¶éƒ½è¦é—¹è…¾ä¸€æ¬¡ ç¬¬äºŒå¤©æ‹–ç€ç¡ä¸é†’çš„çœ¼ç›å»ä¸Šç­ è€æ¿è¯´ä½ ä¸Šç­ä¸å¹²æ´» å›å®¶åª³å¦‡è¯´ä½ ä¸å¹²æ´» ä½ æƒ³äº†åŠå¤©ä¸æ˜ç™½ï¼Œé‚£è°å¹²æ´»å‘¢ï¼Ÿ é‚£è¾†å¼€äº†3å¹´çš„è½¦ æˆä¸ºäº†ä½ çœŸæ­£çš„å®¶ ä½ ä¸åœ¨æŠ±æ€¨è·¯ä¸Šæ‹¥å µçš„äº¤é€š ä½ ç”šè‡³å¼€å§‹å¸Œæœ› å†å¤šå µä¸€ä¼š å›åˆ°å®¶ï¼Œä½ å…³äº†å‘åŠ¨æœº åœ¨è½¦ä¸Šç‚¹äº†ä¸€æ ¹çƒŸ è¿™æ˜¯ä½ æ¯å¤©æœ€å¹¸ç¦çš„ååˆ†é’Ÿ è½¦å‰æ˜¯åŠŸååˆ©ç¦„ï¼Œè½¦å°¾æ˜¯æŸ´ç±³æ²¹ç› åˆ†å‰²çº¿ 35å² ä½ å› ä¸ºèº«ä½“è¶Šæ¥è¶Šå·® åŠ ç­è¶Šæ¥è¶Šå°‘ æ™‹å‡çš„é€Ÿåº¦ä¹Ÿè¶Šæ¥è¶Šç¼“æ…¢ é‚£å¤©ä¸‹ç­ï¼Œåª³å¦‡å‘Šè¯‰ä½  å­©å­è¦ä¸Šå¹¼å„¿å›­äº† åŒè¯­çš„ä¸€ä¸ªæœˆ3000 ä½ çš±äº†çš±çœ‰å¤´ï¼Œé‚£è¾¹å°±å·²ç»ä¸è€çƒ¦äº† â€œå››å•å…ƒçš„è€ç‹å®¶å­©å­ï¼Œä¸€ä¸ªæœˆ6000â€ â€œä½ å·²ç»è¿™æ ·äº†ï¼Œä½ æƒ³è®©å­©å­ä¹Ÿè¾“ï¼Ÿâ€ ä½ æ²¡è¯´è¯ï¼Œå›å±‹ç»™åª³å¦‡è½¬äº†6000å—é’± è¿™ç¬”é’±ï¼Œä½ åŸæœ¬æ‰“ç®—ç»™è‡ªå·±è¿‡ä¸ªç”Ÿæ—¥ï¼Œä¹°ä¸ªæ–°ç”µè„‘ åˆ†å‰²çº¿ 38å²ï¼Œå­©å­ä¸Šäº†ä¸€å¹´çº§ è€å¸ˆè¯´ä¸€å¹´çº§æœ€å…³é”®ï¼Œæ‰“å¥½åŸºç¡€å¾ˆé‡è¦ ä½ ç¬‘ç€è¯´ï¼Œæ˜¯æ˜¯æ˜¯ï¼Œè€å¸ˆæ‚¨å¤šç…§é¡¾ æ–°ç”Ÿæ¥å¾…çš„è€å¸ˆçœ‹ç€ä½ ä¸æ˜äº‹ç†çš„è„¸ ç»™ä½ æŒ‡äº†ä¸€æ¡æ˜è·¯ â€œè¯¾å¤–è¾…å¯¼ç­ï¼Œä¸€ä¸ªæœˆ2200â€ 40å²çš„æ—¶å€™ï¼Œå­©å­ä¸Šäº†ä¸‰å¹´çº§ è€å¸ˆè¯´ï¼Œä¸‰å¹´çº§ï¼Œæœ€å…³é”®ï¼Œæ‰¿ä¸Šå¯ä¸‹å¾ˆé‡è¦ ä½ ç¬‘ç€è¯´ï¼šæ˜¯æ˜¯æ˜¯ï¼Œæ­£æ‰“ç®—å†æŠ¥ä¸ªè¡¥ä¹ ç­ åˆ†å‰²çº¿ 44å²ï¼Œå­©å­ä¸Šäº†åˆä¸­ æœ‰ä¸€å¤©å›åˆ°å®¶ï¼Œå¥¹å¯¹ä½ è¯´ çˆ¸çˆ¸ï¼Œæˆ‘æƒ³å­¦é’¢ç´ ä½ æ²¡ä»€ä¹ˆçŠ¹è±«çš„ ä½ ä»¥ä¸ºè¿™äº›å¹´ï¼Œä½ å·²ç»ä¹ æƒ¯äº† ä½†é‚£å¥â€œçˆ¸çˆ¸ç°åœ¨ä¹°ä¸èµ·â€ä½ å§‹ç»ˆè¯´ä¸å‡ºå£ å¥½åœ¨å­©å­æ¯”è¾ƒæ‡‚äº‹ å¥¹è¯´ï¼šçˆ¸çˆ¸æ²¡äº‹ï¼Œè¦ä¸æˆ‘å…ˆå­¦é™¶ç¬›ä¹Ÿå¯ä»¥ ä½ çœ‹ç€è¿™ä¹ˆæ‡‚äº‹çš„å­©å­ï¼Œå´å¼€å¿ƒä¸èµ·æ¥ åˆ†å‰²çº¿ 46å²ï¼Œå­©å­ä¸Šäº†ä¸€ä¸ªä¸å¥½ä¸å·®çš„é«˜ä¸­ æœ‰ä¸€å¤©ä½ åœ¨å¼€ä¼šï¼Œæ¥åˆ°äº†è€å¸ˆçš„ç”µè¯ ç”µè¯é‡Œè¯´ä½ çš„å­©å­åœ¨å­¦æ ¡æ‰“æ¶äº† å«ä½ å»ä¸€è¶Ÿ ä½ å”¯å”¯è¯ºè¯ºçš„ å’Œé‚£ä¸ªæ¯”ä½ è¿˜å°5å²çš„é¢†å¯¼è¯·äº†ä¸ªå‡ åˆ°å­¦æ ¡åˆè¢«è€å¸ˆè®­äº†ä¸€é€š æ— éå°è¯å°±æ˜¯é‚£ä¸€å¥ ä½ ä»¬åšå®¶é•¿çš„å°±çŸ¥é“å·¥ä½œï¼Œèƒ½ä¸èƒ½é™ªé™ªå­©å­ ä½ çœ‹ç€è¿™ä¸ªè€å¸ˆï¼Œæœ‰ç‚¹å¯ç¬‘ å¥½åƒå½“æ—¶è¯´ï¼š å®¶é•¿åœ¨å¤–è¾›è‹¦ç‚¹ å¤šèµšç‚¹é’±è®©å­©å­å¤šè¡¥è¡¥è¯¾çš„å’Œä»–ä¸æ˜¯ä¸€ä¸ªäºº åˆ†å‰²çº¿ 50å²ï¼Œå­©å­ä¸Šäº†å¤§å­¦ å¾ˆäº‰æ°”ï¼Œæ˜¯ä¸€ä¸ªä¸€æœ¬ ä»–å­¦çš„ä¸“ä¸šä½ æœ‰ç‚¹çœ‹ä¸æ‡‚ ä½ åªçŸ¥é“å·¥ä½œä¸ä¸€å®šå¥½æ‰¾ è€Œä¸”å­¦è´¹è¿˜æ­»è´µ ä½ å’Œä»–æ·±å¤œæƒ³èŠèŠ å‡†å¤‡äº†åŠæ–¤ç™½é…’ï¼Œä¸€ç¢ŸèŠ±ç”Ÿç±³ ä½ è¯´ç€é‚£äº›æ›¾ç»ä½ æœ€è®¨åŒçš„è¯ è¿˜æ˜¯è¦ä¸ºä»¥åå·¥ä½œç€æƒ³ æŒ‘ä¸ªçƒ­é—¨çš„ä¸“ä¸š æ´»ç€æ¯”çƒ­çˆ±é‡è¦ ä½ ä»¬ä»äº¤æµå˜æˆäº†äº‰åµ ä½ å‘ç°ï¼Œä½ è€äº† è€åˆ°å¯èƒ½éƒ½æ‰“ä¸è¿‡è¿™ä¸ª18å²çš„å­©å­ ä½ è¯´ä¸è¿‡ä»–ï¼Œåªèƒ½è¯´ä¸€å¥ï¼šæˆ‘æ˜¯ä½ çˆ¸çˆ¸ï¼ å­©å­çœ‹ç€ä½ ï¼ŒçŸ¥é“å†æ€ä¹ˆäº‰è¾©éƒ½æ²¡ç”¨ è¿™åœºç¡®ç«‹ä½ æœ€åå¨ä¸¥çš„é…’å±€ä¸æ¬¢è€Œæ•£ ä½ å¬çš„ä¸çœŸåˆ‡ åœ¨å­©å­å›è‡ªå·±å±‹çš„è·¯ä¸Šå¥½åƒå¨å¨äº†ä¸€å¥ â€œæˆ‘ä¸æƒ³æ´»çš„åƒä½ ä¸€æ ·â€ æ€ä¹ˆå°±å“­äº†å‘¢ï¼Ÿ50å²çš„äººäº† ä¸€å®šæ˜¯é…’å¤ªè¾£äº†ï¼Œå¯¹ä¸å¯¹ ä¸€å®šæ˜¯é…’å¤ªè¾£äº† åˆ†å‰²çº¿ 55å²ï¼Œå­©å­å·¥ä½œäº†ï¼Œä¼¼ä¹æœ‰ä¸€ç‚¹ç†è§£ä½ äº† ä½†ä½ å´åäº†è¿‡æ¥ï¼Œä½ è¯´ä¸è¦å¦¥å 56å²ï¼Œå­©å­ä¹Ÿç»“å©šäº† ä½ é—®ä»–å–œæ¬¢é‚£ä¸ªå§‘å¨˜ä¹ˆ ä»–æ„£äº†æ„£è¯´ï¼šå–œæ¬¢å§ 60å²ï¼Œè¾›è‹¦äº†ä¸€è¾ˆå­ï¼Œæƒ³å‡ºå»èµ°èµ° èº«è¾¹çš„é‚£ä¸ªäººè¿‡äº†30å¹´ ä½ ä¾æ—§åˆ†ä¸æ¸…åˆ°åº•å–œä¸å–œæ¬¢ ä½ ä»¬å¼€å§‹è§„åˆ’æ—…æ¸¸è·¯çº¿ è¿™ä¹ˆå¤šå¹´äº† ä½ ä»¬è¿˜æ˜¯å­˜åœ¨åˆ†æ­§ï¼Œè¿˜æ˜¯åœ¨äº‰åµ æŸä¸ªç¬é—´ï¼Œä½ è§‰å¾— è¿™æ ·å¯èƒ½ä¹ŸæŒºå¥½ ä¸€åˆ‡éƒ½å‡†å¤‡å¥½äº† å„¿å­è¯´ï¼šçˆ¸å¦ˆï¼Œæˆ‘å·¥ä½œå¤ªå¿™äº† å¯ä»¥å¸®æˆ‘ç…§é¡¾ä¸€ä¸‹å­©å­ä¹ˆ ä½ ä»¬é€€äº†æœºç¥¨ï¼Œåˆå›åˆ°äº†30å¹´å‰ åˆ†å‰²çº¿ 70å²ï¼Œå­©å­çš„å­©å­ä¹Ÿé•¿å¤§äº†ï¼Œä¸ç”¨å¤©å¤©æ“å¿ƒäº† ä½ ä¸‹å®šå†³å¿ƒè¯´ï¼šä¸€å®šè¦å»ç©ä¸€è¶Ÿ å¯æ˜¯æ‰‹è¾¹çš„æ‹æ– åªèƒ½æ”¯æŒä½ èµ°åˆ°æ¥¼ä¸‹çš„èŠ±å›­ 75å²ï¼Œä½ åœ¨åŒ»é™¢çš„ç—…åºŠä¸Š èº«è¾¹èšæ»¡äº†äººï¼Œä½ è¿·è¿·ç³Šç³Šçš„çœ‹è§åŒ»ç”Ÿæ‘‡äº†æ‘‡å¤´ å‘¨å›´é‚£äº›äººç¥æƒ…è‚ƒç©† ä½ æ˜ç™½äº†ï¼Œä½ è¦æ­»æ‰äº† ä½ æ²¡æœ‰æ„Ÿåˆ°ä¸€ä¸å®³æ€• ä½ çªç„¶é—®è‡ªå·±ï¼Œæˆ‘åˆ°åº•æ˜¯ä»€ä¹ˆæ—¶å€™æ­»æ‰çš„å‘¢ï¼Ÿ ä½ æƒ³èµ·æ¥30å²çš„é‚£åœºå©šç¤¼ åŸæ¥ï¼Œé‚£æ—¶å€™ï¼Œä½ å°±æ­»æ‰äº†å§ åˆ†å‰²çº¿ ä¾ç…§æƒ¯ä¾‹ æ­»å‰çš„3ç§’ï¼Œä½ çš„å¤§è„‘è¦èµ°é©¬ç¯ å€’å™ä½ è¿™75ä¸ªå¹´å¤´çš„ä¸€ç”Ÿ ç”»é¢ä¸€å¼ ä¸€å¼ çš„è¿‡ 1ç§’ 2ç§’ ä¸¤ç§’è¿‡å»äº† ä½ é¢æ— è¡¨æƒ…çš„çœ‹ç€è¿™ä¸¤ç§’å†…çš„å›å¿† ç¬¬3ç§’ çªç„¶ä½ ç¬‘äº† åŸæ¥å·²ç»å›åˆ°äº†15å²çš„é‚£ä¸€å¹´ åˆ†å‰²çº¿ ä½ çœ‹è§ä¸€ä¸ªç”·å­© ä»–å¼ç€ä¸€è¢‹ç‰›å¥¶ï¼ŒèƒŒç€ä¹¦åŒ… ä»å¦ä¸€ä¸ªå¥³å­©å®¶çš„é˜³å°ä¸‹è·‘è¿‡ é‚£ä¸ªç”·å­©æœçª—æˆ·é‡Œçœ‹äº†çœ‹ é‚£æ˜¯15å²çš„ä½ æš—æ‹çš„é‚£ä¸ªå¥³å­©å­ ä½ æƒ³ä¸èµ·æ¥å¥¹é•¿ä»€ä¹ˆæ ·å­äº† æœ€åä¸€ç§’ä½ åŠªåŠ›çš„å›å¿†ç€ ç„¶åç»ˆäºç¬‘äº†å‡ºæ¥ 3ç§’è¿‡å»äº† èº«è¾¹çš„äººçªç„¶é—´å¼€å§‹åšå••å¤§å“­ ä½ å¯èƒ½å¬ä¸æ¸…äº† ä½ æœ€åå¬åˆ°çš„å˜ˆæ‚çš„å£°éŸ³ æ˜¯ä¸€ç¾¤åäº”å…­çš„å°‘å¹´ èµ·ç€å“„è¯´çš„ ç­”åº”ä»– ç­”åº”ä»– ç­”åº”ä»– ä¸çˆ±ä½ ï¼Œä¸åº¦ç”Ÿ å–ä¸€ä½è´¦å·å·²æ³¨é”€çš„è¯„è®ºï¼šâ€œæœ‰äº›äºº27å²å°±æ­»äº†ï¼Œç›´åˆ°72å²æ‰è¢«åŸ‹ä¸Šâ€ã€‚èƒ½å¤Ÿæƒ³æ¸…æ¥šè¿‡å»ï¼ŒæŠ“å¾—ä½ç°åœ¨ï¼Œæ”¾çœ¼åœ¨æœªæ¥å§ï¼Œåšä¸€ä¸ªèƒ½æ´»åˆ°72å²çš„ç³Šæ¶‚è›‹ã€‚ ","link":"https://kily-007.github.io/post/ç”Ÿæ´»-å—åŸæ•…äºº/"},{"title":"æ•™å­¦-2020-06-10","content":"Valineè¯„è®ºç³»ç»Ÿ Valineè¯„è®ºç³»ç»Ÿ ç®€ä»‹ LeanCoundæ³¨å†Œé…ç½®è¯´æ˜ ","link":"https://kily-007.github.io/post/æ•™å­¦-2020-06-10/"},{"title":"æ™š é—²æš‡éšç¬”","content":" é«˜ä¸­æ¯•ä¸šä»¥åï¼Œä¾¿é€‰æ‹©äº†è®¡ç®—æœºè¿™ä¸ªä¸“ä¸šï¼Œæ—¶è‡³ä»Šæ—¥ä¹Ÿæœªæ›¾å†™è¿‡äº›ä»€ä¹ˆï¼Œåœ¨åšå®¢ä¸­å»ºäº†ä¸€ä¸ªç”Ÿæ´»è®°å½•çš„æ¿å—ï¼Œä¸€æ—¶ä¸çŸ¥é“å†™äº›ä»€ä¹ˆã€‚ è®°å¾—é«˜ä¸­é‚£æ—¶ç»å¸¸è¦å†™äº›æ–‡å­—çš„ä¾¿æ˜¯è¯­æ–‡ä½œæ–‡äº†å§ï¼Œä½œæ–‡è¦æ±‚ç»å¸¸æ˜¯è®®è®ºæ–‡ï¼Œä¸€èˆ¬æŒ‰ç€æ€»åˆ†æ€»æˆ–è€…æ€»åˆ†çš„ç»“æ„ï¼Œå±‚å±‚åˆ†æä¸€ä¸‹ä¾¿äº†äº‹ã€‚ä¸çŸ¥ä¸è§‰ä¾¿å›å¿†èµ·äº†è¿‡å»ï¼Œä¸çŸ¥é“æ˜¯äººçœŸçš„è€äº†è¿˜æ˜¯å¦‚ä½•ï¼Œè½¬çœ¼ä¾¿åˆ°äº†æ¯•ä¸šçš„å¹´çºªï¼ŒæŒ‰æ´»åˆ°å¤ç¨€ä¹‹å¹´ç®—çš„è¯ï¼Œè¿™è¾ˆå­å·²è¿‡å»äº†ä¸‰åˆ†ä¹‹ä¸€å§ã€‚ å—¨ï¼Œç°å¦‚ä»Šæ­£å€¼é£åæ­£ï¼Œä¾¿ä¸è¯´é‚£äº›ä¸§æ°”çš„è¯äº†ã€‚ä¸–ç•Œä¹‹å¤§ï¼Œè¿˜æœ‰è®¸å¤šæœ‰è¶£çš„åœ°æ–¹è¦å»ï¼›ç¾é£Ÿä¹‹å¤šï¼Œè¿˜æœ‰è®¸å¤šåƒçš„ç­‰ç€æˆ‘å»å“å°ï¼›å¡åœä¸€ä¸‹ï¼Œè¯´èµ·åƒçš„æˆ‘ä¾¿ä¸å¾—ä¸è¯´ï¼Œå¥½åƒçš„ä¸œè¥¿å¯¹æˆ‘æ¥è¯´å°±åƒæ˜¯ä¸€å‰‚è‰¯è¯ï¼Œæ— è®ºä½•æ—¶ä½•åœ°ï¼Œæ— è®ºå¼€å¿ƒä¸å¦ï¼Œå½“åƒåˆ°å¥½åƒçš„æ—¶å€™ï¼Œæ„Ÿè§‰åˆ°å‘³è•¾ç‚¸è£‚çš„ç¬é—´ï¼Œèƒ½è®©æˆ‘å¿ƒæƒ…ç¬é—´èˆ’é€‚ä¸‹æ¥ï¼Œå¯èƒ½è¿™å°±æ˜¯ä¸€ä¸ªåƒè´§çš„æœ¬è´¨äº†å§å“ˆå“ˆã€‚ä¸å¦‚ï¼Œå°±é¡ºä¾¿è®°å½•ä¸€ä¸‹æ›¾ç»åƒè¿‡çš„è§‰å¾—å¥½åƒçš„é£Ÿç‰©å§ï¼š é‡åº†å°ç«é”…ï¼š ç¬¬ä¸€æ¬¡å»é‡åº†æ˜¯ä¸å®¤å‹è€é€—ä¸€å—å„¿å§ï¼Œé‚£æ—¶æ­£è¯»å¤§äºŒï¼Œå‘¨æœ«æœ‰ä¸¤å¤©çš„æ—¶é—´ä¾¿æ¥äº†ä¸€åœºè¯´èµ°å°±èµ°çš„æ—…è¡Œï¼ŒæŒ‰ç…§è¡Œç¨‹çš„è§„åˆ’ï¼Œåˆ°è¾¾é‡åº†å½“åœ°ä¹‹åé¦–è¦ä¾¿æ˜¯å½“åœ°çš„ç«é”…ï¼Œä¸å¾—ä¸è¯´é‡åº†çš„ç«é”…ç¡®å®å¥½åƒï¼Œä¸æ­¦æ±‰ç›¸æ¯”èµ·æ¥ä¸ä¼šåƒåˆ°æœ€åæœ‰è‹¦å‘³å„¿ï¼Œå¤§æ¦‚ç«é”…ä¸Šé¢ä¼šæ¼‚æµ®ä¸€å±‚çº¢è‰²çš„è¾£æ¤’ï¼Œç‰¹åˆ«çš„æœ‰è§†è§‰å†²å‡»åŠ›ï¼Œç„¶åä¼šæœ‰ä¸€ç¢—æ²¹ï¼Œæ˜¯ä¸ºäº†ç»™å¤¹èµ·æ¥çš„é£Ÿç‰©é™æ¸©ï¼Œç„¶åä¹Ÿèƒ½é™è¾£ã€‚ é…±å­é±¼ï¼šåƒçš„æœ€å¤šçš„ä¾¿æ˜¯è¡—é“å£é‚£å®¶äº†å§ï¼Œæœ‰è®¸å¤šå›å¿†ä¾¿ç•™åœ¨äº†é‚£ä¸ªåœ°æ–¹ï¼Œæ¨èå…¶ä¸­çš„é’æ¤’å‘³å„¿å’Œéº»è¾£å‘³å„¿ã€‚ é•¿æ²™è‡­è±†è…ï¼šè¿™ä¸ªä¸€å®šè¦å»æœ¬åœ°ä¹°ï¼Œè·¯è¾¹çš„å°åº—æˆ–è€…æ‘Šè´©ï¼Œå‘³é“ç‰¹åˆ«æ­£å®—ï¼Œä¸åˆ«å¤„ç¨æœ‰ä¸åŒï¼Œåƒèµ·æ¥æ±¤æ±åœ¨å£ä¸­è¿¸å‘ï¼Œç”­æå¤šå¥½åƒäº†ï¼Œè‰¾ç›å£æ°´éƒ½å‡ºæ¥äº†å’±èµ¶ç´§ä¸‹ä¸€ä¸ªã€‚ ä¹¡å·´ä½¬å°é¸¡è…¿ï¼šæœ€åˆæ˜¯å¥½æœ‹å‹ç»™æˆ‘ä¹°è¿‡ä¸€æ¬¡ï¼Œåæ¥è‡ªå·±æ‹æ‹ä¸å¿˜åˆè‡ªä¸ªå„¿åœ¨æ·˜å®ä¸Šä¹°ï¼Œä¾¿å®œå¥½åƒï¼Œå……é¥¥è§£é¦‹å¿…å¤‡è‰¯å“ã€‚ å·¥å¤§è·¯å·é¥¼ï¼šå­¦æ ¡å‘¨è¾¹æ€»ä¼šæœ‰å¾ˆå¤šåƒçš„ï¼Œæœ€çˆ±çš„ä¾¿æ˜¯å·¥å¤§è·¯çš„é‚£å®¶å·é¥¼äº†å§ï¼Œè–„è–„çš„é¢çš®è£¹ä¸Šé¸¡è›‹ã€ç«è…¿è‚ å’Œè‚‰æ¾ï¼Œç”­æå¤šé¦™äº†å‘€ã€‚ é’µé’µé¸¡ï¼šä¸²ä¸Šé¸¡çˆªã€è¿˜å¸¦ã€åœŸè±†ã€é¸¡èƒ—ã€é¹Œé¹‘è›‹ï¼Œåœ¨è°ƒå¥½çš„å‘³æ±å„¿é‡Œæµ¸æ³¡ï¼Œä¿©ä¸ªå­—å„¿æè¿°ï¼šè¶…å¥½åƒã€‚ æš‚æ—¶æƒ³ä¸åˆ°è¿˜æœ‰å•¥äº†ï¼Œå ä¸ªä½å„¿ï¼Œç­‰æƒ³åˆ°äº†å†å¾€ä¸Šæ·» æ²¡å¿ä½å°±å›æƒ³äº†ä¸€æ³¢åƒçš„ï¼Œå¤§æ™šä¸Šçš„æçš„æˆ‘æµäº†ä¸€åœ°å£æ°´ï¼Œåƒè´§çš„æœ¬è´¨æš´éœ²æ— ç–‘äº†ï¼Œç¬¬ä¸€æ¬¡åœ¨åšå®¢ä¸Šå†™äº›ä¸œè¥¿ï¼Œæœ‰äº›å‡Œä¹±ï¼Œæ–‡å­—è¡¨è¾¾ä¸ç”¨é€€åŒ–äº†è®¸å¤šï¼Œå¾ˆå¤šåœ°æ–¹è¯ä¸è¾¾æ„çš„ï¼Œå¤šå†™å†™åº”è¯¥ä¼šæœ‰è¿›æ­¥ï¼Œå†æ¥å†å‰ï¼ŒåŠ æ²¹æ¬§è€¶ï¼ğŸ˜ƒ ","link":"https://kily-007.github.io/post/ç”Ÿæ´»-æ™š é—²æš‡éšç¬”/"},{"title":"Grideaä¸»é¢˜æ¨è","content":"è¯´æ˜ Grideaå®˜ç½‘çš„ä¸»é¢˜å¸‚åœºä¸­ç°åœ¨å…±æœ‰27ä¸ªä¸»é¢˜ï¼Œå…¶ä¸­åŒ…å«3ä¸ªä»˜è´¹ä¸»é¢˜å’Œ24ä¸ªå…è´¹ä¸»é¢˜ï¼Œä½†æ˜¯é¢å¯¹çŒ¿å„¿ä»¬å¹¿å¤§çš„å®¡ç¾éœ€æ±‚ï¼Œæ˜¾ç„¶æ˜¯ä¸å¤Ÿç”¨çš„ï¼Œç»è¿‡ä¸€æ³¢ç®€å•çš„èµ°è®¿ï¼Œæ‰¾åˆ°äº†ä¸€äº›å…¶å®ƒçš„å¼€æºä¸»é¢˜ï¼Œåœ¨è¿™é‡Œå’Œå¤§å®¶åˆ†äº«ä¸€ä¸‹ï¼Œåç»­é‡åˆ°å¥½çœ‹çš„ä¸»é¢˜ä¼šåœ¨è¿™é‡ŒæŒç»­æ›´æ–°ã€‚ Githubä¸Šçš„ ä¸»é¢˜ï¼šzero ç¤ºä¾‹ç½‘ç«™ï¼šhttps://kveln.cn/ æè¿°ï¼šä¸€æ¬¾ç®€æ´ä¸“æ³¨äºå†™ä½œçš„Grideaåšå®¢ä¸»é¢˜ ç‰¹è‰²ï¼šåŒ…å«æ‘„å½±ã€ç”µå½± æˆªå›¾ï¼š ","link":"https://kily-007.github.io/post/Gridea-éå†Grideaä¸»é¢˜/"},{"title":"æ•™å­¦-2020-06-08","content":"å­¦ä¹ å†…å®¹ï¼š GitHubæ³¨å†Œï¼Œè¿œç¨‹ä»“åº“åˆ›å»ºã€‚ Grideaåšå®¢æ­å»ºã€‚ åœç®—å­ç½‘é¡µè®¿é—®æ¬¡æ•°ç»Ÿè®¡ã€‚ HbuildXå®‰è£…ï¼Œå¹¶æŸ¥çœ‹Grdieaæºç ã€‚ Htmlã€CSSã€Jsç®€ä»‹ã€‚ ä½œä¸šï¼š æ’°å†™â€œå…³äºâ€ç•Œé¢çš„åšå®¢ï¼Œå†…å®¹ä¸ºè‡ªæˆ‘ä»‹ç»ã€‚ ","link":"https://kily-007.github.io/post/æ•™å­¦-2020-06-08/"},{"title":"Grideaæ·»åŠ ç™¾åº¦ç»Ÿè®¡","content":"Grideaé»˜è®¤ä»…æ”¯æŒè°·æ­Œç»Ÿè®¡ï¼Œè€Œå›½å†…è®¿é—®è°·æ­Œç½‘ç«™å—é™ï¼Œåœ¨æ­¤æ ¹æ®githubä¸Šçš„èµ„æºï¼Œæ•´åˆäº†æ·»åŠ ç™¾åº¦ç»Ÿè®¡çš„åŠŸèƒ½ã€‚ æ›´æ”¹ä¸»é¢˜ä»£ç  åœ¨å¯¹åº”çš„ä¸»é¢˜æ–‡ä»¶ç›®å½•ä¸‹ï¼Œæœ¬äººä¸ºGridea\\themes\\pure\\config.jsonï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæ©˜çº¢è‰²åœˆä¸­ä¸ºç™¾åº¦ç»Ÿè®¡æ·»åŠ ä»£ç ã€‚é‡æ–°å¯åŠ¨Grideaç•Œé¢ï¼Œåœ¨ä¸»é¢˜-è‡ªå®šä¹‰é…ç½®æœ€ä¸‹é¢ä¼šå‡ºç°ç™¾åº¦ç»Ÿè®¡çš„æ¨¡å—åˆ™ç¬¬ä¸€æ­¥æˆåŠŸã€‚ ç”³è¯·ç™¾åº¦ç»Ÿè®¡å¹¶é…ç½®JSä»£ç  æ³¨å†Œç™¾åº¦ç»Ÿè®¡-ç«™é•¿ç‰ˆ https://tongji.baidu.com/web/welcome/login æ·»åŠ åšå®¢ç½‘ç«™åˆ°ç™¾åº¦ç»Ÿè®¡ ç™¾åº¦ç»Ÿè®¡JSä»£ç è·å– å°†å¯¹åº”çš„ç™¾åº¦ç»Ÿè®¡JSä»£ç æ·»åŠ åˆ°Grideaç•Œé¢ä¸­çš„ä¸»é¢˜-è‡ªå®šä¹‰é…ç½®-ç™¾åº¦ç»Ÿè®¡ä¸­ ","link":"https://kily-007.github.io/post/Gridea-æ·»åŠ ç™¾åº¦ç»Ÿè®¡/"},{"title":"åºè´¯ç›¸ä¼¼æ€§æ£€æµ‹ç®—æ³•(SSDA)","content":"åºè´¯ç›¸ä¼¼æ€§æ£€æµ‹ç®—æ³•ï¼ˆSSDAï¼‰ ä¼ ç»Ÿçš„æ¨¡æ¿åŒ¹é…ç®—æ³•çš„åŸºæœ¬æœç´¢ç­–ç•¥æ˜¯éå†æ€§çš„ï¼Œä¸ºäº†æ‰¾åˆ°æœ€ä¼˜åŒ¹é…ç‚¹ï¼Œä¼ ç»Ÿæ–¹æ³•å‡å¿…é¡»åœ¨æœç´¢åŒºåŸŸå†…çš„æ¯ä¸€ä¸ªåƒç´ ç‚¹ä¸Šè¿›è¡ŒåŒºåŸŸç›¸å…³åŒ¹é…è®¡ç®—ï¼Œå›¾åƒç›¸å…³åŒ¹é…çš„æ•°æ®é‡å’Œè®¡ç®—é‡å¾ˆå¤§ï¼ŒåŒ¹é…é€Ÿåº¦è¾ƒæ…¢ï¼Œåºè´¯ç›¸ä¼¼æ€§æ£€æµ‹ç®—æ³•ï¼ˆSSDAï¼‰æ˜¯é’ˆå¯¹ä¼ ç»Ÿæ¨¡æ¿åŒ¹é…ç®—æ³•æå‡ºçš„ä¸€ç§é«˜æ•ˆçš„å›¾åƒåŒ¹é…ç®—æ³•ã€‚å…·ä½“ç®—æ³•æ˜¯å…ˆåˆæ­¥æœç´¢ï¼Œå†ç²¾æœç´¢ï¼Œæœç´¢çš„èŒƒå›´ä¸€æ­¥ä¸€æ­¥å‡å°ã€‚ æ€è·¯ SSDAé€šè¿‡äººä¸ºè®¾å®šä¸€ä¸ªå›ºå®šé˜ˆå€¼ï¼ŒåŠæ—©åœ°ç»ˆæ­¢åœ¨ä¸åŒ¹é…ä½ç½®ä¸Šçš„è®¡ç®—ï¼Œä»¥æ­¤å‡å°è®¡ç®—é‡ï¼Œè¾¾åˆ°æé«˜è¿ç®—é€Ÿåº¦çš„ç›®çš„ã€‚å…¶æ­¥éª¤å¦‚ä¸‹ï¼š ï¼ˆ1ï¼‰é€‰å–ä¸€ä¸ªè¯¯å·®å‡†åˆ™ï¼Œä½œä¸ºç»ˆæ­¢ä¸åŒ¹é…ç‚¹è®¡ç®—çš„æ ‡å‡†ï¼Œé€šå¸¸å¯é€‰å–ç»å¯¹è¯¯å·® ï¼ˆ2ï¼‰è®¾å®šä¸€ä¸ªä¸å˜é˜ˆå€¼ ï¼ˆ3ï¼‰åœ¨å­å›¾è±¡ä¸­éšæœºé€‰å–ä¸€ç‚¹ï¼Œè®¡ç®—å®ƒä¸æ¨¡æ¿ä¸­ç›¸åº”ç‚¹çš„ç»å¯¹è¯¯å·®å€¼ï¼Œ å°†æ¯ä¸€éšæœºç‚¹å¯¹çš„è¯¯å·®ç´¯åŠ èµ·æ¥ï¼Œè‹¥ç´¯åŠ åˆ°ç¬¬ræ¬¡æ—¶è¯¯å·®è¶…è¿‡è®¾å®šé˜ˆå€¼ï¼Œåˆ™åœæ­¢ç´¯åŠ ï¼Œè®°ä¸‹æ­¤æ—¶çš„ç´¯åŠ æ¬¡æ•°r ï¼ˆ4ï¼‰ å¯¹äºæ•´ å¹…å›¾åƒè®¡ç®—è¯¯å·®eï¼Œå¯å¾—åˆ°ä¸€ä¸ªç”±rå€¼æ„æˆçš„æ›²é¢ï¼Œæ›²é¢æœ€å¤§å€¼å¤„å¯¹åº”çš„ä½ç½®å³ä¸ºæ¨¡æ¿æœ€ä½³åŒ¹é…ä½ç½®ã€‚è¿™æ˜¯å› ä¸ºè¯¥ç‚¹éœ€è¦å¤šæ¬¡ç´¯åŠ è¯¯å·®æ‰èƒ½è¶…è¿‡é˜ˆå€¼ï¼Œå› æ­¤ç›¸å¯¹äºå…¶å®ƒç‚¹ï¼Œå®ƒæœ€æœ‰å¯èƒ½æ˜¯åŒ¹é…ä½ç½®ã€‚ æ¨å¯¼ å‡è®¾ï¼šS(x,y)æ˜¯MxNçš„æœç´¢å›¾ï¼ŒT(x,y)æ˜¯mxnçš„æ¨¡æ¿å›¾ï¼Œæ˜¯æœç´¢å›¾ä¸­çš„ä¸€ä¸ªå­å›¾ï¼ˆå·¦ä¸Šè§’èµ·å§‹ä½ç½®ä¸º(i,j)ï¼‰ã€‚åˆ™å­˜åœ¨ 1â‰¤iâ©½mâˆ’Mâˆ’1,1â‰¤jâ‰¥nâˆ’Nâˆ’11\\leq i\\leqslant m-M-1,1\\leq j\\geq n-N-1 1â‰¤iâ©½mâˆ’Mâˆ’1,1â‰¤jâ‰¥nâˆ’Nâˆ’1 SSDAç®—æ³•æè¿°å¦‚ä¸‹ï¼š â‘ å®šä¹‰ç»å¯¹è¯¯å·®ï¼š Îµ(i,j,s,t)=âˆ£Si,j(s,t)âˆ’Si,jâ€¾âˆ’T(s,t)+Tâ€¾âˆ£\\varepsilon ( i,j,s,t )=\\mid S_{i,j}(s,t)-\\overline{S_{i,j}}-T(s,t)+\\overline{T}| Îµ(i,j,s,t)=âˆ£Si,jâ€‹(s,t)âˆ’Si,jâ€‹â€‹âˆ’T(s,t)+Tâˆ£ å…¶ä¸­ï¼Œå¸¦æœ‰ä¸Šåˆ’çº¿çš„åˆ†åˆ«è¡¨ç¤ºå­å›¾ã€æ¨¡æ¿çš„å‡å€¼ï¼š Si,jâ€¾=E(Si,j)=1Mâˆ—Nâˆ‘s=1Mâˆ‘t=1NSi,j(s,t)\\overline{S_{i,j}}=E(S_{i,j})=\\frac{1}{M*N}\\sum_{s=1}^{M}\\sum_{t=1}^{N}S_{i,j}(s,t) Si,jâ€‹â€‹=E(Si,jâ€‹)=Mâˆ—N1â€‹s=1âˆ‘Mâ€‹t=1âˆ‘Nâ€‹Si,jâ€‹(s,t) Tâ€¾=E(T)=1Mâˆ—Nâˆ‘s=1Mâˆ‘t=1NT(s,t)\\overline{T}=E(T)=\\frac{1}{M*N}\\sum_{s=1}^{M}\\sum_{t=1}^{N}T(s,t) T=E(T)=Mâˆ—N1â€‹s=1âˆ‘Mâ€‹t=1âˆ‘Nâ€‹T(s,t) å®é™…ä¸Šï¼Œç»å¯¹è¯¯å·®å°±æ˜¯å­å›¾ä¸æ¨¡æ¿å›¾å„è‡ªå»æ‰å…¶å‡å€¼åï¼Œå¯¹åº”ä½ç½®ä¹‹å·®çš„ç»å¯¹å€¼ã€‚ â‘¡è®¾å®šé˜ˆå€¼Thï¼› â‘¢åœ¨æ¨¡æ¿å›¾ä¸­éšæœºé€‰å–ä¸é‡å¤çš„åƒç´ ç‚¹ï¼Œè®¡ç®—ä¸å½“å‰å­å›¾çš„ç»å¯¹è¯¯å·®ï¼Œå°†è¯¯å·®ç´¯åŠ ï¼Œå½“è¯¯å·®ç´¯åŠ å€¼è¶…è¿‡äº†Thæ—¶ï¼Œè®°ä¸‹ç´¯åŠ æ¬¡æ•°Hï¼Œæ‰€æœ‰å­å›¾çš„ç´¯åŠ æ¬¡æ•°Hç”¨ä¸€ä¸ªè¡¨R(i,j)æ¥è¡¨ç¤ºã€‚SSDAæ£€æµ‹å®šä¹‰ä¸ºï¼š R(i,j)=Hâˆ£min1â©½Hâ©½Mâˆ—N[âˆ‘hâˆ’1HÎµ(i,j,s,t)â©¾Th]R(i,j)={H|\\underset{1\\leqslant H\\leqslant M*N}{min}\\left [\\sum_{h-1}^{H}\\varepsilon ( i,j,s,t )\\geqslant Th \\right ]} R(i,j)=Hâˆ£1â©½Hâ©½Mâˆ—Nminâ€‹[hâˆ’1âˆ‘Hâ€‹Îµ(i,j,s,t)â©¾Th] ä¸‹å›¾ç»™å‡ºäº†Aã€Bã€Cä¸‰ç‚¹çš„è¯¯å·®ç´¯è®¡å¢é•¿æ›²çº¿ï¼Œå…¶ä¸­Aã€Bä¸¤ç‚¹åç¦»æ¨¡æ¿ï¼Œè¯¯å·®å¢é•¿å¾—å¿«ï¼›Cç‚¹å¢é•¿ç¼“æ…¢ï¼Œè¯´æ˜å¾ˆå¯èƒ½æ˜¯åŒ¹é…ç‚¹ï¼ˆå›¾ä¸­Tkç›¸å½“äºä¸Šè¿°çš„Thï¼Œå³é˜ˆå€¼ï¼›I(i,j)ç›¸å½“äºä¸Šè¿°R(i,j)ï¼Œå³ç´¯åŠ æ¬¡æ•°ï¼‰ã€‚ â‘£åœ¨è®¡ç®—è¿‡ç¨‹ä¸­ï¼Œéšæœºç‚¹çš„ç´¯åŠ è¯¯å·®å’Œè¶…è¿‡äº†é˜ˆå€¼ï¼ˆè®°å½•ç´¯åŠ æ¬¡æ•°Hï¼‰åï¼Œåˆ™æ”¾å¼ƒå½“å‰å­å›¾è½¬è€Œå¯¹ä¸‹ä¸€ä¸ªå­å›¾è¿›è¡Œè®¡ç®—ã€‚éå†å®Œæ‰€æœ‰å­å›¾åï¼Œé€‰å–æœ€å¤§Rå€¼æ‰€å¯¹åº”çš„(i,j)å­å›¾ä½œä¸ºåŒ¹é…å›¾åƒã€è‹¥Rå­˜åœ¨å¤šä¸ªæœ€å¤§å€¼ï¼ˆä¸€èˆ¬ä¸å­˜åœ¨ï¼‰ï¼Œåˆ™å–ç´¯åŠ è¯¯å·®æœ€å°çš„ä½œä¸ºåŒ¹é…å›¾åƒã€‘ã€‚ ç”±äºéšæœºç‚¹ç´¯åŠ å€¼è¶…è¿‡é˜ˆå€¼Thåä¾¿ç»“æŸå½“å‰å­å›¾çš„è®¡ç®—ï¼Œæ‰€ä»¥ä¸éœ€è¦è®¡ç®—å­å›¾æ‰€æœ‰åƒç´ ï¼Œå¤§å¤§æé«˜äº†ç®—æ³•é€Ÿåº¦ï¼›ä¸ºè¿›ä¸€æ­¥æé«˜é€Ÿåº¦ï¼Œå¯ä»¥å…ˆè¿›è¡Œç²—é…å‡†ï¼Œå³ï¼šéš”è¡Œã€éš”ç¦»çš„é€‰å–å­å›¾ï¼Œç”¨ä¸Šè¿°ç®—æ³•è¿›è¡Œç²—ç³™çš„å®šä½ï¼Œç„¶åå†å¯¹å®šä½åˆ°çš„å­å›¾ï¼Œç”¨åŒæ ·çš„æ–¹æ³•æ±‚å…¶8ä¸ªé‚»åŸŸå­å›¾çš„æœ€å¤§Rå€¼ä½œä¸ºæœ€ç»ˆé…å‡†å›¾åƒã€‚è¿™æ ·å¯ä»¥æœ‰æ•ˆçš„å‡å°‘å­å›¾ä¸ªæ•°ï¼Œå‡å°‘è®¡ç®—é‡ï¼Œæé«˜è®¡ç®—é€Ÿåº¦ã€‚ ","link":"https://kily-007.github.io/post/ç®—æ³•-åºè´¯ç›¸ä¼¼æ€§æ£€æµ‹ç®—æ³•-SSDA/"},{"title":"kafkaè‡ªå®šä¹‰åºåˆ—åŒ–ç±»","content":"kafkaç‰ˆæœ¬ zookeeperä½¿ç”¨ç‰ˆæœ¬ï¼šzookeeper-3.4.14.tar.gz kafkaä½¿ç”¨ç‰ˆæœ¬ï¼škafka_2.12-2.0.0.tgz pom.xmlä¾èµ–ï¼š &lt;dependency&gt; &lt;groupId&gt;org.apache.kafka&lt;/groupId&gt; &lt;artifactId&gt;kafka_2.12&lt;/artifactId&gt; &lt;version&gt;2.0.0&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.kafka&lt;/groupId&gt; &lt;artifactId&gt;kafka-clients&lt;/artifactId&gt; &lt;version&gt;2.0.0&lt;/version&gt; &lt;/dependency&gt; kafkaåŸç”Ÿåºåˆ—åŒ– kafkaåœ¨å‘é€å’Œæ¥å—æ¶ˆæ¯çš„æ—¶å€™ï¼Œéƒ½æ˜¯ä»¥byte[]å­—èŠ‚å‹æ•°ç»„å‘é€æˆ–è€…æ¥å—çš„ã€‚ä½†æ˜¯æˆ‘ä»¬å¹³å¸¸ä½¿ç”¨çš„æ—¶å€™ï¼Œä¸ä½†å¯ä»¥ä½¿ç”¨byte[]ï¼Œè¿˜å¯ä»¥ä½¿ç”¨intã€shortã€longã€floatã€doubleã€Stringç­‰æ•°æ®ç±»å‹ï¼Œè¿™æ˜¯å› ä¸ºåœ¨æˆ‘ä»¬ä½¿ç”¨è¿™äº›æ•°æ®ç±»å‹çš„æ—¶å€™ï¼Œkafkaæ ¹æ®æˆ‘ä»¬æŒ‡å®šçš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–æ–¹å¼è½¬æˆbyte[]ç±»å‹ä¹‹åå†è¿›è¡Œå‘é€æˆ–è€…æ¥å—çš„ã€‚ é€šå¸¸æˆ‘ä»¬åœ¨ä½¿ç”¨kakfaå‘é€æˆ–è€…æ¥å—æ¶ˆæ¯çš„æ—¶å€™éƒ½éœ€è¦æŒ‡å®šæ¶ˆæ¯çš„keyå’Œvalueåºåˆ—åŒ–æ–¹å¼ ,ä¾‹å¦‚ï¼š config.put(&quot;key.serializer&quot;, &quot;org.apache.kafka.common.serialization.StringSerializer&quot;); config.put(&quot;value.serializer&quot;, &quot;org.apache.kafka.common.serialization.StringSerializer&quot;); kafkaåºåˆ—åŒ–æ–¹å¼ åºåˆ—åŒ–æ–¹å¼ å¯¹åº”javaæ•°æ®ç±»å‹ è¯´æ˜ org.apache.kafka.common.serialization.ByteArraySerializer byte[] åŸç”Ÿç±»å‹ org.apache.kafka.common.serialization.ByteBufferSerializer ByteBuffer å…³äºByteBuffer org.apache.kafka.common.serialization.IntegerSerializer Interger org.apache.kafka.common.serialization.ShortSerializer Short org.apache.kafka.common.serialization.LongSerializer Long org.apache.kafka.common.serialization.DoubleSerializer Double org.apache.kafka.common.serialization.StringSerializer String kafkaååºåˆ—åŒ–æ–¹å¼ ååºåˆ—åŒ–æ–¹å¼ å¯¹åº”javaæ•°æ®ç±»å‹ è¯´æ˜ org.apache.kafka.common.serialization.ByteArrayDeserializer byte[] åŸç”Ÿç±»å‹ org.apache.kafka.common.serialization.ByteBufferDeserializer ByteBuffer å…³äºByteBuffer org.apache.kafka.common.serialization.IntegerDeserializer Interger org.apache.kafka.common.serialization.ShortDeserializer Short org.apache.kafka.common.serialization.LongDeserializer Long org.apache.kafka.common.serialization.DoubleDeserializer Double org.apache.kafka.common.serialization.StringDeserializer String kafkaåŸç”Ÿåºåˆ—åŒ–å®ç° ä»¥Stringä¸ºä¾‹å­ï¼Œæˆ‘ä»¬åˆ†ækafkaå¦‚ä½•å®ç°åºåˆ—åŒ–ä¸ååºåˆ—åŒ– Stringåºåˆ—åŒ– æŸ¥çœ‹ org.apache.kafka.common.serialization.StringSerializer ç±» /* * Licensed to the Apache Software Foundation (ASF) under one or more * contributor license agreements. See the NOTICE file distributed with * this work for additional information regarding copyright ownership. * The ASF licenses this file to You under the Apache License, Version 2.0 * (the &quot;License&quot;); you may not use this file except in compliance with * the License. You may obtain a copy of the License at * * http://www.apache.org/licenses/LICENSE-2.0 * * Unless required by applicable law or agreed to in writing, software * distributed under the License is distributed on an &quot;AS IS&quot; BASIS, * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. * See the License for the specific language governing permissions and * limitations under the License. */ package org.apache.kafka.common.serialization; import org.apache.kafka.common.errors.SerializationException; import java.io.UnsupportedEncodingException; import java.util.Map; /** * String encoding defaults to UTF8 and can be customized by setting the property key.serializer.encoding, * value.serializer.encoding or serializer.encoding. The first two take precedence over the last. */ public class StringSerializer implements Serializer&lt;String&gt; { private String encoding = &quot;UTF8&quot;; @Override public void configure(Map&lt;String, ?&gt; configs, boolean isKey) { String propertyName = isKey ? &quot;key.serializer.encoding&quot; : &quot;value.serializer.encoding&quot;; Object encodingValue = configs.get(propertyName); if (encodingValue == null) encodingValue = configs.get(&quot;serializer.encoding&quot;); if (encodingValue instanceof String) encoding = (String) encodingValue; } @Override public byte[] serialize(String topic, String data) { try { if (data == null) return null; else return data.getBytes(encoding); } catch (UnsupportedEncodingException e) { throw new SerializationException(&quot;Error when serializing string to byte[] due to unsupported encoding &quot; + encoding); } } } Stringçš„åºåˆ—åŒ–ç±»æ˜¯ç»§æ‰¿äº†Serializeræ¥å£ï¼ŒæŒ‡å®šæ³›å‹ï¼Œç„¶åå®ç°çš„Serializeræ¥å£çš„configure()ã€serialize()æ–¹æ³•ã€‚ä»£ç é‡ç‚¹çš„å®ç°æ˜¯åœ¨serialize()ï¼Œå¯ä»¥çœ‹å‡ºè¿™ä¸ªæ–¹æ³•å°†æˆ‘ä»¬ä¼ å…¥çš„Stringç±»å‹çš„æ•°æ®ï¼Œç®€å•çš„é€šè¿‡data.getBytes()æ–¹æ³•è¿›è¡Œäº†åºåˆ—åŒ–ã€‚ stringååºåˆ—åŒ– æŸ¥çœ‹ org.apache.kafka.common.serialization.StringDeserializerç±» /* * Licensed to the Apache Software Foundation (ASF) under one or more * contributor license agreements. See the NOTICE file distributed with * this work for additional information regarding copyright ownership. * The ASF licenses this file to You under the Apache License, Version 2.0 * (the &quot;License&quot;); you may not use this file except in compliance with * the License. You may obtain a copy of the License at * * http://www.apache.org/licenses/LICENSE-2.0 * * Unless required by applicable law or agreed to in writing, software * distributed under the License is distributed on an &quot;AS IS&quot; BASIS, * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. * See the License for the specific language governing permissions and * limitations under the License. */ package org.apache.kafka.common.serialization; import org.apache.kafka.common.errors.SerializationException; import java.io.UnsupportedEncodingException; import java.util.Map; /** * String encoding defaults to UTF8 and can be customized by setting the property key.deserializer.encoding, * value.deserializer.encoding or deserializer.encoding. The first two take precedence over the last. */ public class StringDeserializer implements Deserializer&lt;String&gt; { private String encoding = &quot;UTF8&quot;; @Override public void configure(Map&lt;String, ?&gt; configs, boolean isKey) { String propertyName = isKey ? &quot;key.deserializer.encoding&quot; : &quot;value.deserializer.encoding&quot;; Object encodingValue = configs.get(propertyName); if (encodingValue == null) encodingValue = configs.get(&quot;deserializer.encoding&quot;); if (encodingValue instanceof String) encoding = (String) encodingValue; } @Override public String deserialize(String topic, byte[] data) { try { if (data == null) return null; else return new String(data, encoding); } catch (UnsupportedEncodingException e) { throw new SerializationException(&quot;Error when deserializing byte[] to string due to unsupported encoding &quot; + encoding); } } } Stringçš„ååºåˆ—åŒ–ç±»æ˜¯ç»§æ‰¿äº†Deserializeræ¥å£ï¼ŒæŒ‡å®šæ³›å‹ï¼Œç„¶åå®ç°çš„Deserializeræ¥å£çš„configure()ã€deserialize()æ–¹æ³•ã€‚ä»£ç é‡ç‚¹çš„å®ç°æ˜¯åœ¨deserialize()ï¼Œå¯ä»¥çœ‹å‡ºè¿™ä¸ªæ–¹æ³•å°†æˆ‘ä»¬ä¼ å…¥çš„byte[]ç±»å‹çš„æ•°æ®ï¼Œç®€å•çš„é€šè¿‡return new String(data, encoding)æ–¹æ³•è¿›è¡Œäº†ååºåˆ—åŒ–å¾—åˆ°äº†Stringç±»å‹çš„æ•°æ®ã€‚ floatåºåˆ—åŒ– æˆ‘ä»¬å†çœ‹floatç±»å‹æ•°æ®çš„åºåˆ—åŒ–ç±»å‹ï¼ŒæŸ¥çœ‹org.apache.kafka.common.serialization.FloatSerializerç±» /* * Licensed to the Apache Software Foundation (ASF) under one or more * contributor license agreements. See the NOTICE file distributed with * this work for additional information regarding copyright ownership. * The ASF licenses this file to You under the Apache License, Version 2.0 * (the &quot;License&quot;); you may not use this file except in compliance with * the License. You may obtain a copy of the License at * * http://www.apache.org/licenses/LICENSE-2.0 * * Unless required by applicable law or agreed to in writing, software * distributed under the License is distributed on an &quot;AS IS&quot; BASIS, * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. * See the License for the specific language governing permissions and * limitations under the License. */ package org.apache.kafka.common.serialization; public class FloatSerializer implements Serializer&lt;Float&gt; { @Override public byte[] serialize(final String topic, final Float data) { if (data == null) return null; long bits = Float.floatToRawIntBits(data); return new byte[] { (byte) (bits &gt;&gt;&gt; 24), (byte) (bits &gt;&gt;&gt; 16), (byte) (bits &gt;&gt;&gt; 8), (byte) bits }; } } å¯ä»¥çœ‹åˆ°ï¼ŒFloatSerializerç±»ç»§æ‰¿äº†Serializeræ¥å£ï¼ŒæŒ‡å®šæ³›å‹ï¼Œç„¶åå®ç°çš„Serializeræ¥å£çš„serialize()æ–¹æ³•ï¼Œå³ç›´æ¥å°†floatç±»å‹æ•°æ®è½¬ä¸ºbyteæ•°ç»„è¿”å›ã€‚ floatååºåˆ—åŒ– æŸ¥çœ‹org.apache.kafka.common.serialization.FloatSerializerç±» /* * Licensed to the Apache Software Foundation (ASF) under one or more * contributor license agreements. See the NOTICE file distributed with * this work for additional information regarding copyright ownership. * The ASF licenses this file to You under the Apache License, Version 2.0 * (the &quot;License&quot;); you may not use this file except in compliance with * the License. You may obtain a copy of the License at * * http://www.apache.org/licenses/LICENSE-2.0 * * Unless required by applicable law or agreed to in writing, software * distributed under the License is distributed on an &quot;AS IS&quot; BASIS, * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. * See the License for the specific language governing permissions and * limitations under the License. */ package org.apache.kafka.common.serialization; import org.apache.kafka.common.errors.SerializationException; public class FloatDeserializer implements Deserializer&lt;Float&gt; { @Override public Float deserialize(final String topic, final byte[] data) { if (data == null) return null; if (data.length != 4) { throw new SerializationException(&quot;Size of data received by Deserializer is not 4&quot;); } int value = 0; for (byte b : data) { value &lt;&lt;= 8; value |= b &amp; 0xFF; } return Float.intBitsToFloat(value); } } å¯ä»¥çœ‹åˆ°ï¼ŒFloatSerializerç±»ç»§æ‰¿äº†Serializeræ¥å£ï¼ŒæŒ‡å®šæ³›å‹ï¼Œç„¶åå®ç°çš„Serializeræ¥å£çš„serialize()æ–¹æ³•ï¼Œå³ç›´æ¥å°†byteæ•°ç»„è½¬å›ä¸ºfloatç±»å‹è¿”å›ã€‚ è‡ªæ­¤æˆ‘ä»¬å¯ä»¥ç¡®å®šï¼Œkafkaä¸­çš„åºåˆ—åŒ–æ–¹å¼å°±æ˜¯å°†æ•°æ®è½¬ä¸ºbyte[]æ•°ç»„æ–¹å¼è¿›è¡Œä¼ é€’ï¼Œåœ¨æ¶ˆè´¹è€…ç«¯é€šè¿‡ååºåˆ—åŒ–ç±»è§£æbyte[]æ•°ç»„æ–¹å¼æ¥è§£ææ•°æ®ï¼Œä¸‹é¢æˆ‘ä»¬æ¥è‡ªå·±å®šä¹‰åºåˆ—åŒ–ç±»ã€‚ kakfaè‡ªå®šä¹‰åºåˆ—åŒ–ç±» åŸºäºfastjsonçš„åºåˆ—åŒ–æ–¹å¼ é…ç½®pom.xmlä¸­å¼•å…¥ä¾èµ–ï¼š &lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;/groupId&gt; &lt;artifactId&gt;fastjson&lt;/artifactId&gt; &lt;version&gt;1.2.37&lt;/version&gt; &lt;/dependency&gt; studentå¯¹è±¡å®ä½“ /** * * Title: Student.java * Description: TODO * * @author MrChen * @date 2019å¹´12æœˆ5æ—¥ ä¸Šåˆ11:22:38 */ public class Student { int id; String name; int age; boolean sex; float[] sorce; public Student(int id, String name, int age, boolean sex, float[] sorce) { super(); this.id = id; this.name = name; this.age = age; this.sex = sex; this.sorce = sorce; } public int getId() { return id; } public void setId(int id) { this.id = id; } public String getName() { return name; } public void setName(String name) { this.name = name; } public int getAge() { return age; } public void setAge(int age) { this.age = age; } public boolean isSex() { return sex; } public void setSex(boolean sex) { this.sex = sex; } public float[] getSorce() { return sorce; } public void setSorce(float[] sorce) { this.sorce = sorce; } } åºåˆ—åŒ–å®ç°StudentSerializer /** * * Title: StudentSerializer.java * Description: studentåºåˆ—åŒ–ç±» * * @author MrChen * @date 2019å¹´12æœˆ4æ—¥ ä¸‹åˆ5:13:41 */ public class StudentSerializer implements Serializer&lt;Student&gt;{ @Override public void configure(Map&lt;String, ?&gt; configs, boolean isKey) { // TODO Auto-generated method stub } @Override public byte[] serialize(String topic, Student data) { // TODO Auto-generated method stub return JSON.toJSONBytes(data); } @Override public void close() { // TODO Auto-generated method stub } } ååºåˆ—åŒ–å®ç°StudentDeserializer /** * * Title: StudentDeserializer.java * Description: studentååºåˆ—åŒ–ç±» * * @author MrChen * @date 2019å¹´12æœˆ4æ—¥ ä¸‹åˆ5:13:11 */ public class StudentDeserializer implements Deserializer&lt;Student&gt;{ @Override public void configure(Map&lt;String, ?&gt; configs, boolean isKey) { // TODO Auto-generated method stub } @Override public DemodulatorParameters deserialize(String topic, byte[] data) { // TODO Auto-generated method stub return JSON.parseObject(data, Student.class); } @Override public void close() { // TODO Auto-generated method stub } } åŸºäºprotostuffçš„åºåˆ—åŒ–æ–¹å¼ å·¥å…·ç±»ProtostuffUtil import com.dyuproject.protostuff.LinkedBuffer; import com.dyuproject.protostuff.ProtostuffIOUtil; import com.dyuproject.protostuff.Schema; import com.dyuproject.protostuff.runtime.RuntimeSchema; import java.util.Map; import java.util.concurrent.ConcurrentHashMap; /** * Created by shirukai on 2018/8/14 * protostuff åºåˆ—åŒ–/ååºåˆ—åŒ–å·¥å…·ç±» */ public class ProtostuffUtil { private static Map&lt;Class&lt;?&gt;, Schema&lt;?&gt;&gt; cachedSchema = new ConcurrentHashMap&lt;&gt;(); /** * åºåˆ—åŒ– * * @param message åºåˆ—åŒ–æ•°æ® * @param tClass .class * @param &lt;T&gt; ç±»å‹ * @return byte[] */ public static &lt;T&gt; byte[] serializer(T message, Class&lt;T&gt; tClass) { Schema&lt;T&gt; schema = getSchema(tClass); return ProtostuffIOUtil.toByteArray(message, schema, LinkedBuffer.allocate(LinkedBuffer.DEFAULT_BUFFER_SIZE)); } /** * ååºåˆ—åŒ– * * @param bytes bytes * @param tClass .class * @param &lt;T&gt; ç±»å‹ * @return T */ public static &lt;T&gt; T deserializer(byte[] bytes, Class&lt;T&gt; tClass) { Schema&lt;T&gt; schema = getSchema(tClass); T message = schema.newMessage(); ProtostuffIOUtil.mergeFrom(bytes, message, schema); return message; } private static &lt;T&gt; Schema&lt;T&gt; getSchema(Class&lt;T&gt; tClass) { Schema&lt;T&gt; schema = (Schema&lt;T&gt;) cachedSchema.get(tClass); if (schema == null) { schema = RuntimeSchema.createFrom(tClass); cachedSchema.put(tClass, schema); } return schema; } } åºåˆ—åŒ–å®ç°StudentProtostuffSerializer import com.springboot.demo.kafka.entity.Person; import com.springboot.demo.utils.ProtostuffUtil; import org.apache.kafka.common.serialization.Serializer; import java.util.Map; /** * Created by shirukai on 2018/8/25 */ public class StudentProtostuffSerializer implements Serializer&lt;Student&gt; { @Override public void configure(Map&lt;String, ?&gt; configs, boolean isKey) { } @Override public byte[] serialize(String topic, Student data) { return ProtostuffUtil.serializer(data, Person.class); } @Override public void close() { } } ååºåˆ—åŒ–å®ç°StudentProtostuffDeserializer import com.springboot.demo.kafka.entity.Person; import com.springboot.demo.utils.ProtostuffUtil; import org.apache.kafka.common.serialization.Deserializer; import java.util.Map; /** * Created by shirukai on 2018/8/25 */ public class StudentProtostuffDeserializer implements Deserializer&lt;Student&gt; { @Override public void configure(Map&lt;String, ?&gt; configs, boolean isKey) { } @Override public Person deserialize(String topic, byte[] data) { return ProtostuffUtil.deserializer(data, Student.class); } @Override public void close() { } } æ€»ç»“ æ ¹æ®è‡ªå·±çš„éœ€æ±‚å¯¹kafkaæ¶ˆæ¯è¿›è¡Œè‡ªå®šä¹‰åºåˆ—åŒ–ï¼Œå°†æ•°æ®ä¿¡æ¯è½¬ä¸ºbyte[]æ•°ç»„çš„å½¢å¼ï¼Œåœ¨ååºåˆ—åŒ–ç«¯å°†byte[]åå‘è½¬ä¸ºæ•°æ®ä¿¡æ¯ã€‚ ","link":"https://kily-007.github.io/post/kafka-è‡ªå®šä¹‰åºåˆ—åŒ–ç±»/"},{"title":"springbootæ•°æ®åº“è®¿é—®","content":"ä½¿ç”¨jpa(JpaRepository)æ–¹å¼è¿æ¥è®¿é—®æ•°æ®åº“ ä½¿ç”¨jpa(JpaRepository)æ–¹å¼è¿æ¥è®¿é—®æ•°æ®åº“ é…ç½®æ–‡ä»¶ åœ¨application.ymlä¸­é…ç½®è¿æ¥mysqlæ•°æ®åº“ datasource: url: jdbc:mysql://localhost:3306/springbootdb?serverTimezone=CTT username: root password: root driver-class-name: com.mysql.cj.jdbc.Driver åœ¨pom.xmlä¸­æ·»åŠ jpaé…ç½® &lt;!-- Spring Data JPA ä¾èµ– :: æ•°æ®æŒä¹…å±‚æ¡†æ¶ --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-data-jpa&lt;/artifactId&gt; &lt;/dependency&gt; æ•°æ®åº“è®¿é—®ç±» package edu.whut.demo.mapper; import edu.whut.demo.bean.User; import org.springframework.data.domain.Page; import org.springframework.data.domain.Pageable; import org.springframework.data.jpa.repository.JpaRepository; import java.util.List; //ç»§æ‰¿JpaRepository public interface UserMapper extends JpaRepository&lt;User,String&gt; { //ä¸éœ€è¦å†™sqlè¯­å¥ï¼Œæ–¹æ³•åæ ¹æ®è§„èŒƒæ’°å†™ï¼Œjpsæ ¹æ®æ–¹æ³•åè§£æå‡ºSQLè¯­å¥ //æ ¹æ®ç”¨æˆ·åæŸ¥æ‰¾ç”¨æˆ· User findUserByUsername(String username); //åˆ†é¡µæŸ¥è¯¢ Page&lt;User&gt; findAll(Pageable pageable); //æŸ¥æ‰¾æ‰€æœ‰ç”¨æˆ· List&lt;User&gt; findAll(); } ","link":"https://kily-007.github.io/post/springboot-æ•°æ®åº“è®¿é—®/"},{"title":"springbootä¹‹JpaRepositoryæŸ¥è¯¢åˆ—åé”™è¯¯","content":"è®°å½•ä¸€æ¬¡æŠ¥é”™ã€‚ java.sql.SQLSyntaxErrorException: Unknown column 'subwaycoun0_.pass_num1' in 'field list' at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-java-8.0.18.jar:8.0.18] at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97) ~[mysql-connector-java-8.0.18.jar:8.0.18] è®°å½•ä¸€æ¬¡æŠ¥é”™ã€‚ åœ¨æ•°æ®åº“æŸ¥è¯¢ä¸­ï¼Œå¯¹å®ä½“ç±»ä½¿ç”¨JpaRepositoryï¼Œå¦‚ç”¨æˆ·è¡¨ -- ç”¨æˆ·è¡¨ CREATE TABLE IF NOT EXISTS USER (id INT UNSIGNED AUTO_INCREMENT, userName VARCHAR(20) NOT NULL, passWord VARCHAR(32) NOT NULL, sex VARCHAR(4) NOT NULL, phone VARCHAR(32), email VARCHAR(32), employer VARCHAR(32), remarks VARCHAR(1000), PRIMARY KEY (id) )ENGINE=INNODB DEFAULT CHARSET=utf8; //userç±» public class User { @Id @Column private String id; @Column private String userName; @Column private String passWord; @Column private String sex; @Column private String phone; @Column private String email; @Column private String employer; @Column private String remarks; ã€‚ã€‚ã€‚ã€‚ } //æ•°æ®åº“äº¤äº’ç±» import com.example.springboot.bean.User; import org.springframework.data.domain.Page; import org.springframework.data.domain.Pageable; import org.springframework.data.jpa.repository.JpaRepository; import java.util.List; public interface UserMapper extends JpaRepository&lt;User,String&gt; { User findUserByUsername(String username); Page&lt;User&gt; findAll(Pageable pageable); List&lt;User&gt; findAll(); } æ­¤æ—¶åœ¨è°ƒç”¨æŸ¥æ‰¾æ—¶ä¼šæŠ¥é”™å¦‚ä¸‹ï¼š java.sql.SQLSyntaxErrorException: Unknown column 'subwaycoun0_.pass_num1' in 'field list' at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120) ~[mysql-connector-java-8.0.18.jar:8.0.18] at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97) ~[mysql-connector-java-8.0.18.jar:8.0.18] åŸå› ï¼šä¸»è¦å°±æ˜¯æ•°æ®åº“å’Œå®ä½“ç±»åç§°ä¸åŒ¹é…ï¼Œé€ æˆä¸åŒ¹é…çš„åŸå› ä¸ºæ•°æ®åº“å­—æ®µæ—¶é©¼å³°å‘½åçš„userNameæ‰§è¡Œçš„æ—¶å€™ä»–ä¼šç»™ä½ çš„æŸ¥è¯¢å­—æ®µåç§°æ”¹ä¸ºuser_Name è§£å†³åŠæ³•1ï¼šå°†æ•°æ®åº“ä¸­çš„é©¼å³°å‘½åæ³•æ”¹ä¸ºä¸‹åˆ’çº¿ï¼Œå³:userName -&gt; user_name ","link":"https://kily-007.github.io/post/springboot-ä¹‹JpaRepositoryæŸ¥è¯¢åˆ—åé”™è¯¯/"},{"title":"å‰ç«¯æ¡†æ¶layui","content":" ç¬¬ä¸€æ¬¡å‘ç°å®ƒæ˜¯åŒå­¦æ¨èç»™æˆ‘çš„ï¼Œå‘ç°çœŸçš„éå¸¸æ–¹ä¾¿ï¼Œlayuiç½‘å€ï¼šhttps://www.layui.com/ï¼Œä¸‹é¢ç®€å•ä»‹ç»å’Œè®°å½•ä¸€ä¸‹ã€‚ å‡†å¤‡å·¥ä½œ å°†layuiä¸‹è½½ä¸‹æ¥ï¼Œå…¶ä¸­åŒ…å«css/font/images/layå’Œlayui.jså››ä¸ªæ–‡ä»¶å¤¹å’Œä¸€ä¸ªjsæ–‡ä»¶ã€‚ å‚è€ƒå®˜æ–¹æ–‡æ¡£å’Œç¤ºä¾‹ï¼Œæ‰¾ä½ éœ€è¦çš„æ¨¡å—ã€‚ ä¸‹é¢è®°å½•ä¸€ä¸‹å‡ ä¸ªç”¨è¿‡çš„æ¨¡å—ã€‚ layuiåå°å¸ƒå±€ åå°å¸ƒå±€çš„æ•ˆæœå¦‚å›¾æ‰€ç¤ºï¼Œç›´æ¥ç‚¹å‡»è·å–å¸ƒå±€ä»£ç å¹…å€¼è¿‡å»æ”¹ä¸‹è·¯å¾„å°±èƒ½ç”¨ã€‚ layuiæ•°æ®è¡¨æ ¼ è®°å½•ä¸€ä¸ªbug æ•°æ®è¡¨å¯¹åº”çš„jsä»£ç ä¸ºï¼š layui.use('table', function(){ var table = layui.table; table.render({ elem: '#test' ,url:'/demo/table/user/' ,cellMinWidth: 80 //å…¨å±€å®šä¹‰å¸¸è§„å•å…ƒæ ¼çš„æœ€å°å®½åº¦ï¼Œlayui 2.2.1 æ–°å¢ ,cols: [[ {field:'id', width:80, title: 'ID', sort: true} ,{field:'username', width:80, title: 'ç”¨æˆ·å'} ,{field:'sex', width:80, title: 'æ€§åˆ«', sort: true} ,{field:'city', width:80, title: 'åŸå¸‚'} ,{field:'sign', title: 'ç­¾å', width: '30%', minWidth: 100} //minWidthï¼šå±€éƒ¨å®šä¹‰å½“å‰å•å…ƒæ ¼çš„æœ€å°å®½åº¦ï¼Œlayui 2.2.1 æ–°å¢ ,{field:'experience', title: 'ç§¯åˆ†', sort: true} ,{field:'score', title: 'è¯„åˆ†', sort: true} ,{field:'classify', title: 'èŒä¸š'} ,{field:'wealth', width:137, title: 'è´¢å¯Œ', sort: true} ]] ,page: true ,response: { statusCode: 200 //é‡æ–°è§„å®šæˆåŠŸçš„çŠ¶æ€ç ä¸º 200ï¼Œtable ç»„ä»¶é»˜è®¤ä¸º 0 } ,parseData: function(res){ //å°†åŸå§‹æ•°æ®è§£ææˆ table ç»„ä»¶æ‰€è§„å®šçš„æ•°æ® return { &quot;code&quot;: res.status, //è§£ææ¥å£çŠ¶æ€ &quot;msg&quot;: res.message, //è§£ææç¤ºæ–‡æœ¬ &quot;count&quot;: res.total, //è§£ææ•°æ®é•¿åº¦ &quot;data&quot;: res.data.content //è§£ææ•°æ®åˆ—è¡¨ }; } }); }); åœ¨controllerä¸­è¿”å›æ•°æ®ç»“æ„ç±»ä¸ºï¼š package com.example.springboot.utils; public class LayuiTableResultUtil&lt;T&gt; { private T data; private String msg; private int code; private Long count; public LayuiTableResultUtil(int code,String msg, Long count, T data) { this.msg = msg; this.data = data; this.code = code; this.count = count; } @Override public String toString() { return &quot;LayuiTableResult [msg=&quot; + msg + &quot;, data=&quot; + data + &quot;, code=&quot; + code + &quot;, count=&quot; + count + &quot;]&quot;; } public String getMsg() { return msg; } public void setMsg(String msg) { this.msg = msg; } public Long getCount() { return count; } public void setCount(Long count) { this.count = count; } public int getCode() { return code; } public void setCode(int code) { this.code = code; } public T getData() { return data; } public void setData(T data) { this.data = data; } } é¡¹ç›®å¯åŠ¨ï¼Œè¿”å›é¡µé¢ä¸Šæ˜¾ç¤ºjsonå­—ç¬¦ä¸²ï¼Œæ— æ³•è§£ææ•°æ®ï¼›è°ƒäº†ä¸‰å¤©ä¹Ÿæ²¡è§£å†³ï¼Œç„¶åæ¢Thymeleafæ˜¾ç¤ºäº†ã€‚ { &quot;code&quot;:0, &quot;msg&quot;:&quot;&quot;, &quot;count&quot;:100, &quot;data&quot;:{&quot;content&quot;:[ {&quot;id&quot;: 1, &quot;username&quot;: &quot;user1&quot;, &quot;sex&quot;: &quot;å¥³&quot;, &quot;city&quot;: &quot;åŸå¸‚-0&quot;, &quot;sign&quot;: &quot;ç­¾å-0&quot;, ...} {&quot;id&quot;: 1, &quot;username&quot;: &quot;user1&quot;, &quot;sex&quot;: &quot;å¥³&quot;, &quot;city&quot;: &quot;åŸå¸‚-0&quot;, &quot;sign&quot;: &quot;ç­¾å-0&quot;, ...} {&quot;id&quot;: 1, &quot;username&quot;: &quot;user1&quot;, &quot;sex&quot;: &quot;å¥³&quot;, &quot;city&quot;: &quot;åŸå¸‚-0&quot;, &quot;sign&quot;: &quot;ç­¾å-0&quot;, ...} ... ]} } ","link":"https://kily-007.github.io/post/å‰ç«¯-å‰ç«¯æ¡†æ¶layui/"},{"title":"springbooté¡¹ç›®ç»“æ„ç®€ä»‹","content":"springbooté¡¹ç›®ç»“æ„ï¼š controller:æ§åˆ¶å™¨å±‚ï¼Œå¯¼å…¥serviceå±‚ï¼Œè°ƒç”¨serviceæ–¹æ³•ï¼›é€šè¿‡æ¥å—å‰ç«¯ä¼ è¿‡æ¥çš„å‚æ•°è¿›è¡Œä¸šåŠ¡æ“ä½œï¼Œå†è¿”å›ä¸€ä¸ªæŒ‡å®šçš„è·¯å¾„æˆ–æ•°æ®è¡¨ bean/entity/model:å®ä½“ç±»ï¼Œæ˜ å°„æ•°æ®åº“ä¸­çš„å­—æ®µ mapper/dao:æ”¾çš„æ˜¯å¯¹æ•°æ®åº“çš„æ“ä½œï¼Œå¦‚CRUD service:ä¸šåŠ¡å±‚ï¼Œå­˜æ”¾ä¸šåŠ¡é€»è¾‘å¤„ç†ï¼›ä¸ç›´æ¥å¯¹æ•°æ®åº“è¿›è¡Œæ“ä½œï¼Œæœ‰æ¥å£å’Œæ¥å£å®ç°ç±»ï¼›æä¾›controllerå±‚è°ƒç”¨çš„æ–¹æ³• controller:æ§åˆ¶å™¨å±‚ï¼Œå¯¼å…¥serviceå±‚ï¼Œè°ƒç”¨serviceæ–¹æ³•ï¼›é€šè¿‡æ¥å—å‰ç«¯ä¼ è¿‡æ¥çš„å‚æ•°è¿›è¡Œä¸šåŠ¡æ“ä½œï¼Œå†è¿”å›ä¸€ä¸ªæŒ‡å®šçš„è·¯å¾„æˆ–æ•°æ®è¡¨ bean/entity/model:å®ä½“ç±»ï¼Œæ˜ å°„æ•°æ®åº“ä¸­çš„å­—æ®µ mapper/dao:æ”¾çš„æ˜¯å¯¹æ•°æ®åº“çš„æ“ä½œï¼Œå¦‚CRUD service:ä¸šåŠ¡å±‚ï¼Œå­˜æ”¾ä¸šåŠ¡é€»è¾‘å¤„ç†ï¼›ä¸ç›´æ¥å¯¹æ•°æ®åº“è¿›è¡Œæ“ä½œï¼Œæœ‰æ¥å£å’Œæ¥å£å®ç°ç±»ï¼›æä¾›controllerå±‚è°ƒç”¨çš„æ–¹æ³• springbootæ¨¡æ¿ç±»å‹ Spring Bootæä¾›äº†é»˜è®¤é…ç½®çš„æ¨¡æ¿å¼•æ“ä¸»è¦æœ‰ä»¥ä¸‹å‡ ç§ï¼š Thymeleafï¼ˆå®˜æ–¹æ¨èï¼‰ FreeMarker Velocity Groovy Mustache JSP æ¨¡æ¿Thymeleaf åˆ°pom.xmlæ–‡ä»¶ä¸­æ·»åŠ ä¾èµ– &lt;!-- æ¨¡æ¿å¼•æ“ Thymeleaf ä¾èµ– --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-thymeleaf&lt;/artifactId&gt; &lt;/dependency&gt; é…ç½®application.ymlæ–‡ä»¶ spring: thymeleaf: prefix: classpath: /templates/ check-template-location: true cache: false suffix: .html encoding: UTF-8 mode: HTML5 servlet: content-type: text/html ä¼ å‚ @Controller @RequestMapping(&quot;/thymeleaf&quot;) public class ThymeleafController { @RequestMapping(&quot;&quot;) public ModelAndView index(){ List&lt;User&gt; userList = new ArrayList&lt;User&gt;(); User user1 = new User(&quot;solidwang&quot;, &quot;solidwang@126.com&quot;); User user2 = new User(&quot;jobs&quot;, &quot;jobs@me.com&quot;); userList.add(user1); userList.add(user2); ModelAndView modelAndView = new ModelAndView(&quot;/index&quot;); modelAndView.addObject(&quot;userList&quot;, userList); return modelAndView; } } &lt;!DOCTYPE html&gt; &lt;html xmlns:th=&quot;http://www.thymeleaf.org&quot;&gt; &lt;head&gt; &lt;title&gt;learn Resources&lt;/title&gt; &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt; &lt;/head&gt; &lt;body&gt; &lt;div&gt; &lt;h1&gt;Thymeleafæµ‹è¯•&lt;/h1&gt; &lt;table border=&quot;1&quot; cellspacing=&quot;1&quot; cellpadding=&quot;0&quot;&gt; &lt;tr&gt; &lt;td&gt;å§“å&lt;/td&gt; &lt;td&gt;passport&lt;/td&gt; &lt;/tr&gt; &lt;tr th:each=&quot;user : ${userList}&quot;&gt; &lt;td th:text=&quot;${user.username}&quot;&gt;solidwang&lt;/td&gt; &lt;td th:text=&quot;${user.passport}&quot;&gt;solidwang@me.com&lt;/td&gt; &lt;/tr&gt; &lt;/table&gt; &lt;/div&gt; &lt;/body&gt; &lt;/html&gt; ","link":"https://kily-007.github.io/post/springboot-é¡¹ç›®ç»“æ„ç®€ä»‹/"},{"title":"windowsè¿œç¨‹è¿æ¥æ¡Œé¢linux","content":"å‡†å¤‡å·¥ä½œ 1ï¼‰centosæ¡Œé¢å·²å®‰è£… 2ï¼‰windowsç³»ç»Ÿ centoså®‰è£…é…ç½®xrdp å®‰è£…epelåº“ æ£€æµ‹æ˜¯å¦å·²å®‰è£…epelåº“ rpm -qa |grep epel å®‰è£…epelåº“ yum install epel-release åœ¨å®‰è£…è¿‡ç¨‹ä¸­ä¼šå‡ºç°é€‰æ‹©ï¼Œç›´æ¥é€‰æ‹©Yå³å¯. å®‰è£…xrdp yum install xrdp å®‰è£…vnc å› ä¸ºXrdpæœ€ç»ˆä¼šè‡ªåŠ¨å¯ç”¨VNCï¼Œæ‰€ä»¥å¿…é¡»å®‰è£…tigervnc-serverï¼Œå¦åˆ™xrdpæ— æ³•ä½¿ç”¨ã€‚å®‰è£…vncï¼š yum install tigervnc-server ä¸ºrootç”¨æˆ·è®¾ç½®VNCå¯†ç  vncpasswd root ä¿®æ”¹xrdpæœ€å¤§è¿æ¥æ•° ï¼ˆä½¿ç”¨é»˜è®¤å€¼ï¼Œä¸ä¿®æ”¹ä¹Ÿæ˜¯å¯ä»¥çš„ï¼‰ vim /etc/xrdp/xrdp.ini ï¼ˆé»˜è®¤æ˜¯32ï¼‰ å…³é—­é˜²ç«å¢™ systemctl stop firewalld.service å¯åŠ¨xrdp systemctl start xrdp è®¾ç½®å¼€æœºå¯åŠ¨ systemctl enable xrdp è¿œç¨‹æµ‹è¯•è¿æ¥ åœ¨windowsæœºä¸Šå¼€æ‰“è¿è¡Œï¼Œè¾“å…¥mstscï¼Œè¾“å…¥è¿œç¨‹linuxçš„ip ","link":"https://kily-007.github.io/post/å·¥å…·-windowsè¿œç¨‹è¿æ¥æ¡Œé¢linux/"},{"title":"MySqlä¸»ä»å¤åˆ¶åŸç†","content":"MySqlä¸»ä»å¤åˆ¶çš„ä½œç”¨ è¯»å†™åˆ†ç¦» å¤‡ä»½ é«˜å¯ç”¨ æ¶æ„æ‰©å±• MySqlä¸»ä»å½¢å¼ ä¸€ä¸»ä¸€ä» ä¸€ä¸»å¤šä»ï¼Œæé«˜ç³»ç»Ÿè¯»æ€§èƒ½ã€‚ å¤šä¸»ä¸€ä»ï¼Œå¯ä»¥å°†å¤šä¸ªæ•°æ®åº“å¤‡ä»½åˆ°ä¸€å°æ€§èƒ½è¾ƒå¥½çš„é¢æœåŠ¡å™¨ä¸Šã€‚ åŒä¸»å¤åˆ¶ï¼Œäº’åšä¸»ä»å¤åˆ¶ï¼Œä¸€æ–¹å˜æ›´ï¼Œä¼šé€šè¿‡å¤åˆ¶åº”ç”¨åˆ°å¦ä¸€æ–¹æ•°æ®åº“ä¸­ã€‚ çº§è”å¤åˆ¶ï¼Œ3-5ä¸ªä»èŠ‚ç‚¹è¿æ¥ä¸»èŠ‚ç‚¹ï¼Œå…¶å®ƒèŠ‚ç‚¹ä½œä¸ºäºŒçº§æˆ–è€…ä¸‰çº§èŠ‚ç‚¹ä¸ä»èŠ‚ç‚¹ç›¸è¿ã€‚ MySqlä¸»ä»å¤åˆ¶åŸç† MySql ä¸»ä»å¤åˆ¶æ¶‰åŠä¸‰ä¸ªçº¿ç¨‹ï¼Œä¸€ä¸ªè¿è¡Œåœ¨ä¸»èŠ‚ç‚¹(log dump thread)ï¼Œä¸¤ä¸ª(I/O thread,SQL thread)è¿è¡Œåœ¨ä»èŠ‚ç‚¹ä¸Šã€‚ log dumpçº¿ç¨‹ï¼šå½“ä»èŠ‚ç‚¹è¿æ¥ä¸»èŠ‚ç‚¹æ—¶ï¼Œä¸»èŠ‚ç‚¹åˆ›å»ºlog dumpçº¿ç¨‹å¯¹bin-logåŠ é”ï¼Œè¯»å–å†…å®¹å‘é€åˆ°ä»èŠ‚ç‚¹ã€‚ I/Oçº¿ç¨‹ï¼šå½“ä»èŠ‚ç‚¹ä¸Šæ‰§è¡Œâ€œstart skaveâ€å‘½ä»¤åï¼Œä»èŠ‚ç‚¹ä¼šåˆ›å»ºä¸€ä¸ªI/Oçº¿ç¨‹ç”¨æ¥è¿æ¥ä¸»èŠ‚ç‚¹ï¼Œè¯·æ±‚ä¸»åº“ä¸­æ›´æ–°çš„bin-logã€‚I/Oçº¿ç¨‹æ¥æ”¶åˆ°ä¸»èŠ‚ç‚¹binlog dumpè¿›ç¨‹å‘æ¥çš„æ›´æ–°ä¹‹åï¼Œä¿å­˜åœ¨æœ¬åœ°relay-logä¸­ã€‚ **SQLçº¿ç¨‹ï¼š**SQLçº¿ç¨‹è´Ÿè´£è¯»å–relay-logä¸­çš„å†…å®¹ï¼Œè§£ææˆå…·ä½“çš„æ“ä½œå¹¶æ‰§è¡Œï¼Œæœ€ç»ˆä¿è¯ä¸»ä»æ•°æ®çš„ä¸€è‡´æ€§ã€‚ MySQL ä¸»ä»å¤åˆ¶é»˜è®¤æ˜¯å¼‚æ­¥çš„æ¨¡å¼ã€‚MySQLå¢åˆ æ”¹æ“ä½œä¼šå…¨éƒ¨è®°å½•åœ¨binary logä¸­ï¼Œå½“slaveèŠ‚ç‚¹è¿æ¥masteræ—¶ï¼Œä¼šä¸»åŠ¨ä»masterå¤„è·å–æœ€æ–°çš„bin logæ–‡ä»¶ã€‚å¹¶æŠŠbin logä¸­çš„sql relayã€‚ ","link":"https://kily-007.github.io/post/MySql-ä¸»ä»å¤åˆ¶åŸç†/"},{"title":"ç¬”è®°-javaåˆ›å»ºçº¿ç¨‹çš„å‡ ç§æ–¹å¼","content":"Javaä½¿ç”¨Threadç±»ä»£è¡¨çº¿ç¨‹ï¼Œæ‰€æœ‰çš„çº¿ç¨‹å¯¹è±¡éƒ½å¿…é¡»æ˜¯Threadç±»æˆ–å…¶å­ç±»çš„å®ä¾‹ã€‚Javaå¯ä»¥ç”¨å››ç§æ–¹å¼æ¥åˆ›å»ºçº¿ç¨‹ï¼Œå¦‚ä¸‹ï¼š 1ï¼‰ç»§æ‰¿Threadç±»åˆ›å»ºçº¿ç¨‹ï¼› 2ï¼‰å®ç°Runnableæ¥å£åˆ›å»ºçº¿ç¨‹ï¼› 3ï¼‰å®ç°Callableæ¥å£é€šè¿‡FutureTaskåŒ…è£…å™¨æ¥åˆ›å»ºThreadçº¿ç¨‹ï¼› 4ï¼‰çº¿ç¨‹æ±  ç»§æ‰¿Threadç±» é€šè¿‡ç»§æ‰¿Threadç±»æ¥åˆ›å»ºå¹¶å¯åŠ¨å¤šçº¿ç¨‹çš„ä¸€èˆ¬æ­¥éª¤å¦‚ä¸‹ï¼š 1ã€‘å®šä¹‰Threadç±»çš„å­ç±»ï¼Œå¹¶é‡å†™è¯¥ç±»çš„run()æ–¹æ³•ï¼Œè¯¥æ–¹æ³•çš„æ–¹æ³•ä½“å°±æ˜¯çº¿ç¨‹éœ€è¦å®Œæˆçš„ä»»åŠ¡ï¼Œrun()æ–¹æ³•ä¹Ÿç§°ä¸ºçº¿ç¨‹æ‰§è¡Œä½“ï¼› 2ã€‘åˆ›å»ºThreadå­ç±»çš„å®ä¾‹ï¼Œä¹Ÿå°±æ˜¯åˆ›å»ºäº†çº¿ç¨‹å¯¹è±¡ï¼› 3ã€‘å¯åŠ¨çº¿ç¨‹ï¼Œå³è°ƒç”¨çº¿ç¨‹çš„start()æ–¹æ³•ã€‚ public class MyThread extends Thread{ public void run() { for (int i = 0; i &lt; 10; i++) { System.out.println(Thread.currentThread()+&quot;:&quot;+i); } } public static void main(String[] args) { MyThread thread1=new MyThread(); MyThread thread2=new MyThread(); MyThread thread3=new MyThread(); thread1.start(); thread2.start(); thread3.start(); } } å®ç°Runnableæ¥å£ é€šè¿‡å®ç°Runnableæ¥å£åˆ›å»ºå¹¶å¯åŠ¨çº¿ç¨‹ä¸€èˆ¬æ­¥éª¤å¦‚ä¸‹ï¼š 1ã€‘å®šä¹‰Runnableæ¥å£çš„å®ç°ç±»ï¼Œä¸€æ ·è¦é‡å†™run()æ–¹æ³•ï¼Œè¿™ä¸ªrun()æ–¹æ³•å’ŒThreadä¸­çš„run()æ–¹æ³•ä¸€æ ·æ˜¯çº¿ç¨‹çš„æ‰§è¡Œä½“ï¼› 2ã€‘åˆ›å»ºRunnableå®ç°ç±»çš„å®ä¾‹ï¼Œå¹¶ç”¨è¿™ä¸ªå®ä¾‹ä½œä¸ºThreadçš„targetæ¥åˆ›å»ºThreadå¯¹è±¡ï¼Œè¿™ä¸ªThreadå¯¹è±¡æ‰æ˜¯çœŸæ­£çš„çº¿ç¨‹å¯¹è±¡ï¼› 3ã€‘ç¬¬ä¸‰æ­¥ä¾ç„¶æ˜¯é€šè¿‡è°ƒç”¨çº¿ç¨‹å¯¹è±¡çš„start()æ–¹æ³•æ¥å¯åŠ¨çº¿ç¨‹ã€‚ public class MyThread implements Runnable{ public void run() { for (int i = 0; i &lt; 10; i++) { System.out.println(Thread.currentThread().getName()+&quot;:&quot;+i); } } public static void main(String[] args) { MyThread myThread1=new MyThread(); MyThread myThread2=new MyThread(); MyThread myThread3=new MyThread(); Thread thread1=new Thread(myThread1); Thread thread2=new Thread(myThread2); Thread thread3=new Thread(myThread3); thread1.start(); thread2.start(); thread3.start(); } } é€šè¿‡Callbleå’Œfuture Task å’ŒRunnableæ¥å£ä¸ä¸€æ ·ï¼ŒCallableæ¥å£æä¾›äº†ä¸€ä¸ªcall() æ–¹æ³•ä½œä¸ºçº¿ç¨‹æ‰§è¡Œä½“ï¼Œcall() æ–¹æ³•æ¯”run() æ–¹æ³•åŠŸèƒ½è¦å¼ºå¤§ï¼š call() æ–¹æ³•å¯ä»¥æœ‰è¿”å›å€¼ï¼› call() æ–¹æ³•å¯ä»¥å£°æ˜æŠ›å‡ºå¼‚å¸¸ã€‚ Java5æä¾›äº†Futureæ¥å£æ¥ä»£è¡¨Callableæ¥å£é‡Œcall() æ–¹æ³•çš„è¿”å›å€¼ï¼Œå¹¶ä¸”ä¸ºFutureæ¥å£æä¾›äº†ä¸€ä¸ªå®ç°ç±»FutureTaskï¼Œè¿™ä¸ªå®ç°ç±»æ—¢å®ç°äº†Futureæ¥å£ï¼Œè¿˜å®ç°äº†Runnableæ¥å£ï¼Œå› æ­¤å¯ä»¥ä½œä¸ºThreadç±»çš„targetã€‚åœ¨Futureæ¥å£é‡Œå®šä¹‰äº†å‡ ä¸ªå…¬å…±æ–¹æ³•æ¥æ§åˆ¶å®ƒå…³è”çš„Callableä»»åŠ¡ã€‚ boolean cancel(boolean mayInterruptIfRunning)ï¼šè§†å›¾å–æ¶ˆè¯¥Futureé‡Œé¢å…³è”çš„Callableä»»åŠ¡ï¼› get()ï¼šè¿”å›Callableé‡Œcall() æ–¹æ³•çš„è¿”å›å€¼ï¼Œè°ƒç”¨è¿™ä¸ªæ–¹æ³•ä¼šå¯¼è‡´ç¨‹åºé˜»å¡ï¼Œå¿…é¡»ç­‰åˆ°å­çº¿ç¨‹ç»“æŸåæ‰ä¼šå¾—åˆ°è¿”å›å€¼ï¼› get(long timeout,TimeUnit unit)ï¼šè¿”å›Callableé‡Œcall() æ–¹æ³•çš„è¿”å›å€¼ï¼Œæœ€å¤šé˜»å¡timeoutæ—¶é—´ï¼Œç»è¿‡æŒ‡å®šæ—¶é—´æ²¡æœ‰è¿”å›æŠ›å‡ºTimeoutExceptionï¼› boolean isDone()ï¼šè‹¥Callableä»»åŠ¡å®Œæˆï¼Œè¿”å›Trueï¼› boolean isCancelled()ï¼šå¦‚æœåœ¨Callableä»»åŠ¡æ­£å¸¸å®Œæˆå‰è¢«å–æ¶ˆï¼Œè¿”å›Trueã€‚ ä»‹ç»äº†ç›¸å…³çš„æ¦‚å¿µä¹‹åï¼Œåˆ›å»ºå¹¶å¯åŠ¨æœ‰è¿”å›å€¼çš„çº¿ç¨‹çš„æ­¥éª¤å¦‚ä¸‹ï¼š 1ã€‘åˆ›å»ºCallableæ¥å£çš„å®ç°ç±»ï¼Œå¹¶å®ç°call() æ–¹æ³•ï¼Œç„¶ååˆ›å»ºè¯¥å®ç°ç±»çš„å®ä¾‹ï¼ˆä»Java8å¼€å§‹å¯ä»¥ç›´æ¥ä½¿ç”¨Lambdaè¡¨è¾¾å¼åˆ›å»ºCallableå¯¹è±¡ï¼‰ï¼› 2ã€‘ä½¿ç”¨FutureTaskç±»æ¥åŒ…è£…Callableå¯¹è±¡ï¼Œè¯¥FutureTaskå¯¹è±¡å°è£…äº†Callableå¯¹è±¡çš„call() æ–¹æ³•çš„è¿”å›å€¼ï¼› 3ã€‘ä½¿ç”¨FutureTaskå¯¹è±¡ä½œä¸ºThreadå¯¹è±¡çš„targetåˆ›å»ºå¹¶å¯åŠ¨çº¿ç¨‹ï¼ˆå› ä¸ºFutureTaskå®ç°äº†Runnableæ¥å£ï¼‰ï¼› 4ã€‘è°ƒç”¨FutureTaskå¯¹è±¡çš„get() æ–¹æ³•æ¥è·å¾—å­çº¿ç¨‹æ‰§è¡Œç»“æŸåçš„è¿”å›å€¼ã€‚ import java.util.concurrent.Callable; import java.util.concurrent.ExecutionException; import java.util.concurrent.FutureTask; public class MyThread implements Callable&lt;String&gt;{ private int count=20; @Override public String call() throws Exception { for (int i = 20; i &gt;0; i--) { System.out.println(Thread.currentThread().getName()+&quot;å½“å‰ç¥¨æ•°&quot;+i); } return &quot;sale out&quot;; } public static void main(String[] args) throws InterruptedException, ExecutionException { Callable&lt;String&gt; callable =new MyThread(); FutureTask &lt;String&gt;futureTask=new FutureTask&lt;&gt;(callable); Thread thread1=new Thread(futureTask); Thread thread2=new Thread(futureTask); Thread thread3=new Thread(futureTask); thread1.start(); thread2.start(); thread3.start(); System.out.println(futureTask.get()); } } ä½¿ç”¨çº¿ç¨‹æ±  Executor Javaé€šè¿‡Executorsæä¾›å››ç§çº¿ç¨‹æ± ï¼Œåˆ†åˆ«ä¸ºï¼š FixedThreadPoolï¼šè¿”å›å›ºå®šçº¿ç¨‹æ•°é‡çš„çº¿ç¨‹æ± ã€‚ SingleThreadExecutorï¼šè¿”å›ä¸€ä¸ªåªæœ‰ä¸€ä¸ªçº¿ç¨‹çš„çº¿ç¨‹æ± ã€‚ CachedThreadPoolï¼šè¯¥æ–¹æ³•è¿”å›ä¸€ä¸ªå¯æ ¹æ®å®é™…æƒ…å†µè°ƒæ•´çº¿ç¨‹æ•°é‡çš„çº¿ç¨‹æ± ã€‚çº¿ç¨‹æ± çš„çº¿ç¨‹æ•°é‡ä¸ç¡®å®šï¼Œä½† è‹¥æœ‰ç©ºé—²çº¿ç¨‹å¯ä»¥å¤ç”¨ï¼Œåˆ™ä¼šä¼˜å…ˆä½¿ç”¨å¯å¤ç”¨çš„çº¿ç¨‹ã€‚è‹¥æ‰€æœ‰çº¿ç¨‹å‡åœ¨å·¥ä½œï¼Œåˆæœ‰æ–°çš„ä»»åŠ¡æäº¤ï¼Œåˆ™ä¼šåˆ›å»ºæ–° çš„çº¿ç¨‹å¤„ç†ä»»åŠ¡ã€‚æ‰€æœ‰çº¿ç¨‹åœ¨å½“å‰ä»»åŠ¡æ‰§è¡Œå®Œæ¯•åï¼Œå°†è¿”å›çº¿ç¨‹æ± è¿›è¡Œå¤ç”¨ã€‚ ScheduledThreadPool åˆ›å»ºä¸€ä¸ªå®šé•¿çº¿ç¨‹æ± ï¼Œæ”¯æŒå®šæ—¶åŠå‘¨æœŸæ€§ä»»åŠ¡æ‰§è¡Œã€‚ ThreadPoolExecutor **Executorsæ˜¯JAVAå¹¶å‘åŒ…ä¸­æä¾›çš„ï¼Œç”¨æ¥å¿«é€Ÿåˆ›å»ºä¸åŒç±»å‹çš„çº¿ç¨‹æ± ã€‚***ä½†åœ¨ä¸€äº›å¤§å‹é¡¹ç›®ä¸­ï¼Œè¿™ç§åšæ³•ä¸€èˆ¬æ˜¯ç¦æ­¢çš„ã€‚å› ä¸ºç”¨Executorsåˆ›å»ºçš„çº¿ç¨‹æ± å­˜åœ¨æ€§èƒ½éšæ‚£ï¼Œæˆ‘ä»¬çœ‹ä¸€ä¸‹æºç å°±çŸ¥é“ï¼Œç”¨Executorsåˆ›å»ºçº¿ç¨‹æ± æ—¶ï¼Œä½¿ç”¨çš„é˜Ÿåˆ—æ˜¯new LinkedBlockingQueue&lt;Runnable&gt;()ï¼Œè¿™æ˜¯ä¸€ä¸ªæ— è¾¹ç•Œé˜Ÿåˆ—ï¼Œå¦‚æœä¸æ–­çš„å¾€é‡ŒåŠ ä»»åŠ¡æ—¶ï¼Œæœ€ç»ˆä¼šå¯¼è‡´å†…å­˜é—®é¢˜ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨é¡¹ç›®ä¸­ç”±äºä½¿ç”¨äº†æ— è¾¹ç•Œé˜Ÿåˆ—ï¼Œå¯¼è‡´çš„å†…å­˜å ç”¨çš„ä¸å¯æ§æ€§ã€‚æ•…ä¸€èˆ¬é‡‡ç”¨è‡ªå·±å®ç°ThreadPoolExecutorçš„æ–¹å¼æ¥è‡ªå®šä¹‰çº¿ç¨‹æ± ã€‚ ThreadPoolExecutor( int corePoolSize,//æŒ‡å®šçº¿ç¨‹æ± ä¸­çº¿ç¨‹çš„æ•°é‡ int maximumPoolSize,//æœ€å¤§çº¿ç¨‹æ•°é‡ long keepAliveTime,//è¶…è¿‡æ ¸å¿ƒçº¿ç¨‹æ•°çš„çº¿ç¨‹è¶…è¿‡corePoolSizeæ—¶ï¼Œå¤šä½™çº¿ç¨‹å¤šä¹…è¢«é”€æ¯ TimeUnit unit,//KeepAliveTimeçš„å•ä½ BlockingQueue&lt;Runnable&gt; workQueue,//ä»»åŠ¡é˜Ÿåˆ— ThreadFactory threadFactory,//çº¿ç¨‹å·¥å‚ RejectedExecutionHandler handler//æ‹’ç»ç­–ç•¥ ) è®¾çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°é‡ä¸ºnï¼Œï¼Œå½“ä¸€ä¸ªä»»åŠ¡é€šè¿‡executeæ–¹æ³•æ·»åŠ åˆ°çº¿ç¨‹æ± æ—¶ï¼š è‹¥n&lt;corePoolSizeï¼Œåˆ›å»ºæ–°çº¿ç¨‹æ¥å¤„ç†ï¼› è‹¥n=corePoolSizeï¼Œä½†ç¼“å†²é˜Ÿåˆ—workQueueæœªæ»¡ï¼Œé‚£ä¹ˆä»»åŠ¡æ”¾è¿›é˜Ÿåˆ—ï¼› è‹¥n&gt;corePoolSizeï¼Œç¼“å†²é˜Ÿåˆ—workQueueæ»¡ï¼Œä¸”n&lt;maximumPoolSizeï¼Œæ–°å»ºçº¿ç¨‹å¤„ç†ä»»åŠ¡ï¼› è‹¥n&gt;corePoolSizeï¼Œç¼“å†²é˜Ÿåˆ—workQueueæ»¡ï¼Œä¸”n=maximumPoolSizeï¼Œé€šè¿‡handleæŒ‡å®šçš„æ‹’ç»ç­–ç•¥æ¥å¤„ç†ä»»åŠ¡ã€‚ ä»»åŠ¡å¤„ç†ä¼˜å…ˆçº§ä¸ºï¼šæ ¸å¿ƒçº¿ç¨‹corePoolSizeã€ä»»åŠ¡é˜Ÿåˆ—workQueueã€æœ€å¤§çº¿ç¨‹maximumPoolSizeï¼Œå¦‚æœä¸‰è€…éƒ½æ»¡äº†ï¼Œä½¿ç”¨handlerå¤„ç†è¢«æ‹’ç»çš„ä»»åŠ¡ã€‚ æ‹’ç»ç­–ç•¥ åœ¨åˆ†æThreadPoolExecutorçš„æ„é€ å‚æ•°æ—¶ï¼Œæœ‰ä¸€ä¸ªRejectedExecutionHandlerå‚æ•°ã€‚RejectedExecutionHandleræ˜¯ä¸€ä¸ªæ¥å£ï¼š public interface RejectedExecutionHandler { void rejectedExecution(Runnable r, ThreadPoolExecutor executor); } é‡Œé¢åªæœ‰ä¸€ä¸ªæ–¹æ³•ã€‚å½“è¦åˆ›å»ºçš„çº¿ç¨‹æ•°é‡å¤§äºçº¿ç¨‹æ± çš„æœ€å¤§çº¿ç¨‹æ•°çš„æ—¶å€™ï¼Œæ–°çš„ä»»åŠ¡å°±ä¼šè¢«æ‹’ç»ï¼Œå°±ä¼šè°ƒç”¨è¿™ä¸ªæ¥å£é‡Œçš„è¿™ä¸ªæ–¹æ³•ã€‚å¯ä»¥è‡ªå·±å®ç°è¿™ä¸ªæ¥å£ï¼Œå®ç°å¯¹è¿™äº›è¶…å‡ºæ•°é‡çš„ä»»åŠ¡çš„å¤„ç†ã€‚ ThreadPoolExecutorè‡ªå·±å·²ç»æä¾›äº†å››ä¸ªæ‹’ç»ç­–ç•¥ï¼Œåˆ†åˆ«æ˜¯AbortPolicy,CallerRunsPolicy,DiscardPolicy,DiscardOldestPolicy AbortPolicyï¼šThreadPoolExecutorä¸­é»˜è®¤çš„æ‹’ç»ç­–ç•¥å°±æ˜¯AbortPolicyã€‚ç›´æ¥æŠ›å‡ºå¼‚å¸¸ã€‚ CallerRunsPolicy:åœ¨ä»»åŠ¡è¢«æ‹’ç»æ·»åŠ åï¼Œä¼šè°ƒç”¨å½“å‰çº¿ç¨‹æ± çš„æ‰€åœ¨çš„çº¿ç¨‹å»æ‰§è¡Œè¢«æ‹’ç»çš„ä»»åŠ¡ã€‚ DiscardPolicy:é‡‡ç”¨è¿™ä¸ªæ‹’ç»ç­–ç•¥ï¼Œä¼šè®©è¢«çº¿ç¨‹æ± æ‹’ç»çš„ä»»åŠ¡ç›´æ¥æŠ›å¼ƒï¼Œä¸ä¼šæŠ›å¼‚å¸¸ä¹Ÿä¸ä¼šæ‰§è¡Œã€‚ DiscardOldestPolicyï¼šå½“ä»»åŠ¡è¢«æ‹’ç»æ·»åŠ æ—¶ï¼Œä¼šæŠ›å¼ƒä»»åŠ¡é˜Ÿåˆ—ä¸­æœ€æ—§çš„ä»»åŠ¡ä¹Ÿå°±æ˜¯æœ€å…ˆåŠ å…¥é˜Ÿåˆ—çš„ï¼Œå†æŠŠè¿™ä¸ªæ–°ä»»åŠ¡æ·»åŠ è¿›å»ã€‚ ","link":"https://kily-007.github.io/post/ç¬”è®°-javaåˆ›å»ºçº¿ç¨‹çš„å‡ ç§æ–¹å¼/"},{"title":"ç®—æ³•-æ±‚å…¨æ’åˆ—","content":"é¢˜ç›®ï¼šæ•°å­—1ï¼Œ2ï¼Œ3ï¼Œ4å…¨æ’åˆ—ã€‚ å…¨æ’åˆ— æ€è·¯ï¼šä½¿ç”¨é€’å½’ç­–ç•¥å°†å¾…æ’æ•°åˆ—é€ä¸€ç¼©å°ã€‚ä¾‹å¦‚1,2,3,4ã€‚å…ˆæŠŠ1å›ºå®šï¼Œé€’å½’æ±‚2,3,4çš„å…¨æ’åˆ—ï¼›åˆæŠŠ2å›ºå®šï¼Œé€’å½’æ±‚3,4å…¨æ’åˆ—......ç›´åˆ°åªå‰©ä¸€ä¸ªæ•°ï¼Œè¾“å‡ºè¿™ä¸ªæ’åˆ—ã€‚å›¾è§£å¦‚ä¸‹ï¼š private static void permutation(int[] array, int index) { if (index == array.length - 1) System.out.println(Arrays.toString(array)); //ä»å›ºå®šçš„æ•°ï¼Œä¸åé¢æ¯ä¸€ä½äº¤æ¢ for (int i = index; i &lt; array.length; i++) { swap(array, i, index); permutation(array, index + 1);//ç¡®å®šç¬¬indexä½çš„æ•°å€¼ swap(array, i, index); } } private static void swap(int[] array, int i, int index) { int temp=array[i]; array[i]=array[index]; array[index]=temp; } å¸¦é‡å¤å€¼çš„å…¨æ’åˆ— ä¾‹å¦‚ï¼š1,2,3ï¼Œ2 å½“è¿›è¡Œåˆ°index=0æ—¶ï¼Œå›ºå®š{1}+P(2,3,2)ï¼Œæ¥ä¸‹æ¥æ±‚å­ä¸²(2,3,2)çš„å…¨æ’åˆ—ï¼Œä½†å…¶ä¸­æœ‰ä¸¤ä¸ª2ï¼Œæ— è®ºå“ªä¸ªä¸æ­¤æ—¶çš„1äº¤æ¢ï¼Œåé¢çš„å­ä¸²éƒ½ç›¸åŒï¼Œä¼šé‡å¤ã€‚æ•…éœ€è¦è·³è¿‡ä¿ç•™å…¶ä¸­ä¸€ç§å°±å¯ä»¥äº†ï¼ŒæŸ¥è¯¢æ˜¯å¦é‡å¤çš„åŒºé—´ä¸ºå½“å‰è¿›è¡Œåˆ°çš„ä½ç½®indexå’Œå‡†å¤‡äº¤æ¢çš„ä½ç½®iï¼Œåœ¨iä¹‹å‰è‹¥æœ‰é‡å¤çš„ï¼Œåˆ™è¯´æ˜indexä½ç½®å…ƒç´ ä¸éœ€è¦å†ä¸iä½ç½®äº¤æ¢è®¡ç®—äº†ã€‚ä»£ç å¦‚ä¸‹ï¼š private static void permutation(int[] array, int index) { if (index == array.length - 1) System.out.println(Arrays.toString(array)); // ç”¨å½“å‰ä½å€¼ï¼Œä¸åé¢æ¯ä¸€ä½äº¤æ¢ for (int i = index; i &lt; array.length; i++) { if(check(array,index,i)){ swap(array, i, index); permutation(array, index + 1);//ç¡®å®šç¬¬indexä½çš„æ•°å€¼ swap(array, i, index); } } } private static boolean check(int[] array, int index, int i) { if (i &gt; index) {//å…¼å®¹index=içš„æƒ…å†µ for (int j = index; j &lt; i; j++) { if (array[j] == array[i]) return false; } } return true; } private static void swap(int[] array, int i, int index) { int temp = array[i]; array[i] = array[index]; array[index] = temp; } ","link":"https://kily-007.github.io/post/ç®—æ³•-æ±‚å…¨æ’åˆ—/"},{"title":"ç®—æ³•-KMP","content":"KMPç®—æ³• æš´åŠ›åŒ¹é… é—®é¢˜ï¼šæœ‰ä¸€ä¸ªæ–‡æœ¬ä¸²Sï¼Œå’Œä¸€ä¸ªæ¨¡å¼ä¸²Pï¼Œç°åœ¨è¦æŸ¥æ‰¾Påœ¨Sä¸­çš„ä½ç½®ï¼Œç›´æ¥æ€è·¯ï¼šæš´åŠ›æŸ¥æ‰¾ã€‚ public int strMatch(String S,String P){ int i=0; int j=0; while(i&lt;S.length()&amp;&amp;j&lt;P.length()){ if(S[i]==P[j]){ i++; j++; }else{ i=i-j+1; j=0; } } if(j==P.length()){ return i-j; }else{ return -1; } } KMPç®—æ³• å‡è®¾ç°åœ¨æ–‡æœ¬ä¸²SåŒ¹é…åˆ° i ä½ç½®ï¼Œæ¨¡å¼ä¸²PåŒ¹é…åˆ° j ä½ç½® å¦‚æœj = -1ï¼Œæˆ–è€…å½“å‰å­—ç¬¦åŒ¹é…æˆåŠŸï¼ˆå³S[i] == P[j]ï¼‰ï¼Œéƒ½ä»¤i++ï¼Œj++ï¼Œç»§ç»­åŒ¹é…ä¸‹ä¸€ä¸ªå­—ç¬¦ï¼› å¦‚æœj != -1ï¼Œä¸”å½“å‰å­—ç¬¦åŒ¹é…å¤±è´¥ï¼ˆå³S[i] != P[j]ï¼‰ï¼Œåˆ™ä»¤ i ä¸å˜ï¼Œj = next[j]ã€‚æ­¤ä¸¾æ„å‘³ç€å¤±é…æ—¶ï¼Œæ¨¡å¼ä¸²Pç›¸å¯¹äºæ–‡æœ¬ä¸²Så‘å³ç§»åŠ¨äº†j - next [j] ä½ã€‚åˆ™ä»£ç å˜ä¸ºï¼š public int strMatch(String S,String P){ int i=0; int j=0; while(i&lt;S.length()&amp;&amp;j&lt;P.length()){ if(j==-1||S[i]==P[j]){ i++; j++; }else{ j=next[j]; } } if(j==P.length()){ return i-j; }else{ return -1; } } å½“S[10]è·ŸP[6]åŒ¹é…å¤±è´¥æ—¶ï¼ŒKMPä¸æ˜¯è·Ÿæš´åŠ›åŒ¹é…é‚£æ ·ç®€å•çš„æŠŠæ¨¡å¼ä¸²å³ç§»ä¸€ä½ï¼Œè€Œæ˜¯æ‰§è¡Œç¬¬â‘¡æ¡æŒ‡ä»¤ï¼šâ€œå¦‚æœj != -1ï¼Œä¸”å½“å‰å­—ç¬¦åŒ¹é…å¤±è´¥ï¼ˆå³S[i] != P[j]ï¼‰ï¼Œåˆ™ä»¤ i ä¸å˜ï¼Œj = next[j]â€ï¼Œå³j ä»6å˜åˆ°2ï¼ˆåé¢æˆ‘ä»¬å°†æ±‚å¾—P[6]ï¼Œå³å­—ç¬¦Då¯¹åº”çš„next å€¼ä¸º2ï¼‰ï¼Œæ‰€ä»¥ç›¸å½“äºæ¨¡å¼ä¸²å‘å³ç§»åŠ¨çš„ä½æ•°ä¸ºj - next[j]ï¼ˆj - next[j] = 6-2 = 4ï¼‰ã€‚ æ±‚nextæ•°ç»„ next æ•°ç»„çš„æ±‚è§£ï¼šå°±æ˜¯æ‰¾æœ€å¤§å¯¹ç§°é•¿åº¦çš„å‰ç¼€åç¼€ï¼Œç„¶åæ•´ä½“å³ç§»ä¸€ä½ï¼Œåˆå€¼èµ‹ä¸º-1ï¼ˆå½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥ç›´æ¥è®¡ç®—æŸä¸ªå­—ç¬¦å¯¹åº”çš„nextå€¼ï¼Œå°±æ˜¯çœ‹è¿™ä¸ªå­—ç¬¦ä¹‹å‰çš„å­—ç¬¦ä¸²ä¸­æœ‰å¤šå¤§é•¿åº¦çš„ç›¸åŒå‰ç¼€åç¼€ï¼‰ã€‚ â€‹ æ¢è¨€ä¹‹ï¼Œå¯¹äºç»™å®šçš„æ¨¡å¼ä¸²ï¼šABCDABDï¼Œå®ƒçš„æœ€å¤§é•¿åº¦è¡¨åŠnext æ•°ç»„åˆ†åˆ«å¦‚ä¸‹ï¼š æ ¹æ®æœ€å¤§é•¿åº¦è¡¨æ±‚å‡ºäº†next æ•°ç»„åï¼Œä»è€Œæœ‰å¤±é…æ—¶ï¼Œæ¨¡å¼ä¸²å‘å³ç§»åŠ¨çš„ä½æ•°ä¸ºï¼šå¤±é…å­—ç¬¦æ‰€åœ¨ä½ç½® - å¤±é…å­—ç¬¦å¯¹åº”çš„next å€¼. public int[] getNextJ(int[] next){ int k=-1; int j=0; while(j&lt;next.length{ if(k==-1||p[k]==p[j]){ k++; j++; next[j]=k; }else{ k=next[k]; } } } BMç®—æ³• KMPçš„åŒ¹é…æ˜¯ä»æ¨¡å¼ä¸²çš„å¼€å¤´å¼€å§‹åŒ¹é…çš„ï¼Œè€Œ1977å¹´ï¼Œå¾·å…‹è¨æ–¯å¤§å­¦çš„Robert S. Boyeræ•™æˆå’ŒJ Strother Mooreæ•™æˆå‘æ˜äº†ä¸€ç§æ–°çš„å­—ç¬¦ä¸²åŒ¹é…ç®—æ³•ï¼šBoyer-Mooreç®—æ³•ï¼Œç®€ç§°BMç®—æ³•ã€‚è¯¥ç®—æ³•ä»æ¨¡å¼ä¸²çš„å°¾éƒ¨å¼€å§‹åŒ¹é…ï¼Œä¸”æ‹¥æœ‰åœ¨æœ€åæƒ…å†µä¸‹O(N)çš„æ—¶é—´å¤æ‚åº¦ã€‚åœ¨å®è·µä¸­ï¼Œæ¯”KMPç®—æ³•çš„å®é™…æ•ˆèƒ½é«˜ã€‚ â€‹ BMç®—æ³•å®šä¹‰äº†ä¸¤ä¸ªè§„åˆ™ï¼š åå­—ç¬¦è§„åˆ™ï¼šå½“æ–‡æœ¬ä¸²ä¸­çš„æŸä¸ªå­—ç¬¦è·Ÿæ¨¡å¼ä¸²çš„æŸä¸ªå­—ç¬¦ä¸åŒ¹é…æ—¶ï¼Œæˆ‘ä»¬ç§°æ–‡æœ¬ä¸²ä¸­çš„è¿™ä¸ªå¤±é…å­—ç¬¦ä¸ºåå­—ç¬¦ï¼Œæ­¤æ—¶æ¨¡å¼ä¸²éœ€è¦å‘å³ç§»åŠ¨ï¼Œç§»åŠ¨çš„ä½æ•° = åå­—ç¬¦åœ¨æ¨¡å¼ä¸²ä¸­çš„ä½ç½® - åå­—ç¬¦åœ¨æ¨¡å¼ä¸²ä¸­æœ€å³å‡ºç°çš„ä½ç½®ã€‚æ­¤å¤–ï¼Œå¦‚æœ&quot;åå­—ç¬¦&quot;ä¸åŒ…å«åœ¨æ¨¡å¼ä¸²ä¹‹ä¸­ï¼Œåˆ™æœ€å³å‡ºç°ä½ç½®ä¸º-1ã€‚ å¥½åç¼€è§„åˆ™ï¼šå½“å­—ç¬¦å¤±é…æ—¶ï¼Œåç§»ä½æ•° = å¥½åç¼€åœ¨æ¨¡å¼ä¸²ä¸­çš„ä½ç½® - å¥½åç¼€åœ¨æ¨¡å¼ä¸²ä¸Šä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼Œä¸”å¦‚æœå¥½åç¼€åœ¨æ¨¡å¼ä¸²ä¸­æ²¡æœ‰å†æ¬¡å‡ºç°ï¼Œåˆ™ä¸º-1ã€‚ ä¸‹é¢ä¸¾ä¾‹è¯´æ˜BMç®—æ³•ã€‚ä¾‹å¦‚ï¼Œç»™å®šæ–‡æœ¬ä¸²â€œHERE IS A SIMPLE EXAMPLEâ€ï¼Œå’Œæ¨¡å¼ä¸²â€œEXAMPLEâ€ï¼Œç°è¦æŸ¥æ‰¾æ¨¡å¼ä¸²æ˜¯å¦åœ¨æ–‡æœ¬ä¸²ä¸­ï¼Œå¦‚æœå­˜åœ¨ï¼Œè¿”å›æ¨¡å¼ä¸²åœ¨æ–‡æœ¬ä¸²ä¸­çš„ä½ç½®ã€‚ â€‹ 1. é¦–å…ˆï¼Œ&quot;æ–‡æœ¬ä¸²&quot;ä¸&quot;æ¨¡å¼ä¸²&quot;å¤´éƒ¨å¯¹é½ï¼Œä»å°¾éƒ¨å¼€å§‹æ¯”è¾ƒã€‚&quot;S&quot;ä¸&quot;E&quot;ä¸åŒ¹é…ã€‚è¿™æ—¶ï¼Œ&quot;S&quot;å°±è¢«ç§°ä¸º&quot;åå­—ç¬¦&quot;ï¼ˆbad characterï¼‰ï¼Œå³ä¸åŒ¹é…çš„å­—ç¬¦ï¼Œå®ƒå¯¹åº”ç€æ¨¡å¼ä¸²çš„ç¬¬6ä½ã€‚ä¸”&quot;S&quot;ä¸åŒ…å«åœ¨æ¨¡å¼ä¸²&quot;EXAMPLE&quot;ä¹‹ä¸­ï¼ˆç›¸å½“äºæœ€å³å‡ºç°ä½ç½®æ˜¯-1ï¼‰ï¼Œè¿™æ„å‘³ç€å¯ä»¥æŠŠæ¨¡å¼ä¸²åç§»6-(-1)=7ä½ï¼Œä»è€Œç›´æ¥ç§»åˆ°&quot;S&quot;çš„åä¸€ä½ã€‚ â€‹ 2. ä¾ç„¶ä»å°¾éƒ¨å¼€å§‹æ¯”è¾ƒï¼Œå‘ç°&quot;P&quot;ä¸&quot;E&quot;ä¸åŒ¹é…ï¼Œæ‰€ä»¥&quot;P&quot;æ˜¯&quot;åå­—ç¬¦&quot;ã€‚ä½†æ˜¯ï¼Œ&quot;P&quot;åŒ…å«åœ¨æ¨¡å¼ä¸²&quot;EXAMPLE&quot;ä¹‹ä¸­ã€‚å› ä¸ºâ€œPâ€è¿™ä¸ªâ€œåå­—ç¬¦â€å¯¹åº”ç€æ¨¡å¼ä¸²çš„ç¬¬6ä½ï¼ˆä»0å¼€å§‹ç¼–å·ï¼‰ï¼Œä¸”åœ¨æ¨¡å¼ä¸²ä¸­çš„æœ€å³å‡ºç°ä½ç½®ä¸º4ï¼Œæ‰€ä»¥ï¼Œå°†æ¨¡å¼ä¸²åç§»6-4=2ä½ï¼Œä¸¤ä¸ª&quot;P&quot;å¯¹é½ã€‚ â€‹ 3. ä¾æ¬¡æ¯”è¾ƒï¼Œå¾—åˆ° â€œMPLEâ€åŒ¹é…ï¼Œç§°ä¸º&quot;å¥½åç¼€&quot;ï¼ˆgood suffixï¼‰ï¼Œå³æ‰€æœ‰å°¾éƒ¨åŒ¹é…çš„å­—ç¬¦ä¸²ã€‚æ³¨æ„ï¼Œ&quot;MPLE&quot;ã€&quot;PLE&quot;ã€&quot;LE&quot;ã€&quot;E&quot;éƒ½æ˜¯å¥½åç¼€ã€‚ â€‹ 4. å‘ç°â€œIâ€ä¸â€œAâ€ä¸åŒ¹é…ï¼šâ€œIâ€æ˜¯åå­—ç¬¦ã€‚å¦‚æœæ˜¯æ ¹æ®åå­—ç¬¦è§„åˆ™ï¼Œæ­¤æ—¶æ¨¡å¼ä¸²åº”è¯¥åç§»2-(-1)=3ä½ã€‚é—®é¢˜æ˜¯ï¼Œæœ‰æ²¡æœ‰æ›´ä¼˜çš„ç§»æ³•ï¼Ÿ â€‹ 5. æ›´ä¼˜çš„ç§»æ³•æ˜¯åˆ©ç”¨å¥½åç¼€è§„åˆ™ï¼šå½“å­—ç¬¦å¤±é…æ—¶ï¼Œåç§»ä½æ•° = å¥½åç¼€åœ¨æ¨¡å¼ä¸²ä¸­çš„ä½ç½® - å¥½åç¼€åœ¨æ¨¡å¼ä¸²ä¸­ä¸Šä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼Œä¸”å¦‚æœå¥½åç¼€åœ¨æ¨¡å¼ä¸²ä¸­æ²¡æœ‰å†æ¬¡å‡ºç°ï¼Œåˆ™ä¸º-1ã€‚ â€‹ æ‰€æœ‰çš„â€œå¥½åç¼€â€ï¼ˆMPLEã€PLEã€LEã€Eï¼‰ä¹‹ä¸­ï¼Œåªæœ‰â€œEâ€åœ¨â€œEXAMPLEâ€çš„å¤´éƒ¨å‡ºç°ï¼Œæ‰€ä»¥åç§»6-0=6ä½ã€‚ â€‹ å¯ä»¥çœ‹å‡ºï¼Œâ€œåå­—ç¬¦è§„åˆ™â€åªèƒ½ç§»3ä½ï¼Œâ€œå¥½åç¼€è§„åˆ™â€å¯ä»¥ç§»6ä½ã€‚æ¯æ¬¡åç§»è¿™ä¸¤ä¸ªè§„åˆ™ä¹‹ä¸­çš„è¾ƒå¤§å€¼ã€‚è¿™ä¸¤ä¸ªè§„åˆ™çš„ç§»åŠ¨ä½æ•°ï¼Œåªä¸æ¨¡å¼ä¸²æœ‰å…³ï¼Œä¸åŸæ–‡æœ¬ä¸²æ— å…³ã€‚ â€‹ 6. ç»§ç»­ä»å°¾éƒ¨å¼€å§‹æ¯”è¾ƒï¼Œâ€œPâ€ä¸â€œEâ€ä¸åŒ¹é…ï¼Œå› æ­¤â€œPâ€æ˜¯â€œåå­—ç¬¦â€ï¼Œæ ¹æ®â€œåå­—ç¬¦è§„åˆ™â€ï¼Œåç§» 6 - 4 = 2ä½ã€‚å› ä¸ºæ˜¯æœ€åä¸€ä½å°±å¤±é…ï¼Œå°šæœªè·å¾—å¥½åç¼€ã€‚ â€‹ ç”±ä¸Šå¯çŸ¥ï¼ŒBMç®—æ³•ä¸ä»…æ•ˆç‡é«˜ï¼Œè€Œä¸”æ„æ€å·§å¦™ï¼Œå®¹æ˜“ç†è§£ã€‚ Sundayç®—æ³• ä¸Šæ–‡ä¸­ï¼Œæˆ‘ä»¬å·²ç»ä»‹ç»äº†KMPç®—æ³•å’ŒBMç®—æ³•ï¼Œè¿™ä¸¤ä¸ªç®—æ³•åœ¨æœ€åæƒ…å†µä¸‹å‡å…·æœ‰çº¿æ€§çš„æŸ¥æ‰¾æ—¶é—´ã€‚ä½†å®é™…ä¸Šï¼ŒKMPç®—æ³•å¹¶ä¸æ¯”æœ€ç®€å•çš„cåº“å‡½æ•°strstr()å¿«å¤šå°‘ï¼Œè€ŒBMç®—æ³•è™½ç„¶é€šå¸¸æ¯”KMPç®—æ³•å¿«ï¼Œä½†BMç®—æ³•ä¹Ÿè¿˜ä¸æ˜¯ç°æœ‰å­—ç¬¦ä¸²æŸ¥æ‰¾ç®—æ³•ä¸­æœ€å¿«çš„ç®—æ³•ï¼Œæœ¬æ–‡æœ€åå†ä»‹ç»ä¸€ç§æ¯”BMç®—æ³•æ›´å¿«çš„æŸ¥æ‰¾ç®—æ³•å³Sundayç®—æ³•ã€‚ â€‹ Sundayç®—æ³•ç”±Daniel M.Sundayåœ¨1990å¹´æå‡ºï¼Œå®ƒçš„æ€æƒ³è·ŸBMç®—æ³•å¾ˆç›¸ä¼¼ï¼š åªä¸è¿‡Sundayç®—æ³•æ˜¯ä»å‰å¾€ååŒ¹é…ï¼Œåœ¨åŒ¹é…å¤±è´¥æ—¶å…³æ³¨çš„æ˜¯æ–‡æœ¬ä¸²ä¸­å‚åŠ åŒ¹é…çš„æœ€æœ«ä½å­—ç¬¦çš„ä¸‹ä¸€ä½å­—ç¬¦ã€‚ å¦‚æœè¯¥å­—ç¬¦æ²¡æœ‰åœ¨æ¨¡å¼ä¸²ä¸­å‡ºç°åˆ™ç›´æ¥è·³è¿‡ï¼Œå³ç§»åŠ¨ä½æ•° = åŒ¹é…ä¸²é•¿åº¦ + 1ï¼› å¦åˆ™ï¼Œå…¶ç§»åŠ¨ä½æ•° = æ¨¡å¼ä¸²ä¸­æœ€å³ç«¯çš„è¯¥å­—ç¬¦åˆ°æœ«å°¾çš„è·ç¦»+1ã€‚ â€‹ ä¸‹é¢ä¸¾ä¸ªä¾‹å­è¯´æ˜ä¸‹Sundayç®—æ³•ã€‚å‡å®šç°åœ¨è¦åœ¨æ–‡æœ¬ä¸²&quot;substring searching algorithm&quot;ä¸­æŸ¥æ‰¾æ¨¡å¼ä¸²&quot;search&quot;ã€‚ ä¸‹é¢ä¸¾ä¸ªä¾‹å­è¯´æ˜ä¸‹Sundayç®—æ³•ã€‚å‡å®šç°åœ¨è¦åœ¨æ–‡æœ¬ä¸²&quot;substring searching algorithm&quot;ä¸­æŸ¥æ‰¾æ¨¡å¼ä¸²&quot;search&quot;ã€‚ â€‹ 1. åˆšå¼€å§‹æ—¶ï¼ŒæŠŠæ¨¡å¼ä¸²ä¸æ–‡æœ¬ä¸²å·¦è¾¹å¯¹é½ï¼š substring searching algorithm search 2. ç»“æœå‘ç°åœ¨ç¬¬2ä¸ªå­—ç¬¦å¤„å‘ç°ä¸åŒ¹é…ï¼Œä¸åŒ¹é…æ—¶å…³æ³¨æ–‡æœ¬ä¸²ä¸­å‚åŠ åŒ¹é…çš„æœ€æœ«ä½å­—ç¬¦çš„ä¸‹ä¸€ä½å­—ç¬¦ï¼Œå³æ ‡ç²—çš„å­—ç¬¦ iï¼Œå› ä¸ºæ¨¡å¼ä¸²searchä¸­å¹¶ä¸å­˜åœ¨iï¼Œæ‰€ä»¥æ¨¡å¼ä¸²ç›´æ¥è·³è¿‡ä¸€å¤§ç‰‡ï¼Œå‘å³ç§»åŠ¨ä½æ•° = åŒ¹é…ä¸²é•¿åº¦ + 1 = 6 + 1 = 7ï¼Œä» i ä¹‹åçš„é‚£ä¸ªå­—ç¬¦ï¼ˆå³å­—ç¬¦nï¼‰å¼€å§‹ä¸‹ä¸€æ­¥çš„åŒ¹é…ï¼Œå¦‚ä¸‹å›¾ï¼š substring searching algorithm search ^ 3. ç»“æœç¬¬ä¸€ä¸ªå­—ç¬¦å°±ä¸åŒ¹é…ï¼Œå†çœ‹æ–‡æœ¬ä¸²ä¸­å‚åŠ åŒ¹é…çš„æœ€æœ«ä½å­—ç¬¦çš„ä¸‹ä¸€ä½å­—ç¬¦ï¼Œæ˜¯'r'ï¼Œå®ƒå‡ºç°åœ¨æ¨¡å¼ä¸²ä¸­çš„å€’æ•°ç¬¬3ä½ï¼Œäºæ˜¯æŠŠæ¨¡å¼ä¸²å‘å³ç§»åŠ¨3ä½ï¼ˆr åˆ°æ¨¡å¼ä¸²æœ«å°¾çš„è·ç¦» + 1 = 2 + 1 =3ï¼‰ï¼Œä½¿ä¸¤ä¸ª'r'å¯¹é½ï¼Œå¦‚ä¸‹ï¼š substring searching algorithm search 4. åŒ¹é…æˆåŠŸã€‚ å›é¡¾æ•´ä¸ªè¿‡ç¨‹ï¼Œæˆ‘ä»¬åªç§»åŠ¨äº†ä¸¤æ¬¡æ¨¡å¼ä¸²å°±æ‰¾åˆ°äº†åŒ¹é…ä½ç½®ï¼Œç¼˜äºSundayç®—æ³•æ¯ä¸€æ­¥çš„ç§»åŠ¨é‡éƒ½æ¯”è¾ƒå¤§ï¼Œæ•ˆç‡å¾ˆé«˜ã€‚å®Œã€‚ ","link":"https://kily-007.github.io/post/ç®—æ³•-KMP/"},{"title":"ç“œå­äºŒæ‰‹è½¦é¢ç»-å¤§æ•°æ®å²—","content":"ç“œå­äºŒæ‰‹è½¦é¢ç» ä¸€é¢ï¼š é¢è¯•å®˜æ˜¯ä¸ªæ¯”è¾ƒè€å¿ƒçš„å¤§å§å§ç±»å‹ï¼Œå¾ˆå¤šé—®é¢˜éƒ½ä¸ä¼šä¹Ÿè·Ÿæˆ‘è¯´æ²¡å…³ç³»ï¼Œæ€»å…±é¢äº†45åˆ†é’Ÿã€‚æˆ‘é—®äº†ä¸€ä¸‹ç“œå­çš„å¼€å‘å²—éƒ½æ˜¯åœ¨ä¸€èµ·é¢å¾—ï¼Œå†…å®¹éƒ½å¾ˆç›¸ä¼¼ï¼Œå¹¶æ²¡æœ‰é’ˆå¯¹ç‰¹å®šçš„å²—ä½é—®å¯¹åº”çš„å†…å®¹ï¼Œä¸‹é¢è¯´ä¸‹é¢è¯•è¿‡ç¨‹è¶´ã€‚ 1ã€è‡ªæˆ‘ä»‹ç»å’Œé¡¹ç›®ä»‹ç»ï¼Œæ²¡æ’‘è¿‡5åˆ†é’Ÿï¼Œè®©ç›´æ¥è®²é‡Œé¢ç”¨åˆ°çš„æŠ€æœ¯æ ˆï¼Œä¸è¦è®²ä¸šåŠ¡é€»è¾‘ã€‚ç”¨åˆ°çš„æŠ€æœ¯åŒ…æ‹¬ç¼“å†²åŒºã€kafkaã€sparkã€hbaseä¹‹ç±»çš„ã€‚ 2ã€javaä¸­çš„å¼±å¼•ç”¨ä¸å¼ºå¼•ç”¨ï¼› å¼ºå¼•ç”¨æ˜¯ä½¿ç”¨æœ€æ™®éçš„å¼•ç”¨ã€‚å¦‚æœä¸€ä¸ªå¯¹è±¡å…·æœ‰å¼ºå¼•ç”¨ï¼Œé‚£åƒåœ¾å›æ”¶å™¨ç»ä¸ä¼šå›æ”¶å®ƒã€‚å½“å†…å­˜ç©ºé—´ä¸è¶³æ—¶ï¼ŒJavaè™šæ‹Ÿæœºå®æ„¿æŠ›å‡ºOutOfMemoryErroré”™è¯¯ï¼Œä½¿ç¨‹åºå¼‚å¸¸ç»ˆæ­¢ï¼Œä¹Ÿä¸ä¼šé éšæ„å›æ”¶å…·æœ‰å¼ºå¼•ç”¨çš„å¯¹è±¡æ¥è§£å†³å†…å­˜ä¸è¶³çš„é—®é¢˜ã€‚ å¦‚æœå¼ºå¼•ç”¨å¯¹è±¡ä¸ä½¿ç”¨æ—¶ï¼Œéœ€è¦å¼±åŒ–ä»è€Œä½¿GCèƒ½å¤Ÿå›æ”¶ï¼Œå¦‚ä¸‹ï¼š strongReference = null; æ˜¾å¼åœ°è®¾ç½®strongReferenceå¯¹è±¡ä¸ºnullï¼Œæˆ–è®©å…¶è¶…å‡ºå¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸèŒƒå›´ï¼Œåˆ™gcè®¤ä¸ºè¯¥å¯¹è±¡ä¸å­˜åœ¨å¼•ç”¨ï¼Œè¿™æ—¶å°±å¯ä»¥å›æ”¶è¿™ä¸ªå¯¹è±¡ã€‚å…·ä½“ä»€ä¹ˆæ—¶å€™æ”¶é›†è¿™è¦å–å†³äºGCç®—æ³•ã€‚ è½¯å¼•ç”¨å¦‚æœä¸€ä¸ªå¯¹è±¡åªå…·æœ‰è½¯å¼•ç”¨ï¼Œåˆ™å†…å­˜ç©ºé—´å……è¶³æ—¶ï¼Œåƒåœ¾å›æ”¶å™¨å°±ä¸ä¼šå›æ”¶å®ƒï¼›å¦‚æœå†…å­˜ç©ºé—´ä¸è¶³äº†ï¼Œå°±ä¼šå›æ”¶è¿™äº›å¯¹è±¡çš„å†…å­˜ã€‚åªè¦åƒåœ¾å›æ”¶å™¨æ²¡æœ‰å›æ”¶å®ƒï¼Œè¯¥å¯¹è±¡å°±å¯ä»¥è¢«ç¨‹åºä½¿ç”¨ã€‚(è½¯å¼•ç”¨å¯ç”¨æ¥å®ç°å†…å­˜æ•æ„Ÿçš„é«˜é€Ÿç¼“å­˜ã€‚)è½¯å¼•ç”¨å¯ä»¥å’Œä¸€ä¸ªå¼•ç”¨é˜Ÿåˆ—(ReferenceQueue)è”åˆä½¿ç”¨ã€‚å¦‚æœè½¯å¼•ç”¨æ‰€å¼•ç”¨å¯¹è±¡è¢«åƒåœ¾å›æ”¶ï¼ŒJAVAè™šæ‹Ÿæœºå°±ä¼šæŠŠè¿™ä¸ªè½¯å¼•ç”¨åŠ å…¥åˆ°ä¸ä¹‹å…³è”çš„å¼•ç”¨é˜Ÿåˆ—ä¸­ã€‚ å½“å†…å­˜ä¸è¶³æ—¶ï¼ŒJVMé¦–å…ˆå°†è½¯å¼•ç”¨ä¸­çš„å¯¹è±¡å¼•ç”¨ç½®ä¸ºnullï¼Œç„¶åé€šçŸ¥åƒåœ¾å›æ”¶å™¨è¿›è¡Œå›æ”¶,ä¹Ÿå°±æ˜¯è¯´ï¼Œåƒåœ¾æ”¶é›†çº¿ç¨‹ä¼šåœ¨è™šæ‹ŸæœºæŠ›å‡ºOutOfMemoryErrorä¹‹å‰å›æ”¶è½¯å¼•ç”¨å¯¹è±¡ï¼Œè€Œä¸”è™šæ‹Ÿæœºä¼šå°½å¯èƒ½ä¼˜å…ˆå›æ”¶é•¿æ—¶é—´é—²ç½®ä¸ç”¨çš„è½¯å¼•ç”¨å¯¹è±¡ã€‚å¯¹é‚£äº›åˆšæ„å»ºçš„æˆ–åˆšä½¿ç”¨è¿‡çš„**â€œè¾ƒæ–°çš„â€è½¯å¯¹è±¡ä¼šè¢«è™šæ‹Ÿæœºå°½å¯èƒ½ä¿ç•™**ï¼Œè¿™å°±æ˜¯å¼•å…¥å¼•ç”¨é˜Ÿåˆ—ReferenceQueueçš„åŸå› ã€‚ åº”ç”¨åœºæ™¯ï¼š æµè§ˆå™¨çš„åé€€æŒ‰é’®ã€‚æŒ‰åé€€æ—¶ï¼Œè¿™ä¸ªåé€€æ—¶æ˜¾ç¤ºçš„ç½‘é¡µå†…å®¹æ˜¯é‡æ–°è¿›è¡Œè¯·æ±‚è¿˜æ˜¯ä»ç¼“å­˜ä¸­å–å‡ºå‘¢ï¼Ÿè¿™å°±è¦çœ‹å…·ä½“çš„å®ç°ç­–ç•¥äº†ã€‚ å¦‚æœä¸€ä¸ªç½‘é¡µåœ¨æµè§ˆç»“æŸæ—¶å°±è¿›è¡Œå†…å®¹çš„å›æ”¶ï¼Œåˆ™æŒ‰åé€€æŸ¥çœ‹å‰é¢æµè§ˆè¿‡çš„é¡µé¢æ—¶ï¼Œéœ€è¦é‡æ–°æ„å»ºï¼› å¦‚æœå°†æµè§ˆè¿‡çš„ç½‘é¡µå­˜å‚¨åˆ°å†…å­˜ä¸­ä¼šé€ æˆå†…å­˜çš„å¤§é‡æµªè´¹ï¼Œç”šè‡³ä¼šé€ æˆå†…å­˜æº¢å‡ºã€‚ è¿™æ—¶å€™å°±å¯ä»¥ä½¿ç”¨è½¯å¼•ç”¨ï¼Œå¾ˆå¥½çš„è§£å†³äº†å®é™…çš„é—®é¢˜ã€‚ å¼±å¼•ç”¨ä¸è½¯å¼•ç”¨çš„åŒºåˆ«åœ¨äºï¼šåªå…·æœ‰å¼±å¼•ç”¨çš„å¯¹è±¡æ‹¥æœ‰æ›´çŸ­æš‚çš„ç”Ÿå‘½å‘¨æœŸã€‚åœ¨åƒåœ¾å›æ”¶å™¨çº¿ç¨‹æ‰«æå®ƒæ‰€ç®¡è¾–çš„å†…å­˜åŒºåŸŸçš„è¿‡ç¨‹ä¸­ï¼Œä¸€æ—¦å‘ç°äº†åªå…·æœ‰å¼±å¼•ç”¨çš„å¯¹è±¡ï¼Œä¸ç®¡å½“å‰å†…å­˜ç©ºé—´è¶³å¤Ÿä¸å¦ï¼Œéƒ½ä¼šå›æ”¶å®ƒçš„å†…å­˜ã€‚ä¸è¿‡ï¼Œç”±äºåƒåœ¾å›æ”¶å™¨æ˜¯ä¸€ä¸ªä¼˜å…ˆçº§å¾ˆä½çš„çº¿ç¨‹ï¼Œå› æ­¤ä¸ä¸€å®šä¼šå¾ˆå¿«å‘ç°é‚£äº›åªå…·æœ‰å¼±å¼•ç”¨çš„å¯¹è±¡ã€‚ è™šå¼•ç”¨é¡¾åæ€ä¹‰ï¼Œå°±æ˜¯å½¢åŒè™šè®¾ï¼Œä¸å…¶ä»–å‡ ç§å¼•ç”¨éƒ½ä¸åŒï¼Œè™šå¼•ç”¨å¹¶ä¸ä¼šå†³å®šå¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸã€‚å¦‚æœä¸€ä¸ªå¯¹è±¡ä»…æŒæœ‰è™šå¼•ç”¨ï¼Œé‚£ä¹ˆå®ƒå°±å’Œæ²¡æœ‰ä»»ä½•å¼•ç”¨ä¸€æ ·ï¼Œåœ¨ä»»ä½•æ—¶å€™éƒ½å¯èƒ½è¢«åƒåœ¾å›æ”¶ã€‚è™šå¼•ç”¨ä¸»è¦ç”¨æ¥è·Ÿè¸ªå¯¹è±¡è¢«åƒåœ¾å›æ”¶çš„æ´»åŠ¨ã€‚è™šå¼•ç”¨ä¸è½¯å¼•ç”¨å’Œå¼±å¼•ç”¨çš„ä¸€ä¸ªåŒºåˆ«åœ¨äºï¼šè™šå¼•ç”¨å¿…é¡»å’Œå¼•ç”¨é˜Ÿåˆ—ï¼ˆReferenceQueueï¼‰è”åˆä½¿ç”¨ã€‚å½“åƒåœ¾å›æ”¶å™¨å‡†å¤‡å›æ”¶ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œå¦‚æœå‘ç°å®ƒè¿˜æœ‰è™šå¼•ç”¨ï¼Œå°±ä¼šåœ¨å›æ”¶å¯¹è±¡çš„å†…å­˜ä¹‹å‰ï¼ŒæŠŠè¿™ä¸ªè™šå¼•ç”¨åŠ å…¥åˆ°ä¸ä¹‹å…³è”çš„å¼•ç”¨é˜Ÿåˆ—ä¸­ã€‚ç¨‹åºå¯ä»¥é€šè¿‡åˆ¤æ–­å¼•ç”¨é˜Ÿåˆ—ä¸­æ˜¯å¦å·²ç»åŠ å…¥äº†è™šå¼•ç”¨ï¼Œæ¥äº†è§£è¢«å¼•ç”¨çš„å¯¹è±¡æ˜¯å¦å°†è¦è¢«åƒåœ¾å›æ”¶ã€‚ç¨‹åºå¦‚æœå‘ç°æŸä¸ªè™šå¼•ç”¨å·²ç»è¢«åŠ å…¥åˆ°å¼•ç”¨é˜Ÿåˆ—ï¼Œé‚£ä¹ˆå°±å¯ä»¥åœ¨æ‰€å¼•ç”¨çš„å¯¹è±¡çš„å†…å­˜è¢«å›æ”¶ä¹‹å‰é‡‡å–å¿…è¦çš„è¡ŒåŠ¨ã€‚ ç‰¹åˆ«æ³¨æ„ï¼Œåœ¨å®é™…ç¨‹åºè®¾è®¡ä¸­ä¸€èˆ¬å¾ˆå°‘ä½¿ç”¨å¼±å¼•ç”¨ä¸è™šå¼•ç”¨ï¼Œä½¿ç”¨è½¯ç”¨çš„æƒ…å†µè¾ƒå¤šï¼Œè¿™æ˜¯å› ä¸ºè½¯å¼•ç”¨å¯ä»¥åŠ é€ŸJVMå¯¹åƒåœ¾å†…å­˜çš„å›æ”¶é€Ÿåº¦ï¼Œå¯ä»¥ç»´æŠ¤ç³»ç»Ÿçš„è¿è¡Œå®‰å…¨ï¼Œé˜²æ­¢å†…å­˜æº¢å‡ºï¼ˆOutOfMemoryï¼‰ç­‰é—®é¢˜çš„äº§ç”Ÿã€‚ 3ã€è®©å®ç°LRUç®—æ³•ï¼Œè®²è®²æ€è·¯ï¼› æœ€è¿‘æœ€å°‘ä½¿ç”¨ç®—æ³•ã€‚å¸¸ç”¨äºé¡µé¢ç½®æ¢ç®—æ³•ï¼Œæ˜¯ä¸ºè™šæ‹Ÿé¡µå¼å­˜å‚¨ç®¡ç†æœåŠ¡çš„ã€‚å½“ä¸€ä¸ªæ•°æ®æœ€è¿‘ä¸€æ®µæ—¶é—´æ²¡æœ‰è¢«è®¿é—®ï¼Œæœªæ¥è¢«è®¿é—®çš„æ¦‚ç‡ä¹Ÿå¾ˆå°ã€‚å½“ç©ºé—´è¢«å æ»¡åï¼Œæœ€å…ˆæ·˜æ±°æœ€è¿‘æœ€å°‘ä½¿ç”¨çš„æ•°æ®ã€‚ æ€è·¯ä¸€ï¼šé‡‡ç”¨é“¾è¡¨ç»´æŒä¸€ä¸ªè™šæ‹Ÿé˜Ÿåˆ—ï¼Œæœ‰æ–°å…ƒç´ è¿›å…¥æ—¶ï¼Œæ’å…¥åˆ°å¤´ç»“ç‚¹ï¼›å½“æŸä¸ªç»“ç‚¹è¢«è®¿é—®æ—¶ï¼Œå°†å…¶ç§»åˆ°å¤´ç»“ç‚¹ï¼›å½“è¶…è¿‡é˜Ÿåˆ—å®¹é‡æ—¶ï¼Œåˆ é™¤è¡¨å°¾å…ƒç´ ã€‚ æ€è·¯äºŒï¼šé‡‡ç”¨å®¹å™¨ä¸è®¡æ•°çš„æ–¹æ³•ã€‚å…ƒç´ æŒ‰é¡ºåºè¿›å…¥å®¹å™¨ï¼Œæ¯ä¸ªå…ƒç´ æœ‰ä¸€ä¸ªè®¡æ•°å™¨ï¼ŒæŒ‰ç…§è¿›å…¥å®¹å™¨çš„é¡ºåºè®¡æ•°ï¼Œæ¯è¢«è®¿é—®ä¸€æ¬¡è®¡æ•°å™¨åŠ ä¸€ï¼› 4ã€ä¸‰æ¬¡æ¡æ‰‹åŠè¯¦ç»†è¿‡ç¨‹ï¼Œä»€ä¹ˆæ—¶å€™è°ƒç”¨accept()å‡½æ•°ï¼Œæœ‰ä»€ä¹ˆä½œç”¨ï¼›timewaiteå‘ç”Ÿåœ¨ä»€ä¹ˆæ—¶å€™ï¼Œä¸ºä»€ä¹ˆè¦waitï¼Ÿ 1.æœåŠ¡å™¨è°ƒç”¨listenè¿›è¡Œç›‘å¬ã€‚ 2.å®¢æˆ·ç«¯è°ƒç”¨connectæ¥å‘é€synæŠ¥æ–‡ æœåŠ¡å™¨åè®®æ ˆè´Ÿè´£ä¸‰æ¬¡æ¡æ‰‹çš„äº¤äº’è¿‡ç¨‹ã€‚ 3.è¿æ¥å»ºç«‹åï¼Œå¾€listené˜Ÿåˆ—ä¸­æ·»åŠ ä¸€ä¸ªæˆåŠŸçš„è¿æ¥ï¼Œç›´åˆ°é˜Ÿåˆ—çš„æœ€å¤§é•¿åº¦ã€‚ 4.æœåŠ¡å™¨è°ƒç”¨acceptä»listené˜Ÿåˆ—ä¸­å–å‡ºä¸€æ¡æˆåŠŸçš„tcpè¿æ¥ï¼Œlistené˜Ÿåˆ—ä¸­çš„è¿æ¥ä¸ªæ•°å°±å°‘ä¸€ä¸ª 5ã€è®²ä¸€ä¸‹sessionå’Œcookieçš„åŒºåˆ«ï¼›åœ¨æœåŠ¡å™¨ä¸Šå¤šå°æœºå™¨å¤šå®ä¾‹éœ€è¦å…±äº«sessionä¸­çš„å†…å®¹è¯¥æ€ä¹ˆåŠï¼Ÿ sessionåœ¨æœåŠ¡ç«¯ï¼Œå®ƒ çš„å«ä¹‰æ˜¯æŒ‡ä¸€ç±»ç”¨æ¥åœ¨å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´ä¿æŒçŠ¶æ€çš„è§£å†³æ–¹æ¡ˆã€‚æ¯ä¸ªå®¢æˆ·ç«¯å¯¹åº”ä¸€ä¸ªsessionï¼Œæ¯ä¸ªsessionæœ‰ä¸€ä¸ªsession idï¼Œ cookieåœ¨å®¢æˆ·ç«¯ï¼Œæµè§ˆå™¨ç¼“å­˜è®¿é—®ä¿¡æ¯ã€è®°å½•ä¸èµ„æºåœ¨cookieä¸­ã€‚ cookieçš„å†…å®¹ä¸»è¦åŒ…æ‹¬ï¼šåå­—ï¼Œå€¼ï¼Œè¿‡æœŸæ—¶é—´ï¼Œè·¯å¾„å’ŒåŸŸã€‚ ç”±äºcookieå¯ä»¥è¢«äººä¸ºçš„ç¦æ­¢ï¼Œå¿…é¡»æœ‰å…¶ä»–æœºåˆ¶ä»¥ä¾¿åœ¨cookieè¢«ç¦æ­¢æ—¶ä»ç„¶èƒ½å¤ŸæŠŠsession idä¼ é€’å›æœåŠ¡å™¨ã€‚ç»å¸¸è¢«ä½¿ç”¨çš„ä¸€ç§æŠ€æœ¯å«åšURLé‡å†™ï¼Œå°±æ˜¯æŠŠsession idç›´æ¥é™„åŠ åœ¨URLè·¯ å¾„çš„åé¢ï¼Œé™„åŠ æ–¹å¼ä¹Ÿæœ‰ä¸¤ç§ï¼Œä¸€ç§æ˜¯ä½œä¸ºURLè·¯å¾„çš„é™„åŠ ä¿¡æ¯ï¼Œå¦ä¸€ç§æ˜¯ä½œä¸ºæŸ¥è¯¢å­—ç¬¦ä¸²é™„åŠ åœ¨URLåé¢. å…±äº«ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œsessionéƒ½æ˜¯å­˜å‚¨åœ¨å†…å­˜é‡Œï¼Œå½“æœåŠ¡å™¨è¿›ç¨‹è¢«åœæ­¢æˆ–è€…é‡å¯çš„æ—¶å€™ï¼Œå†…å­˜é‡Œ çš„sessionä¹Ÿä¼šè¢«æ¸…ç©ºï¼Œå¦‚æœè®¾ç½®äº†sessionçš„æŒä¹…åŒ–ç‰¹æ€§ï¼ŒæœåŠ¡å™¨å°±ä¼šæŠŠsessionä¿å­˜åˆ°ç¡¬ç›˜ ä¸Šï¼Œå½“æœåŠ¡å™¨è¿›ç¨‹é‡æ–°å¯åŠ¨æˆ–è¿™äº›ä¿¡æ¯å°†èƒ½å¤Ÿè¢«å†æ¬¡ä½¿ç”¨ï¼ŒWeblogic Serveræ”¯æŒçš„æŒä¹…æ€§æ–¹ å¼åŒ…æ‹¬æ–‡ä»¶ã€æ•°æ®åº“ã€å®¢æˆ·ç«¯cookieä¿å­˜å’Œå¤åˆ¶ã€‚å¤åˆ¶ä¸¥æ ¼è¯´æ¥ä¸ç®—æŒä¹…åŒ–ä¿å­˜ï¼Œå› ä¸ºsessionå®é™…ä¸Šè¿˜æ˜¯ä¿å­˜åœ¨å†…å­˜é‡Œï¼Œä¸è¿‡åŒæ ·çš„ä¿¡æ¯ è¢«å¤åˆ¶åˆ°å„ä¸ªclusterå†…çš„æœåŠ¡å™¨è¿›ç¨‹ä¸­ï¼Œè¿™æ ·å³ä½¿æŸä¸ªæœåŠ¡å™¨è¿›ç¨‹åœæ­¢å·¥ä½œä¹Ÿä»ç„¶å¯ä»¥ä»å…¶ ä»–è¿›ç¨‹ä¸­å–å¾—sessionã€‚ 6ã€socketç¼–ç¨‹ä¸­ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯å»ºç«‹è¿æ¥éœ€è¦ç”¨åˆ°å“ªäº›å‡½æ•°å¹¶è§£é‡Šä¸€ä¸‹ä½œç”¨ã€‚ 7ã€socketè¿æ¥ä¸­shutdown()å’Œclose()æœ‰ä»€ä¹ˆåŒºåˆ«ã€‚ closeå…³é—­çš„æ˜¯åŒå‘çš„ï¼Œin outéƒ½å…³äº†~~ä½†æ˜¯æ˜¯å¼•ç”¨è®¡æ•°--ç›´åˆ°--åˆ°ä¸º0æ‰çœŸæ­£çš„å…³é—­~å› è€Œæ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚ shutdown æ˜¯å•å‘å…³é—­ï¼Œé€šè¿‡å‚æ•°æŒ‡å®šå…³é—­ä¸åŒçš„æ–¹å‘ï¼Œç›´æ¥å¼ºåˆ¶å…³é—­ï¼Œéçº¿ç¨‹å®‰å…¨ï¼› 8ã€å¤šçº¿ç¨‹å’Œå¤šè¿›ç¨‹çš„åŒºåˆ«å’Œè”ç³»ï¼Œå¤šè¿›ç¨‹è®¿é—®ä¸´ç•Œèµ„æºå¦‚ä½•å¤„ç†ã€‚ è¿›ç¨‹æ˜¯èµ„æºåˆ†é…çš„æœ€å°å•ä½ï¼Œçº¿ç¨‹æ˜¯CPUè°ƒåº¦çš„æœ€å°å•ä½ å¤šçº¿ç¨‹ä¹‹é—´å…±äº«åŒä¸€ ä¸ªè¿›ç¨‹çš„åœ°å€ç©ºé—´ï¼Œçº¿ç¨‹é—´é€šä¿¡ç®€å•ï¼ŒåŒæ­¥å¤æ‚ï¼Œçº¿ç¨‹åˆ›å»ºã€é”€æ¯å’Œåˆ‡æ¢ç®€å•ï¼Œé€Ÿåº¦å¿«ï¼Œå ç”¨å†…å­˜å°‘ï¼Œé€‚ç”¨äºå¤šæ ¸åˆ†å¸ƒå¼ç³»ç»Ÿï¼Œä½†æ˜¯çº¿ç¨‹é—´ä¼šç›¸äº’å½±å“ï¼Œä¸€ä¸ªçº¿ç¨‹æ„ å¤–ç»ˆæ­¢ä¼šå¯¼è‡´åŒä¸€ä¸ªè¿›ç¨‹çš„å…¶ä»–çº¿ç¨‹ä¹Ÿç»ˆæ­¢ï¼Œç¨‹åºå¯é æ€§å¼±ã€‚ å¤šè¿›ç¨‹é—´æ‹¥æœ‰å„è‡ª ç‹¬ç«‹çš„è¿è¡Œåœ°å€ç©ºé—´ï¼Œè¿›ç¨‹é—´ä¸ä¼šç›¸äº’å½±å“ï¼Œç¨‹åºå¯é æ€§å¼ºï¼Œä½†æ˜¯è¿›ç¨‹åˆ›å»ºã€é”€æ¯ å’Œåˆ‡æ¢å¤æ‚ï¼Œé€Ÿåº¦æ…¢ï¼Œå ç”¨å†…å­˜å¤šï¼Œè¿›ç¨‹é—´é€šä¿¡å¤æ‚ï¼Œä½†æ˜¯åŒæ­¥ç®€å•ï¼Œé€‚ç”¨äºå¤šæ ¸ ã€å¤šæœºåˆ†å¸ƒã€‚ 8ã€æ‰‹æ’•ç®—æ³•é¢˜ï¼Œè¾“å‡ºæŸäºŒå‰æ ‘ä¸­è·¯å¾„å’Œç­‰äºå®šå€¼nçš„æ‰€æœ‰è·¯å¾„ï¼Œè·¯å¾„ï¼šä»æ ¹èŠ‚ç‚¹åˆ°å¶ç»“ç‚¹æˆ–ä»å¶èŠ‚ç‚¹åˆ°å¶èŠ‚ç‚¹ æƒ³æ³•ï¼šå°†äºŒå‰æ ‘å»ºç«‹å­èŠ‚ç‚¹æŒ‡å‘çˆ¶èŠ‚ç‚¹çš„å¼•ç”¨ï¼ŒBFSéå†æŸå¶èŠ‚ç‚¹æˆ–rootç»“ç‚¹åˆ°å‰©ä¸‹ç»“ç‚¹çš„çš„è·¯å¾„ï¼Œå’Œä¸ºnåˆ™è¾“å‡ºã€‚ 9ã€æ‰‹æ’•ä»£ç ï¼Œç»™å‡ºäºŒå‰æ ‘ä¸­çš„ä¸¤ä¸ªç»“ç‚¹ï¼Œæ‰¾å‡ºå®ƒä»¬çš„æœ€ä½å…¬å…±çˆ¶èŠ‚ç‚¹ã€‚ BFSæˆ–DFSæ‰¾åˆ°æŒ‡ç‚¹ä¸¤ä¸ªç»“ç‚¹n1å’Œn2ï¼Œè®°å½•rootç»“ç‚¹åˆ°n1å’Œn2ç»“ç‚¹çš„è·¯å¾„ï¼Œæœ€åä¸€ä¸ªé‡å¤ç»“ç‚¹å³ä¸ºæœ€ä½å…¬å…±çˆ¶ç»“ç‚¹ã€‚ äºŒé¢ï¼š ä¸€é¢é¢ç»å†™åˆ°ä¸€åŠï¼Œç„¶åæ‰“ç”µè¯æ¥äº†äºŒé¢ï¼Œæ•ˆç‡æ˜¯çœŸçš„é«˜ã€‚äºŒé¢å°å“¥è¶…å¸…çš„ï¼Œæ€»å…±é¢äº†47åˆ†é’Ÿï¼Œå¤§å¤šæ—¶é—´éƒ½åœ¨æ’•ä»£ç ï¼Œæˆ–è€…åœ¨æ’•ä»£ç çš„è·¯ä¸Šã€‚ è‡ªæˆ‘ä»‹ç»ï¼Œç„¶åè®²3åˆ†é’Ÿé¡¹ç›®ï¼Œæ ¹æ®é¡¹ç›®æäº†ä¸€äº›å¯¹åº”çš„é—®é¢˜ï¼Œç„¶åå°±æ˜¯ä½ é—®æˆ‘ç­”ç¯èŠ‚ã€‚ 1ã€kafkaå½“åˆ†åŒºæ•°å¤§äºæ¶ˆè´¹è€…æ•°é‡çš„æ—¶å€™å¦‚ä½•æ¶ˆè´¹ï¼Œåè¿‡æ¥å‘¢ï¼Ÿ åˆ†åŒºæ•°&gt;æ¶ˆè´¹è€…æ•°ï¼šä¸€ä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹å›ºå®šè´Ÿè´£ä¸€ä¸ªæˆ–å¤šä¸ªåˆ†åŒºæ•°æ®ï¼› åˆ†åŒºæ•°&lt;æ¶ˆè´¹è€…æ•°ï¼šä¸€ä¸ªæ¶ˆè´¹è€…å›ºå®šæ¶ˆè´¹ä¸€ä¸ªåˆ†åŒºï¼Œå¤šä½™æ¶ˆè´¹è€…ç©ºé—²ã€‚ 2ã€kafkaå¦‚ä½•ä¿è¯å¤šåˆ†åŒºæ•°æ®çš„é¡ºåºæ€§ã€‚ é‡‡ç”¨é‡æ’åºã€é˜»å¡ã€å•åˆ†åŒºã€‚ 3ã€kakfaåœ¨æ¶ˆè´¹è€…ç«¯è°ƒè¯•è¿‡å“ªäº›å‚æ•°ï¼Œæœ‰ä»€ä¹ˆæ„ä¹‰ï¼›åœ¨ä½¿ç”¨pollæ‹‰å–æ¶ˆæ¯çš„æ—¶å€™æœ‰ä¸ªé™¤äº†æœ‰ä¸ªæ¯æ¬¡æ‹‰å–çš„æ•°æ®æ¡æ•°è®¾ç½®è¿˜æœ‰å“ªäº›å‚æ•°ã€‚ // åˆ›å»ºä¸€ä»½kafkaå‚æ•°map Map&lt;String, Object&gt; kafkaParams = new HashMap&lt;String, Object&gt;(); kafkaParams.put(&quot;bootstrap.servers&quot;, &quot;master:9092,slave1:9092,slave2:9092&quot;); kafkaParams.put(&quot;key.deserializer&quot;, StringDeserializer.class); kafkaParams.put(&quot;value.deserializer&quot;, ByteArrayDeserializer.class); kafkaParams.put(&quot;group.id&quot;, &quot;topic6-groud1&quot;); kafkaParams.put(&quot;auto.offset.reset&quot;, &quot;latest&quot;); kafkaParams.put(&quot;enable.auto.commit&quot;, true); Collection&lt;String&gt; topics = Arrays.asList(&quot;topic6&quot;); while (true) { ConsumerRecords&lt;String, byte[]&gt; records = consumer.poll(Duration.ofMillis(500)); for (ConsumerRecord&lt;String, byte[]&gt; record : records) { } } 4ã€ä»‹ç»ä¸€ä¸‹sparkæµå¼è®¡ç®—æ¡†æ¶ï¼ŒRDDå¼¹æ€§æ•°æ®é›†ä»¥åŠå¯¹å…¶çš„äº†è§£ã€‚ 5ã€hbaseä¼˜åŒ–ç­–ç•¥è°ƒè¿‡å“ªäº›å‚æ•°ã€‚ 6ã€å¤šçº¿ç¨‹ä¸å¤šè¿›ç¨‹çš„åŒºåˆ«ï¼ˆä¸¤é¢éƒ½é—®åˆ°è¿‡ï¼‰ï¼Œåœ¨çº¿ç¨‹å’Œè¿›ç¨‹åˆ‡æ¢æ—¶æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œå“ªä¸ªå¼€é”€å¤§ï¼Œä¸ºä»€ä¹ˆï¼Ÿ 7ã€æ’åºç®—æ³•ä¸­æœ‰å“ªäº›æ˜¯ç¨³å®šçš„ï¼Œå“ªäº›ä¸ç¨³å®š ç¨³å®šç®—æ³•ï¼šå†’æ³¡æ’åºã€æ’å…¥æ’åºã€å½’å¹¶æ’åºã€åŸºæ•°æ’åº ä¸ç¨³å®šç®—æ³•ï¼šé€‰æ‹©æ’åºã€å¿«é€Ÿæ’åºã€å¸Œå°”æ’åºã€å †æ’åº 8ã€linuxå‘½ä»¤ï¼ŒæŸ¥çœ‹å†…å­˜æƒ…å†µï¼Œå‰©ä½™ç£ç›˜ç©ºé—´ï¼Œç½‘ç»œçŠ¶æ€ topã€df -lhã€netstat 9ã€æ„é€ æœ€å°ç”Ÿæˆæ ‘Primç®—æ³•ï¼ˆä¸è®°å¾—ï¼‰ 10ã€è¿ªæ°æ–¯ç‰¹æ‹‰ç®—æ³•æ±‚æœ€çŸ­è·¯å¾„ï¼ˆè¿˜æ˜¯ä¸è®°å¾—ï¼Œé»˜é»˜å¿ƒç–¼ä¸€æ³¢è‡ªå·±ï¼‰ 11ã€æ‰‹æ’•ä¸€ä¸ªç®—æ³•é¢˜ æœ‰å¤šä¸ªæŸ±å­é åœ¨ä¸€èµ·ï¼ŒæŸ±å­å®½åº¦å›ºå®šä¸º1ï¼Œç»™å®šä¸€ä¸ªæ•°ç»„ï¼Œè¡¨ç¤ºæ¯ä¸ªæŸ±å­çš„é«˜åº¦ï¼Œé—®ä»æŸ±å­ä¸Šæ–¹æ³¼æ°´ï¼ŒæŸ±å­ä¸­æœ€å¤šèƒ½å®¹çº³å¤šå°‘æ°´ã€‚ç¤ºæ„å›¾å¦‚ä¸‹ é¦–å…ˆæƒ³åˆ°çš„æ˜¯è®¡ç®—æ¯ä¸ªæŸ±å­ç›¸é‚»çš„ä¸¤ä¸ªæŸ±å­è¾ƒä½çš„é‚£ä¸ªé«˜åº¦ï¼Œç„¶åç›¸åŠ ã€‚åœ¨å°å“¥çš„æé†’ä¸‹å‘ç°ï¼Œå½“å¦‚å›¾ä¸­ç¬¬7æ ¹å’Œç¬¬9æ ¹é…±ç´«çš„æ—¶å€™ä¸å¯¹ã€‚ ç„¶åæˆ‘åˆæƒ³äº†ä¸€ä¼šå„¿ï¼Œæå‡ºå¯¹æ¯ä¸ªæŸ±å­éå†ï¼Œæ‰¾åˆ°å…¶å·¦å³ä¸¤è¾¹çš„æœ€é«˜çš„é‚£ä¸ªæŸ±å­ï¼Œå–è¾ƒä½çš„é‚£ä¸ªç„¶åæ‰€æœ‰ç›¸åŠ ã€‚ç„¶åå°å“¥è¯´å¤æ‚åº¦å¤ªå¤§äº†ï¼Œæœ‰æ²¡æœ‰åŠæ³•åœ¨O(n)çš„å¤æ‚åº¦å†…æŠŠå·¦å³ä¸¤è¾¹çš„æœ€é«˜æŸ±å­ç®—å‡ºæ¥ã€‚ ç„¶åæˆ‘æƒ³äº†ä¼šå„¿ï¼Œé‡‡ç”¨éå†ä¸€æ¬¡ï¼Œæ¯æ¬¡ç”¨tempLå’ŒtempRè®°å½•å½“å‰æœ€å¤§å€¼ï¼Œæ”¾è¿›è¾…åŠ©æ•°ç»„é‡Œï¼Œç„¶åè®©æˆ‘ç”¨ä»£ç å†™ä¸€ä¸‹ã€‚ç„¶ååœ¨ä½œä¸šæœ¬ä¸Šæ’•äº†ä¸€ä¸‹ï¼š ç­”æ¡ˆè¿˜åœ¨æ‰‹æ‰“ä¸­ï¼Œå¾…ç»­ã€‚ã€‚ã€‚ ","link":"https://kily-007.github.io/post/é¢ç»-ç“œå­äºŒæ‰‹è½¦é¢ç»-å¤§æ•°æ®å²—/"},{"title":"é›†ç¾¤æ­å»ºè®°å½•","content":"2018/12/12æ•´ç† Centos7 jdk1.8.0 hadoop-2.8.4 zookeeper-3.5.4 hbase-2.0.1 flume1.8.0 spark-2.3.1-bin-hadoop2.7 scala-2.12.6 redis-4.0.11 æ ¡å‡†ç³»ç»Ÿæ—¶é—´ï¼šsudo /usr/sbin/ntpdate stdtime.gov.hk æ ¹æ®çŸ«æ­£è¿‡çš„ç³»ç»Ÿæ—¶é—´è®¾ç½®ç¡¬ä»¶æ—¶é’Ÿï¼šsudo hwclock -w ç›®å½• 1ã€å®‰è£…hadoop-2.8.4 1 2ã€é…ç½®zookeeper-3.5.4-beta 4 3ã€å®‰è£…hbase 5 4ã€hbaseå»ºåº“å»ºè¡¨ 7 5ã€å®‰è£…flume 8 6ã€å®‰è£…spark 9 7ã€å®‰è£…redis-4.0.11 10 8ã€kafkaé›†ç¾¤å®‰è£…é…ç½® 12 9ã€spark streaming æ¥æ”¶kafkaé€šé“æ•°æ®æµ 1ã€å®‰è£…hadoop-2.8.4 1ã€ä¿®æ”¹ä¸»æœºå æœºåä¿®æ”¹vim /etc/hostname æ˜ å°„ä¿®æ”¹vim /etc/hosts 192.168.1.100 master 192.168.1.101 slave1 192.168.1.102 slave2 æ£€æŸ¥æ˜¯å¦pingé€šï¼šping master â€“c 3 2ã€åˆ›å»ºhadoopç”¨æˆ·å’Œç”¨æˆ·ç»„ æ·»åŠ ç”¨æˆ·ï¼šuseradd hadoop å¯†ç ï¼špasswd hadoop å°†ç”¨æˆ·æ·»åŠ åˆ°ç»„ï¼šusermod â€“a â€“G hadoop hadoop æŸ¥è¯¢ç»“æœï¼šcat /etc/group è®¾ç½®ç®¡ç†å‘˜æƒé™ï¼švisudo ä¿®æ”¹æ–‡ä»¶å¦‚ä¸‹: root ALL=(ALL) ALL hadoop ALL=(ALL) ALL 2ã€è®¾ç½®SSHå…å¯†ç™»å½• ç”¨hadoopç”¨æˆ·ç™»å½• #æŸ¥çœ‹æ˜¯å¦å®‰è£…äº†sshæœåŠ¡ï¼šrpm â€“qa | grep ssh æŸ¥çœ‹sshæœåŠ¡æ˜¯å¦å¯åŠ¨ï¼šps -e | grep ssh æµ‹è¯•SSHæ˜¯å¦èƒ½ç”¨ï¼šssh ä¸»æœºå cd ~/.ssh/ åˆ›å»ºé’¥åŒ™ï¼šssh-keygen -t rsa å°†å…¬åŒ™åŠ å…¥keysä¸­ï¼šcat id_rsa.pub &gt;&gt; authorized_keys ä¿®æ”¹æ–‡ä»¶å¤¹æƒé™chmod 600 ./authorized_keys æŠŠnode1å’Œnode2çš„id_rsa.pubä¼ ç»™master: scp id_rsa.pub admin@master:~/.ssh/id_rsa.pub.slave1 åœ¨masterä¸Šç»¼åˆæ‰€æœ‰å…¬åŒ™ï¼š cat id_rsa.pub&gt;&gt;authorized_keys cat id_rsa.pub.slave1&gt;&gt;authorized_keys cat id_rsa.pub.slave2&gt;&gt;authorized_keys å°†masterä¸­çš„å…¬åŒ™authorized_keyså¤åˆ¶åˆ°node1å’Œnode2çš„.sshç›®å½•ä¸‹ scp authorized_keys admin@slave1:/home/admin/.ssh/authorized_keys scp authorized_keys admin@slave2:/home/admin/.ssh/authorized_keys ** æ’æ’­ï¼šä¿®æ”¹å±å¹•åˆ†è¾¨ç‡:** 1 æŸ¥çœ‹ç°æœ‰åˆ†è¾¨ç‡ xrandr 2 æ·»åŠ è‡ªå·±æƒ³è¦çš„åˆ†è¾¨ç‡ cvt 1600 900 3 å¢åŠ æ–°çš„åˆ†è¾¨ç‡ xrandr --newmode &quot;16000x900_60.00&quot; 106.50 1440 1528 1672 1904 900 903 909 934 -hsync +vsync --newmodeåé¢çš„å‚æ•°å°±æ˜¯ä½¿ç”¨cvtçš„è¿”å›å€¼Modelineåé¢çš„éƒ¨åˆ† 4.ä¸ºå½“å‰æ˜¾ç¤ºå¢åŠ è¿™ä¸ªåˆ†è¾¨ç‡ xrandr --addmode VGA-1 1440x900_60.00 5 è®¾ç½®åˆ†è¾¨ç‡ xrandr --output VGA-1 --mode 1600x900_60.00 3ã€å®‰è£…jdk æŸ¥çœ‹åŸè£…jdkï¼š rpm -qa | grep java å¸è½½åŸå…ˆçš„jdkï¼š sudo rpm -e --nodeps java-1.8.0-openjdk-1.8.0.181-7.b13.el7.x86_64 sudo rpm -e --nodeps java-1.8.0-openjdk-headless-1.8.0.181-7.b13.el7.x86_64 sudo rpm -e --nodeps java-1.7.0-openjdk-1.7.0.171-2.6.15.5.el7.x86_64 sudo rpm -e --nodeps java-1.7.0-openjdk-headless-1.7.0.191-2.6.15.5.el7.x86_64 sudo mkdir /usr/java è§£å‹åˆ°/sur/javaä¸­ï¼šsudo tar -zxvf ä¸‹è½½/jdk-8u172-linux-x64.tar.gz -C /usr/java/ é…ç½®æœ¬ç”¨æˆ·çš„ç¯å¢ƒå˜é‡ï¼šsudo vim /etc/profile export JAVA_HOME=/usr/java/jdk1.8.0 export CLASSPATH=.:JAVAHOME/lib/dt.jar:JAVA_HOME/lib/dt.jar:JAVAHâ€‹OME/lib/dt.jar:JAVA_HOME/lib/tools.jar export PATH=JAVAHOME/bin:JAVA_HOME/bin:JAVAHâ€‹OME/bin:PATH 4ã€ç”¨hadoopç”¨æˆ·è¿›å…¥å®‰è£…hadoop è§£å‹hadoopï¼štar -zxvf ä¸‹è½½/hadoop-2.8.4.tar.gz -C /home/admin/app/ sudo vim /home/admin/app/hadoop/etc/hadoop/hadoop-env.sh æ‰¾åˆ°JAVA_HOMEå˜é‡ï¼Œä¿®æ”¹æ­¤å˜é‡å¦‚ä¸‹ export JAVA_HOME=/usr/java/jdk1.8.0 èµ‹äºˆè¯»å†™æƒé™ï¼šsudo chmod 774 /home/admin/app/hadoop/etc/hadoop/ ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼švim /home/admin/app/hadoop/etc/hadoop/core-site.xml â‘ core-site.xml &lt;configuration&gt; &lt;property&gt; &lt;name&gt;hadoop.tmp.dir&lt;/name&gt; &lt;value&gt;file:/home/admin/app/hadoop/tmp&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;fs.defaultFS&lt;/name&gt; &lt;value&gt;hdfs://master:9000&lt;/value&gt; &lt;/property&gt; &lt;/configuration&gt; â‘¡hdfs-site.xml &lt;configuration&gt; &lt;property&gt; &lt;name&gt;dfs.replication&lt;/name&gt; &lt;value&gt;2&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;dfs.namenode.name.dir&lt;/name&gt; &lt;value&gt;file:/home/admin/app/hadoop/tmp/dfs/name&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;dfs.datanode.data.dir&lt;/name&gt; &lt;value&gt;file:/home/admin/app/hadoop/tmp/dfs/data&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;dfs.datanode.http.address&lt;/name&gt;&lt;!--hbaseè®¿é—®ip--&gt; &lt;value&gt;0.0.0.0:50075&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;dfs.replication.interval&lt;/name&gt;&lt;!--hadoopæ£€æŸ¥å¤‡ä»½çš„æ—¶é—´é—´éš”--&gt; &lt;value&gt;30&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;dfs.datanode.handler.count&lt;/name&gt;&lt;!--å¢åŠ datanodeçš„handleræ•°--&gt; &lt;value&gt;300&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;dfs.namenode.handler.count&lt;/name&gt;&lt;!--namenodeçš„handleræ•°--&gt; &lt;value&gt;300&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;dfs.datanode.max.xcievers&lt;/name&gt;&lt;!--datanodeçš„handleræ•°--&gt; &lt;value&gt;1024&lt;/value&gt; &lt;/property&gt; &lt;/configuration&gt; â‘¢mapred-site.xml &lt;configuration&gt; &lt;property&gt; &lt;name&gt;mapreduce.framework.name&lt;/name&gt; &lt;value&gt;yarn&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;mapreduce.jobhistory.address&lt;/name&gt; &lt;value&gt;master:10020&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;mapreduce.jobhistory.webapp.address&lt;/name&gt; &lt;value&gt;master:19888&lt;/value&gt; &lt;/property&gt; &lt;/configuration&gt; â‘£yarn-site.xml &lt;configuration&gt; &lt;property&gt; &lt;name&gt;yarn.resourcemanager.hostname&lt;/name&gt; &lt;value&gt;master&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;yarn.nodemanager.aux-services&lt;/name&gt; &lt;value&gt;mapreduce_shuffle&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;yarn.log-aggregation-enable&lt;/name&gt; &lt;value&gt;true&lt;/value&gt; &lt;/property&gt; &lt;/configuration&gt; â‘¤åœ¨masteræœºä¸Šåœ¨slavesä¸­å°†localhostæ”¹ä¸ºnode1å’Œnode2 ä¿®æ”¹hadoopå¯åŠ¨ä¸åœæ­¢pidæ–‡ä»¶ å°†hadoop/sbin/hadoop-daemon.shä¸­æ·»åŠ HADOOP_PID_DIR=/home/admin/app/hadoop/pids å°†hadoop/sbin/yarn-daemon.shä¸­æ·»åŠ TARN_PID_DIR=/home/admin/app/hadoop/pids â‘¥æ—¶é—´åŒæ­¥: åœ¨hadoop-env.shæ·»åŠ : export HADOOP_OPTS=&quot;HADOOPOPTSâˆ’Duser.timezone=GMT+08&quot;åœ¨yarnâˆ’env.shYARNOPTS=&quot;HADOOP_OPTS -Duser.timezone=GMT+08&quot; åœ¨yarn-env.sh YARN_OPTS=&quot;HADOOPOâ€‹PTSâˆ’Duser.timezone=GMT+08&quot;åœ¨yarnâˆ’env.shYARNOâ€‹PTS=&quot;YARN_OPTS -Duser.timezone=GMT+08&quot; â‘¦å‘é€åˆ°slave1,slave2 scp -r hadoop admin@slave1:/home/admin/app/ é¦–æ¬¡å¯åŠ¨æ ¼å¼åŒ–ï¼šhdfs namenode -format åœ¨æµè§ˆå™¨ä¸­ http://master:8088 master:50070 hadoopè¿›ç¨‹ï¼š master: NameNode,SecondaryNameNode,ResourceManager slave1:DataNode,NodeManager slave2:DataNode,NodeManager ##5ã€å„èŠ‚ç‚¹IPä¸åç§° 192.168.146.140 master 192.168.146.141 node1 192.168.146.142 node2 å…³é—­é˜²ç«å¢™ï¼šsystemctl stop firewalld æŸ¥çœ‹é˜²ç«å¢™çŠ¶æ€ï¼šfirewall-cmd --state 2ã€é…ç½®zookeeper-3.5.4-beta 1. è§£å‹ï¼šcd /home /ä¸‹è½½ tar -zxvf ä¸‹è½½/zookeeper-3.5.4-beta.tar.gz -C /home/admin/app 2. é…ç½®ç¯å¢ƒå˜é‡ï¼š vim /etc/profile source /etc/profile export ZOOKEEPER_HOME=/home/admin/app/zookeeper export PATH=PATH:PATH:PATH:ZOOKEEPER_HOME/bin:$ZOOKEEPER_HOME/conf 3. ä¿®æ”¹é…ç½®æ–‡ä»¶ cd /home/hadoop/zookeeper-3.5.4-beta/conf cp zoo_sample.cfg zoo.cfg vim zoo.cfg tickTime=5000 initLimit=10 syncLimit=5 dataDir=/home/hadoop/app/zookeeper/data clientPort=2181 dataLogDir=/home/hadoop/app/zookeeper/datalog server.1=master:2888:3888 server.2=node1:2888:3888 server.3=node2:2888:3888 åœ¨zookeeperæ–‡ä»¶å¤¹ä¸‹åˆ›å»ºdataå’Œdatalogæ–‡ä»¶å¤¹ï¼Œåœ¨dataæ–‡ä»¶å¤¹ä¸‹åˆ›å»ºä¸€ä¸ªæ–‡ä»¶myidï¼Œå†…å®¹ä¸ºæ•°å­—xï¼Œxä¸ºä¸Šé…ç½®ä¸­server.xä¸­çš„æ•°å­—ï¼š vim /home/hadoop//zookeeper-3.5.4-beta/data/myid 4. å¯åŠ¨zookeeperï¼šæ³¨æ„è¦æŒ‰ç…§myidå¤§å°é¡ºåºæ¥ä¾æ¬¡åœ¨ä¸»æœºä¸Šå¯åŠ¨: zkServer.sh start zkServer.sh restart zkServer.sh stop å¯åŠ¨zookeeper/bin/zkServer.sh start é‡å¯zookeeper/bin/zkServer.sh restart æŸ¥çœ‹çŠ¶æ€zookeeper/bin/zkServer.sh status ä¿®æ”¹æ–‡ä»¶å¤¹æƒé™ï¼šsudo chmod -R 777 zookeeper ä¿®æ”¹æ–‡ä»¶åŠå­æ–‡ä»¶æ‰€å±ç”¨æˆ·å’Œç”¨æˆ·ç»„ï¼šsudo chown -R hadoop:hadoop zookeeper å¯åŠ¨æˆåŠŸï¼šè¾“å…¥zkServer.sh statuså‘½ä»¤å¯ä»¥çœ‹åˆ°å¦‚ä¸‹ä¿¡æ¯åˆ™è¡¨ç¤ºå®‰è£…é…ç½®æˆåŠŸ Mode:follower(æˆ–è€…æ˜¯leader) zookeeperè¿›ç¨‹: master:QuorumPeerMain slave1:QuorumPeerMain slave2:QuorumPeerMain è¿æ¥å®¢æˆ·ç«¯:zkCli.sh -timeout 5000 -r -server master:2181 3ã€å®‰è£…hbase 1. è§£å‹ï¼šcd /ä¸‹è½½ tar -zxvf ä¸‹è½½/hbase-2.0.1-bin.tar.gz -C /home/admin/app 2. é…ç½®ç¯å¢ƒå˜é‡ï¼š vim /etc/profile source /etc/profile export HBASE_HOME=/home/admin/app/hbase export PATH=PATH:PATH:PATH:HBASE_HOME/bin 3. é…ç½®æ–‡ä»¶sudo gedit hbase/conf/hbase-env.sh hbase-env.sh export JAVA_HOME=/usr/java/jdk1.8.0 export HBASE_MANAGES_ZK=false hbase-site.xml &lt;configuration&gt; &lt;property&gt; &lt;name&gt;hbase.rootdir&lt;/name&gt; &lt;value&gt;hdfs://master:9000/hbase&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;hbase.cluster.distributed&lt;/name&gt; &lt;value&gt;true&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;hbase.zookeeper.quorum&lt;/name&gt; &lt;value&gt;master,slave1,slave2&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;hbase.master&lt;/name&gt; &lt;value&gt;master:60000&lt;/value&gt; &lt;/property&gt; &lt;/configuration&gt; regionservers slave1 slave2 å°†hbaseæ–‡ä»¶å‘é€åˆ°slave1å’Œslave2çš„ç›¸åº”ä½ç½®: scp -r hbase admin@slave1:/home/admin/app/ scp -r hbase admin@slave2:/home/admin/app/ 4. å¯åŠ¨hbase: start-hbase.sh å¯åŠ¨HBaseçš„shellå‘½ä»¤ï¼šhbase shell å…ˆå¯åŠ¨regionserverï¼Œåœ¨å¯åŠ¨HMaster åœ¨regionServerä¸Š./hbase-daemon.sh start regionserver åœ¨masterä¸Šæ‰§è¡Œï¼š./bin/hbase-daemon.sh start master 5. è®¿é—®webé¡µé¢:http://master:16010 6. è®¾ç½®å¤‡ç”¨hmaster: åœ¨hbase/confä¸‹æ–°å»ºæ–‡ä»¶backup-masters ,æ·»åŠ slave1ä½œä¸ºå¤‡ç”¨hmaster 7. hbaseå¯åŠ¨é”™:Causedby:java.lang.ClassNotFoundException:org.apache.htrace.SamplerBuilder è§£å†³åŠæ³•:cp $HBASE_HOME/lib/client-facing-thirdparty/htrace-core-3.1.0-incubating.jar $HBASE_HOME/lib/ hbaseè¿›ç¨‹ï¼š master: HMaster slave1:HRegionServer slave2:HRegionServer 4ã€hbaseå»ºåº“å»ºè¡¨ 1. å»ºè¡¨ å»ºè¡¨ï¼š create â€˜stuâ€™, â€˜informationâ€™ ,â€˜scoreâ€™ ç¦ç”¨è¡¨ï¼šdisable â€˜stuâ€™ åˆ é™¤è¡¨ï¼šï¼ˆåˆ é™¤ä¹‹å‰å¿…é¡»å…ˆç¦ç”¨ï¼‰ï¼šdrop 'stu' éªŒè¯è¡¨æ˜¯å¦è¢«åˆ é™¤: exists 'stu' æ¸…ç©ºè¡¨:truncate 'test' create 'test','ts',SPLITS=&gt;['0050','0100','0150','0200','0250','0300','0350','0400','0450','0500','0550','0600','0650','0700','0750','0800','0850','0900','0950','1000'] create 'test','ts',SPLITS=&gt;['10','20','30'] 2. å¢ æ’å€¼ï¼š put 'stu','row0','information:name','Chengang' put 'stu','row0','information:sex','man' put 'stu','row0','information:age','23' put 'stu','row0','score:math','99' put 'stu','row0','score:English','89' put 'stu','row0','score:hbase','100' 3. åˆ  åˆ é™¤ç‰¹å®šå•å…ƒæ ¼ï¼šdelete â€˜stuâ€™,â€™row2â€™,â€™score:hbaseâ€™ åˆ é™¤æ‰€æœ‰å•å…ƒæ ¼ï¼šdelete â€˜stuâ€™,â€™row2â€™ 4. æŸ¥ è¯»å–æŒ‡å®šè¡Œï¼šget â€™â€™,â€™row1â€™ è¯»å–æŒ‡å®šåˆ—ï¼šget 'stu','row1',{COLUMN=&gt;'information:name'} 5. æ”¹ æ›´æ–°ï¼šput 'stu','row2','score:English','99' 6. å¸¸ç”¨æŒ‡ä»¤ï¼š 1åˆ—å‡ºè¡¨ä¸­æ‰€æœ‰æ•°æ®ï¼šscan â€˜stuâ€™ 2è®¡ç®—è¡¨çš„è¡Œæ•°é‡ï¼šcount â€˜stuâ€™ 3ä¸ºç”¨æˆ·hadoopæˆäºˆç‰¹å®šçš„æƒé™:grant â€˜hadoopâ€™,â€™RXAâ€™ R - ä»£è¡¨è¯»å–æƒé™ W - ä»£è¡¨å†™æƒé™ X - ä»£è¡¨æ‰§è¡Œæƒé™ C - ä»£è¡¨åˆ›å»ºæƒé™ A - ä»£è¡¨ç®¡ç†æƒé™ 4æ’¤é”€ç”¨æˆ·hadoopè®¿é—®è¡¨(æ‰€æœ‰æƒé™)çš„æƒé™ï¼šrevoke â€˜hadoopâ€™ 5åˆ—å‡ºstuè¡¨çš„æ‰€æœ‰ç”¨æˆ·æƒé™: user_permission â€˜stuâ€™ 5. å®‰è£…flume 1. è§£å‹ å®‰è£… sudo tar -zxvf apache-flume-1.8.0-bin.tar.gz -C /home/hadoop 2. é…ç½®ç¯å¢ƒå˜é‡ sudo gedit /etc/profile source /etc/profile export FLUME_HOME=/home/hadoop/flume export FLUME_CONF=FLUMEHOME/confexportPATH=FLUME_HOME/conf export PATH=FLUMEHâ€‹OME/confexportPATH=PATH:$FLUME_HOME 3. é…ç½®flume-env.sh cd /home/hadoop/flume/conf sudo cp ./flume-env.sh.template ./flume-env.sh sudo gedit ./flume-env.sh export JAVA_HOME=/usr/java/jdk1.8.0 4. å†™hbase-sink-aysn.conf,ç”¨äºæ‰§è¡Œflumeå†™å…¥hbase gedit /home/hadoop/flume/conf/hbase-sink-aysn.conf å°†ä»¥ä¸‹å¤åˆ¶ï¼š # Name the components on this agent a1.sources = r1 a1.sinks = k1 a1.channels = c1 # Describe/configure the source a1.sources.r1.type = syslogtcp a1.sources.r1.bind = master a1.sources.r1.port = 44444 a1.sources.r1.eventSize = 1000 # Describe the sink a1.sinks.k1.type = asynchbase a1.sinks.k1.table = student a1.sinks.k1.columnFamily = information a1.sinks.k1.serializer.payloadColumn=id,name,age, a1.sinks.k1.batchSize = 10 a1.sinks.k1.serializer = org.apache.flume.sink.hbase.AsyncHbaseEventSerializer a1.channels.c1.type = memory a1.channels.c1.capacity = 1000 a1.channels.c1.transactionCapacity = 100 # Bind the source and sink to the channel a1.sources.r1.channels = c1 a1.sinks.k1.channel = c1 5. å¯åŠ¨flumeæœåŠ¡ flume-ng agent -c conf -f tcp_hbase.conf -n a1 -Dflume.root.logger=INFO,console --conf = conf æŸ¥çœ‹å†™å…¥çš„æ•°æ®æ–‡ä»¶hadoop fs -ls /flume æ‰“å¼€æ•°æ®æ–‡ä»¶hadoop fs -cat /flume/master.1531133606859 6. å®‰è£…spark å®‰è£…sparkä¹‹å‰éœ€è¦å…ˆå®‰è£…scala scalaå®‰è£… è§£å‹ åˆ°/home/hadoop/app : tar -zxvf scala-2.12.6.tgz -C /home/admin/appå°†scala-2.12.6é‡å‘½åä¸ºscala é…ç½®ç¯å¢ƒå˜é‡: export SCALA_HOME=/home/admin/app/scala export PATH=$PATH:$SCALA_HOME/bin æµ‹è¯•æ˜¯å¦å®‰è£…æˆåŠŸ:scala -version 2. å®‰è£…spark 1. è§£å‹ åˆ°/home/hadoop/app : tar -zxvf spark-2.3.1-bin-hadoop2.7.tgz -C /home/admin/app å°† spark-2.3.1-bin-hadoop2.7é‡å‘½åä¸ºspark 2. é…ç½®ç¯å¢ƒå˜é‡: export SPARK_HOME=/home/admin/app/spark export PATH=PATH:PATH:PATH:SPARK_HOME/sbin:$SPARK_HOME/bin 3. é…ç½®/spark/conf/spark-env.shæ–‡ä»¶ export JAVA_HOME=/usr/local/jdk1.8.0 export HADOOP_HOME=/home/hadoop/app/hadoop export SCALA_HOME=/home/hadoop/app/scala export HBASE_HOME=/home/hadoop/app/hbase export HADOOP_CONF_DIR=/home/hadoop/app/hadoop/etc/hadoop export SPARK_MASTER_HOST=master export SPARK_MASTER_PORT=7077 export SPARK_MASTER_WEBUI_PORT=7078 export SPARK_WORKER_MEMORY=30G export LD_LIBRARY_PATH=$HADOOP_HOME/lib/native 4. cp spark-env.sh.template spark-env.sh åŠ å…¥spark.master spark://master:8040 5. cp slaves.template slaves åŠ å…¥ master slave1 slave2 6. å¯åŠ¨sparké›†ç¾¤: start-all.sh stop-all.sh 7. sparkæäº¤ä»»åŠ¡ ./bin/spark-submit --class com.spark.kafkaConsumer.SparkFromKafka --master spark://master:7077 --executor-memory 8G --total-executor-cores 8 /home/hadoop/workspace/KafkaConsumer/target/KafkaConsumer-0.0.1-SNAPSHOT-jar-with-dependencies.jar spark-shell --master yarn nmap -p 7077 master_ip 7.å®‰è£…redis-4.0.11 192.168.1.100 7001 7004 192.168.1.101 7002 7005 192.168.1.102 7003 7006 1. è§£å‹ åˆ°/home/hadoop/app :tar -zxvf redis-4.0.11.tar.gz -C /home/admin/app é‡å‘½åä¸ºredis ç¼–è¯‘:make &amp;&amp; make install 2. é…ç½®redisé›†ç¾¤ï¼š åœ¨redis/ç›®å½•ä¸‹ï¼š mkdir -p redis-cluster/{7001,7004} cp redis.conf redis-cluster/7001/redis-7001.conf cp redis.conf redis-cluster/7004/redis-7004.conf ä¿®æ”¹ï¼š bind 192.168.1.100 port 7001 daemonize yes ï¼ˆredisåå°è¿è¡Œï¼‰ cluster-enabled yesï¼ˆå¯åŠ¨é›†ç¾¤æ¨¡å¼ï¼‰ appendonly yes (å¼€å¯è‡ªåŠ¨æŒä¹…åŒ–) dir /home/admin/app/redis/redis-cluster/7001/data (dataå­˜æ”¾ç›®å½•) logfile /home/admin/app/redis/redis-cluster/7001/log/redis-7001.log pidfile /var/run/redis_7001.pid ï¼ˆpid 7001å’Œportè¦å¯¹åº”ï¼‰ cluster-config-file nodes-7001.conf cluster-node-timeout 15000 3. æŒ‡å®šé…ç½®æ–‡ä»¶å¯åŠ¨: cd redis/src ./redis-server ../reids.conf 4.é›†ç¾¤æ­å»º æ¯å°æœºå­ä¸Šéƒ½æŒ‰ä¸Šè¿°æ­¥éª¤å®‰è£…redis 5. é…ç½®æ­¥éª¤å‚ç…§https://www.cnblogs.com/ding2016/p/7892542.html 6. åˆ é™¤æŸæ–‡ä»¶å¤¹ä¸‹æ‰€æœ‰æ–‡ä»¶: rm -r app/redis/redis-cluster/7002/data/* rm -r app/redis/redis-cluster/7002/log/* 7. å¯åŠ¨é›†ç¾¤: redis/ 8. å¯åŠ¨å…­ä¸ªèŠ‚ç‚¹çš„æœåŠ¡: master: src/redis-server redis-cluster/7001/redis-7001.conf app/redis/src/redis-server app/redis/redis-cluster/7004/redis-7004.conf slave1: app/redis/src/redis-server app/redis/redis-cluster/7002/redis-7002.conf app/redis/src/redis-server app/redis/redis-cluster/7005/redis-7005.conf slave2: app/redis/src/redis-server app/redis/redis-cluster/7003/redis-7003.conf app/redis/src/redis-server app/redis/redis-cluster/7006/redis-7006.conf 9. æŸ¥çœ‹æœåŠ¡æ˜¯å¦å¯åŠ¨: ps -ef | grep redis 10. è¿›å…¥redisç›®å½•å¯åŠ¨é›†ç¾¤ ; src/redis-trib.rb create --replicas 1 192.168.1.100:7001 192.168.1.101:7002 192.168.1.102:7003 192.168.1.100:7004 192.168.1.101:7005 192.168.1.102:7006 src/redis-trib.rb create --replicas 1 110.1.1.1:7001 110.1.1.101:7002 110.1.1.102:7003 110.1.1.1:7004 110.1.1.101:7005 110.1.1.102:7006 11. è¿›å…¥å®¢æˆ·ç«¯ ./src/redis-cli -c -h 192.168.1.100 -p 7001 æŸ¥çœ‹redisçš„å»¶è¿Ÿæ•°æ®: Redis-cli --latency -h 127.0.0.1 -p 6379 7.5é‡å¯åæŠ¥é”™:Node 192.168.1.101:7001 is not empty. Either the node already knows other no ps -ef | grep redis , kill æ‰6ä¸ªredisè¿›ç¨‹,åˆ é™¤reids/redis-cluster/7001/dataä¸­çš„æ‰€æœ‰æ–‡ä»¶ é‡æ–°å¯åŠ¨æ‰€æœ‰æœåŠ¡ æ–°å¢ç»“ç‚¹:src/redis-trib.rb add-node 192.168.1.100:7007 192.168.1.100:7001 12. å¸¸è§rediså‘½ä»¤ é›†ç¾¤ cluster info æ‰“å°é›†ç¾¤çš„ä¿¡æ¯ cluster nodes åˆ—å‡ºé›†ç¾¤å½“å‰å·²çŸ¥çš„æ‰€æœ‰èŠ‚ç‚¹ï¼ˆnodeï¼‰ï¼Œä»¥åŠè¿™äº›èŠ‚ç‚¹çš„ç›¸å…³ä¿¡æ¯ã€‚ èŠ‚ç‚¹ cluster meet å°†ipå’Œportæ‰€æŒ‡å®šçš„èŠ‚ç‚¹æ·»åŠ åˆ°é›†ç¾¤å½“ä¸­ï¼Œè®©å®ƒæˆä¸ºé›†ç¾¤çš„ä¸€ä»½å­ã€‚ cluster forget &lt;node_id&gt; ä»é›†ç¾¤ä¸­ç§»é™¤ node_id æŒ‡å®šçš„èŠ‚ç‚¹ã€‚ cluster replicate &lt;node_id&gt; å°†å½“å‰èŠ‚ç‚¹è®¾ç½®ä¸ºnode_idæŒ‡å®šçš„èŠ‚ç‚¹çš„ä»èŠ‚ç‚¹ã€‚ cluster saveconfig å°†èŠ‚ç‚¹çš„é…ç½®æ–‡ä»¶ä¿å­˜åˆ°ç¡¬ç›˜é‡Œé¢ã€‚ æ§½(slot) cluster addslots [slot ...] å°†ä¸€ä¸ªæˆ–å¤šä¸ªæ§½ï¼ˆslotï¼‰æŒ‡æ´¾ï¼ˆassignï¼‰ç»™å½“å‰èŠ‚ç‚¹ã€‚ cluster delslots [slot ...] ç§»é™¤ä¸€ä¸ªæˆ–å¤šä¸ªæ§½å¯¹å½“å‰èŠ‚ç‚¹çš„æŒ‡æ´¾ã€‚ cluster flushslots ç§»é™¤æŒ‡æ´¾ç»™å½“å‰èŠ‚ç‚¹çš„æ‰€æœ‰æ§½ï¼Œè®©å½“å‰èŠ‚ç‚¹å˜æˆä¸€ä¸ªæ²¡æœ‰æŒ‡æ´¾ä»»ä½•æ§½çš„èŠ‚ç‚¹ã€‚ cluster setslot node &lt;node_id&gt; å°†æ§½ slot æŒ‡æ´¾ç»™ node_id æŒ‡å®šçš„èŠ‚ç‚¹ï¼Œå¦‚æœæ§½å·²ç»æŒ‡æ´¾ç»™å¦ä¸€ä¸ªèŠ‚ç‚¹ï¼Œé‚£ä¹ˆå…ˆè®©å¦ä¸€ä¸ªèŠ‚ç‚¹åˆ é™¤è¯¥æ§½&gt;ï¼Œç„¶åå†è¿›è¡ŒæŒ‡æ´¾ã€‚ cluster setslot migrating &lt;node_id&gt; å°†æœ¬èŠ‚ç‚¹çš„æ§½ slot è¿ç§»åˆ° node_id æŒ‡å®šçš„èŠ‚ç‚¹ä¸­ã€‚ cluster setslot importing &lt;node_id&gt; ä» node_id æŒ‡å®šçš„èŠ‚ç‚¹ä¸­å¯¼å…¥æ§½ slot åˆ°æœ¬èŠ‚ç‚¹ã€‚ cluster setslot stable å–æ¶ˆå¯¹æ§½ slot çš„å¯¼å…¥ï¼ˆimportï¼‰æˆ–è€…è¿ç§»ï¼ˆmigrateï¼‰ã€‚ é”® cluster keyslot è®¡ç®—é”® key åº”è¯¥è¢«æ”¾ç½®åœ¨å“ªä¸ªæ§½ä¸Šã€‚ cluster countkeysinslot è¿”å›æ§½ slot ç›®å‰åŒ…å«çš„é”®å€¼å¯¹æ•°é‡ã€‚ cluster getkeysinslot è¿”å› count ä¸ª slot æ§½ä¸­çš„é”®ã€‚ 13. redisæ•°æ®å¤‡ä»½åŠå›å¤ dump.rdb æ–¹å¼ å®‰è£…æ•°æ®è§£æå·¥å…·æ‰§è¡Œå‘½ä»¤: easy_install pip install rdbtools å°†rdbæ–‡ä»¶è½¬ä¸ºjsonæ–‡ä»¶ rdb --command json redis-cluster/7001/data/dump.rdb&gt;redis-cluster/7001/data/dump.json 8 .kafkaé›†ç¾¤å®‰è£…é…ç½® â‘ è§£å‹åˆ°æŒ‡å®šæ–‡ä»¶å¤¹ tar -zxvf ä¸‹è½½/kafka_2.12-2.0.0.tgz -C /home/admin/app/ â‘¡ä¿®æ”¹é…ç½®æ–‡ä»¶ kafka/config/server.properties broker.id=0 listeners=PLAINTEXT://master:9092 advertised.listeners=PLAINTEXT://master:9092 log.dirs=/home/admin/app/kafka/kafka-logs zookeeper.connect=master:2181,slave1:2181,slave2:2181 â‘¢è®²kafkaæ–‡ä»¶å‘é€åˆ°slave1å’Œslave2 scp -r kafka admin@slave1:/home/admin/app/ scp -r kafka admin@slave2:/home/admin/app/ â‘£ä¿®æ”¹slave1ä¸­çš„é…ç½®æ–‡ä»¶kafka/config/server.properties broker.id=1 listeners=PLAINTEXT://slave1:9092 advertised.listeners=PLAINTEXT://slave1:9092 log.dirs=/home/hadoop/app/kafka/kafka-logs zookeeper.connect=master:2181,slave1:2181,slave2:2181 â‘¤ä¿®æ”¹slave2ä¸­çš„é…ç½®æ–‡ä»¶kafka/config/server.properties broker.id=2 listeners=PLAINTEXT://slave2: advertised.listeners=PLAINTEXT://slave2:9092 log.dirs=/home/hadoop/app/kafka/kafka-logs zookeeper.connect=master:2181,slave1:2181,slave2:2181 â‘¥æµ‹è¯• åœ¨æ¯ä¸ªèŠ‚ç‚¹å¯åŠ¨kafkaæœåŠ¡: bin/kafka-server-start.sh -daemon config/server.properties &amp; åå°å¯åŠ¨:bin/kafka-server-start.sh config/server.properties 1&gt;/dev/null 2&gt;&amp;1 &amp; 1åˆ›å»ºtopic: ./bin/kafka-topics.sh --create --zookeeper master:2181,slave1:2181,slave2:2181 --replication-factor 2 --partitions 1 --topic topic1 2ç”Ÿäº§è€…bin/kafka-console-producer.sh --broker-list slave1:9092 --topic topic6 3æ¶ˆè´¹è€…bin/kafka-console-consumer.sh --bootstrap-server master:9092 --topic topic6 â€“from-beginning 4æŸ¥çœ‹æ‰€æœ‰topic: ./bin/kafka-topics.sh --list --zookeeper master:2181 5æŸ¥çœ‹æŸtopicè¯¦ç»†ä¿¡æ¯: bin/kafka-topics.sh --describe --zookeeper master:2181 --topic topic1 6 æŸ¥çœ‹æ‰€æœ‰topicè¯¦ç»†ä¿¡æ¯: bin/kafka-topics.sh --describe --zookeeper master:2181 7åˆ é™¤topic :bin/kafka-topics.sh --delete --zookeeper master:2181 --topic topic1 8åœæ­¢kafkaæœåŠ¡:bin/kafka-server-stop.sh 9é”™è¯¯è®°å½•: kafkaè¿›ç¨‹å¯åŠ¨åä¸€ä¼šå„¿è‡ªåŠ¨æŒ‚æ‰,ä¿®æ”¹/kafka/kafka-logs/meta.propertiesä¸­çš„broker.idä¸server.propertiesä¸­çš„broker.idä¸€è‡´ 10é”™è¯¯è®°å½•: KafkaConsumer is not safe for multi-threaded access KafkaConsumeræ˜¯éçº¿ç¨‹å®‰å…¨çš„ç±»ï¼Œå½“ä½¿ç”¨å¤šä¸ªçº¿ç¨‹æ“ä½œåŒä¸€ä¸ªKafkaConsumerå¯¹è±¡æ—¶å°±ä¼šå¼•èµ·è¿™ä¸ªé”™è¯¯ã€‚ PartitionCountï¼šåˆ†åŒºä¸ªæ•° ??ReplicationFactorï¼šå‰¯æœ¬ä¸ªæ•° ??Partitionï¼šåˆ†åŒº ??Leaderï¼šè´Ÿè´£å¤„ç†æ¶ˆæ¯çš„è¯»å’Œå†™ï¼Œleaderæ˜¯ä»æ‰€æœ‰èŠ‚ç‚¹ä¸­éšæœºé€‰æ‹©çš„.å½“å‰partitionèµ·ä½œç”¨çš„breaker.id ??Replicas: åˆ—å‡ºäº†æ‰€æœ‰çš„å‰¯æœ¬èŠ‚ç‚¹ï¼Œä¸ç®¡èŠ‚ç‚¹æ˜¯å¦åœ¨æœåŠ¡ä¸­. ??Isrï¼šæ˜¯æ­£åœ¨æœåŠ¡ä¸­çš„èŠ‚ç‚¹. 9.spark streaming æ¥æ”¶kafkaé€šé“æ•°æ®æµ â‘¡é›†ç¾¤ ./bin/spark-submit --class edu.wuli.gqzx.kafkaConsumer.SparkFromKafka --master spark://master:7077 --executor-memory 8G --total-executor-cores 30 /home/admin/workspace/workspace2/KafkaConsumer/target/KafkaConsumer-0.0.1-SNAPSHOT-jar-with-dependencies.jar 10.sparkæ•°æ®å¤„ç†è®°å½• â‘ mapå‡½æ•°ä¸flatmapå‡½æ•° mapå‡½æ•°: é¡¾åæ€ä¹‰ï¼Œå°†ä¸€ä¸ªå‡½æ•°ä¼ å…¥mapä¸­ï¼Œç„¶ååˆ©ç”¨ä¼ å…¥çš„è¿™ä¸ªå‡½æ•°ï¼Œå°†é›†åˆä¸­çš„æ¯ä¸ªå…ƒç´ å¤„ç†ï¼Œå¹¶å°†å¤„ç†åçš„ç»“æœè¿”å›ã€‚ flatMapå‡½æ•°: flatMapä¸mapå”¯ä¸€ä¸ä¸€æ ·çš„åœ°æ–¹å°±æ˜¯ä¼ å…¥çš„å‡½æ•°åœ¨å¤„ç†å®Œåè¿”å›å€¼å¿…é¡»æ˜¯Listï¼Œå…¶å®è¿™ä¹Ÿä¸éš¾ç†è§£ï¼Œæ—¢ç„¶æ˜¯flatMapï¼Œé‚£é™¤äº†mapä»¥å¤–å¿…ç„¶è¿˜æœ‰flatçš„æ“ä½œï¼Œæ‰€ä»¥éœ€è¦è¿”å›å€¼æ˜¯Listæ‰èƒ½æ‰§è¡Œflatè¿™ä¸€æ­¥. 11.redisä¼˜åŒ–è®°å½• redis-7001.confæ–‡ä»¶: maxmemory 68719476736 #559 maxmemory-policy volatile-ttl #590 cluster-require-full-coverage no #905 1ï¼‰ åœ¨Redisé…ç½®æ–‡ä»¶ä¸­(ä¸€èˆ¬å«Redis.conf)ï¼Œé€šè¿‡è®¾ç½®â€œmaxmemoryâ€å±æ€§çš„å€¼å¯ä»¥é™åˆ¶Redisæœ€å¤§ä½¿ç”¨çš„å†…å­˜è‹¥æ˜¯å¯ç”¨äº†Rediså¿«ç…§åŠŸèƒ½ï¼Œåº”è¯¥è®¾ç½®â€œmaxmemoryâ€å€¼ä¸ºç³»ç»Ÿå¯ä½¿ç”¨å†…å­˜çš„45%ï¼Œå› ä¸ºå¿«ç…§æ—¶éœ€è¦ä¸€å€çš„å†…å­˜æ¥å¤åˆ¶æ•´ä¸ªæ•°æ®é›†ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœå½“å‰å·²ä½¿ç”¨45%ï¼Œåœ¨å¿«ç…§æœŸé—´ä¼šå˜æˆ95%(45%+45%+5%)ï¼Œå…¶ä¸­5%æ˜¯é¢„ç•™ç»™å…¶ä»–çš„å¼€é”€ã€‚ å¦‚æœæ²¡å¼€å¯å¿«ç…§åŠŸèƒ½ï¼Œmaxmemoryæœ€é«˜èƒ½è®¾ç½®ä¸ºç³»ç»Ÿå¯ç”¨å†…å­˜çš„95%ã€‚ 2) å½“å†…å­˜ä½¿ç”¨è¾¾åˆ°è®¾ç½®çš„æœ€å¤§é˜€å€¼æ—¶ï¼Œéœ€è¦é€‰æ‹©ä¸€ç§keyçš„å›æ”¶ç­–ç•¥ï¼Œå¯åœ¨Redis.confé…ç½®æ–‡ä»¶ä¸­ä¿®æ”¹â€œmaxmemory-policyâ€å±æ€§å€¼ã€‚ è‹¥æ˜¯Redisæ•°æ®é›†ä¸­çš„keyéƒ½è®¾ç½®äº†è¿‡æœŸæ—¶é—´ï¼Œé‚£ä¹ˆâ€œvolatile-ttlâ€ç­–ç•¥æ˜¯æ¯”è¾ƒå¥½çš„é€‰æ‹©ã€‚ä½†å¦‚æœkeyåœ¨è¾¾åˆ°æœ€å¤§å†…å­˜é™åˆ¶æ—¶æ²¡èƒ½å¤Ÿè¿…é€Ÿè¿‡æœŸï¼Œæˆ–è€…æ ¹æœ¬æ²¡æœ‰è®¾ç½®è¿‡æœŸæ—¶é—´ã€‚é‚£ä¹ˆè®¾ç½®ä¸ºâ€œallkeys-lruâ€å€¼æ¯”è¾ƒåˆé€‚ï¼Œå®ƒå…è®¸Redisä»æ•´ä¸ªæ•°æ®é›†ä¸­æŒ‘é€‰æœ€è¿‘æœ€å°‘ä½¿ç”¨çš„keyè¿›è¡Œåˆ é™¤(LRUæ·˜æ±°ç®—æ³•)ã€‚Redisè¿˜æä¾›äº†ä¸€äº›å…¶ä»–æ·˜æ±°ç­–ç•¥ï¼Œå¦‚ä¸‹ï¼š volatile-lruï¼šä½¿ç”¨LRUç®—æ³•ä»å·²è®¾ç½®è¿‡æœŸæ—¶é—´çš„æ•°æ®é›†åˆä¸­æ·˜æ±°æ•°æ®ã€‚ volatile-ttlï¼šä»å·²è®¾ç½®è¿‡æœŸæ—¶é—´çš„æ•°æ®é›†åˆä¸­æŒ‘é€‰å³å°†è¿‡æœŸçš„æ•°æ®æ·˜æ±°ã€‚ volatile-randomï¼šä»å·²è®¾ç½®è¿‡æœŸæ—¶é—´çš„æ•°æ®é›†åˆä¸­éšæœºæŒ‘é€‰æ•°æ®æ·˜æ±°ã€‚ allkeys-lruï¼šä½¿ç”¨LRUç®—æ³•ä»æ‰€æœ‰æ•°æ®é›†åˆä¸­æ·˜æ±°æ•°æ®ã€‚ allkeys-randomï¼šä»æ•°æ®é›†åˆä¸­ä»»æ„é€‰æ‹©æ•°æ®æ·˜æ±° no-envictionï¼šç¦æ­¢æ·˜æ±°æ•°æ®ã€‚ 3ï¼‰ æ§½æ˜¯å¦å…¨è¦†ç›–ï¼šcluster-require-full-coverage noã€‚é»˜è®¤æ˜¯yesï¼Œåªè¦æœ‰ç»“ç‚¹å®•æœºå¯¼è‡´16384ä¸ªæ§½æ²¡å…¨è¢«è¦†ç›–ï¼Œæ•´ä¸ªé›†ç¾¤å°±å…¨éƒ¨åœæ­¢æœåŠ¡ï¼Œæ‰€ä»¥ä¸€å®šè¦æ”¹ä¸ºno 4ï¼‰ list-compress-depth 0 è®¾ç½®: åˆ—è¡¨ä¹Ÿå¯èƒ½è¢«å‹ç¼© 0:ç¦ç”¨æ‰€æœ‰åˆ—è¡¨å‹ç¼©ã€‚ 1:depth 1çš„æ„æ€æ˜¯â€œåœ¨1ä¸ªèŠ‚ç‚¹è¿›å…¥åˆ—è¡¨åï¼Œä»å¤´éƒ¨æˆ–å°¾éƒ¨å¼€å§‹å‹ç¼©â€ So:[head]-&gt;node-&gt;node-&gt;...-&gt;node-&gt;[tail]ï¼Œ[head],[tail]å°†å§‹ç»ˆæœªå‹ç¼©ï¼›å†…éƒ¨èŠ‚ç‚¹å°†å‹ç¼©ã€‚ 2: [head]-&gt;[next]-&gt;node-&gt;node-&gt;...-&gt;node-&gt;[prev]-&gt;[tail] 2åœ¨è¿™é‡Œçš„æ„æ€æ˜¯:ä¸è¦å‹ç¼©headæˆ–head-&gt;nextæˆ–tail-&gt;prevæˆ–tailï¼Œè€Œæ˜¯å‹ç¼©å®ƒä»¬ä¹‹é—´çš„æ‰€æœ‰èŠ‚ç‚¹ã€‚ 3:[head]-&gt;[next]-&gt;[next]-&gt;node-&gt;node-&gt;...-&gt;node-&gt;[prev]-&gt;[prev]-&gt;[tail] 5) å†…æ ¸å‚æ•° overcommit_memory 1 æœ‰ä¸‰ç§æ–¹å¼ä¿®æ”¹å†…æ ¸å‚æ•°ï¼Œä½†è¦æœ‰rootæƒé™ï¼š ï¼ˆ1ï¼‰ç¼–è¾‘/etc/sysctl.conf ï¼Œæ”¹vm.overcommit_memory=1ï¼Œç„¶åsysctl -p ä½¿é…ç½®æ–‡ä»¶ç”Ÿæ•ˆ ï¼ˆ2ï¼‰sysctl vm.overcommit_memory=1 ï¼ˆ3ï¼‰echo 1 &gt; /proc/sys/vm/overcommit_memory å»ºè®®ä½¿ç”¨æ–¹æ³• 1 å®ƒæ˜¯ å†…å­˜åˆ†é…ç­–ç•¥ å¯é€‰å€¼ï¼š0ã€1ã€2ã€‚ 0ï¼Œ è¡¨ç¤ºå†…æ ¸å°†æ£€æŸ¥æ˜¯å¦æœ‰è¶³å¤Ÿçš„å¯ç”¨å†…å­˜ä¾›åº”ç”¨è¿›ç¨‹ä½¿ç”¨ï¼›å¦‚æœæœ‰è¶³å¤Ÿçš„å¯ç”¨å†…å­˜ï¼Œå†…å­˜ç”³è¯·å…è®¸ï¼›å¦åˆ™ï¼Œå†…å­˜ç”³è¯·å¤±è´¥ï¼Œå¹¶æŠŠé”™è¯¯è¿”å›ç»™åº”ç”¨è¿›ç¨‹ã€‚ 1ï¼Œ è¡¨ç¤ºå†…æ ¸å…è®¸åˆ†é…æ‰€æœ‰çš„ç‰©ç†å†…å­˜ï¼Œè€Œä¸ç®¡å½“å‰çš„å†…å­˜çŠ¶æ€å¦‚ä½•ã€‚ 2ï¼Œ è¡¨ç¤ºå†…æ ¸å…è®¸åˆ†é…è¶…è¿‡æ‰€æœ‰ç‰©ç†å†…å­˜å’Œäº¤æ¢ç©ºé—´æ€»å’Œçš„å†…å­˜ 12. hbaseä¼˜åŒ–è®°å½• putlistå¤§å° 2524288000/74176 2524288000/60608 hbase.ipc.server.callqueue.handler.factor æŒ‡å®šè°ƒç”¨é˜Ÿåˆ—çš„æ•°é‡ï¼š 0 æ„å‘³ç€å•ä¸ªå…±äº«é˜Ÿåˆ—ã€‚ 1 æ„å‘³ç€æ¯ä¸ªå¤„ç†ç¨‹åºçš„ä¸€ä¸ªé˜Ÿåˆ—ã€‚ ä¸€ä¸ª0å’Œ1ä¹‹é—´çš„å€¼ï¼ŒæŒ‰å¤„ç†ç¨‹åºçš„æ•°é‡æˆæ¯”ä¾‹åœ°åˆ†é…é˜Ÿåˆ—æ•°ã€‚ä¾‹å¦‚ï¼Œ0.5 çš„å€¼åœ¨æ¯ä¸ªå¤„ç†ç¨‹åºä¹‹é—´å…±äº«ä¸€ä¸ªé˜Ÿåˆ—ã€‚ 2)ä½¿ç”¨ hbase.ipc.server.callqueue.read.ratioï¼ˆhbase.ipc.server.callqueue.read.shareåœ¨0.98ä¸­ï¼‰å°†è°ƒç”¨é˜Ÿåˆ—åˆ†æˆè¯»å†™é˜Ÿåˆ—ï¼š 0.5 æ„å‘³ç€å°†æœ‰ç›¸åŒæ•°é‡çš„è¯»å†™é˜Ÿåˆ—ã€‚ &lt;0.5 è¡¨ç¤ºä¸ºè¯»å¤šäºå†™ã€‚ 0.5 è¡¨ç¤ºå†™å¤šäºè¯» 3)ç¦ç”¨ Nagle çš„ç®—æ³•ã€‚å»¶è¿Ÿçš„ ACKs å¯ä»¥å¢åŠ åˆ°200æ¯«ç§’çš„ RPC å¾€è¿”æ—¶é—´ã€‚è®¾ç½®ä»¥ä¸‹å‚æ•°ï¼š åœ¨ Hadoop çš„ core-site.xml ä¸­ï¼š ipc.server.tcpnodelay = true ipc.client.tcpnodelay = true åœ¨ HBase çš„ hbase-site.xml ä¸­ï¼š hbase.ipc.client.tcpnodelay = true hbase.ipc.server.tcpnodelay = true 13. æ“ä½œç³»ç»Ÿä¼˜åŒ– 1)ä¿®æ”¹linuxæ‰“å¼€æ–‡ä»¶æ•°å’Œè¿›ç¨‹æ•° sudo vim /etc/security/limits.conf åŠ å…¥: soft nofile 102400 hard nofile 409600 sudo vim /etc/security/limits.d/20-nproc.conf soft nproc 409600 hard nproc 819200 2ï¼‰ç¦ç”¨é€æ˜å¤§é¡µé¢å‹ç¼© rootç”¨æˆ·æ‰§è¡Œ echo never &gt; /sys/kernel/mm/transparent_hugepage/defrag å¼€æœºç¦ç”¨: sudo vim /etc/rc.local echo never &gt; /sys/kernel/mm/transparent_hugepage/defrag ","link":"https://kily-007.github.io/post/ç¬”è®°-é›†ç¾¤æ­å»ºè®°å½•/"},{"title":"ç¬”è®°-javaä¸­çš„é”","content":"ç¬”è®°-javaä¸­çš„é” javaå¯¹è±¡ javaå¯¹è±¡=å¯¹è±¡å¤´+å®ä¾‹æ•°æ®+å¯¹å…¶å¡«å…… javaå¯¹è±¡å¤´ å¯¹è±¡å¤´=MarkWord+class pointer+array length(è‹¥å¯¹è±¡ä¸ºæ•°ç»„) é”å­˜åœ¨Javaå¯¹è±¡å¤´é‡Œã€‚å¦‚æœå¯¹è±¡æ˜¯æ•°ç»„ç±»å‹ï¼Œåˆ™è™šæ‹Ÿæœºç”¨3ä¸ªWordï¼ˆå­—å®½ï¼‰å­˜å‚¨å¯¹è±¡å¤´ï¼Œå¦‚æœå¯¹è±¡æ˜¯éæ•°ç»„ç±»å‹ï¼Œåˆ™ç”¨2å­—å®½å­˜å‚¨å¯¹è±¡å¤´ã€‚åœ¨32ä½è™šæ‹Ÿæœºä¸­ï¼Œä¸€å­—å®½ç­‰äºå››å­—èŠ‚ï¼Œå³32bitã€‚ //æ™®é€šå¯¹è±¡ï¼š |-------------------------------- -------------------------| | Object Header (64 bits) | |--------------------------------|-------------------------| | Mark Word (32 bits) | Klass Word (32 bits) | |--------------------------------|-------------------------| //æ•°ç»„å¯¹è±¡ï¼š |---------------------------------------------------------------------------------| | Object Header (96 bits) | |--------------------------------|-----------------------|------------------------| | Mark Word(32bits) | Klass Word(32bits) | array length(32bits) | |--------------------------------|-----------------------|------------------------| å¯¹è±¡å¤´çš„ç»„æˆ Mark Word 32ä½JVMçš„Mark Wordé»˜è®¤å­˜å‚¨ç»“æ„å¦‚ä¸‹ class pointer è¿™ä¸€éƒ¨åˆ†ç”¨äºå­˜å‚¨å¯¹è±¡çš„ç±»å‹æŒ‡é’ˆï¼Œè¯¥æŒ‡é’ˆæŒ‡å‘å®ƒçš„ç±»å…ƒæ•°æ®ï¼ŒJVMé€šè¿‡è¿™ä¸ªæŒ‡é’ˆç¡®å®šå¯¹è±¡æ˜¯å“ªä¸ªç±»çš„å®ä¾‹ã€‚ array length å¦‚æœå¯¹è±¡æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œé‚£ä¹ˆå¯¹è±¡å¤´è¿˜éœ€è¦æœ‰é¢å¤–çš„ç©ºé—´ç”¨äºå­˜å‚¨æ•°ç»„çš„é•¿åº¦ã€‚ æ€»ç»“ é•¿åº¦ å†…å®¹ è¯´æ˜ 32/64bit Mark Word å­˜å‚¨å¯¹è±¡çš„hashCodeæˆ–é”ä¿¡æ¯ç­‰ 32/64bit Class Metadata Address å­˜å‚¨åˆ°å¯¹è±¡ç±»å‹æ•°æ®çš„æŒ‡é’ˆ 32/64bit Array length æ•°ç»„çš„é•¿åº¦ï¼ˆå¦‚æœå½“å‰å¯¹è±¡æ˜¯æ•°ç»„ï¼‰ è‡ªæ—‹é” è‡ªæ—‹é”åŸç†ï¼šå¦‚æœæŒæœ‰é”çš„çº¿ç¨‹èƒ½åœ¨å¾ˆçŸ­æ—¶é—´å†…é‡Šæ”¾é”èµ„æºï¼Œé‚£ä¹ˆé‚£äº›ç­‰å¾…ç«äº‰é”çš„çº¿ç¨‹å°±ä¸éœ€è¦åšå†…æ ¸æ€å’Œç”¨æˆ·æ€ä¹‹é—´çš„åˆ‡æ¢è¿›å…¥é˜»å¡æŒ‚èµ·çŠ¶æ€ï¼Œå®ƒä»¬åªéœ€è¦ç­‰ä¸€ç­‰ï¼ˆè‡ªæ—‹ï¼‰ï¼Œç­‰æŒæœ‰é”çš„çº¿ç¨‹é‡Šæ”¾é”åå³å¯ç«‹å³è·å–é”ï¼Œè¿™æ ·å°±é¿å…ç”¨æˆ·çº¿ç¨‹å’Œå†…æ ¸çš„åˆ‡æ¢çš„æ¶ˆè€—ã€‚ä½†æ˜¯çº¿ç¨‹è‡ªæ—‹æ˜¯éœ€è¦æ¶ˆè€—cupçš„ï¼Œè¯´ç™½äº†å°±æ˜¯è®©cupåœ¨åšæ— ç”¨åŠŸï¼Œçº¿ç¨‹ä¸èƒ½ä¸€ç›´å ç”¨cupè‡ªæ—‹åšæ— ç”¨åŠŸï¼Œæ‰€ä»¥éœ€è¦è®¾å®šä¸€ä¸ªè‡ªæ—‹ç­‰å¾…çš„æœ€å¤§æ—¶é—´ã€‚å¦‚æœæŒæœ‰é”çš„çº¿ç¨‹æ‰§è¡Œçš„æ—¶é—´è¶…è¿‡è‡ªæ—‹ç­‰å¾…çš„æœ€å¤§æ—¶é—´æ‰”æ²¡æœ‰é‡Šæ”¾é”ï¼Œå°±ä¼šå¯¼è‡´å…¶å®ƒäº‰ç”¨é”çš„çº¿ç¨‹åœ¨æœ€å¤§ç­‰å¾…æ—¶é—´å†…è¿˜æ˜¯è·å–ä¸åˆ°é”ï¼Œè¿™æ—¶äº‰ç”¨çº¿ç¨‹ä¼šåœæ­¢è‡ªæ—‹è¿›å…¥é˜»å¡çŠ¶æ€ã€‚ è‡ªé€‰æ—¶é—´é˜ˆå€¼ï¼šè‡ªæ—‹é”çš„ç›®çš„æ˜¯ä¸ºäº†å ç€CPUçš„èµ„æºä¸é‡Šæ”¾ï¼Œç­‰åˆ°è·å–åˆ°é”ç«‹å³è¿›è¡Œå¤„ç†ã€‚ä½†æ˜¯å¦‚ä½•å»é€‰æ‹©è‡ªæ—‹çš„æ‰§è¡Œæ—¶é—´å‘¢ï¼Ÿå¦‚æœè‡ªæ—‹æ‰§è¡Œæ—¶é—´å¤ªé•¿ï¼Œä¼šæœ‰å¤§é‡çš„çº¿ç¨‹å¤„äºè‡ªæ—‹çŠ¶æ€å ç”¨CPUèµ„æºï¼Œè¿›è€Œä¼šå½±å“æ•´ä½“ç³»ç»Ÿçš„æ€§èƒ½ã€‚å› æ­¤è‡ªæ—‹çš„å‘¨æœŸé€‰çš„é¢å¤–é‡è¦ï¼ JVMå¯¹äºè‡ªæ—‹å‘¨æœŸçš„é€‰æ‹©ï¼Œjdk1.5è¿™ä¸ªé™åº¦æ˜¯ä¸€å®šçš„å†™æ­»çš„ï¼Œåœ¨1.6å¼•å…¥äº†é€‚åº”æ€§è‡ªæ—‹é”ï¼Œé€‚åº”æ€§è‡ªæ—‹é”æ„å‘³ç€è‡ªæ—‹çš„æ—¶é—´ä¸åœ¨æ˜¯å›ºå®šçš„äº†ï¼Œè€Œæ˜¯ç”±å‰ä¸€æ¬¡åœ¨åŒä¸€ä¸ªé”ä¸Šçš„è‡ªæ—‹æ—¶é—´ä»¥åŠé”çš„æ‹¥æœ‰è€…çš„çŠ¶æ€æ¥å†³å®šï¼ŒåŸºæœ¬è®¤ä¸ºä¸€ä¸ªçº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢çš„æ—¶é—´æ˜¯æœ€ä½³çš„ä¸€ä¸ªæ—¶é—´ï¼ŒåŒæ—¶JVMè¿˜é’ˆå¯¹å½“å‰CPUçš„è´Ÿè·æƒ…å†µåšäº†è¾ƒå¤šçš„ä¼˜åŒ– å¦‚æœå¹³å‡è´Ÿè½½å°äºCPUsåˆ™ä¸€ç›´è‡ªæ—‹ å¦‚æœæœ‰è¶…è¿‡(CPUs/2)ä¸ªçº¿ç¨‹æ­£åœ¨è‡ªæ—‹ï¼Œåˆ™åæ¥çº¿ç¨‹ç›´æ¥é˜»å¡ å¦‚æœæ­£åœ¨è‡ªæ—‹çš„çº¿ç¨‹å‘ç°Ownerå‘ç”Ÿäº†å˜åŒ–åˆ™å»¶è¿Ÿè‡ªæ—‹æ—¶é—´ï¼ˆè‡ªæ—‹è®¡æ•°ï¼‰æˆ–è¿›å…¥é˜»å¡ å¦‚æœCPUå¤„äºèŠ‚ç”µæ¨¡å¼åˆ™åœæ­¢è‡ªæ—‹ è‡ªæ—‹æ—¶é—´çš„æœ€åæƒ…å†µæ˜¯CPUçš„å­˜å‚¨å»¶è¿Ÿï¼ˆCPU Aå­˜å‚¨äº†ä¸€ä¸ªæ•°æ®ï¼Œåˆ°CPU Bå¾—çŸ¥è¿™ä¸ªæ•°æ®ç›´æ¥çš„æ—¶é—´å·®ï¼‰ è‡ªæ—‹æ—¶ä¼šé€‚å½“æ”¾å¼ƒçº¿ç¨‹ä¼˜å…ˆçº§ä¹‹é—´çš„å·®å¼‚ åå‘é” åå‘é”:ç®€å•æ¥è¯´å°±æ˜¯ä¸€æ®µåŒæ­¥ä»£ç å—ä¸€ç›´è¢«ä¸€ä¸ªçº¿ç¨‹æ‰€è®¿é—®ï¼Œé‚£ä¹ˆè¯¥çº¿ç¨‹å°±ä¼šè‡ªåŠ¨è·å–é”ï¼Œé™ä½è·å–é”çš„ä»£ä»·ã€‚ å®ƒä¼šåå‘æœ€å…ˆè·å¾—å®ƒçš„çº¿ç¨‹ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹è®¿é—®åŒæ­¥ä»£ç å—è·å¾—é”æ—¶ï¼Œä¼šåœ¨å¯¹è±¡å¤´å’Œæ ˆå¸§è®°å½•é‡Œå­˜å‚¨é”åå‘çš„çº¿ç¨‹IDï¼Œå½“è¿™ä¸ªçº¿ç¨‹å†æ¬¡è¿›å…¥åŒæ­¥ä»£ç å—æ—¶ï¼Œå°±ä¸éœ€è¦CASæ“ä½œæ¥åŠ é”äº†ï¼Œåªè¦æµ‹è¯•ä¸€ä¸‹å¯¹è±¡å¤´é‡Œæ˜¯å¦å­˜å‚¨ç€æŒ‡å‘å½“å‰çº¿ç¨‹çš„åå‘é”ã€‚å¦‚æœæµ‹è¯•æˆåŠŸï¼Œåˆ™è¡¨æ˜è¯¥çº¿ç¨‹å·²ç»è·å¾—äº†é”ï¼Œå¦‚æœå¤±è´¥ï¼Œåˆ™å‡äº§åå‘é”çš„æ ‡ç¤ºæ˜¯å¦è®¾ä¸º1ï¼Œä¹Ÿå°±æ˜¯å½“å‰æ˜¯å¦æ˜¯åå‘é”ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™å°è¯•ç”¨CASæ“ä½œå°†å¯¹è±¡å¤´çš„åå‘é”æŒ‡å‘å½“å‰çº¿ç¨‹ï¼Œå¦‚æœä¸æ˜¯ï¼Œåˆ™ç”¨CASç«äº‰é”ã€‚ æ’¤é”€: å½“æœ‰å…¶ä»–çº¿ç¨‹ç«äº‰åå‘é”çš„æ—¶å€™ï¼ŒæŒæœ‰åå‘é”çš„çº¿ç¨‹æ‰ä¼šé‡Šæ”¾é”ã€‚å½“å‰æŒæœ‰åå‘é”çš„çº¿ç¨‹å¦‚æœå¤„äºä¸æ´»åŠ¨çš„çŠ¶æ€ï¼Œåˆ™ç›´æ¥å°†å¯¹è±¡å¤´è®¾ç½®ä¸ºæ— é”çŠ¶æ€ï¼›å¦‚æœçº¿ç¨‹ä»ç„¶æ´»åŠ¨ï¼Œæ‹¥æœ‰åå‘é”çš„æ ˆä¼šè¢«æ‰§è¡Œï¼Œç„¶åå°†é”åå‘äºå…¶ä»–çº¿ç¨‹ï¼Œæˆ–è€…æ¢å¤åˆ°æ— é”çŠ¶æ€ã€‚ åœ¨æ²¡æœ‰å®é™…ç«äº‰çš„æƒ…å†µä¸‹ï¼Œè¿˜èƒ½å¤Ÿé’ˆå¯¹éƒ¨åˆ†åœºæ™¯ç»§ç»­ä¼˜åŒ–ã€‚å¦‚æœä¸ä»…ä»…æ²¡æœ‰å®é™…ç«äº‰ï¼Œè‡ªå§‹è‡³ç»ˆï¼Œä½¿ç”¨é”çš„çº¿ç¨‹éƒ½åªæœ‰ä¸€ä¸ªï¼Œé‚£ä¹ˆï¼Œç»´æŠ¤è½»é‡çº§é”éƒ½æ˜¯æµªè´¹çš„ã€‚åå‘é”çš„ç›®æ ‡æ˜¯ï¼Œå‡å°‘æ— ç«äº‰ä¸”åªæœ‰ä¸€ä¸ªçº¿ç¨‹ä½¿ç”¨é”çš„æƒ…å†µä¸‹ï¼Œä½¿ç”¨è½»é‡çº§é”äº§ç”Ÿçš„æ€§èƒ½æ¶ˆè€—ã€‚è½»é‡çº§é”æ¯æ¬¡ç”³è¯·ã€é‡Šæ”¾é”éƒ½è‡³å°‘éœ€è¦ä¸€æ¬¡CASï¼Œä½†åå‘é”åªæœ‰åˆå§‹åŒ–æ—¶éœ€è¦ä¸€æ¬¡CASã€‚ è½»é‡çº§é” è½»é‡çº§é”æ˜¯ç”±åå‘æ‰€å‡çº§æ¥çš„ï¼Œåå‘é”è¿è¡Œåœ¨ä¸€ä¸ªçº¿ç¨‹è¿›å…¥åŒæ­¥å—çš„æƒ…å†µä¸‹ï¼Œå½“ç¬¬äºŒä¸ªçº¿ç¨‹åŠ å…¥é”äº‰ç”¨çš„æ—¶å€™ï¼Œåå‘é”å°±ä¼šå‡çº§ä¸ºè½»é‡çº§é”ã€‚å…¶å®ƒçº¿ç¨‹ä¼šé€šè¿‡è‡ªé€‰çš„å½¢å¼å°è¯•è·å–é”ï¼Œä¸ä¼šé˜»å¡ï¼Œæé«˜æ€§èƒ½ã€‚ **ä¼˜ç‚¹ï¼š**è½»é‡çº§é”å°½å¯èƒ½çš„å‡å°‘çº¿ç¨‹çš„é˜»å¡ï¼Œè¿™å¯¹äºé”çš„ç«äº‰ä¸æ¿€çƒˆï¼Œä¸”å ç”¨é”æ—¶é—´éå¸¸çŸ­çš„ä»£ç å—æ¥è¯´æ€§èƒ½èƒ½å¤§å¹…åº¦çš„æå‡ï¼Œå› ä¸ºè‡ªæ—‹çš„æ¶ˆè€—ä¼šå°äºçº¿ç¨‹é˜»å¡æŒ‚èµ·å†å”¤é†’çš„æ“ä½œçš„æ¶ˆè€—ï¼Œè¿™äº›æ“ä½œä¼šå¯¼è‡´çº¿ç¨‹å‘ç”Ÿä¸¤æ¬¡ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼ **ç¼ºç‚¹ï¼š**ä½†æ˜¯å¦‚æœé”çš„ç«äº‰æ¿€çƒˆï¼Œæˆ–è€…æŒæœ‰é”çš„çº¿ç¨‹éœ€è¦é•¿æ—¶é—´å ç”¨é”æ‰§è¡ŒåŒæ­¥å—ï¼Œè¿™æ—¶å€™å°±ä¸é€‚åˆä½¿ç”¨è½»é‡çº§é”äº†ï¼Œå› ä¸ºè½»é‡çº§é”åœ¨è·å–é”å‰ä¸€ç›´éƒ½æ˜¯å ç”¨cpuåšæ— ç”¨åŠŸï¼ŒåŒæ—¶æœ‰å¤§é‡çº¿ç¨‹åœ¨ç«äº‰ä¸€ä¸ªé”ï¼Œä¼šå¯¼è‡´è·å–é”çš„æ—¶é—´å¾ˆé•¿ï¼Œçº¿ç¨‹è‡ªæ—‹çš„æ¶ˆè€—å¤§äºçº¿ç¨‹é˜»å¡æŒ‚èµ·æ“ä½œçš„æ¶ˆè€—ï¼Œå…¶å®ƒéœ€è¦cupçš„çº¿ç¨‹åˆä¸èƒ½è·å–åˆ°cpuï¼Œé€ æˆcpuçš„æµªè´¹ã€‚æ‰€ä»¥è¿™ç§æƒ…å†µä¸‹æˆ‘ä»¬è¦å…³é—­è½»é‡çº§é”ï¼› é‡é‡çº§é” é‡é‡çº§é”æ˜¯æŒ‡å½“é”ä¸ºè½»é‡çº§é”æ—¶ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹è™½æ˜¯è‡ªæ—‹ï¼Œè‡ªæ—‹ä¸€å®šçš„æ¬¡æ•°ä»»ç„¶æœªè·å¾—é”å°±ä¼šè¿›å…¥é˜»å¡ï¼Œè¯¥é”è†¨èƒ€ä¸ºé‡é‡çº§é”ã€‚é‡é‡çº§é”ä¼šè®©å…¶å®ƒçº¿ç¨‹é˜»å¡ï¼Œé™ä½æ€§èƒ½ã€‚ ","link":"https://kily-007.github.io/post/ç¬”è®°-javaä¸­çš„é”/"},{"title":"æ‹¼å¤šå¤šäºŒé¢","content":"æ‹¼å¤šå¤šå¤§æ•°æ®å²—äºŒé¢ 2019.8.19 åˆšä»åŒ—äº¬è´å£³ä¸€è½®æ¸¸å›æ¥ï¼Œæ™šä¸Šå°±æ¥äº†æ‹¼å¤šå¤šäºŒé¢é€šçŸ¥ï¼Œæˆ‘æŠŠæ—¶é—´è®°æˆäº†8.20å·ï¼Œæ‰€ä»¥çŒä¸åŠé˜²å€Ÿäº†ç”µè„‘å»é¢è¯•ï¼Œé¢è¯•å®˜æ˜¯ä¸ªæ¯”è¾ƒå¹´è½»çš„ç”·å­©å­ï¼Œé¢è¯•æ˜¯åŠ äº†å¾®ä¿¡ï¼Œä½¿ç”¨å¾®ä¿¡è§†é¢‘é¢å¾—ã€‚ é¦–å…ˆä¸Šæ¥è‡ªæˆ‘ä»‹ç»ï¼Œæˆ‘å¤§æ¦‚è®²äº†ä¸€ä¸‹æœ€è¿‘åšçš„åœ°é“è½¨é“ç›‘æµ‹é¡¹ç›®ï¼Œç„¶åé’ˆå¯¹æˆ‘å°†çš„è·Ÿæˆ‘æé—®ï¼Œå¤§æ¦‚è®²äº†äºŒååˆ†é’Ÿå·¦å³ï¼Œç„¶åæé—®åŠ åœ¨çº¿å†™ä»£ç  mysqlæ•°æ®åº“ç´¢å¼•ä¸­çš„æœ€å·¦å‰ç¼€åŸåˆ™ï¼› balabaã€‚ã€‚ã€‚è®°ä¸èµ·æ¥äº†éƒ½ï¼Œä»¥åä¸€å®šé¢å®Œå°±å†™é¢ç»å‘œå‘œå‘œã€‚ã€‚ã€‚ ç»™ç½‘å€åœ¨çº¿å†™ä»£ç ï¼šå»ºç«‹äºŒå‰æœç´¢æ ‘ï¼› æœ‰ä»€ä¹ˆè¦é—®çš„ï¼Œæ‹¼å¤šå¤šå¤§æ•°æ®å²—åˆ†å“ªäº›æ–¹å‘ï¼Œä¸»è¦åšäº›ä»€ä¹ˆã€‚ ","link":"https://kily-007.github.io/post/é¢ç»-æ‹¼å¤šå¤šäºŒé¢/"},{"title":"MarkDownæ•™ç¨‹","content":"1ã€æ ‡é¢˜ # ä¸€çº§æ ‡é¢˜ ## äºŒçº§æ ‡é¢˜ ### ä¸‰çº§æ ‡é¢˜ #### å››çº§æ ‡é¢˜ ##### äº”çº§æ ‡é¢˜ ###### å…­çº§æ ‡é¢˜ 2ã€æ®µè½ &lt;br/&gt;äººå·¥æ¢è¡Œ 3ã€å­—ä½“ *æ–œä½“* **ç²—ä½“** ***ç²—æ–œä½“*** 4ã€åˆ†å‰²çº¿ *** --- 5ã€åˆ é™¤çº¿ ~åˆ’æ‰æ–‡å­—~ 6ã€ä¸‹åˆ’çº¿ &lt;u&gt;ä¸‹åˆ’çº¿&lt;u&gt; 7ã€æ— åºåˆ—è¡¨ *ç¬¬ä¸€é¡¹ +ç¬¬ä¸€é¡¹ -ç¬¬ä¸€é¡¹ *ç¬¬äºŒé¡¹ +ç¬¬äºŒé¡¹ -ç¬¬äºŒé¡¹ *ç¬¬ä¸‰é¡¹ +ç¬¬ä¸‰é¡¹ -ç¬¬ä¸‰é¡¹ 8ã€æœ‰åºåˆ—è¡¨ 1.ç¬¬ä¸€é¡¹ 2.ç¬¬äºŒé¡¹ 9ã€åŒºå— &gt;æœ€å¤–å±‚ &gt;&gt;ç¬¬ä¸€å±‚åµŒå¥— &gt;&gt;&gt;ç¬¬äºŒå±‚åµŒå¥— 10ã€é“¾æ¥åœ°å€ &lt;https://www.baidu.com&gt; [1]:https://www.baidu.com 11ã€![å±æ€§æ–‡æœ¬](å›¾ç‰‡åœ°å€) 12ã€è¡¨æ ¼ | è¡¨å¤´ | è¡¨å¤´ | | ---- | ---- | | å•å…ƒæ ¼ | å•å…ƒæ ¼ | | å•å…ƒæ ¼ | å•å…ƒæ ¼ | 13ã€æ·»åŠ å›¾ç‰‡ ![]() ","link":"https://kily-007.github.io/post/ç¬”è®°-MarkDownæ•™ç¨‹/"},{"title":"ç¬”è®°-MySql","content":"MySqlä¸­å¸¸ç”¨ä¿©ç§å¼•æ“ MyISAM (Indexed Sequential Access Methodæœ‰ç´¢å¼•çš„é¡ºåºè®¿é—®æ–¹æ³•) ä¸æ”¯æŒäº‹åŠ¡ï¼Œä½†æ˜¯æ¯æ¬¡æŸ¥è¯¢éƒ½æ˜¯åŸå­çš„ æ”¯æŒè¡¨çº§é”ï¼Œå³æ¯æ¬¡æ“ä½œæ˜¯å¯¹æ•´ä¸ªè¡¨åŠ é”ï¼› å­˜å‚¨è¡¨çš„æ€»è¡Œæ•°ï¼› ä¸€ä¸ªMYISAMè¡¨æœ‰ä¸‰ä¸ªæ–‡ä»¶ï¼šç´¢å¼•æ–‡ä»¶ã€è¡¨ç»“æ„æ–‡ä»¶ã€æ•°æ®æ–‡ä»¶ï¼› é‡‡ç”¨éèšé›†ç´¢å¼•ï¼Œç´¢å¼•æ–‡ä»¶çš„æ•°æ®åŸŸå­˜å‚¨æŒ‡å‘æ•°æ®æ–‡ä»¶çš„æŒ‡é’ˆã€‚è¾…ç´¢å¼•ä¸ä¸»ç´¢å¼•åŸºæœ¬ ä¸€è‡´ï¼Œä½†æ˜¯è¾…ç´¢å¼•ä¸ç”¨ä¿è¯å”¯ä¸€æ€§ã€‚ InnoDB æ”¯æŒACIDçš„äº‹åŠ¡ï¼Œæ”¯æŒäº‹åŠ¡çš„å››ç§éš”ç¦»çº§åˆ«ï¼› æ”¯æŒè¡Œçº§é”åŠå¤–é”®çº¦æŸï¼Œå› æ­¤å¯ä»¥æ”¯æŒå†™å¹¶å‘ï¼› ä¸å­˜å‚¨æ€»è¡Œæ•°ï¼› ä¸€ä¸ªInnoDbå¼•æ“å­˜å‚¨åœ¨ä¸€ä¸ªæ–‡ä»¶ç©ºé—´ï¼ˆå…±äº«è¡¨ç©ºé—´ï¼Œè¡¨å¤§å°ä¸å—æ“ä½œç³»ç»Ÿæ§åˆ¶ï¼Œä¸€ä¸ª è¡¨å¯èƒ½åˆ†å¸ƒåœ¨å¤šä¸ªæ–‡ä»¶é‡Œï¼‰ï¼Œä¹Ÿæœ‰å¯èƒ½ä¸ºå¤šä¸ªï¼ˆè®¾ç½®ä¸ºç‹¬ç«‹è¡¨ç©ºï¼Œè¡¨å¤§å°å—æ“ä½œç³»ç»Ÿ æ–‡ä»¶å¤§å°é™åˆ¶ï¼Œä¸€èˆ¬ä¸º2Gï¼‰ï¼Œå—æ“ä½œç³»ç»Ÿæ–‡ä»¶å¤§å°çš„é™åˆ¶ï¼› ä¸»é”®ç´¢å¼•é‡‡ç”¨èšé›†ç´¢å¼•ï¼ˆç´¢å¼•çš„æ•°æ®åŸŸå­˜å‚¨æ•°æ®æ–‡ä»¶æœ¬èº«ï¼‰ï¼Œè¾…ç´¢å¼•çš„æ•°æ®åŸŸå­˜å‚¨ä¸»é”®çš„å€¼ï¼›å› æ­¤ä»è¾…ç´¢å¼•æŸ¥æ‰¾æ•°æ®ï¼Œéœ€è¦å…ˆé€šè¿‡è¾…ç´¢å¼•æ‰¾åˆ°ä¸»é”®å€¼ï¼Œå†è®¿é—®è¾…ç´¢å¼•ï¼›æœ€å¥½ä½¿ç”¨è‡ªå¢ä¸»é”®ï¼Œé˜²æ­¢æ’å…¥æ•°æ®æ—¶ï¼Œä¸ºç»´æŒB+æ ‘ç»“æ„ï¼Œæ–‡ä»¶çš„å¤§è°ƒæ•´ã€‚ MyISAMä¸ InnoDBåŒºåˆ« countè¿ç®—ä¸Šçš„åŒºåˆ«ï¼šå› ä¸ºMylSAMç¼“å­˜æœ‰è¡¨meta-data(è¡Œæ•°ç­‰)ï¼Œå› æ­¤åœ¨åšCOUNT(*)æ—¶å¯¹äºä¸€ä¸ªç»“æ„å¾ˆå¥½çš„æŸ¥è¯¢æ˜¯ä¸éœ€è¦æ¶ˆè€—å¤šå°‘èµ„æºçš„ã€‚è€Œå¯¹äºInnoDBæ¥è¯´ï¼Œåˆ™æ²¡æœ‰è¿™ç§ç¼“å­˜ã€‚ æ˜¯å¦æ”¯æŒäº‹ç‰©å’Œå´©æºƒåçš„å®‰å…¨æ¢å¤ï¼šMyISAMå¼ºè°ƒçš„æ˜¯æ€§èƒ½ï¼Œæ¯æ¬¡æŸ¥è¯¢å…·æœ‰åŸå­æ€§ï¼Œå…¶æ‰§è¡Œé€Ÿåº¦æ¯”InnoDBç±»å‹æ›´å¿«ï¼Œä½†æ˜¯ä¸æä¾›äº‹ç‰©æ”¯æŒã€‚ä½†æ˜¯InnoDBæä¾›äº‹ç‰©æ”¯æŒï¼Œå¤–é”®ç­‰é«˜çº§æ•°æ®åº“åŠŸèƒ½ã€‚å…·æœ‰äº‹ç‰©(commit)ã€å›æ»š(rollback)ã€å’Œå´©æºƒä¿®å¤èƒ½åŠ›(crash recovery capabilities)çš„äº‹åŠ¡å®‰å…¨(transaction-safe (ACID compliant))å‹è¡¨ã€‚ æ˜¯å¦æ”¯æŒå¤–é”®ï¼š MyISAMä¸æ”¯æŒï¼Œè€ŒInnoDBæ”¯æŒã€‚ MyISAMæ›´é€‚åˆè¯»å¯†é›†çš„è¡¨ï¼Œè€ŒInnoDBæ›´é€‚åˆå†™å¯†é›†çš„çš„è¡¨ã€‚ åœ¨æ•°æ®åº“åšä¸»ä»åˆ†ç¦»çš„æƒ…å†µä¸‹ï¼Œç»å¸¸é€‰æ‹©MyISAMä½œ ä¸ºä¸»åº“çš„å­˜å‚¨å¼•æ“ã€‚ ä¸€èˆ¬æ¥è¯´ï¼Œå¦‚æœéœ€è¦äº‹åŠ¡æ”¯æŒï¼Œå¹¶ä¸”æœ‰è¾ƒé«˜çš„å¹¶å‘è¯»å–é¢‘ç‡(MyISAMçš„è¡¨é”çš„ç²’åº¦å¤ªå¤§ï¼Œæ‰€ä»¥ å½“è¯¥è¡¨å†™å¹¶å‘é‡è¾ƒé«˜æ—¶ï¼Œè¦ç­‰å¾…çš„æŸ¥è¯¢å°±ä¼šå¾ˆå¤šäº†)ï¼ŒInnoDBæ˜¯ä¸é”™çš„é€‰æ‹©ã€‚å¦‚æœä½ çš„æ•°æ®é‡å¾ˆå¤§ï¼ˆMyISAMæ”¯æŒå‹ ç¼©ç‰¹æ€§å¯ä»¥å‡å°‘ç£ç›˜çš„ç©ºé—´å ç”¨ï¼‰ï¼Œè€Œä¸”ä¸éœ€è¦æ”¯æŒäº‹åŠ¡æ—¶ï¼ŒMyISAMæ˜¯å¥½çš„é€‰æ‹©ã€‚ MySQLçš„åŸºæœ¬å­˜å‚¨ç»“æ„ é¡µçš„ç»„æˆéƒ¨åˆ† MySQLçš„åŸºæœ¬å­˜å‚¨ç»“æ„æ˜¯é¡µï¼ˆè®°å½•éƒ½å­˜åœ¨é¡µé‡Œï¼‰ï¼Œé¡µçš„åŸºæœ¬ç»“æ„å¦‚ä¸‹å›¾ï¼š ä¸€ä¸ªé¡µé¢çš„å­˜å‚¨ç”±ä»¥ä¸‹å‡ éƒ¨åˆ†ç»„æˆï¼š åç§° ä¸­æ–‡å å ç”¨ç©ºé—´å¤§å° ç®€å•æè¿° File Header æ–‡ä»¶å¤´ 38å­—èŠ‚ æè¿°é¡µçš„ä¿¡æ¯ Page Header é¡µå¤´ 56å­—èŠ‚ é¡µçš„çŠ¶æ€ä¿¡æ¯ Infimum + SupreMum æœ€å°è®°å½•å’Œæœ€å¤§è®°å½• 26å­—èŠ‚ ä¸¤ä¸ªè™šæ‹Ÿçš„è¡Œè®°å½•ï¼ˆåé¢ä¼šè¯´æ˜ï¼‰ User Records ç”¨æˆ·è®°å½• ä¸ç¡®å®š å®é™…å­˜å‚¨çš„è¡Œè®°å½•å†…å®¹ Free Space ç©ºé—²ç©ºé—´ ä¸ç¡®å®š é¡µä¸­å°šæœªä½¿ç”¨çš„ç©ºé—´ Page Directory é¡µç›®å½• ä¸ç¡®å®š é¡µä¸­çš„è®°å½•ç›¸å¯¹ä½ç½® File Trailer æ–‡ä»¶ç»“å°¾ 8å­—èŠ‚ ç»“å°¾ä¿¡æ¯ é¡µä¸­çš„å­˜å‚¨ å½“æˆ‘ä»¬åœ¨å­˜å‚¨æ•°æ®çš„æ—¶å€™ï¼Œè®°å½•ä¼šå­˜å‚¨åˆ°User Recordséƒ¨åˆ† ã€‚ä½†æ˜¯åœ¨ä¸€ä¸ªé¡µæ–°å½¢æˆçš„æ—¶å€™æ˜¯ä¸å­˜åœ¨User Records è¿™ä¸ªéƒ¨åˆ†çš„ï¼Œæ¯å½“æˆ‘ä»¬åœ¨æ’å…¥ä¸€æ¡è®°å½•çš„æ—¶å€™ï¼Œéƒ½ä¼šä»Free Spaceä¸­å»ç”³è¯·ä¸€å—å¤§å°ç¬¦åˆè¯¥è®°å½•å¤§å°çš„ç©ºé—´å¹¶åˆ’åˆ†åˆ°User Recordsï¼Œå½“Free Spaceçš„éƒ¨åˆ†ç©ºé—´å…¨éƒ¨è¢«User Recordséƒ¨åˆ†æ›¿æ¢æ‰ä¹‹åï¼Œå°±æ„å‘³ç€å½“å‰é¡µä½¿ç”¨å®Œæ¯•ï¼Œå¦‚æœè¿˜æœ‰æ–°çš„è®°å½•æ’å…¥ï¼Œéœ€è¦å†å»ç”³è¯·æ–°çš„é¡µï¼Œè¿‡ç¨‹å¦‚ä¸‹ï¼š æ¯ä¸ªæ•°æ®é¡µå¯ä»¥ç»„æˆä¸€ä¸ªåŒå‘åˆ—è¡¨ï¼› æ¯ä¸ªæ•°æ®é¡µä¸­çš„è®°å½•åˆå¯ä»¥ç”Ÿæˆä¸€ä¸ªå•å‘åˆ—è¡¨ï¼š æ¯ä¸ªæ•°æ®é¡µéƒ½ä¼šä¸ºå­˜å‚¨åœ¨å®ƒé‡Œè¾¹çš„è®°å½•ç”Ÿæˆä¸€ä¸ªé¡µç›®å½•ï¼Œåœ¨é€šè¿‡ä¸»é”®æŸ¥æ‰¾æŸæ¡è®°å½•çš„æ—¶å€™å¯ä»¥åœ¨é¡µç›®å½•ä½¿ç”¨äºŒåˆ†æ³•å¿«é€Ÿå®šä½åˆ°å¯¹åº”çš„æ§½ï¼Œç„¶åå†éå†è¯¥æ§½ä¸­å¯¹åº”åˆ†ç»„ä¸­çš„è®°å½•å³å¯å¿«é€Ÿæ‰¾åˆ°æŒ‡å®šçš„è®°å½•ã€‚ ä»¥å…¶ä»–åˆ—(éä¸»é”®)ä½œä¸ºæœç´¢æ¡ä»¶ï¼šåªèƒ½ä»æœ€å°è®°å½•å¼€å§‹ä¾æ¬¡éå†å•é“¾è¡¨ä¸­çš„æ¯æ¡è®°å½• æ‰€ä»¥è¯´ï¼Œå¦‚æœæˆ‘ä»¬å†™select * from user where indexname = 'xxxâ€™è¿™æ ·æ²¡æœ‰è¿›è¡Œä»»ä½•ä¼˜åŒ–çš„sqlè¯­å¥ï¼Œé»˜è®¤ä¼šè¿™æ ·åšï¼š 1.å®šä½åˆ°è®°å½•æ‰€åœ¨çš„é¡µ:éœ€è¦éå†åŒå‘é“¾è¡¨ï¼Œæ‰¾åˆ°æ‰€åœ¨çš„é¡µ 2.ä»æ‰€åœ¨çš„é¡µå†…ä¸­æŸ¥æ‰¾ç›¸åº”çš„è®°å½•:ç”±äºä¸æ˜¯æ ¹æ®ä¸»é”®æŸ¥è¯¢ï¼Œåªèƒ½éå†æ‰€åœ¨é¡µçš„å•é“¾è¡¨äº† å¾ˆæ˜æ˜¾ï¼Œåœ¨æ•°æ®é‡å¾ˆå¤§çš„æƒ…å†µä¸‹è¿™æ ·æŸ¥æ‰¾ä¼šå¾ˆæ…¢ï¼è¿™æ ·çš„æ—¶é—´å¤æ‚åº¦ä¸ºOï¼ˆnï¼‰ã€‚ ä½¿ç”¨ç´¢å¼•ä¹‹åï¼Œç´¢å¼•åšäº†äº›ä»€ä¹ˆå¯ä»¥è®©æˆ‘ä»¬æŸ¥è¯¢åŠ å¿«é€Ÿåº¦å‘¢ï¼Ÿå…¶å®å°±æ˜¯å°†æ— åºçš„æ•°æ®å˜æˆæœ‰åº(ç›¸å¯¹)ï¼š è¦æ‰¾åˆ°idä¸º8çš„è®°å½•ç®€è¦æ­¥éª¤ï¼š å¾ˆæ˜æ˜¾çš„æ˜¯ï¼šæ²¡æœ‰ç”¨ç´¢å¼•æˆ‘ä»¬æ˜¯éœ€è¦éå†åŒå‘é“¾è¡¨æ¥å®šä½å¯¹åº”çš„é¡µï¼Œç°åœ¨é€šè¿‡ â€œç›®å½•â€ å°±å¯ä»¥å¾ˆå¿«åœ°å®šä½åˆ°å¯¹åº”çš„é¡µ ä¸Šäº†ï¼ï¼ˆäºŒåˆ†æŸ¥æ‰¾ï¼Œæ—¶é—´å¤æ‚åº¦è¿‘ä¼¼ä¸ºO(logn)ï¼‰ å…¶å®åº•å±‚ç»“æ„å°±æ˜¯B+æ ‘ï¼ŒB+æ ‘ä½œä¸ºæ ‘çš„ä¸€ç§å®ç°ï¼Œèƒ½å¤Ÿè®©æˆ‘ä»¬å¾ˆå¿«åœ°æŸ¥æ‰¾å‡ºå¯¹åº”çš„è®°å½•ã€‚ æ•°æ®åº“å››å¤§ç‰¹æ€§ åŸå­æ€§ï¼ˆAtomicityï¼‰ åŸå­æ€§æ˜¯æŒ‡äº‹ç‰©åŒ…å«çš„æ‰€æœ‰æ“ä½œè¦ä¹ˆå…¨éƒ¨æˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨å¤±è´¥å›æ»šã€‚å› æ­¤äº‹ç‰©çš„æ“ä½œå¦‚æœæˆåŠŸå°±å¿…é¡»å®Œå…¨åº”ç”¨åˆ°æ•°æ®åº“ï¼Œå¦‚æœæ“ä½œå¤±è´¥åˆ™ä¸èƒ½å¯¹æ•°æ®åº“æœ‰ä»»ä½•å½±å“ã€‚ ä¸€è‡´æ€§ï¼ˆConsistencyï¼‰ ä¸€è‡´æ€§æ˜¯æŒ‡äº‹ç‰©å¿…é¡»ä½¿æ•°æ®åº“ä»ä¸€ä¸ªä¸€è‡´çŠ¶æ€å˜æ¢åˆ°å¦ä¸€ä¸ªä¸€è‡´æ€§çŠ¶æ€ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸€ä¸ªäº‹ç‰©æ‰§è¡Œä¹‹å‰å’Œæ‰§è¡Œä¹‹åéƒ½å¿…é¡»å¤„äºä¸€è‡´æ€§çŠ¶æ€ã€‚ éš”ç¦»æ€§ï¼ˆIsolationï¼‰ å¤šä¸ªäº‹ç‰©å¹¶å‘æ“ä½œæ—¶ï¼Œå¤šä¸ªå¹¶å‘äº‹ç‰©ä¹‹é—´è¦ç›¸äº’éš”ç¦»ã€‚ æŒä¹…æ€§ï¼ˆDurabilityï¼‰ æŒä¹…æ€§æ˜¯æŒ‡ä¸€ä¸ªäº‹ç‰©ä¸€æ—¦æäº¤äº†ï¼Œé‚£ä¹ˆå¯¹æ•°æ®åº“ä¸­çš„æ•°æ®çš„æ”¹å˜å°±æ˜¯æ°¸ä¹…æ€§çš„ã€‚ æ•°æ®åº“çš„å››ç§éš”ç¦»çº§åˆ« è¯»å–æœªæäº¤ï¼ˆRead Uncommittedï¼‰ åœ¨è¯¥éš”ç¦»çº§åˆ«ï¼Œæ‰€æœ‰äº‹åŠ¡éƒ½å¯ä»¥çœ‹åˆ°å…¶ä»–æœªæäº¤äº‹åŠ¡çš„æ‰§è¡Œç»“æœã€‚è¿™æ˜¯ä¸‡ä¸‡ä¸å¯å‡ºç°çš„ã€‚ è¯»å·²æäº¤ï¼ˆRead Committedï¼‰ è¿™æ˜¯å¤§å¤šæ•°æ•°æ®åº“ç³»ç»Ÿçš„é»˜è®¤éš”ç¦»çº§åˆ«ï¼ˆä½†ä¸æ˜¯MySqlé»˜è®¤çš„ï¼‰ã€‚å®ƒæ»¡è¶³äº†éš”ç¦»çš„ç®€å•å®šä¹‰ï¼šä¸€ä¸ªäº‹ç‰©åªèƒ½çœ‹è§å·²ç»æäº¤çš„äº‹åŠ¡æ‰€åšçš„æ”¹å˜ã€‚ä½†æ˜¯è¯¥éš”ç¦»çº§åˆ«å¯èƒ½ä¼šäº§ç”Ÿä¸å¯é‡å¤è¯»çš„ç°è±¡ï¼Œå³åŒä¸€äº‹åŠ¡çš„å…¶ä»–å®ä¾‹åœ¨è¯¥å®ä¾‹å¤„ç†æœŸé—´å¯èƒ½ä¼šæœ‰æ–°çš„commitå¯¹æ•°æ®æ›´æ–°ï¼Œæ‰€ä»¥åŒä¸€selectå¯èƒ½è¿”å›ä¸åŒçš„ç»“æœã€‚ é‡‡ç”¨MVCCå¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶è§£å†³ä¸å¯é‡å¤è¯»çš„é—®é¢˜ã€‚ å¯é‡è¯»ï¼ˆRepeatable Readï¼‰ è¿™æ˜¯MySqlçš„é»˜è®¤äº‹åŠ¡éš”ç¦»çº§åˆ«ï¼Œå®ƒç¡®ä¿åŒä¸€äº‹åŠ¡çš„å¤šä¸ªå®ä¾‹åœ¨å¹¶å‘è¯»å–æ•°æ®æ—¶ï¼Œä¼šçœ‹åˆ°åŒæ ·çš„æ•°æ®è¡Œã€‚ä½†è¿™ä¼šå¯¼è‡´é‡Œå¦ä¸€ä¸ªé—®é¢˜ï¼šå¹»è¯»ã€‚å¹»è¯»æ˜¯æŒ‡ç”¨æˆ·è¯»å–æŸä¸€èŒƒå›´çš„æ•°æ®è¡Œæ—¶ï¼Œå¦ä¸€ä¸ªäº‹åŠ¡åˆåœ¨è¯¥èŒƒå›´å†…æ’å…¥äº†æ–°è¡Œï¼Œå½“ç”¨æˆ·å†è¯»å–è¯¥èŒƒå›´çš„æ•°æ®è¡Œæ—¶ï¼Œä¼šå‘ç°æœ‰æ–°çš„â€œå¹»å½±â€è¡Œã€‚ å¯ä¸²è¡ŒåŒ–ï¼ˆSerializableï¼‰ è¿™æ˜¯æœ€é«˜çš„éš”ç¦»çº§åˆ«ï¼Œå®ƒé€šè¿‡å¼ºåˆ¶äº‹åŠ¡æ’åºï¼Œä½¿ä¹‹ä¸å¯èƒ½ç›¸äº’å†²çªï¼Œä»è€Œè§£å†³å¹»è¯»é—®é¢˜ã€‚ç®€è¨€ä¹‹ï¼Œå®ƒæ˜¯åœ¨æ¯ä¸ªè¯»çš„æ•°æ®è¡Œä¸ŠåŠ å…±äº«é”ï¼Œåœ¨è¿™ä¸ªçº§åˆ«ï¼Œå¯èƒ½å¯¼è‡´å¤§é‡çš„è¶…æ—¶ç°è±¡å’Œé”ç«äº‰ã€‚ æœ€å·¦å‰ç¼€åŸåˆ™ MySQLä¸­çš„ç´¢å¼•å¯ä»¥ä»¥ä¸€å®šé¡ºåºå¼•ç”¨å¤šåˆ—ï¼Œè¿™ç§ç´¢å¼•å«ä½œè”åˆç´¢å¼•ã€‚å¦‚Userè¡¨çš„nameå’ŒcityåŠ è”åˆç´¢å¼•å°±æ˜¯ (name,city)oè€Œå·¦å‰åŸåˆ™æŒ‡çš„æ˜¯ï¼Œå¦‚æœæŸ¥è¯¢çš„æ—¶å€™æŸ¥è¯¢æ¡ä»¶ç²¾ç¡®åŒ¹é…ç´¢å¼•çš„å·¦è¾¹è¿ç»­ä¸€åˆ—æˆ–å‡ åˆ—ï¼Œåˆ™æ­¤åˆ—å°±å¯ä»¥ è¢«ç”¨åˆ°ã€‚å¦‚ä¸‹ï¼š select * from user where name=xx and city=xx ; ï¼ï¼å¯ä»¥å‘½ä¸­ç´¢å¼• select * from user where name=xx ; // å¯ä»¥å‘½ä¸­ç´¢å¼• select * from user where city=xx; // æ— æ³•å‘½ä¸­ç´¢å¼• è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒæŸ¥è¯¢çš„æ—¶å€™å¦‚æœä¸¤ä¸ªæ¡ä»¶éƒ½ç”¨ä¸Šäº†ï¼Œä½†æ˜¯é¡ºåºä¸åŒï¼Œå¦‚ city= xx and name ï¼xx ï¼Œé‚£ä¹ˆç°åœ¨ çš„æŸ¥è¯¢å¼•æ“ä¼šè‡ªåŠ¨ä¼˜åŒ–ä¸ºåŒ¹é…è”åˆç´¢å¼•çš„é¡ºåºï¼Œè¿™æ ·æ˜¯èƒ½å¤Ÿå‘½ä¸­ç´¢å¼•çš„. ç”±äºå·¦å‰åŸåˆ™ï¼Œåœ¨åˆ›å»ºè”åˆç´¢å¼•æ—¶ï¼Œç´¢å¼•å­—æ®µçš„é¡ºåºéœ€è¦è€ƒè™‘å­—æ®µå€¼å»é‡ä¹‹åçš„ä¸ªæ•°ï¼Œè¾ƒå¤šçš„æ”¾å‰é¢ã€‚ ORDERBYå­å¥ä¹Ÿéµå¾ªæ­¤è§„åˆ™ã€‚ æ³¨æ„é¿å…å†—ä½™ç´¢å¼•ï¼šå†—ä½™ç´¢å¼•æŒ‡çš„æ˜¯ç´¢å¼•çš„åŠŸèƒ½ç›¸åŒï¼Œèƒ½å¤Ÿå‘½ä¸­ å°±è‚¯å®šèƒ½å‘½ä¸­ ï¼Œé‚£ä¹ˆ å°±æ˜¯å†—ä½™ç´¢å¼•å¦‚ï¼ˆname,city ï¼‰å’Œï¼ˆname ï¼‰è¿™ä¸¤ ä¸ªç´¢å¼•å°±æ˜¯å†—ä½™ç´¢å¼•ï¼Œèƒ½å¤Ÿå‘½ä¸­åè€…çš„æŸ¥è¯¢è‚¯å®šæ˜¯èƒ½å¤Ÿå‘½ä¸­å‰è€…çš„ åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œéƒ½åº”è¯¥å°½é‡æ‰©å±•å·²æœ‰çš„ç´¢å¼•è€Œ ä¸æ˜¯åˆ›å»ºæ–°ç´¢å¼•ã€‚ MySQLS.7 ç‰ˆæœ¬åï¼Œå¯ä»¥é€šè¿‡æŸ¥è¯¢ sys åº“çš„ schemal_r dundant_indexes è¡¨æ¥æŸ¥çœ‹å†—ä½™ç´¢å¼• MySqlå¦‚ä½•ä¸ºè¡¨å­—æ®µæ·»åŠ ç´¢å¼• 1.æ·»åŠ PRIMARY KEYï¼ˆä¸»é”®ç´¢å¼•ï¼‰ ALTER TABLE `table_name` ADD PRIMARY KEY ( `column` ) 2.æ·»åŠ UNIQUE(å”¯ä¸€ç´¢å¼•) ALTER TABLE `table_name` ADD UNIQUE ( `column` ) 3.æ·»åŠ INDEX(æ™®é€šç´¢å¼•) ALTER TABLE `table_name` ADD INDEX index_name ( `column` ) 4.æ·»åŠ FULLTEXT(å…¨æ–‡ç´¢å¼•) ALTER TABLE `table_name` ADD FULLTEXT ( `column`) 5.æ·»åŠ å¤šåˆ—ç´¢å¼• ALTER TABLE `table_name` ADD INDEX index_name ( `column1`, `column2`, `column3` ) ç´¢å¼• èšé›†ç´¢å¼• åœ¨èšé›†ç´¢å¼•ä¸­ï¼Œè¡¨ä¸­è¡Œçš„ç‰©ç†é¡ºåºä¸é”®å€¼çš„é€»è¾‘ï¼ˆç´¢å¼•ï¼‰é¡ºåºç›¸åŒã€‚ä¸€ä¸ªè¡¨åªèƒ½åŒ…å«ä¸€ ä¸ªèšé›†ç´¢å¼•ã€‚ å¦‚æœæŸç´¢å¼•ä¸æ˜¯èšé›†ç´¢å¼•ï¼Œåˆ™è¡¨ä¸­è¡Œçš„ç‰©ç†é¡ºåºä¸é”®å€¼çš„é€»è¾‘é¡ºåºä¸åŒ¹é…ã€‚ä¸éèšé›†ç´¢å¼•ç›¸æ¯”ï¼Œèšé›†ç´¢å¼•é€šå¸¸æä¾›æ›´å¿«çš„æ•°æ®è®¿é—®é€Ÿåº¦ã€‚ è¾…åŠ©ç´¢å¼• è¾…åŠ©ç´¢å¼•ä¸èšé›†ç´¢å¼•çš„åŒºåˆ«åœ¨äºè¾…åŠ©ç´¢å¼•çš„å¶å­èŠ‚ç‚¹å¹¶ä¸åŒ…å«è¡Œè®°å½•çš„å…¨éƒ¨æ•°æ®ï¼Œè€Œæ˜¯å­˜å‚¨ç›¸åº”è¡Œæ•°æ®çš„èšé›†ç´¢å¼•é”®ï¼Œå³ä¸»é”®ã€‚å½“é€šè¿‡è¾…åŠ©ç´¢å¼•æ¥æŸ¥è¯¢æ•°æ®æ—¶ï¼ŒInnoDBå­˜å‚¨å¼•æ“ä¼šéå†è¾…åŠ©ç´¢å¼•æ‰¾åˆ°ä¸»é”®ï¼Œç„¶åå†é€šè¿‡ä¸»é”®åœ¨èšé›†ç´¢å¼•ä¸­æ‰¾åˆ°å®Œæ•´çš„è¡Œè®°å½•æ•°æ®ã€‚ hashç´¢å¼• å“ˆå¸Œç´¢å¼•ï¼ˆhash indexï¼‰åŸºäºå“ˆå¸Œè¡¨å®ç°ï¼Œåªæœ‰ç²¾ç¡®åŒ¹é…ç´¢å¼•æ‰€æœ‰åˆ—çš„æŸ¥è¯¢æ‰æœ‰æ•ˆã€‚å¯¹äºæ¯ä¸€è¡Œæ•°æ®ï¼Œå­˜å‚¨å¼•æ“éƒ½ä¼šå¯¹æ‰€æœ‰çš„ç´¢å¼•åˆ—è®¡ç®—ä¸€ä¸ªå“ˆå¸Œç ï¼ˆhash codeï¼‰ï¼Œå“ˆå¸Œç æ˜¯ä¸€ä¸ªè¾ƒå°çš„å€¼ï¼Œå¹¶ä¸”ä¸åŒé”®å€¼çš„è¡Œè®¡ç®—å‡ºæ¥çš„å“ˆå¸Œç ä¹Ÿä¸ä¸€æ ·ã€‚å“ˆå¸Œç´¢å¼•å°†æ‰€æœ‰çš„å“ˆå¸Œç å­˜å‚¨åœ¨ç´¢å¼•ä¸­ï¼ŒåŒæ—¶åœ¨å“ˆå¸Œè¡¨ä¸­ä¿å­˜æŒ‡å‘æ¯ä¸ªæ•°æ®è¡Œçš„æŒ‡é’ˆã€‚ hashç´¢å¼•çš„ç¤ºæ„å›¾ï¼š hashç´¢å¼•çš„é™åˆ¶ï¼š å“ˆå¸Œç´¢å¼•åªåŒ…å«å“ˆå¸Œå€¼å’Œè¡ŒæŒ‡é’ˆï¼Œè€Œä¸å­˜å‚¨å­—æ®µå€¼ï¼Œæ‰€ä»¥ä¸èƒ½ä½¿ç”¨ç´¢å¼•ä¸­çš„å€¼æ¥é¿å…è¯»å–è¡Œã€‚ å“ˆå¸Œç´¢å¼•æ•°æ®å¹¶ä¸æ˜¯æŒ‰ç…§ç´¢å¼•å€¼é¡ºåºå­˜å‚¨çš„ï¼Œæ‰€ä»¥ä¹Ÿå°±æ— æ³•ç”¨äºæ’åºã€‚ å“ˆå¸Œç´¢å¼•ä¹Ÿä¸æ”¯æŒéƒ¨åˆ†ç´¢å¼•åˆ—åŒ¹é…æŸ¥æ‰¾ï¼Œå› ä¸ºå“ˆå¸Œç´¢å¼•å§‹ç»ˆæ˜¯ä½¿ç”¨ç´¢å¼•åˆ—çš„å…¨éƒ¨å†…å®¹æ¥è®¡ç®—å“ˆå¸Œå€¼çš„ã€‚ å“ˆå¸Œç´¢å¼•åªæ”¯æŒç­‰å€¼æ¯”è¾ƒæŸ¥è¯¢ï¼ŒåŒ…æ‹¬=ã€IN()ã€&lt;&gt;ï¼ˆæ³¨æ„&lt;&gt;å’Œ&lt;=&gt;æ˜¯ä¸åŒçš„æ“ä½œï¼‰ã€‚ä¹Ÿä¸æ”¯æŒä»»ä½•èŒƒå›´æŸ¥è¯¢ï¼Œä¾‹å¦‚WHERE price&gt;100ã€‚ è®¿é—®å“ˆå¸Œç´¢å¼•çš„æ•°æ®éå¸¸å¿«ï¼Œé™¤éæœ‰å¾ˆå¤šå“ˆå¸Œå†²çªï¼ˆä¸åŒçš„ç´¢å¼•åˆ—å€¼å´æœ‰ç›¸åŒçš„å“ˆå¸Œå€¼ï¼‰ã€‚å½“å‡ºç°å“ˆå¸Œå†²çªçš„æ—¶å€™ï¼Œå­˜å‚¨å¼•æ“å¿…é¡»éå†é“¾è¡¨ä¸­æ‰€æœ‰çš„è¡ŒæŒ‡é’ˆï¼Œé€è¡Œè¿›è¡Œæ¯”è¾ƒï¼Œç›´åˆ°æ‰¾åˆ°æ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„è¡Œã€‚ å¦‚æœå“ˆå¸Œå†²çªå¾ˆå¤šçš„è¯ï¼Œä¸€äº›ç´¢å¼•ç»´æŠ¤æ“ä½œçš„ä»£ä»·ä¹Ÿä¼šå¾ˆé«˜ã€‚ä¾‹å¦‚ï¼Œå¦‚æœåœ¨æŸä¸ªé€‰æ‹©æ€§å¾ˆä½ï¼ˆå“ˆå¸Œå†²çªå¾ˆå¤šï¼‰çš„åˆ—ä¸Šå»ºç«‹å“ˆå¸Œç´¢å¼•ï¼Œé‚£ä¹ˆå½“ä»è¡¨ä¸­åˆ é™¤ä¸€è¡Œæ—¶ï¼Œå­˜å‚¨å¼•æ“éœ€è¦éå†å¯¹åº”å“ˆå¸Œå€¼çš„é“¾è¡¨ä¸­çš„æ¯ä¸€è¡Œï¼Œæ‰¾åˆ°å¹¶åˆ é™¤å¯¹åº”è¡Œçš„å¼•ç”¨ï¼Œå†²çªè¶Šå¤šï¼Œä»£ä»·è¶Šå¤§ã€‚ B-æ ‘ åœ¨è¯´B+æ ‘ä¹‹å‰æˆ‘ä»¬å…ˆä»‹ç»ä¸€ä¸‹Bæ ‘ä¸B+æ ‘çš„æ•°æ®ç»“æ„ã€‚ B-æ ‘å®šä¹‰ï¼š ä¸€æ£µmé˜¶çš„B-Treeæœ‰å¦‚ä¸‹ç‰¹æ€§ï¼š æ¯ä¸ªèŠ‚ç‚¹æœ€å¤šæœ‰mä¸ªå­©å­ã€‚ é™¤äº†æ ¹èŠ‚ç‚¹å’Œå¶å­èŠ‚ç‚¹å¤–ï¼Œå…¶å®ƒæ¯ä¸ªèŠ‚ç‚¹è‡³å°‘æœ‰Ceil(m/2)ä¸ªå­©å­ã€‚ è‹¥æ ¹èŠ‚ç‚¹ä¸æ˜¯å¶å­èŠ‚ç‚¹ï¼Œåˆ™è‡³å°‘æœ‰2ä¸ªå­©å­ æ‰€æœ‰å¶å­èŠ‚ç‚¹éƒ½åœ¨åŒä¸€å±‚ï¼Œä¸”ä¸åŒ…å«å…¶å®ƒå…³é”®å­—ä¿¡æ¯ æ¯ä¸ªéç»ˆç«¯èŠ‚ç‚¹åŒ…å«nä¸ªå…³é”®å­—ä¿¡æ¯ï¼ˆP0,P1,â€¦Pn, k1,â€¦knï¼‰ å…³é”®å­—çš„ä¸ªæ•°næ»¡è¶³ï¼šceil(m/2)-1 &lt;= n &lt;= m-1 ki(i=1,â€¦n)ä¸ºå…³é”®å­—ï¼Œä¸”å…³é”®å­—å‡åºæ’åºã€‚ Pi(i=1,â€¦n)ä¸ºæŒ‡å‘å­æ ‘æ ¹èŠ‚ç‚¹çš„æŒ‡é’ˆã€‚P(i-1)æŒ‡å‘çš„å­æ ‘çš„æ‰€æœ‰èŠ‚ç‚¹å…³é”®å­—å‡å°äºkiï¼Œä½†éƒ½å¤§äºk(i-1)ã€‚ B-Treeä¸­çš„æ¯ä¸ªèŠ‚ç‚¹æ ¹æ®å®é™…æƒ…å†µå¯ä»¥åŒ…å«å¤§é‡çš„å…³é”®å­—ä¿¡æ¯å’Œåˆ†æ”¯ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºä¸ºä¸€ä¸ª3é˜¶çš„B-Treeï¼š æ¯ä¸ªèŠ‚ç‚¹å ç”¨ä¸€ä¸ªç›˜å—çš„ç£ç›˜ç©ºé—´ï¼Œä¸€ä¸ªèŠ‚ç‚¹ä¸Šæœ‰ä¸¤ä¸ªå‡åºæ’åºçš„å…³é”®å­—å’Œä¸‰ä¸ªæŒ‡å‘å­æ ‘æ ¹èŠ‚ç‚¹çš„æŒ‡é’ˆï¼ŒæŒ‡é’ˆå­˜å‚¨çš„æ˜¯å­èŠ‚ç‚¹æ‰€åœ¨ç£ç›˜å—çš„åœ°å€ã€‚ä¸¤ä¸ªå…³é”®è¯åˆ’åˆ†æˆçš„ä¸‰ä¸ªèŒƒå›´åŸŸå¯¹åº”ä¸‰ä¸ªæŒ‡é’ˆæŒ‡å‘çš„å­æ ‘çš„æ•°æ®çš„èŒƒå›´åŸŸã€‚ä»¥æ ¹èŠ‚ç‚¹ä¸ºä¾‹ï¼Œå…³é”®å­—ä¸º17å’Œ35ï¼ŒP1æŒ‡é’ˆæŒ‡å‘çš„å­æ ‘çš„æ•°æ®èŒƒå›´ä¸ºå°äº17ï¼ŒP2æŒ‡é’ˆæŒ‡å‘çš„å­æ ‘çš„æ•°æ®èŒƒå›´ä¸º17~35ï¼ŒP3æŒ‡é’ˆæŒ‡å‘çš„å­æ ‘çš„æ•°æ®èŒƒå›´ä¸ºå¤§äº35ã€‚ æ¨¡æ‹ŸæŸ¥æ‰¾å…³é”®å­—29çš„è¿‡ç¨‹ï¼š æ ¹æ®æ ¹èŠ‚ç‚¹æ‰¾åˆ°ç£ç›˜å—1ï¼Œè¯»å…¥å†…å­˜ã€‚ã€ç£ç›˜I/Oæ“ä½œç¬¬1æ¬¡ã€‘ æ¯”è¾ƒå…³é”®å­—29åœ¨åŒºé—´ï¼ˆ17,35ï¼‰ï¼Œæ‰¾åˆ°ç£ç›˜å—1çš„æŒ‡é’ˆP2ã€‚ æ ¹æ®P2æŒ‡é’ˆæ‰¾åˆ°ç£ç›˜å—3ï¼Œè¯»å…¥å†…å­˜ã€‚ã€ç£ç›˜I/Oæ“ä½œç¬¬2æ¬¡ã€‘ æ¯”è¾ƒå…³é”®å­—29åœ¨åŒºé—´ï¼ˆ26,30ï¼‰ï¼Œæ‰¾åˆ°ç£ç›˜å—3çš„æŒ‡é’ˆP2ã€‚ æ ¹æ®P2æŒ‡é’ˆæ‰¾åˆ°ç£ç›˜å—8ï¼Œè¯»å…¥å†…å­˜ã€‚ã€ç£ç›˜I/Oæ“ä½œç¬¬3æ¬¡ã€‘ åœ¨ç£ç›˜å—8ä¸­çš„å…³é”®å­—åˆ—è¡¨ä¸­æ‰¾åˆ°å…³é”®å­—29ã€‚ åˆ†æä¸Šé¢è¿‡ç¨‹ï¼Œå‘ç°éœ€è¦3æ¬¡ç£ç›˜I/Oæ“ä½œï¼Œå’Œ3æ¬¡å†…å­˜æŸ¥æ‰¾æ“ä½œã€‚ç”±äºå†…å­˜ä¸­çš„å…³é”®å­—æ˜¯ä¸€ä¸ªæœ‰åºè¡¨ç»“æ„ï¼Œå¯ä»¥åˆ©ç”¨äºŒåˆ†æ³•æŸ¥æ‰¾æé«˜æ•ˆç‡ã€‚è€Œ3æ¬¡ç£ç›˜I/Oæ“ä½œæ˜¯å½±å“æ•´ä¸ªB-TreeæŸ¥æ‰¾æ•ˆç‡çš„å†³å®šå› ç´ ã€‚B-Treeç›¸å¯¹äºAVLTreeç¼©å‡äº†èŠ‚ç‚¹ä¸ªæ•°ï¼Œä½¿æ¯æ¬¡ç£ç›˜I/Oå–åˆ°å†…å­˜çš„æ•°æ®éƒ½å‘æŒ¥äº†ä½œç”¨ï¼Œä»è€Œæé«˜äº†æŸ¥è¯¢æ•ˆç‡ã€‚ æ•°æ®åº“ç³»ç»Ÿçš„è®¾è®¡è€…å·§å¦™åˆ©ç”¨äº†ç£ç›˜é¢„è¯»åŸç†ï¼Œ å°†ä¸€ä¸ªèŠ‚ç‚¹çš„å¤§å°è®¾ä¸ºç­‰äºä¸€ä¸ªé¡µï¼Œè¿™æ ·æ¯ä¸ªèŠ‚ç‚¹åªéœ€è¦ä¸€æ¬¡I/Oå°±å¯ä»¥å®Œå…¨è½½å…¥ã€‚ä¸ºäº†è¾¾åˆ°è¿™ä¸ªç›®çš„ï¼Œåœ¨å®é™…å®ç°B-Treeè¿˜éœ€è¦ä½¿ç”¨å¦‚ä¸‹æŠ€å·§ï¼š æ¯æ¬¡æ–°å»ºèŠ‚ç‚¹æ—¶ï¼Œç›´æ¥ç”³è¯·ä¸€ä¸ªé¡µçš„ç©ºé—´ï¼Œè¿™æ ·å°±ä¿è¯ä¸€ä¸ªèŠ‚ç‚¹ç‰©ç†ä¸Šä¹Ÿå­˜å‚¨åœ¨ä¸€ä¸ªé¡µé‡Œï¼Œ åŠ ä¹‹è®¡ç®—æœºå­˜å‚¨åˆ†é…éƒ½æ˜¯æŒ‰é¡µå¯¹é½çš„ï¼Œå°±å®ç°äº†ä¸€ä¸ªnodeåªéœ€ä¸€æ¬¡I/Oã€‚ B+æ ‘ B+Treeæ˜¯åœ¨B-TreeåŸºç¡€ä¸Šçš„ä¸€ç§ä¼˜åŒ–ï¼Œä½¿å…¶æ›´é€‚åˆå®ç°å¤–å­˜å‚¨ç´¢å¼•ç»“æ„ï¼ŒInnoDBå­˜å‚¨å¼•æ“å°±æ˜¯ç”¨B+Treeå®ç°å…¶ç´¢å¼•ç»“æ„ã€‚ ä»ä¸Šä¸€èŠ‚ä¸­çš„B-Treeç»“æ„å›¾ä¸­å¯ä»¥çœ‹åˆ°æ¯ä¸ªèŠ‚ç‚¹ä¸­ä¸ä»…åŒ…å«æ•°æ®çš„keyå€¼ï¼Œè¿˜æœ‰dataå€¼ã€‚è€Œæ¯ä¸€ä¸ªé¡µçš„å­˜å‚¨ç©ºé—´æ˜¯æœ‰é™çš„ï¼Œå¦‚æœdataæ•°æ®è¾ƒå¤§æ—¶å°†ä¼šå¯¼è‡´æ¯ä¸ªèŠ‚ç‚¹ï¼ˆå³ä¸€ä¸ªé¡µï¼‰èƒ½å­˜å‚¨çš„keyçš„æ•°é‡å¾ˆå°ï¼Œå½“å­˜å‚¨çš„æ•°æ®é‡å¾ˆå¤§æ—¶åŒæ ·ä¼šå¯¼è‡´B-Treeçš„æ·±åº¦è¾ƒå¤§ï¼Œå¢å¤§æŸ¥è¯¢æ—¶çš„ç£ç›˜I/Oæ¬¡æ•°ï¼Œè¿›è€Œå½±å“æŸ¥è¯¢æ•ˆç‡ã€‚åœ¨B+Treeä¸­ï¼Œæ‰€æœ‰æ•°æ®è®°å½•èŠ‚ç‚¹éƒ½æ˜¯æŒ‰ç…§é”®å€¼å¤§å°é¡ºåºå­˜æ”¾åœ¨åŒä¸€å±‚çš„å¶å­èŠ‚ç‚¹ä¸Šï¼Œè€Œéå¶å­èŠ‚ç‚¹ä¸Šåªå­˜å‚¨keyå€¼ä¿¡æ¯ï¼Œè¿™æ ·å¯ä»¥å¤§å¤§åŠ å¤§æ¯ä¸ªèŠ‚ç‚¹å­˜å‚¨çš„keyå€¼æ•°é‡ï¼Œé™ä½B+Treeçš„é«˜åº¦ã€‚ B+Treeç›¸å¯¹äºB-Treeæœ‰å‡ ç‚¹ä¸åŒï¼š éå¶å­èŠ‚ç‚¹åªå­˜å‚¨é”®å€¼ä¿¡æ¯ã€‚ æ‰€æœ‰å¶å­èŠ‚ç‚¹ä¹‹é—´éƒ½æœ‰ä¸€ä¸ªé“¾æŒ‡é’ˆã€‚ æ•°æ®è®°å½•éƒ½å­˜æ”¾åœ¨å¶å­èŠ‚ç‚¹ä¸­ã€‚ å°†ä¸Šä¸€èŠ‚ä¸­çš„B-Treeä¼˜åŒ–ï¼Œç”±äºB+Treeçš„éå¶å­èŠ‚ç‚¹åªå­˜å‚¨é”®å€¼ä¿¡æ¯ï¼Œå‡è®¾æ¯ä¸ªç£ç›˜å—èƒ½å­˜å‚¨4ä¸ªé”®å€¼åŠæŒ‡é’ˆä¿¡æ¯ï¼Œåˆ™å˜æˆB+Treeåå…¶ç»“æ„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š é€šå¸¸åœ¨B+Treeä¸Šæœ‰ä¸¤ä¸ªå¤´æŒ‡é’ˆï¼Œä¸€ä¸ªæŒ‡å‘æ ¹èŠ‚ç‚¹ï¼Œå¦ä¸€ä¸ªæŒ‡å‘å…³é”®å­—æœ€å°çš„å¶å­èŠ‚ç‚¹ï¼Œè€Œä¸”æ‰€æœ‰å¶å­èŠ‚ç‚¹ï¼ˆå³æ•°æ®èŠ‚ç‚¹ï¼‰ä¹‹é—´æ˜¯ä¸€ç§é“¾å¼ç¯ç»“æ„ã€‚å› æ­¤å¯ä»¥å¯¹B+Treeè¿›è¡Œä¸¤ç§æŸ¥æ‰¾è¿ç®—ï¼šä¸€ç§æ˜¯å¯¹äºä¸»é”®çš„èŒƒå›´æŸ¥æ‰¾å’Œåˆ†é¡µæŸ¥æ‰¾ï¼Œå¦ä¸€ç§æ˜¯ä»æ ¹èŠ‚ç‚¹å¼€å§‹ï¼Œè¿›è¡ŒéšæœºæŸ¥æ‰¾ã€‚ å¯èƒ½ä¸Šé¢ä¾‹å­ä¸­åªæœ‰22æ¡æ•°æ®è®°å½•ï¼Œçœ‹ä¸å‡ºB+Treeçš„ä¼˜ç‚¹ï¼Œä¸‹é¢åšä¸€ä¸ªæ¨ç®—ï¼š InnoDBå­˜å‚¨å¼•æ“ä¸­é¡µçš„å¤§å°ä¸º16KBï¼Œä¸€èˆ¬è¡¨çš„ä¸»é”®ç±»å‹ä¸ºINTï¼ˆå ç”¨4ä¸ªå­—èŠ‚ï¼‰æˆ–BIGINTï¼ˆå ç”¨8ä¸ªå­—èŠ‚ï¼‰ï¼ŒæŒ‡é’ˆç±»å‹ä¹Ÿä¸€èˆ¬ä¸º4æˆ–8ä¸ªå­—èŠ‚ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸€ä¸ªé¡µï¼ˆB+Treeä¸­çš„ä¸€ä¸ªèŠ‚ç‚¹ï¼‰ä¸­å¤§æ¦‚å­˜å‚¨16KB/(8B+8B)=1Kä¸ªé”®å€¼ï¼ˆå› ä¸ºæ˜¯ä¼°å€¼ï¼Œä¸ºæ–¹ä¾¿è®¡ç®—ï¼Œè¿™é‡Œçš„Kå–å€¼ä¸ºã€–10ã€—3ï¼‰ã€‚ä¹Ÿå°±æ˜¯è¯´ä¸€ä¸ªæ·±åº¦ä¸º3çš„B+Treeç´¢å¼•å¯ä»¥ç»´æŠ¤103 * 10^3 * 10^3 = 10äº¿ æ¡è®°å½•ã€‚ å®é™…æƒ…å†µä¸­æ¯ä¸ªèŠ‚ç‚¹å¯èƒ½ä¸èƒ½å¡«å……æ»¡ï¼Œå› æ­¤åœ¨æ•°æ®åº“ä¸­ï¼ŒB+Treeçš„é«˜åº¦ä¸€èˆ¬éƒ½åœ¨24å±‚ã€‚MySQLçš„InnoDBå­˜å‚¨å¼•æ“åœ¨è®¾è®¡æ—¶æ˜¯å°†æ ¹èŠ‚ç‚¹å¸¸é©»å†…å­˜çš„ï¼Œä¹Ÿå°±æ˜¯è¯´æŸ¥æ‰¾æŸä¸€é”®å€¼çš„è¡Œè®°å½•æ—¶æœ€å¤šåªéœ€è¦13æ¬¡ç£ç›˜I/Oæ“ä½œã€‚ æ•°æ®åº“ä¸­çš„B+Treeç´¢å¼•å¯ä»¥åˆ†ä¸ºèšé›†ç´¢å¼•ï¼ˆclustered indexï¼‰å’Œè¾…åŠ©ç´¢å¼•ï¼ˆsecondary indexï¼‰ã€‚ä¸Šé¢çš„B+Treeç¤ºä¾‹å›¾åœ¨æ•°æ®åº“ä¸­çš„å®ç°å³ä¸ºèšé›†ç´¢å¼•ï¼Œèšé›†ç´¢å¼•çš„B+Treeä¸­çš„å¶å­èŠ‚ç‚¹å­˜æ”¾çš„æ˜¯æ•´å¼ è¡¨çš„è¡Œè®°å½•æ•°æ®ã€‚è¾…åŠ©ç´¢å¼•ä¸èšé›†ç´¢å¼•çš„åŒºåˆ«åœ¨äºè¾…åŠ©ç´¢å¼•çš„å¶å­èŠ‚ç‚¹å¹¶ä¸åŒ…å«è¡Œè®°å½•çš„å…¨éƒ¨æ•°æ®ï¼Œè€Œæ˜¯å­˜å‚¨ç›¸åº”è¡Œæ•°æ®çš„èšé›†ç´¢å¼•é”®ï¼Œå³ä¸»é”®ã€‚å½“é€šè¿‡è¾…åŠ©ç´¢å¼•æ¥æŸ¥è¯¢æ•°æ®æ—¶ï¼ŒInnoDBå­˜å‚¨å¼•æ“ä¼šéå†è¾…åŠ©ç´¢å¼•æ‰¾åˆ°ä¸»é”®ï¼Œç„¶åå†é€šè¿‡ä¸»é”®åœ¨èšé›†ç´¢å¼•ä¸­æ‰¾åˆ°å®Œæ•´çš„è¡Œè®°å½•æ•°æ® å±€éƒ¨æ€§åŸç†ä¸ç£ç›˜é¢„è¯» ç”±äºå­˜å‚¨ä»‹è´¨çš„ç‰¹æ€§ï¼Œç£ç›˜æœ¬èº«å­˜å–å°±æ¯”ä¸»å­˜æ…¢å¾ˆå¤šï¼Œå†åŠ ä¸Šæœºæ¢°è¿åŠ¨è€—è´¹ï¼Œç£ç›˜çš„å­˜å–é€Ÿ åº¦å¾€å¾€æ˜¯ä¸»å­˜çš„å‡ ç™¾åˆ†åˆ†ä¹‹ä¸€ï¼Œå› æ­¤ä¸ºäº†æé«˜æ•ˆç‡ï¼Œè¦å°½é‡å‡å°‘ç£ç›˜I/Oã€‚ä¸ºäº†è¾¾åˆ°è¿™ä¸ªç›® çš„ï¼Œç£ç›˜å¾€å¾€ä¸æ˜¯ä¸¥æ ¼æŒ‰éœ€è¯»å–ï¼Œè€Œæ˜¯æ¯æ¬¡éƒ½ä¼šé¢„è¯»ï¼Œå³ä½¿åªéœ€è¦ä¸€ä¸ªå­—èŠ‚ï¼Œç£ç›˜ä¹Ÿä¼šä»è¿™ä¸ªä½ç½®å¼€å§‹ï¼Œé¡ºåºå‘åè¯»å–ä¸€å®šé•¿åº¦çš„æ•°æ®æ”¾å…¥å†…å­˜ã€‚è¿™æ ·åšçš„ç†è®ºä¾æ®æ˜¯è®¡ç®—æœºç§‘å­¦ä¸­è‘—åçš„**å±€éƒ¨æ€§åŸç†ï¼š**å½“ä¸€ä¸ªæ•°æ®è¢«ç”¨åˆ°æ—¶ï¼Œå…¶é™„è¿‘çš„æ•°æ®ä¹Ÿé€šå¸¸ä¼šé©¬ä¸Šè¢«ä½¿ç”¨ã€‚ç¨‹åºè¿è¡ŒæœŸé—´ æ‰€éœ€è¦çš„æ•°æ®é€šå¸¸æ¯”è¾ƒé›†ä¸­ã€‚ ç”±äºç£ç›˜é¡ºåºè¯»å–çš„æ•ˆç‡å¾ˆé«˜ï¼ˆä¸éœ€è¦å¯»é“æ—¶é—´ï¼Œåªéœ€å¾ˆå°‘çš„æ—‹è½¬æ—¶é—´ï¼‰ï¼Œå› æ­¤å¯¹äºå…·æœ‰å±€éƒ¨æ€§çš„ç¨‹åºæ¥è¯´ï¼Œé¢„è¯»å¯ä»¥æé«˜I/Oæ•ˆç‡ã€‚é¢„è¯»çš„é•¿åº¦ä¸€èˆ¬ä¸ºé¡µï¼ˆpageï¼‰çš„æ•´å€æ•°ã€‚é¡µæ˜¯è®¡ç®—æœºç®¡ç†å­˜å‚¨å™¨çš„é€»è¾‘å—ï¼Œç¡¬ä»¶åŠæ“ä½œç³»ç»Ÿ å¾€å¾€å°†ä¸»å­˜å’Œç£ç›˜å­˜å‚¨åŒºåˆ†å‰²ä¸ºè¿ç»­çš„å¤§å°ç›¸ç­‰çš„å—ï¼Œæ¯ä¸ªå­˜å‚¨å—ç§°ä¸ºä¸€é¡µï¼ˆåœ¨è®¸å¤šæ“ä½œç³» ç»Ÿä¸­ï¼Œé¡µå¾—å¤§å°é€šå¸¸ä¸º4kï¼‰ï¼Œä¸»å­˜å’Œç£ç›˜ä»¥é¡µä¸ºå•ä½äº¤æ¢æ•°æ®ã€‚å½“ç¨‹åºè¦è¯»å–çš„æ•°æ®ä¸åœ¨ä¸»å­˜ä¸­æ—¶ï¼Œä¼šè§¦å‘ä¸€ä¸ªç¼ºé¡µå¼‚å¸¸ï¼Œæ­¤æ—¶ç³»ç»Ÿä¼šå‘ç£ç›˜å‘å‡ºè¯»ç›˜ä¿¡å·ï¼Œç£ç›˜ä¼šæ‰¾åˆ°æ•°æ®çš„èµ·å§‹ä½ç½®å¹¶å‘åè¿ç»­è¯»å–ä¸€é¡µæˆ–å‡ é¡µè½½å…¥å†…å­˜ä¸­ï¼Œç„¶åå¼‚å¸¸è¿”å›ï¼Œç¨‹åºç»§ç»­è¿è¡Œã€‚ å¸¸è§å¤§è¡¨çš„ä¼˜åŒ–æ‰‹æ®µ å½“MySQLå•è¡¨è®°å½•æ•°è¿‡å¤§æ—¶ï¼Œæ•°æ®åº“çš„CRUDæ€§èƒ½ä¼šæ˜æ˜¾ä¸‹é™ï¼Œä¸€äº›å¸¸è§çš„ä¼˜åŒ–æªæ–½å¦‚ä¸‹ï¼š é™å®šæ•°æ®çš„èŒƒå›´ åŠ¡å¿…ç¦æ­¢ä¸å¸¦ä»»ä½•é™åˆ¶æ•°æ®èŒƒå›´æ¡ä»¶çš„æŸ¥è¯¢è¯­å¥ã€‚æ¯”å¦‚ï¼šæˆ‘ä»¬å½“ç”¨æˆ·åœ¨æŸ¥è¯¢è®¢å•å†å²çš„æ—¶ å€™ï¼Œæˆ‘ä»¬å¯ä»¥æ§åˆ¶åœ¨ä¸€ä¸ªæœˆçš„èŒƒå›´å†…ã€‚ è¯»å†™åˆ†ç¦» ç»å…¸çš„æ•°æ®åº“æ‹†åˆ†æ–¹æ¡ˆï¼Œä¸»åº“è´Ÿè´£å†™ï¼Œä»åº“è´Ÿè´£è¯»ã€‚ å‚ç›´åˆ†åŒº æ ¹æ®æ•°æ®åº“é‡Œé¢æ•°æ®è¡¨çš„ç›¸å…³æ€§è¿›è¡Œæ‹†åˆ†ã€‚ ä¾‹å¦‚ï¼Œç”¨æˆ·è¡¨ä¸­æ—¢æœ‰ç”¨æˆ·çš„ç™»å½•ä¿¡æ¯åˆæœ‰ç”¨æˆ·çš„åŸºæœ¬ä¿¡ æ¯ï¼Œå¯ä»¥å°†ç”¨æˆ·è¡¨æ‹†åˆ†æˆä¸¤ä¸ªå•ç‹¬çš„è¡¨ï¼Œç”šè‡³æ”¾åˆ°å•ç‹¬çš„åº“åšåˆ†åº“ã€‚ç®€å•æ¥è¯´å‚ç›´æ‹†åˆ†æ˜¯æŒ‡æ•°æ®è¡¨åˆ—çš„æ‹†åˆ†ï¼Œ æŠŠä¸€å¼ åˆ—æ¯”è¾ƒå¤šçš„è¡¨æ‹†åˆ†ä¸ºå¤šå¼ è¡¨ã€‚ å‚ç›´æ‹†åˆ†çš„ä¼˜ç‚¹ï¼š å¯ä»¥ä½¿å¾—è¡Œæ•°æ®å˜å°ï¼Œåœ¨æŸ¥è¯¢æ—¶å‡å°‘è¯»å–çš„Blockæ•°ï¼Œå‡å°‘I/Oæ¬¡æ•°ã€‚æ­¤å¤–ï¼Œå‚ç›´åˆ†åŒºå¯ä»¥ç®€ åŒ–è¡¨çš„ç»“æ„ï¼Œæ˜“äºç»´æŠ¤ã€‚å‚ç›´æ‹†åˆ†çš„ç¼ºç‚¹ï¼š ä¸»é”®ä¼šå‡ºç°å†—ä½™ï¼Œéœ€è¦ç®¡ç†å†—ä½™åˆ—ï¼Œå¹¶ä¼šå¼•èµ·Joinæ“ä½œï¼Œå¯ä»¥é€šè¿‡ åœ¨åº”ç”¨å±‚è¿›è¡ŒJoinæ¥è§£å†³ã€‚æ­¤å¤–ï¼Œå‚ç›´åˆ†åŒºä¼šè®©äº‹åŠ¡å˜å¾—æ›´åŠ å¤æ‚ï¼› æ°´å¹³åˆ†åŒº ä¿æŒæ•°æ®è¡¨ç»“æ„ä¸å˜ï¼Œé€šè¿‡æŸç§ç­–ç•¥å­˜å‚¨æ•°æ®åˆ†ç‰‡ã€‚è¿™æ ·æ¯ä¸€ç‰‡æ•°æ®åˆ†æ•£åˆ°ä¸åŒçš„è¡¨æˆ–è€…åº“ä¸­ï¼Œè¾¾ åˆ°äº†åˆ†å¸ƒå¼çš„ç›®çš„ã€‚ æ°´å¹³æ‹†åˆ†å¯ä»¥æ”¯æ’‘éå¸¸å¤§çš„æ•°æ®é‡ã€‚ æ°´å¹³æ‹†åˆ†æ˜¯æŒ‡æ•°æ®è¡¨è¡Œçš„æ‹†åˆ†ï¼Œè¡¨çš„è¡Œæ•°è¶…è¿‡200ä¸‡ è¡Œæ—¶ï¼Œå°±ä¼šå˜æ…¢ï¼Œè¿™æ—¶å¯ä»¥æŠŠä¸€å¼ çš„è¡¨çš„æ•°æ®æ‹†æˆå¤šå¼ è¡¨æ¥å­˜æ”¾ã€‚ä¸¾ä¸ªä¾‹å­ï¼šæˆ‘ä»¬å¯ä»¥å°†ç”¨æˆ·ä¿¡æ¯è¡¨æ‹†åˆ†æˆå¤š ä¸ªç”¨æˆ·ä¿¡æ¯è¡¨ï¼Œè¿™æ ·å°±å¯ä»¥é¿å…å•ä¸€è¡¨æ•°æ®é‡è¿‡å¤§å¯¹æ€§èƒ½é€ æˆå½±å“ã€‚ æ°´å¹³æ‹†åˆ†å¯ä»¥æ”¯æŒéå¸¸å¤§çš„æ•°æ®é‡ã€‚éœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯:åˆ†è¡¨ä»…ä»…æ˜¯è§£å†³äº†å•ä¸€è¡¨æ•°æ®è¿‡å¤§çš„é—®é¢˜ï¼Œä½†ç”±äºè¡¨çš„ æ•°æ®è¿˜æ˜¯åœ¨åŒä¸€å°æœºå™¨ä¸Šï¼Œå…¶å®å¯¹äºæå‡MySQLå¹¶å‘èƒ½åŠ›æ²¡æœ‰ä»€ä¹ˆæ„ä¹‰ï¼Œæ‰€ä»¥ æ°´å¹³æ‹†åˆ†æœ€å¥½åˆ†åº“ ã€‚æ°´å¹³æ‹†åˆ†èƒ½ å¤Ÿ æ”¯æŒéå¸¸å¤§çš„æ•°æ®é‡å­˜å‚¨ï¼Œåº”ç”¨ç«¯æ”¹é€ ä¹Ÿå°‘ï¼Œä½† åˆ†ç‰‡äº‹åŠ¡éš¾ä»¥è§£å†³ ï¼Œè·¨ç•Œç‚¹Joinæ€§èƒ½è¾ƒå·®ï¼Œé€»è¾‘å¤æ‚ã€‚ ã€ŠJavaå·¥ç¨‹å¸ˆä¿®ç‚¼ä¹‹é“ã€‹çš„ä½œè€…æ¨è å°½é‡ä¸è¦å¯¹æ•°æ®è¿›è¡Œåˆ†ç‰‡ï¼Œå› ä¸ºæ‹†åˆ†ä¼šå¸¦æ¥é€»è¾‘ã€éƒ¨ç½²ã€è¿ç»´çš„å„ç§å¤æ‚ åº¦ ï¼Œä¸€èˆ¬çš„æ•°æ®è¡¨åœ¨ä¼˜åŒ–å¾—å½“çš„æƒ…å†µä¸‹æ”¯æ’‘åƒä¸‡ä»¥ä¸‹çš„æ•°æ®é‡æ˜¯æ²¡æœ‰å¤ªå¤§é—®é¢˜çš„ã€‚å¦‚æœå®åœ¨è¦åˆ†ç‰‡ï¼Œå°½é‡é€‰æ‹© å®¢æˆ·ç«¯åˆ†ç‰‡æ¶æ„ï¼Œè¿™æ ·å¯ä»¥å‡å°‘ä¸€æ¬¡å’Œä¸­é—´ä»¶çš„ç½‘ç»œI/Oã€‚ æ•°æ®åº“åˆ†ç‰‡çš„ä¸¤ç§å¸¸è§æ–¹æ¡ˆ å®¢æˆ·ç«¯ä»£ç†ï¼š åˆ†ç‰‡é€»è¾‘åœ¨åº”ç”¨ç«¯ï¼Œå°è£…åœ¨jaråŒ…ä¸­ï¼Œé€šè¿‡ä¿®æ”¹æˆ–è€…å°è£…JDBCå±‚æ¥å®ç°ã€‚ å½“å½“ç½‘çš„ ShardingJDBC ã€é˜¿é‡Œçš„TDDLæ˜¯ä¸¤ç§æ¯”è¾ƒå¸¸ç”¨çš„å®ç°ã€‚ ä¸­é—´ä»¶ä»£ç†ï¼š åœ¨åº”ç”¨å’Œæ•°æ®ä¸­é—´åŠ äº†ä¸€ä¸ªä»£ç†å±‚ã€‚åˆ†ç‰‡é€»è¾‘ç»Ÿä¸€ç»´æŠ¤åœ¨ä¸­é—´ä»¶æœåŠ¡ä¸­ã€‚ æˆ‘ä»¬ç°åœ¨è°ˆçš„ Mycat ã€360çš„Atlasã€ç½‘æ˜“çš„DDBç­‰ç­‰éƒ½æ˜¯è¿™ç§æ¶æ„çš„å®ç°ã€‚ Sqlæ³¨å…¥å’Œé˜²æ³¨å…¥ Sqlæ³¨å…¥ ç®€ä»‹ SQLæ³¨å…¥æ˜¯æ¯”è¾ƒå¸¸è§çš„ç½‘ç»œæ”»å‡»æ–¹å¼ä¹‹ä¸€ï¼Œå®ƒä¸æ˜¯åˆ©ç”¨æ“ä½œç³»ç»Ÿçš„BUGæ¥å®ç°æ”»å‡»ï¼Œè€Œæ˜¯é’ˆå¯¹ç¨‹åºå‘˜ç¼–ç¨‹æ—¶çš„ç–å¿½ï¼Œé€šè¿‡SQLè¯­å¥ï¼Œå®ç°æ— å¸å·ç™»å½•ï¼Œç”šè‡³ç¯¡æ”¹æ•°æ®åº“ã€‚ SQLæ³¨å…¥æ”»å‡»çš„æ€»ä½“æ€è·¯ 1.å¯»æ‰¾åˆ°SQLæ³¨å…¥çš„ä½ç½® 2.åˆ¤æ–­æœåŠ¡å™¨ç±»å‹å’Œåå°æ•°æ®åº“ç±»å‹ 3.é’ˆå¯¹ä¸é€šçš„æœåŠ¡å™¨å’Œæ•°æ®åº“ç‰¹ç‚¹è¿›è¡ŒSQLæ³¨å…¥æ”»å‡» SQLæ³¨å…¥æ”»å‡»å®ä¾‹ æ¯”å¦‚åœ¨ä¸€ä¸ªç™»å½•ç•Œé¢ï¼Œè¦æ±‚è¾“å…¥ç”¨æˆ·åå’Œå¯†ç ï¼š å¯ä»¥è¿™æ ·è¾“å…¥å®ç°å…å¸å·ç™»å½•ï¼š ç”¨æˆ·åï¼š â€˜or 1 = 1 â€“ å¯† ç ï¼š ç‚¹ç™»é™†,å¦‚è‹¥æ²¡æœ‰åšç‰¹æ®Šå¤„ç†,é‚£ä¹ˆè¿™ä¸ªéæ³•ç”¨æˆ·å°±å¾ˆå¾—æ„çš„ç™»é™†è¿›å»äº†.(å½“ç„¶ç°åœ¨çš„æœ‰äº›è¯­è¨€çš„æ•°æ®åº“APIå·²ç»å¤„ç†äº†è¿™äº›é—®é¢˜)è¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢? ä¸‹é¢æˆ‘ä»¬åˆ†æä¸€ä¸‹ï¼šä»ç†è®ºä¸Šè¯´ï¼Œåå°è®¤è¯ç¨‹åºä¸­ä¼šæœ‰å¦‚ä¸‹çš„SQLè¯­å¥ï¼š String sql = &quot;select * from user_table where username=' &quot;+userName+&quot; ' and password=' &quot;+password+&quot; '&quot;; //å½“è¾“å…¥äº†ä¸Šé¢çš„ç”¨æˆ·åå’Œå¯†ç ï¼Œä¸Šé¢çš„SQLè¯­å¥å˜æˆï¼š SELECT * FROM user_table WHERE username='â€™or 1 = 1 -- and password='â€™ åˆ†æSQLè¯­å¥ï¼š æ¡ä»¶åé¢username=â€or 1=1 ç”¨æˆ·åç­‰äº â€ æˆ–1=1 é‚£ä¹ˆè¿™ä¸ªæ¡ä»¶ä¸€å®šä¼šæˆåŠŸï¼›ç„¶ååé¢åŠ ä¸¤ä¸ª-ï¼Œè¿™æ„å‘³ç€æ³¨é‡Šï¼Œå®ƒå°†åé¢çš„è¯­å¥æ³¨é‡Šï¼Œè®©ä»–ä»¬ä¸èµ·ä½œç”¨ï¼Œè¿™æ ·è¯­å¥æ°¸è¿œéƒ½èƒ½æ­£ç¡®æ‰§è¡Œï¼Œç”¨æˆ·è½»æ˜“éª—è¿‡ç³»ç»Ÿï¼Œè·å–åˆæ³•èº«ä»½ã€‚è¿™è¿˜æ˜¯æ¯”è¾ƒæ¸©æŸ”çš„ï¼Œå¦‚æœæ˜¯æ‰§è¡ŒSELECT * FROM user_table WHEREusername='' ;DROP DATABASE (DB Name) --' and password='' â€¦.å…¶åæœå¯æƒ³è€ŒçŸ¥â€¦ é˜²æ³¨å…¥æ–¹æ³• é¢„ç¼–è¯‘è¯­å¥é›†ï¼ˆPreparedStatementï¼‰ é‡‡ç”¨é¢„ç¼–è¯‘è¯­å¥é›†ï¼Œå®ƒå†…ç½®äº†å¤„ç†SQLæ³¨å…¥çš„èƒ½åŠ›ï¼Œåªè¦ä½¿ç”¨å®ƒçš„setXXXæ–¹æ³•ä¼ å€¼å³å¯ã€‚ ä½¿ç”¨å¥½å¤„ï¼š (1).ä»£ç çš„å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§. (2).PreparedStatementå°½æœ€å¤§å¯èƒ½æé«˜æ€§èƒ½. (3).æœ€é‡è¦çš„ä¸€ç‚¹æ˜¯æå¤§åœ°æé«˜äº†å®‰å…¨æ€§.åŸç†ï¼š PreparedStatement preparedStatement =connection.prepareStatement(preSql); preparedStatement.setString(1, username); preparedStatement.setString(2, pwd); åŸç†ï¼š sqlæ³¨å…¥åªå¯¹sqlè¯­å¥çš„å‡†å¤‡(ç¼–è¯‘)è¿‡ç¨‹æœ‰ç ´åä½œç”¨ è€ŒPreparedStatementå·²ç»å‡†å¤‡å¥½äº†,æ‰§è¡Œé˜¶æ®µåªæ˜¯æŠŠè¾“å…¥ä¸²ä½œä¸ºæ•°æ®å¤„ç†, è€Œä¸å†å¯¹sqlè¯­å¥è¿›è¡Œè§£æ,å‡†å¤‡,å› æ­¤ä¹Ÿå°±é¿å…äº†sqlæ³¨å…¥é—®é¢˜. ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼è¿‡æ»¤ä¼ å…¥çš„å‚æ•° ä¸‹é¢æ˜¯å…·ä½“çš„æ­£åˆ™è¡¨è¾¾å¼ï¼š æ£€æµ‹SQL meta-charactersçš„æ­£åˆ™è¡¨è¾¾å¼ ï¼š /(%27)|(\\â€™)|(--)|(%23)|(#)/ix ä¿®æ­£æ£€æµ‹SQL meta-charactersçš„æ­£åˆ™è¡¨è¾¾å¼ ï¼š/((%3D)|(=))[^\\n]*((%27)|(\\â€™)|(--)|(%3B)|(ğŸ˜ƒ)/i å…¸å‹çš„SQL æ³¨å…¥æ”»å‡»çš„æ­£åˆ™è¡¨è¾¾å¼ ï¼š/\\w*((%27)|(\\â€™))((%6F)|o|(%4F))((%72)|r|(%52))/ix æ£€æµ‹SQLæ³¨å…¥ï¼ŒUNIONæŸ¥è¯¢å…³é”®å­—çš„æ­£åˆ™è¡¨è¾¾å¼ ï¼š/((%27)|(\\â€™))union/ix(%27)|(\\â€™) æ£€æµ‹MS SQL Server SQLæ³¨å…¥æ”»å‡»çš„æ­£åˆ™è¡¨è¾¾å¼ï¼š /exec(\\s|+)+(s|x)p\\w+/ix å­—ç¬¦ä¸²è¿‡æ»¤ è¿‡æ»¤æ‰ä¸€äº›æ•æ„Ÿç‰¹æ®Šå­—ç¬¦å…³é”®å­— String inj_str = &quot;'|and|exec|insert|select|delete|update| count|*|%|chr|mid|master|truncate|char|declare|;|or|-|+|,&quot;; String inj_stra[] = split(inj_str,&quot;|&quot;); ","link":"https://kily-007.github.io/post/ç¬”è®°-MySql/"},{"title":"æ ¼åŠ›ä¸€é¢é¢ç»","content":"è‡ªæˆ‘ä»‹ç» é¦–å…ˆä¸Šæ¥æ˜¯é¢è¯•å®˜è‡ªæˆ‘ä»‹ç»ï¼Œç„¶åè®©æˆ‘è‡ªæˆ‘ä»‹ç»ï¼Œä¸»è¦è¯´äº†æ‰€åœ¨å®éªŒå®¤å’Œå¹³æ—¶æ‰€åšçš„ é¡¹ç›®ï¼Œåœ¨ä»‹ç»çš„è¿‡ç¨‹ä¸­æ¶‰åŠåˆ°äº†å¹³æ—¶æ‰€åšçš„é¡¹ç›®ï¼Œæˆ‘è¿™è¾¹ä¸»è¦æ˜¯hadoop+kafka+hbaseçš„å¤§æ•°æ®ç›¸å…³çš„å†…å®¹çš„ä¸€ä¸ªé¡¹ç›®å’Œå¾ˆä¹…ä»¥å‰åšçš„MVCæ¶æ„çš„é…’åº—ç®¡ç†ç³»ç»Ÿã€‚ ç”±é¡¹ç›®å±•å¼€è¯¦ç»†è¿½é—® ä¸»è¦åœ¨æˆ‘å™è¯´é¡¹ç›®è¿‡ç¨‹ä¸­ï¼Œä¼šæ—¶ä¸æ—¶çš„é—®åˆ°ç›¸å…³çš„ä¸“ä¸šçŸ¥è¯†å†…å®¹ã€‚æˆ‘è¿™é‡Œä¸»è¦è¢«é—®åˆ°æœ‰udpçš„æ•°æ®ä¼ è¾“åŸç†ï¼Œä»¥åŠä¸ºä»€ä¹ˆä½¿ç”¨è¿™æ ·çš„ä¸€ä¸ªåè®®ã€‚è¿™é‡Œå›ç­”ä¸ºUDPçš„å³æ—¶é€šè®¯åŸç†ï¼Œå’Œé¢å‘æ— è¿æ¥çš„è¦æ±‚é€Ÿåº¦å¿«çš„è¿™æ ·ä¸€ä¸ªåº”ç”¨åœºæ™¯ã€‚ kafkaæ•°æ®ä¼ è¾“åŸç† é—®ï¼šåŒ…å«æ•°æ®å¦‚ä½•æ‰“åŒ…ï¼Œkeyå€¼è®¾è®¡åŸç†ï¼Œä¼šé—®ä¸ºä»€ä¹ˆè¿™æ ·è®¾è®¡ï¼ŒåŒ…å«ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…å…·ä½“å¦‚ä½•å¯¹æ¥ã€‚ ç­”ï¼škafkaä»¥é”®å€¼å¯¹çš„å½¢å¼è¿›è¡Œæ•°æ®ä¼ è¾“ï¼Œå› ä¸ºæœ¬èº«kafkaæ˜¯ä¸€ä¸ªæ¶ˆæ¯é˜Ÿåˆ—æœºåˆ¶ï¼Œå› ä¸ºé¡¹ç›®ä¸­å¯¹åˆ†åŒºæ²¡æœ‰è¦æ±‚ï¼Œæ‰€ä»¥é‡‡ç”¨å•åˆ†åŒºçš„å½¢å¼ï¼Œkeyå€¼ä¸­è®¾è®¡ä¸ºæ•°æ®çš„å±æ€§ä¿¡æ¯ï¼Œkey=ä»ªè¡¨å·-é€šé“å·-æ—¶é—´æˆ³ï¼Œkeyå€¼é‡‡ç”¨stringç±»å‹è¿›è¡Œä¼ è¾“ï¼Œvalueä¸ºä¸€ä¸ªfloatç±»å‹æ•°ç»„ï¼Œåœ¨ä¼ è¾“å‰å°†floatæ•°ç»„è½¬ä¸ºbyteå­—èŠ‚ï¼Œé‡‡ç”¨å­—èŠ‚æµçš„å½¢å¼è¿›è¡Œä¼ è¾“ã€‚åœ¨æ¶ˆè´¹è€…ç«¯å¯¹keyå€¼è¿›è¡Œè§£æï¼ŒæŠŠvalueå€¼è§£æå›floatæ•°ç»„ï¼Œå…¶å®valueå€¼å°±æ˜¯ä¸€ä¸ªå…¸å‹åºåˆ—åŒ–çš„è¿‡ç¨‹ï¼Œæ¶ˆè´¹è€…ç«¯é€šè¿‡è§£ækeyå€¼å°†æ•°æ®valueå­˜å‚¨åˆ°ç›¸åº”çš„åœ°æ–¹ã€‚ hbaseéå…³ç³»å‹æ•°æ®åº“ ä¸»è¦æ¶‰åŠåˆ°hbaseçš„æŸ¥è¯¢ä¼˜åŒ–ä»¥åŠå¦‚ä½•é¿å…scanå…¨è¡¨æ‰«æç­–ç•¥ï¼Œæˆ‘è¿™é‡Œå›ç­”ä½¿ç”¨filterè¿‡æ»¤å™¨ï¼Œåœ¨é¢è¯•å®˜æé†’ä¸‹æƒ³èµ·æ¥æœ‰èµ·å§‹è¡Œstartrowå’Œç»“æŸè¡Œendrowå¯¹æ‰«é¢èŒƒå›´è¿›è¡Œé™å®šè¿™æ ·ä¸€ç§ç­–ç•¥ã€‚ è¿‡æ»¤å™¨åŒ…æ‹¬ï¼š è¡Œé”®è¿‡æ»¤å™¨ï¼šRowFilter åˆ—ç°‡è¿‡æ»¤å™¨ FamilyFilter åˆ—è¿‡æ»¤å™¨ QualifierFilter å€¼è¿‡æ»¤å™¨ ValueFilter æ—¶é—´æˆ³è¿‡æ»¤å™¨ TimestampsFilter å‰ç¼€è¿‡æ»¤å™¨ PrefixFilter----é’ˆå¯¹è¡Œé”® //è®¾ç½®å¼€å§‹è¡Œï¼ˆå‰ç¼€ï¼‰å’Œç»“æŸè¡Œï¼ˆå‰ç¼€ï¼‰ Scan scan = new Scan();//å…¨è¡¨æ‰«æå™¨ scan.setStartRow(&quot;startRowKey&quot;.getBytes()); scan.setStopRow(&quot;stopRowKey&quot;.getBytes()); hadoopä¸­æ¶‰åŠåˆ°çš„å®ˆæŠ¤è¿›ç¨‹ master: NameNode,SecondaryNameNode,ResourceManager slave1:DataNode,NodeManager slave2:DataNode,NodeManager è¯´è¯´å¯¹æ•°æ®åº“ä¸­äº‹åŠ¡çš„ç†è§£ è¿™ä¸ªè¿˜æ²¡å¤ä¹ åˆ°ï¼Œæ²¡ç­”ä¸Šæ¥ï¼Œä¸‹é¢è´´ç­”æ¡ˆï¼š äº‹åŠ¡ï¼šå°±æ˜¯è¢«ç»‘å®šåœ¨ä¸€èµ·ä½œä¸ºä¸€ä¸ªé€»è¾‘å·¥ä½œå•å…ƒçš„ SQL è¯­å¥åˆ†ç»„ï¼Œå¦‚æœä»»ä½•ä¸€ä¸ªè¯­å¥æ“ä½œå¤±è´¥é‚£ä¹ˆæ•´ä¸ªæ“ä½œå°±è¢«å¤±è´¥ï¼Œä»¥åæ“ä½œå°±ä¼šå›æ»šåˆ°æ“ä½œå‰çŠ¶æ€ï¼Œæˆ–è€…æ˜¯ä¸Šæœ‰ä¸ªèŠ‚ç‚¹ã€‚ä¸ºäº†ç¡®ä¿è¦ä¹ˆæ‰§è¡Œï¼Œè¦ä¹ˆä¸æ‰§è¡Œï¼Œå°±å¯ä»¥ä½¿ç”¨äº‹åŠ¡ã€‚è¦å°†æœ‰ç»„è¯­å¥ä½œä¸ºäº‹åŠ¡è€ƒè™‘ï¼Œå°±éœ€è¦é€šè¿‡ ACID æµ‹è¯•ï¼Œå³åŸå­æ€§ï¼Œä¸€è‡´æ€§ï¼Œéš”ç¦»æ€§å’ŒæŒä¹…æ€§ã€‚ é”ï¼šåœ¨æ‰€ä»¥çš„ DBMS ä¸­ï¼Œé”æ˜¯å®ç°äº‹åŠ¡çš„å…³é”®ï¼Œé”å¯ä»¥ä¿è¯äº‹åŠ¡çš„å®Œæ•´æ€§å’Œå¹¶å‘æ€§ã€‚ä¸ç°å®ç”Ÿæ´»ä¸­é”ä¸€æ ·ï¼Œå®ƒå¯ä»¥ä½¿æŸäº›æ•°æ®çš„æ‹¥æœ‰è€…ï¼Œåœ¨æŸæ®µæ—¶é—´å†…ä¸èƒ½ä½¿ç”¨æŸäº›æ•°æ®æˆ–æ•°æ®ç»“æ„ã€‚å½“ç„¶é”è¿˜åˆ†çº§åˆ«çš„ã€‚ äº‹åŠ¡å¿…é¡»æœä»ISO/IECæ‰€åˆ¶å®šçš„ACIOåŸåˆ™ï¼ŒACIOæ˜¯åŸå­æ€§ï¼ˆatomicityï¼‰ã€ä¸€è‡´æ€§ï¼ˆconsistencyï¼‰ã€éš”ç¦»æ€§ï¼ˆisolationï¼‰ã€æŒä¹…æ€§ï¼ˆdurabilityï¼‰çš„ç¼©å†™ã€‚ äº‹åŠ¡çš„åŸå­æ€§ï¼šè¡¨ç¤ºäº‹åŠ¡æ‰§è¡Œè¿‡ç¨‹ä¸­çš„ä»»ä½•å¤±è´¥éƒ½å°†å¯¼è‡´äº‹åŠ¡æ‰€åšçš„ä»»ä½•ä¿®æ”¹å¤±æ•ˆã€‚ äº‹åŠ¡çš„ä¸€è‡´æ€§ï¼šè¡¨ç¤ºå½“äº‹åŠ¡æ‰§è¡Œå¤±è´¥æ—¶ï¼Œæ‰€æœ‰è¢«è¯¥äº‹åŠ¡å½±å“çš„æ•°æ®éƒ½åº”è¯¥æ¢å¤åˆ°äº‹åŠ¡æ‰§è¡Œå‰çš„çŠ¶æ€ã€‚ äº‹åŠ¡çš„éš”ç¦»æ€§ï¼šè¡¨ç¤ºåœ¨äº‹åŠ¡æ‰§è¡Œè¿‡ç¨‹ä¸­å¯¹æ•°æ®çš„ä¿®æ”¹ï¼Œåœ¨äº‹åŠ¡æäº¤ä¹‹å‰å¯¹å…¶ä»–äº‹åŠ¡ä¸å¯è§ã€‚ äº‹åŠ¡çš„æŒä¹…æ€§ï¼šè¡¨ç¤ºå·²æäº¤çš„æ•°æ®åœ¨äº‹åŠ¡æ‰§è¡Œå¤±è´¥æ—¶ï¼Œæ•°æ®çš„çŠ¶æ€éƒ½åº”è¯¥æ˜¯æ­£ç¡®çš„ã€‚ äº‹åŠ¡å¹¶å‘æ“ä½œå¸¦æ¥çš„é—®é¢˜ 2ï¼‰è„è¯»ï¼š ä¸€ä¸ªäº‹åŠ¡è¯»å–äº†å¦ä¸€ä¸ªäº‹åŠ¡æœªæäº¤çš„æ•°æ®ã€‚ 3ï¼‰ä¸å¯é‡å¤è¯»ï¼šä¸€ä¸ªäº‹åŠ¡ä¸¤æ¬¡è¯»å–åŒä¸€ä¸ªæ•°æ®ï¼Œä¸¤æ¬¡è¯»å–çš„æ•°æ®ä¸ä¸€è‡´ã€‚ 4ï¼‰å¹»è±¡è¯»ï¼š ä¸€ä¸ªäº‹åŠ¡ä¸¤æ¬¡è¯»å–ä¸€ä¸ªèŒƒå›´çš„è®°å½•ï¼Œä¸¤æ¬¡è¯»å–çš„è®°å½•æ•°ä¸ä¸€è‡´ã€‚ æ•°æ®åº“è¿æ¥jdbcä¸­ï¼Œå¦‚ä½•å®ç°äº‹åŠ¡ å½“ä¸€ä¸ªè¿æ¥å¯¹è±¡è¢«åˆ›å»ºæ—¶é»˜è®¤æƒ…å†µä¸‹æ˜¯è‡ªåŠ¨æäº¤äº‹åŠ¡ï¼Œæ¯æ¬¡æ‰§è¡Œä¸€ä¸ªSQLè¯­å¥æ—¶ï¼Œå¦‚æœæ‰§è¡ŒæˆåŠŸï¼Œå°±ä¼šå‘æ•°æ®åº“è‡ªåŠ¨æäº¤ï¼Œè€Œä¸èƒ½å›æ»šï¼Œä¸ºäº†è®©å¤šä¸ªSQLè¯­å¥ä½œä¸ºä¸€ä¸ªäº‹åŠ¡æ‰§è¡Œï¼Œå¯ä½¿ç”¨ä¸€ä¸‹æ­¥éª¤ï¼š â€”â€”è°ƒç”¨Connectionå¯¹è±¡çš„setAutoCommit(false)ï¼Œä»¥å–æ¶ˆè‡ªåŠ¨æäº¤äº‹åŠ¡ã€‚ â€”â€”åœ¨æ‰€æœ‰çš„SQLè¯­å¥éƒ½æˆåŠŸæ‰§è¡Œåï¼Œè°ƒç”¨commitæ–¹æ³•æäº¤äº‹åŠ¡ã€‚ â€”â€”åœ¨å‡ºç°å¼‚å¸¸æ—¶ï¼Œè°ƒç”¨rollbackæ–¹æ³•ï¼Œäº‹åŠ¡å›æ»šã€‚ â€”â€”è‹¥æ­¤æ—¶Connecitonæ²¡æœ‰å…³é—­ï¼Œåˆ™éœ€è¦æ¢å¤å…¶è‡ªåŠ¨æäº¤çŠ¶æ€ã€‚ æ³¨æ„ï¼šè‹¥ä½¿ç”¨çš„æ•°æ®åº“å¼•æ“ä¸æ˜¯innodbï¼Œåˆ™äº‹åŠ¡æ— æ³•å›æ»šã€‚è€Œmysqlé»˜è®¤çš„æ•°æ®åº“å¼•æ“æ˜¯MyISAMï¼Œæ‰€ä»¥ç¬¬ä¸€æ¬¡ä½¿ç”¨äº‹åŠ¡åˆ™éœ€è¦æ›´æ”¹æ•°æ®è¡¨çš„å¼•æ“ã€‚ ","link":"https://kily-007.github.io/post/é¢ç»-æ ¼åŠ›ä¸€é¢é¢ç»/"},{"title":"ç¬”è®°-javaåŸºç¡€","content":"1 javaåŸºç¡€çŸ¥è¯† 1.2 é‡è½½å’Œé‡å†™çš„åŒºåˆ« é‡è½½ï¼šç›¸åŒçš„å‡½æ•°åï¼Œå‚æ•°ç±»å‹ä¸åŒ é‡å†™ï¼šå­ç±»é‡å†™çˆ¶ç±»æ–¹æ³•ï¼Œprivateä¿®é¥°çš„æ–¹æ³•ä¸èƒ½é‡å†™ 1.3 stringä¸stringbuildä¸stringBufferåŒºåˆ« String ä¸­ç”±finalä¿®é¥°çš„charæ•°ç»„å®ç°ï¼Œæ•…ä¸å¯å˜ï¼› stringBuildæ¯”stringBufferæ€§èƒ½å¥½ä¸€ä¸¢ä¸¢ï¼› StringBufferä¸ºçº¿ç¨‹å®‰å…¨çš„ï¼Œå…¶å¯¹æ–¹æ³•åŠ äº†åŒæ­¥é”æˆ–è€…å¯¹è°ƒç”¨æ–¹æ³•åŠ äº†åŒæ­¥é” 1.4 ==ä¸equals == åŸºæœ¬ç±»å‹æ¯”è¾ƒçš„æ˜¯å€¼ï¼Œå¯¹è±¡ï¼ˆå¼•ç”¨æ•°æ®ç±»å‹ï¼‰æ¯”è¾ƒçš„æ˜¯åœ°å€ï¼› equals() : æœªé‡å†™çš„equalsæ–¹æ³•å’Œ==ç­‰ä»·ï¼Œé‡å†™ä¹‹åçš„equalsæ¯”è¾ƒçš„æ˜¯å¯¹è±¡çš„å€¼æ˜¯å¦ç›¸ 1.41 ä¸ºä»€ä¹ˆé‡å†™equalsæ–¹æ³•ï¼Œä¸€å®šè¦é‡å†™HashCodeæ–¹æ³• å¦‚æœä½ é‡è½½äº†equalsï¼Œæ¯”å¦‚è¯´æ˜¯åŸºäºå¯¹è±¡çš„å†…å®¹å®ç°çš„ï¼Œè€Œä¿ç•™hashCodeçš„å®ç°ä¸å˜ï¼Œé‚£ä¹ˆå¾ˆå¯èƒ½æŸä¸¤ä¸ªå¯¹è±¡æ˜æ˜æ˜¯â€œç›¸ç­‰â€ï¼Œè€ŒhashCodeå´ä¸ä¸€æ ·ã€‚ è¿™æ ·ï¼Œå½“ä½ ç”¨å…¶ä¸­çš„ä¸€ä¸ªä½œä¸ºé”®ä¿å­˜åˆ°hashMapã€hasoTableæˆ–hashSetä¸­ï¼Œå†ä»¥â€œç›¸ç­‰çš„â€æ‰¾å¦ä¸€ä¸ªä½œä¸ºé”®å€¼å»æŸ¥æ‰¾ä»–ä»¬çš„æ—¶å€™ï¼Œåˆ™æ ¹æœ¬æ‰¾ä¸åˆ°ã€‚ ä½¿ç”¨HashMapï¼Œå¦‚æœkeyæ˜¯è‡ªå®šä¹‰çš„ç±»ï¼Œå°±å¿…é¡»é‡å†™hashcode()å’Œequals()ã€‚ è€Œå¯¹äºæ¯ä¸€ä¸ªå¯¹è±¡ï¼Œé€šè¿‡å…¶hashCode()æ–¹æ³•å¯ä¸ºå…¶ç”Ÿæˆä¸€ä¸ªæ•´å½¢å€¼ï¼ˆæ•£åˆ—ç ï¼‰ï¼Œè¯¥æ•´å‹å€¼è¢«å¤„ç†åï¼Œå°†ä¼šä½œä¸ºæ•°ç»„ä¸‹æ ‡ï¼Œå­˜æ”¾è¯¥å¯¹è±¡æ‰€å¯¹åº”çš„Entryï¼ˆå­˜æ”¾è¯¥å¯¹è±¡åŠå…¶å¯¹åº”å€¼ï¼‰ã€‚ equals()æ–¹æ³•åˆ™æ˜¯åœ¨HashMapä¸­æ’å…¥å€¼æˆ–æŸ¥è¯¢æ—¶ä¼šä½¿ç”¨åˆ°ã€‚å½“HashMapä¸­æ’å…¥å€¼æˆ–æŸ¥è¯¢å€¼å¯¹åº”çš„æ•£åˆ—ç ä¸æ•°ç»„ä¸­çš„æ•£åˆ—ç ç›¸ç­‰æ—¶ï¼Œåˆ™ä¼šé€šè¿‡equalsæ–¹æ³•æ¯”è¾ƒkeyå€¼æ˜¯å¦ç›¸ç­‰ï¼Œæ‰€ä»¥æƒ³ä»¥è‡ªå»ºå¯¹è±¡ä½œä¸ºHashMapçš„keyï¼Œå¿…é¡»é‡å†™è¯¥å¯¹è±¡ç»§æ‰¿objectçš„hashCodeå’Œequalsæ–¹æ³•ã€‚ 2.æœ¬æ¥ä¸å°±æœ‰hashcode()å’Œequals()äº†ä¹ˆï¼Ÿå¹²å˜›è¦é‡å†™ï¼Œç›´æ¥ç”¨åŸæ¥çš„ä¸è¡Œä¹ˆï¼Ÿ HashMapä¸­ï¼Œå¦‚æœè¦æ¯”è¾ƒkeyæ˜¯å¦ç›¸ç­‰ï¼Œè¦åŒæ—¶ä½¿ç”¨è¿™ä¸¤ä¸ªå‡½æ•°ï¼å› ä¸ºè‡ªå®šä¹‰çš„ç±»çš„hashcode()æ–¹æ³•ç»§æ‰¿äºObjectç±»ï¼Œå…¶hashcodeç ä¸ºé»˜è®¤çš„å†…å­˜åœ°å€ï¼Œè¿™æ ·å³ä¾¿æœ‰ç›¸åŒå«ä¹‰çš„ä¸¤ä¸ªå¯¹è±¡ï¼Œæ¯”è¾ƒä¹Ÿæ˜¯ä¸ç›¸ç­‰çš„ï¼Œä¾‹å¦‚ï¼Œç”Ÿæˆäº†ä¸¤ä¸ªâ€œç¾Šâ€å¯¹è±¡ï¼Œæ­£å¸¸ç†è§£è¿™ä¸¤ä¸ªå¯¹è±¡åº”è¯¥æ˜¯ç›¸ç­‰çš„ï¼Œä½†å¦‚æœä½ ä¸é‡å†™ hashcodeï¼ˆï¼‰æ–¹æ³•çš„è¯ï¼Œæ¯”è¾ƒæ˜¯ä¸ç›¸ç­‰çš„ï¼ HashMapä¸­çš„æ¯”è¾ƒkeyæ˜¯è¿™æ ·çš„ï¼Œå…ˆæ±‚å‡ºkeyçš„hashcode(),æ¯”è¾ƒå…¶å€¼æ˜¯å¦ç›¸ç­‰ï¼Œè‹¥ç›¸ç­‰å†æ¯”è¾ƒequals(),è‹¥ç›¸ç­‰åˆ™è®¤ä¸ºä»–ä»¬æ˜¯ç›¸ç­‰çš„ã€‚è‹¥equals()ä¸ç›¸ç­‰åˆ™è®¤ä¸ºä»–ä»¬ä¸ç›¸ç­‰ã€‚å¦‚æœåªé‡å†™hashcode()ä¸é‡å†™equals()æ–¹æ³•ï¼Œå½“æ¯”è¾ƒequals()æ—¶åªæ˜¯çœ‹ä»–ä»¬æ˜¯å¦ä¸ºåŒä¸€å¯¹è±¡ï¼ˆå³è¿›è¡Œå†…å­˜åœ°å€çš„æ¯”è¾ƒï¼‰,æ‰€ä»¥å¿…å®šè¦ä¸¤ä¸ªæ–¹æ³•ä¸€èµ·é‡å†™ã€‚HashMapç”¨æ¥åˆ¤æ–­keyæ˜¯å¦ç›¸ç­‰çš„æ–¹æ³•ï¼Œå…¶å®æ˜¯è°ƒç”¨äº†HashSetåˆ¤æ–­åŠ å…¥å…ƒç´ æ˜¯å¦ç›¸ç­‰ã€‚ 1.5 finalå…³é”®å­—çš„ä½¿ç”¨ï¼šå˜é‡ï¼Œæ–¹æ³•ï¼Œç±» å˜é‡ï¼šä¿®é¥°åŸºæœ¬æ•°æ®ç±»å‹ï¼Œåˆ™åˆå§‹åŒ–ä¹‹åä¸å¯æ›´æ”¹ï¼›ä¿®é¥°å¼•ç”¨ç±»å‹å˜é‡ï¼Œåˆ™åˆå§‹åŒ–ä¹‹åä¸èƒ½è®©å…¶æŒ‡å‘å¦ä¸€ä¸ªå¯¹è±¡ã€‚ æ–¹æ³•ï¼šé”å®šæ–¹æ³•ï¼Œä»¥é˜²ä»»ä½•ç»§æ‰¿ç±»ä¿®æ”¹ ç±»ï¼šè¡¨æ˜è¯¥ç±»ä¸èƒ½è¢«ç»§æ‰¿ï¼Œä¸”ç±»ä¸­æ‰€æœ‰æ–¹æ³•å‡è¢«éšå¼æŒ‡å®šä¸ºfinalæ–¹æ³• 1.6 objectç±»å¸¸è§æ–¹æ³• public final native Class&lt;?&gt; getClass() //ç”¨äºè¿”å›å½“å‰è¿è¡Œæ—¶å¯¹è±¡çš„calsså¯¹è±¡ public native int hashCode() //è¿”å›å¯¹è±¡hashç  public boolean equals(Object obj) //æ¯”è¾ƒä¿©ä¸ªå¯¹è±¡çš„å†…å­˜åœ°å€æ˜¯å¦ç›¸ç­‰ protected native Object clone() throws CloneNotSupportedExcception // public String toString() //è¿”å›ç±»å@å®ä¾‹çš„å“ˆå¸Œç çš„16è¿›åˆ¶çš„å­—ç¬¦ä¸² public final native void notify() //å”¤é†’ä¸€ä¸ªåœ¨æ­¤å¯¹è±¡ç›‘è§†å™¨ä¸Šç­‰å¾…çš„å¿åŸï¼Œå¦‚æœæœ‰å¤šä¸ªçº¿ç¨‹åœ¨ç­‰å¾…åªä¼šå”¤é†’ä¸€ä¸ª public final native void notifyAll() public final native void wait(long timeout) throws InterrupteException //æš‚åœçº¿ç¨‹çš„æ‰§è¡Œã€‚æ³¨æ„ï¼šsleepæ–¹æ³•æ²¡æœ‰é‡Šæ”¾é”ï¼Œwaitæ–¹æ³•é‡Šæ”¾äº†é” public final void wait(long timeout,int nanos) throws InterrupteException //nanosè¡¨ç¤ºé¢å¤–æ—¶é—´ public final void wait() throws InterrupteException //ä¸€ç›´ç­‰å¾…ï¼Œæ²¡æœ‰è¶…æ—¶æ¦‚å¿µ protected void finalize() throws Throwable { } //å®ä¾‹è¢«åƒåœ¾å›æ”¶å™¨å›æ”¶çš„æ—¶å€™è§¦å‘çš„æ“ä½œ 1.7 javaä¸­å¸¸è§å¼‚å¸¸ æ‰€æœ‰å¼‚å¸¸çš„å…±åŒç¥–å…ˆThrowableç±»ï¼Œå…¶ä¿©ä¸ªé‡è¦å­ç±»ï¼š Eceptionï¼ˆå¼‚å¸¸ï¼‰å’ŒErrorï¼ˆé”™è¯¯ï¼‰ Errorï¼šç¨‹åºæ— æ³•å¤„ç†çš„é”™è¯¯ï¼Œå¤§å¤šæ•°ä¸ç¼–ç è€…æ‰§è¡Œæ“ä½œæ— å…³ Exceptionï¼šç¨‹åºæœ¬èº«å¯ä»¥ å¤„ç†çš„å¼‚å¸¸ å¼‚å¸¸å¤„ç†ï¼šæ— è®ºå¼‚å¸¸æ˜¯å¦æ•è·æˆ–å¤„ç†ï¼Œfinallyå—é‡Œçš„è¯­å¥éƒ½ä¼šæ‰§è¡Œã€‚æŒ¡åœ¨tryæˆ–catchå—ä¸­é‡åˆ°returnè¯­å¥æ—¶ï¼Œfinallyè¯­å¥å—å°†åœ¨æ–¹æ³•è¿”å›ä¹‹å‰è¢«æ‰§è¡Œ æ³¨æ„ï¼šä»¥ä¸‹å››ç§ç‰¹æ®Šæƒ…å†µfinallyä¸ä¼šè¢«æ‰§è¡Œï¼š åœ¨finallyå—è¯­å¥ä¸­å‘ç”Ÿäº†å¼‚å¸¸ï¼› åœ¨å‰é¢çš„ä»£ç ä¸­ç”¨äº†System,exit()é€€å‡ºç¨‹åºï¼› ç¨‹åºååœ¨çº¿ç¨‹æ­»äº¡ï¼› å…³é—­CPUã€‚ 1.8 javaä¸­çš„ä¿©ç§è¾“å…¥å¸¸ç”¨æ–¹æ³• Scanner input = new Scanner(System.in); String s = input.nextLine(); input.close(); BufferedReader input = new BufferedReader(new InputStreamReader(System.in)); String s = input.readLine(); 1.9 æ¥å£å’ŒæŠ½è±¡ç±»çš„åŒºåˆ« ä¸€ä¸ªç±»å¯ä»¥å®ç°å¤šä¸ªæ¥å£ï¼›æ¥å£ä¸­çš„æ–¹æ³•åªæœ‰å£°æ˜ï¼Œä¸èƒ½å®ç°ï¼›è¦å®ç°æ¥å£ä¸­çš„æ‰€æœ‰æ–¹æ³•ï¼›æ¥å£ä¸­çš„å®ä¾‹å˜é‡é»˜è®¤æ˜¯finalç±»å‹çš„ æ¥å£ï¼šæ¥å£åªæœ‰æ–¹æ³•ä½“æ²¡æœ‰å…·ä½“çš„å®ç°ï¼Œç”¨interfaceä¿®é¥° ç‰¹ç‚¹ï¼š æ¥å£ä¸­æ²¡æœ‰è‡ªå·±çš„å±æ€§ï¼Œåªèƒ½æœ‰æ–¹æ³•ä½“ ç±»åœ¨å®ç°æ¥å£æ—¶ï¼Œå¯ä»¥å®ç°å¤šä¸ªæ¥å£ //æ¥å£ UserRightsService.java public interface UserRightsService { // è·å–æ•°æ®æ€»æ•° public int findUserRightsCount() throws Exception; // æ ¹æ®å¼€å§‹ä½ç½®ï¼Œæ¯é¡µè®°å½•æ•°æŸ¥æ‰¾ç”¨æˆ·åˆ—è¡¨ public List&lt;Userrights&gt; selectUserRightsList(int startPos, int pageSize) throws Exception; // æ ¹æ®ç”¨æˆ·æƒé™çš„idæŸ¥æ‰¾ä¸€æ¡æ•°æ® public Userrights findUserRightsById(int id) throws Exception; // æ ¹æ®idæ›´æ–°ä¸€æ¡æ•°æ® public void updateUserRightsById(int id, String username) throws Exception; // æ ¹æ®ä¼ è¿‡æ¥çš„å‚æ•°æŸ¥è¯¢å¯¹åº”å‚æ•°çš„æ•°æ® public String checkDataByParam(String param, String userloginid) throws Exception; } //å®ç°æ¥å£ UserRightsServiceImpl.java public class UserRightsServiceImpl implements UserRightsService { @Autowired private UserrightsVoMapper userrightsVoMapper; // è·å–æ•°æ®æ€»æ•° public int findUserRightsCount() throws Exception { return userrightsVoMapper.findUserRightsCount(); } // æ ¹æ®å¼€å§‹ä½ç½®ï¼Œæ¯é¡µè®°å½•æ•°æŸ¥æ‰¾ç”¨æˆ·åˆ—è¡¨ public List&lt;Userrights&gt; selectUserRightsList(int startPos, int pageSize) throws Exception { return userrightsVoMapper.selectUserRightsList(startPos, pageSize); } // æ ¹æ®ç”¨æˆ·æƒé™çš„idæŸ¥æ‰¾ä¸€æ¡æ•°æ® public Userrights findUserRightsById(int id) throws Exception { return userrightsVoMapper.findUserRightsById(id); } // æ ¹æ®idæ›´æ–°ä¸€æ¡æ•°æ® public void updateUserRightsById(int id,String username) throws Exception { userrightsVoMapper.updateUserRightsById(id,username); } // æ ¹æ®ä¼ è¿‡æ¥çš„å‚æ•°æŸ¥è¯¢å¯¹åº”å‚æ•°çš„æ•°æ® public String checkDataByParam(String param, String userloginid) throws Exception { return userrightsVoMapper.checkDataByParam(param, userloginid); } ä¸€ä¸ªç±»åªèƒ½å®ç°ä¸€ä¸ªæŠ½è±¡ç±»ï¼ŒæŠ½è±¡ç±»ä¸­å¯ä»¥æœ‰éæŠ½è±¡æ–¹æ³•ï¼› æŠ½è±¡ç±»ï¼šæŒ‡çš„æ˜¯ç”¨abstractå…³é”®å­—ä¿®é¥°æˆ–è€…ç±»ä¸­æœ‰æŠ½è±¡æ–¹æ³•ï¼Œé‚£ä¹ˆè¿™ä¸ªç±»å°±æ˜¯æŠ½è±¡ç±» ç‰¹ç‚¹ï¼š æŠ½è±¡ç±»ç”¨å…³é”®å­— abstractä¿®é¥° æŠ½è±¡ç±»çš„æŠ½è±¡æ–¹æ³•æ²¡æœ‰æ–¹æ³•ä½“ï¼Œåœ¨å­ç±»ç»§æ‰¿çˆ¶ç±»ä¸­æœ‰æŠ½è±¡æ–¹æ³•æ—¶ï¼Œå¿…é¡»å®ç°æŠ½åƒæ–¹æ³• æŠ½è±¡ç±»ä¸èƒ½è¢«å®ä¾‹åŒ– //æŠ½è±¡ç±» Employee.java public abstract class Employee{ private String name; private String address; private int number; /* å£°æ˜æŠ½è±¡æ–¹æ³•ä¼šé€ æˆä»¥ä¸‹ä¸¤ä¸ªç»“æœï¼š 1.å¦‚æœä¸€ä¸ªç±»åŒ…å«æŠ½è±¡æ–¹æ³•ï¼Œé‚£ä¹ˆè¯¥ç±»å¿…é¡»æ˜¯æŠ½è±¡ç±»ã€‚ 2.ä»»ä½•å­ç±»å¿…é¡»é‡å†™çˆ¶ç±»çš„æŠ½è±¡æ–¹æ³•ï¼Œæˆ–è€…å£°æ˜è‡ªèº«ä¸ºæŠ½è±¡ç±»ã€‚ */ public abstract double computePay(); public string getName(){ return name; } } //ç»§æ‰¿æŠ½è±¡ç±» Salary.java public class Salary extends Employee{ private double salary; // Annual salary //ä»»ä½•å­ç±»å¿…é¡»é‡å†™çˆ¶ç±»çš„æŠ½è±¡æ–¹æ³• public double computePay(){ System.out.println(&quot;Computing salary pay for &quot; + getName()); return salary/52; } } 1.10 (B)IOã€NIOã€AIO (B)IOï¼šåŒæ­¥é˜»å¡I/Oï¼ŒåŒæ­¥å¹¶é˜»å¡ï¼ŒæœåŠ¡å™¨å®ç°æ¨¡å¼ä¸ºä¸€ä¸ªè¿æ¥ä¸€ä¸ªçº¿ç¨‹ï¼Œå³å®¢æˆ·ç«¯æœ‰è¿æ¥è¯·æ±‚æ—¶æœåŠ¡å™¨ç«¯å°±éœ€è¦å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹è¿›è¡Œå¤„ç†ï¼Œå¦‚æœè¿™ä¸ªè¿æ¥ä¸åšä»»ä½•äº‹æƒ…ä¼šé€ æˆä¸å¿…è¦çš„çº¿ç¨‹å¼€é”€ï¼Œå½“ç„¶å¯ä»¥é€šè¿‡çº¿ç¨‹æ± æœºåˆ¶æ”¹å–„ã€‚å¹¶å‘å±€é™äºåº”ç”¨ä¸­ï¼Œåœ¨jdk1.4ä»¥å‰æ˜¯å”¯ä¸€çš„io NIOï¼šåŒæ­¥éé˜»å¡I/Oï¼ŒæœåŠ¡å™¨å®ç°æ¨¡å¼ä¸ºä¸€ä¸ªè¯·æ±‚ä¸€ä¸ªçº¿ç¨‹ï¼Œå³å®¢æˆ·ç«¯å‘é€çš„è¿æ¥è¯·æ±‚éƒ½ä¼šæ³¨å†Œåˆ°å¤šè·¯å¤ç”¨å™¨ä¸Šï¼Œå¤šè·¯å¤ç”¨å™¨è½®è¯¢åˆ°è¿æ¥æœ‰IOè¯·æ±‚æ—¶æ‰å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹è¿›è¡Œå¤„ç†ã€‚NIOæ–¹å¼é€‚ç”¨äºè¿æ¥æ•°ç›®å¤šä¸”è¿æ¥æ¯”è¾ƒçŸ­ï¼ˆè½»æ“ä½œï¼‰çš„æ¶æ„ï¼Œæ¯”å¦‚èŠå¤©æœåŠ¡å™¨ï¼Œå¹¶å‘å±€é™äºåº”ç”¨ä¸­ï¼Œç¼–ç¨‹æ¯”è¾ƒå¤æ‚ï¼Œjdk1,4å¼€å§‹æ”¯æŒã€‚ AIOï¼šå¼‚æ­¥éé˜»å¡I/Oï¼ŒæœåŠ¡å™¨å®ç°æ¨¡å¼ä¸ºä¸€ä¸ªæœ‰æ•ˆè¯·æ±‚ä¸€ä¸ªçº¿ç¨‹ï¼Œå®¢æˆ·ç«¯çš„IOè¯·æ±‚éƒ½æ˜¯ç”±æ“ä½œç³»ç»Ÿå…ˆå®Œæˆäº†å†é€šçŸ¥æœåŠ¡å™¨ç”¨å…¶å¯åŠ¨çº¿ç¨‹è¿›è¡Œå¤„ç†ã€‚AIOæ–¹å¼é€‚ç”¨äºè¿æ¥æ•°ç›®å¤šä¸”è¿æ¥æ¯”è¾ƒé•¿ï¼ˆé‡æ“ä½œï¼‰çš„æ¶æ„ï¼Œæ¯”å¦‚ç›¸å†ŒæœåŠ¡å™¨ï¼Œå……åˆ†è°ƒç”¨OSå‚ä¸å¹¶å‘æ“ä½œï¼Œç¼–ç¨‹æ¯”è¾ƒå¤æ‚ï¼Œjdk1.7å¼€å§‹æ”¯æŒ åŒæ­¥ï¼šå¦‚æœæœ‰å¤šä¸ªä»»åŠ¡æˆ–è€…äº‹ä»¶è¦å‘ç”Ÿï¼Œè¿™äº›ä»»åŠ¡æˆ–è€…äº‹ä»¶å¿…é¡»é€ä¸ªåœ°è¿›è¡Œï¼Œä¸€ä¸ªäº‹ä»¶æˆ–è€…ä»»åŠ¡çš„æ‰§è¡Œä¼šå¯¼è‡´æ•´ä¸ªæµç¨‹çš„æš‚æ—¶ç­‰å¾…ï¼Œè¿™äº›äº‹ä»¶æ²¡æœ‰åŠæ³•å¹¶å‘åœ°æ‰§è¡Œï¼› å¼‚æ­¥ï¼šå¦‚æœæœ‰å¤šä¸ªä»»åŠ¡æˆ–è€…äº‹ä»¶å‘ç”Ÿï¼Œè¿™äº›äº‹ä»¶å¯ä»¥å¹¶å‘åœ°æ‰§è¡Œï¼Œä¸€ä¸ªäº‹ä»¶æˆ–è€…ä»»åŠ¡çš„æ‰§è¡Œä¸ä¼šå¯¼è‡´æ•´ä¸ªæµç¨‹çš„æš‚æ—¶ç­‰å¾…ã€‚ é˜»å¡ / éé˜»å¡æè¿°çš„æ˜¯å‡½æ•°ï¼ŒæŒ‡è®¿é—®æŸä¸ªå‡½æ•°æ—¶æ˜¯å¦ä¼šé˜»å¡çº¿ç¨‹(blockï¼Œçº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€)ã€‚ åŒæ­¥ /å¼‚æ­¥æè¿°çš„æ˜¯æ‰§è¡ŒIOæ“ä½œçš„ä¸»ä½“æ˜¯è°ï¼ŒåŒæ­¥æ˜¯ç”±ç”¨æˆ·è¿›ç¨‹è‡ªå·±å»æ‰§è¡Œæœ€ç»ˆçš„IOæ“ä½œã€‚å¼‚æ­¥æ˜¯ç”¨æˆ·è¿›ç¨‹è‡ªå·±ä¸å…³ç³»å®é™…IOæ“ä½œçš„è¿‡ç¨‹ï¼Œåªéœ€è¦ç”±å†…æ ¸åœ¨IOå®Œæˆåé€šçŸ¥å®ƒæ—¢å¯ï¼Œç”±å†…æ ¸è¿›ç¨‹æ¥æ‰§è¡Œæœ€ç»ˆçš„IOæ“ä½œã€‚ https://blog.csdn.net/z15732621582/article/details/78939122?tdsourcetag=s_pctim_aiomsg 1 ) å¼‚æ­¥éé˜»å¡ä¾‹å­:(ç½‘ä¸Šçœ‹åˆ°çš„æ¯”è¾ƒçŸ­å°ç²¾æ‚çš„å¥½ä¾‹å­,ç›´æ¥æ‹¿è¿‡æ¥äº†)è€å¼ çˆ±å–èŒ¶ï¼ŒåºŸè¯ä¸è¯´ï¼Œç…®å¼€æ°´ã€‚ å‡ºåœºäººç‰©ï¼šè€å¼ ï¼Œæ°´å£¶ä¸¤æŠŠï¼ˆæ™®é€šæ°´å£¶ï¼Œç®€ç§°æ°´å£¶ï¼›ä¼šå“çš„æ°´å£¶ï¼Œç®€ç§°å“æ°´å£¶ï¼‰ã€‚ 1 è€å¼ æŠŠæ°´å£¶æ”¾åˆ°ç«ä¸Šï¼ŒåŸåœ°ä¸åŠ¨ç­‰æ°´å¼€ã€‚ï¼ˆåŒæ­¥é˜»å¡ï¼‰ ----------&gt;è€å¼ è§‰å¾—è‡ªå·±æœ‰ç‚¹å‚» 2 è€å¼ æŠŠæ°´å£¶æ”¾åˆ°ç«ä¸Šï¼Œå»å®¢å…çœ‹æ¯›éª—ï¼Œæ—¶ä¸æ—¶å»çœ‹çœ‹æ°´å¼€æ²¡æœ‰ã€‚ï¼ˆåŒæ­¥éé˜»å¡ï¼‰ ----------&gt;è€å¼ è§‰å¾—è‡ªå·±æœ‰ç‚¹å‚» äºæ˜¯å˜é«˜ç«¯äº†ï¼Œä¹°äº†æŠŠä¼šå“ç¬›çš„é‚£ç§æ°´å£¶ã€‚æ°´å¼€ä¹‹åï¼Œèƒ½å¤§å£°å‘å‡ºå˜€~~~~çš„å“å£°ã€‚ 3 è€å¼ æŠŠå“æ°´å£¶æ”¾åˆ°ç«ä¸Šï¼Œç«‹ç­‰æ°´å¼€ã€‚ï¼ˆå¼‚æ­¥é˜»å¡ï¼‰ ---------&gt;è€å¼ è§‰å¾—è‡ªå·±æœ‰ç‚¹å‚» 4 è€å¼ æŠŠå“æ°´å£¶æ”¾åˆ°ç«ä¸Šï¼Œå»å®¢å…çœ‹æ¯›éª—ï¼Œæ°´å£¶å“ä¹‹å‰ä¸å†å»çœ‹å®ƒï¼Œå“äº†å†å»æ‹¿å£¶ã€‚ï¼ˆå¼‚æ­¥éé˜»å¡ï¼‰ ----------&gt;å—¯,è€å¼ è§‰å¾—è‡ªå·±æ£’æ£’å“’ 2 javaå®¹å™¨ 2.1 Arraylistä¸LinkListçš„å¼‚åŒ ArrayListåˆå§‹åŒ–é•¿åº¦ä¸º10ï¼Œæ¯æ¬¡æ‰©å®¹ä¸ºåŸæ¥çš„1.5å€ã€‚ å‡ä¸ºçº¿ç¨‹ä¸å®‰å…¨çš„ Arrayliståº•å±‚é‡‡ç”¨Objectæ•°ç»„å®ç°ï¼›LinkedListé‡‡ç”¨åŒå‘é“¾è¡¨æ•°æ®ç»“æ„å®ç° Arraylistæ’å…¥é»˜è®¤è¿½åŠ åˆ°æœ«å°¾ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(1)ï¼Œè‹¥æ’å…¥åˆ°æŒ‡å®šä½ç½®ï¼Œå°±éœ€è¦å°†æŒ‡å®šä½ç½®åçš„æ‰€æœ‰å…ƒç´ åç§»ä¸€ä½ï¼›LinkListæ’å…¥æ—¶é—´å¤æ‚æ’ä¸ºO(1) å¿«é€Ÿéšæœºè®¿é—® ç©ºé—´å ç”¨ //RandomAccessæ¥å£ä¸­ä»€ä¹ˆéƒ½æ²¡æœ‰å®šä¹‰ï¼Œå¯ä»¥ç†è§£ä¸ºä¸€ä¸ªæ˜¯å¦å…·æœ‰éšæœºè®¿é—®åŠŸèƒ½çš„æ ‡è¯† public interface RandomAccess{ } è¿­ä»£å™¨æ¨¡å¼ï¼šå°±æ˜¯æä¾›ä¸€ç§æ–¹æ³•å¯¹ä¸€ä¸ªå®¹å™¨å¯¹è±¡ä¸­çš„å„ä¸ªå…ƒç´ è¿›è¡Œè®¿é—®ï¼Œè€Œåˆä¸æš´éœ²è¯¥å¯¹è±¡å®¹å™¨çš„å†…éƒ¨ç»†èŠ‚ã€‚ 2.2 Vectorç±» Vectorç±»å’ŒArrayListç±»ä¼¼ï¼Œéƒ½æ˜¯ç”±åŠ¨æ€æ•°ç»„å®ç°ï¼› æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå®ƒçš„æ–¹æ³•ä¹‹é—´æ˜¯çº¿ç¨‹åŒæ­¥çš„ã€‚ Vectoræ‰©å®¹æ—¶å¢é•¿ä¸ºåŸæ¥çš„2å€ï¼ŒArrayListæ‰©å®¹ä¸ºåŸæ¥çš„1.5å€ 2.3 hashmap JDK1.8 ä¹‹å‰ HashMap åº•å±‚æ˜¯ æ•°ç»„å’Œé“¾è¡¨ ç»“åˆåœ¨ä¸€èµ·ä½¿ç”¨ä¹Ÿå°±æ˜¯ é“¾è¡¨æ•£åˆ—ã€‚HashMap é€šè¿‡ key çš„ hashCode ç» è¿‡æ‰°åŠ¨å‡½æ•°å¤„ç†è¿‡åå¾—åˆ° hash å€¼ï¼Œç„¶åé€šè¿‡ (n - 1) &amp; hash åˆ¤æ–­å½“å‰å…ƒç´ å­˜æ”¾çš„ä½ç½®ï¼ˆè¿™é‡Œçš„ n æŒ‡çš„æ˜¯æ•°ç»„çš„ é•¿åº¦ï¼‰ï¼Œå¦‚æœå½“å‰ä½ç½®å­˜åœ¨å…ƒç´ çš„è¯ï¼Œå°±åˆ¤æ–­è¯¥å…ƒç´ ä¸è¦å­˜å…¥çš„å…ƒç´ çš„ hash å€¼ä»¥åŠ key æ˜¯å¦ç›¸åŒï¼Œå¦‚æœç›¸åŒçš„ è¯ï¼Œç›´æ¥è¦†ç›–ï¼Œä¸ç›¸åŒå°±é€šè¿‡æ‹‰é“¾æ³•è§£å†³å†²çªã€‚ æ‰€è°“æ‰°åŠ¨å‡½æ•°æŒ‡çš„å°±æ˜¯ HashMap çš„ hash æ–¹æ³•ã€‚ä½¿ç”¨ hash æ–¹æ³•ä¹Ÿå°±æ˜¯æ‰°åŠ¨å‡½æ•°æ˜¯ä¸ºäº†é˜²æ­¢ä¸€äº›å®ç°æ¯”è¾ƒå·®çš„ hashCode() æ–¹æ³• æ¢å¥è¯è¯´ä½¿ç”¨æ‰°åŠ¨å‡½æ•°ä¹‹åå¯ä»¥å‡å°‘ç¢°æ’ã€‚ HashMapï¼šå®ƒæ ¹æ®é”®çš„hashCodeå€¼å­˜å‚¨æ•°æ®ï¼Œå¤§å¤šæ•°æƒ…å†µä¸‹å¯ä»¥ç›´æ¥å®šä½åˆ°å®ƒçš„å€¼ï¼Œå› è€Œå…·æœ‰å¾ˆå¿«çš„è®¿é—®é€Ÿåº¦ï¼Œä½†éå†é¡ºåºå´æ˜¯ä¸ç¡®å®šçš„ã€‚ HashMapæœ€å¤šåªå…è®¸ä¸€æ¡è®°å½•çš„é”®ä¸ºnullï¼Œå…è®¸å¤šæ¡è®°å½•çš„å€¼ä¸ºnullã€‚HashMapéçº¿ç¨‹å®‰å…¨ï¼Œå³ä»»ä¸€æ—¶åˆ»å¯ä»¥æœ‰å¤šä¸ªçº¿ç¨‹åŒæ—¶å†™HashMapï¼Œå¯èƒ½ä¼šå¯¼è‡´æ•°æ®çš„ä¸ä¸€è‡´ã€‚å¦‚æœéœ€è¦æ»¡è¶³çº¿ç¨‹å®‰å…¨ï¼Œå¯ä»¥ç”¨ Collectionsçš„synchronizedMapæ–¹æ³•ä½¿HashMapå…·æœ‰çº¿ç¨‹å®‰å…¨çš„èƒ½åŠ›ï¼Œæˆ–è€…ä½¿ç”¨ConcurrentHashMap. 2.4 javaé›†åˆæ€»ç»“ Collection List ArrayListï¼šObjctæ•°ç»„å®ç° Vectorï¼šObjectå®ç°ï¼Œçº¿ç¨‹å®‰å…¨ LinkListï¼šåŒå‘é“¾è¡¨ Set HashSetï¼šåŸºäºhashmapå®ç°ï¼Œ æ— åºã€å”¯ä¸€ LinkedHashSetï¼šç»§æ‰¿ HashSetï¼Œå†…éƒ¨ä¸ºLinkedHashMapå®ç° TreeSetï¼šçº¢é»‘æ ‘ï¼Œæœ‰åºã€å”¯ä¸€ Map Hashmapï¼šæ•°ç»„+é“¾è¡¨+çº¢é»‘æ ‘ LinkedHashMapï¼šç»§æ‰¿HashMapï¼ŒåŒå‘é“¾è¡¨+æ•°ç»„ï¼Œæ’å…¥æœ‰åºæˆ–è®¿é—®æœ‰åº HashTableï¼šsynchronizedåŒæ­¥çš„HashMap TreeMapï¼šçº¢é»‘æ ‘ 3 java å¤šçº¿ç¨‹å…³é”®å­— 3.1 synchronizedå…³é”®å­— ä¿®é¥°å®ä¾‹æ–¹æ³•ï¼Œä½œç”¨äºå½“å‰å¯¹è±¡å®ä¾‹åŠ é”ï¼Œè¿›å…¥åŒæ­¥ä»£ç å‰è¦è·å¾—å½“å‰å¯¹è±¡å®ä¾‹çš„é”ã€‚ ä¿®é¥°é™æ€æ–¹æ³•ï¼Œä½œç”¨äºå½“å‰ç±»å¯¹è±¡åŠ é”ï¼Œè¿›å…¥åŒæ­¥ä»£ç å‰è¦è·å¾—å½“å‰ç±»å¯¹è±¡çš„é”ã€‚ä¹Ÿå°±æ˜¯ç»™å½“å‰ç±»åŠ é”ï¼Œä¼šä½œç”¨äºç±»çš„æ‰€æœ‰å¯¹è±¡å®ä¾‹ï¼Œå› ä¸ºé™æ€æˆå‘˜ä¸å±äºä»»ä½•ä¸€ä¸ªå®ä¾‹å¯¹è±¡ï¼Œæ˜¯ç±»æˆå‘˜(æ‰€ä»¥å¦‚æœä¸€ä¸ªçº¿ç¨‹Aè°ƒç”¨ä¸€ä¸ªå® ä¾‹å¯¹è±¡çš„éé™æ€ synchronized æ–¹æ³•ï¼Œè€Œçº¿ç¨‹Béœ€è¦è°ƒç”¨è¿™ä¸ªå®ä¾‹å¯¹è±¡æ‰€å±ç±»çš„é™æ€ synchronized æ–¹æ³•ï¼Œæ˜¯å… è®¸çš„ï¼Œä¸ä¼šå‘ç”Ÿäº’æ–¥ç°è±¡ï¼Œå› ä¸ºè®¿é—®é™æ€ synchronized æ–¹æ³•å ç”¨çš„é”æ˜¯å½“å‰ç±»çš„é”ï¼Œè€Œè®¿é—®éé™æ€ synchronized æ–¹æ³•å ç”¨çš„é”æ˜¯å½“å‰å®ä¾‹å¯¹è±¡é”ã€‚ ) ä¿®é¥°ä»£ç å—ï¼ŒæŒ‡å®šåŠ é”å¯¹è±¡ï¼Œå¯¹ç»™å®šçš„å¯¹è±¡åŠ é”ï¼Œè¿›å…¥åŒæ­¥ä»£ç åº“å‰è¦è·å¾—ç»™å®šå¯¹è±¡çš„é”ã€‚ï¼ˆsynchronizedåŠ åˆ°staticé™æ€æ–¹æ³•å’Œsynchronized(class)ä»£ç å—éƒ½æ˜¯ç»™Classç±»ä¸Šé”ï¼‰ åŒé‡æ ¡éªŒé”å®ç°å¯¹è±¡å•ä¾‹ï¼ˆçº¿ç¨‹å®‰å…¨ï¼‰ public class Singleton{ private volatile static Singleton uniqueInstance; private Singleton(){} public static Singleton getUniqueInstance(){ if(uniqueInstance==null){ synchronized(Singeton.class){ if(uniqueInstance==null){ uniqueInstance=new Singleton(); } } } return uniqueInstance; } } å¦å¤–ï¼Œéœ€è¦æ³¨æ„ uniqueInstance é‡‡ç”¨ volatile å…³é”®å­—ä¿®é¥°ä¹Ÿæ˜¯å¾ˆæœ‰å¿…è¦ã€‚ uniqueInstance é‡‡ç”¨ volatile å…³é”®å­—ä¿®é¥°ä¹Ÿæ˜¯å¾ˆæœ‰å¿…è¦çš„ï¼Œ uniqueInstance = new Singleton(); è¿™æ®µä»£ç å…¶å®æ˜¯åˆ† ä¸ºä¸‰æ­¥æ‰§è¡Œï¼š1.ä¸º uniqueInstance åˆ†é…å†…å­˜ç©ºé—´ 2. åˆå§‹åŒ– uniqueInstance 3. å°† uniqueInstance æŒ‡å‘åˆ†é…çš„å†…å­˜åœ°å€ ä½†æ˜¯ç”±äº JVM å…·æœ‰æŒ‡ä»¤é‡æ’çš„ç‰¹æ€§ï¼Œæ‰§è¡Œé¡ºåºæœ‰å¯èƒ½å˜æˆ 1-&gt;3-&gt;2ã€‚æŒ‡ä»¤é‡æ’åœ¨å•çº¿ç¨‹ç¯å¢ƒä¸‹ä¸ä¼šå‡ºå…ˆé—®é¢˜ï¼Œä½†æ˜¯åœ¨ å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ä¼šå¯¼è‡´ä¸€ä¸ªçº¿ç¨‹è·å¾—è¿˜æ²¡æœ‰åˆå§‹åŒ–çš„å®ä¾‹ã€‚ä¾‹å¦‚ï¼Œçº¿ç¨‹ T1 æ‰§è¡Œäº† 1 å’Œ 3ï¼Œæ­¤æ—¶ T2 è°ƒç”¨ getUniqueInstance() åå‘ç° uniqueInstance ä¸ä¸ºç©ºï¼Œå› æ­¤è¿”å› uniqueInstanceï¼Œä½†æ­¤æ—¶ uniqueInstance è¿˜æœªè¢« åˆå§‹åŒ–ã€‚ ä½¿ç”¨ volatile å¯ä»¥ç¦æ­¢ JVM çš„æŒ‡ä»¤é‡æ’ï¼Œä¿è¯åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ä¹Ÿèƒ½æ­£å¸¸è¿è¡Œã€‚ 3.2 ReenTrantLock ReenTrantLock æ˜¯å¯é‡å…¥çš„ï¼Œå…¶åŠ é”å’Œè§£é”æ˜¯æ‰‹åŠ¨æ“ä½œï¼Œæ¯”è¾ƒçµæ´»ã€‚è€Œsynchronizedçš„åŠ é”è§£é”è¿‡ç¨‹æ˜¯éšå¼çš„ã€‚ ReentrantLock lock = new ReentrantLock(true);//å¯é€šè¿‡ä¼ å‚æŒ‡å®šè¯¥é”æ˜¯å…¬å¹³é”è¿˜æ˜¯éå…¬å¹³é”ã€‚ //å…¬å¹³é”æ˜¯æŒ‡å½“é”å¯ç”¨æ—¶,åœ¨é”ä¸Šç­‰å¾…æ—¶é—´æœ€é•¿çš„çº¿ç¨‹å°†è·å¾—é”çš„ä½¿ç”¨æƒ 3.3 volatile volatileå…³é”®å­—æ˜¯çº¿ç¨‹åŒæ­¥çš„è½»é‡çº§å®ç°ï¼Œæ‰€ä»¥æ€§èƒ½è‚¯å®šæ¯”synchronizedå¥½ã€‚ä½†volatileåªèƒ½ä¿®é¥°å˜é‡ï¼Œè€Œsynchronizedå…³é”®å­—èƒ½ä¿®é¥°æ–¹æ³•å’Œä»£ç å—ã€‚ï¼ˆsynchronizedå…³é”®å­—åœ¨JavaSE1.6ä¹‹åè¿› è¡Œäº†ä¸»è¦åŒ…æ‹¬ä¸ºäº†å‡å°‘è·å¾—é”å’Œé‡Šæ”¾é”å¸¦æ¥çš„æ€§èƒ½æ¶ˆè€—è€Œå¼•å…¥çš„åå‘é”å’Œè½»é‡çº§é”ä»¥åŠå…¶å®ƒå„ç§ä¼˜åŒ–ä¹‹åæ‰§è¡Œ æ•ˆç‡æœ‰äº†æ˜¾è‘—æå‡ï¼Œå®é™…å¼€å‘ä¸­ä½¿ç”¨ synchronized å…³é”®å­—çš„åœºæ™¯è¿˜æ˜¯æ›´å¤šä¸€äº›ã€‚ ï¼‰ volatileå…³é”®å­—èƒ½ä¿è¯æ•°æ®çš„å¯è§æ€§ï¼Œå•ä¸èƒ½ä¿è¯æ•°æ®çš„åŸå­æ€§ï¼Œsynchronizedä¸¤è€…éƒ½èƒ½ä¿è¯ã€‚ volatileä¸»è¦ç”¨äºè§£å†³å˜é‡åœ¨å¤šä¸ªçº¿ç¨‹ä¹‹é—´çš„å¯è§æ€§ï¼Œè€Œsynchronizedè§£å†³çš„æ˜¯å¤šä¸ªçº¿ç¨‹ä¹‹é—´è®¿é—®èµ„æºçš„åŒæ­¥æ€§ã€‚ 3.4 ä½¿ç”¨çº¿ç¨‹æ± çš„ä¼˜ç‚¹ é™ä½èµ„æºæ¶ˆè€—ã€‚ é€šè¿‡é‡å¤åˆ©ç”¨å·²åˆ›å»ºçš„çº¿ç¨‹é™ä½çº¿ç¨‹åˆ›å»ºå’Œé”€æ¯é€ æˆçš„æ¶ˆè€—ã€‚ æé«˜å“åº”é€Ÿåº¦ã€‚ å½“ä»»åŠ¡åˆ°è¾¾æ—¶ï¼Œä»»åŠ¡å¯ä»¥ä¸éœ€è¦çš„ç­‰åˆ°çº¿ç¨‹åˆ›å»ºå°±èƒ½ç«‹å³æ‰§è¡Œã€‚ æé«˜çº¿ç¨‹çš„å¯ç®¡ç†æ€§ã€‚ çº¿ç¨‹æ˜¯ç¨€ç¼ºèµ„æºï¼Œå¦‚æœæ— é™åˆ¶çš„åˆ›å»ºï¼Œä¸ä»…ä¼šæ¶ˆè€—ç³»ç»Ÿèµ„æºï¼Œè¿˜ä¼šé™ä½ç³»ç»Ÿçš„ç¨³å®šæ€§ï¼Œ ä½¿ç”¨çº¿ç¨‹æ± å¯ä»¥è¿›è¡Œç»Ÿä¸€çš„åˆ†é…ï¼Œè°ƒä¼˜å’Œç›‘æ§ã€‚ 3.5 å®ç°Runnableæ¥å£ä¸Callableæ¥å£çš„åŒºåˆ« Runnableæ¥å£ä¸ä¼šè¿”å›ç»“æœï¼›Callableæ¥å£å¯ä»¥è¿”å›ç»“æœã€‚ 3.6 execute()æ–¹æ³•å’Œsubmit()æ–¹æ³•æœ‰ä»€ä¹ˆåŒºåˆ« execute() æ–¹æ³•ç”¨äºæäº¤ä¸éœ€è¦è¿”å›å€¼çš„ä»»åŠ¡ï¼Œæ‰€ä»¥æ— æ³•åˆ¤æ–­ä»»åŠ¡æ˜¯å¦è¢«çº¿ç¨‹æ± æ‰§è¡ŒæˆåŠŸ submit()æ–¹æ³•ç”¨äºæäº¤éœ€è¦è¿”å›å€¼çš„ä»»åŠ¡ã€‚çº¿ç¨‹æ± ä¼šè¿”å›ä¸€ä¸ªfutureç±»å‹çš„å¯¹è±¡ï¼Œé€šè¿‡è¯¥å¯¹è±¡å¯ä»¥åˆ¤æ–­ä»»åŠ¡æ˜¯å¦æˆåŠŸæ‰§è¡Œã€‚ 3.7 å¦‚ä½•åˆ›å»ºçº¿ç¨‹æ±  ã€Šé˜¿é‡Œå·´å·´Javaå¼€å‘æ‰‹å†Œã€‹ä¸­å¼ºåˆ¶çº¿ç¨‹æ± ä¸å…è®¸ä½¿ç”¨ Executors å»åˆ›å»ºï¼Œè€Œæ˜¯é€šè¿‡ ThreadPoolExecutor çš„æ–¹å¼ï¼Œè¿™æ ·çš„å¤„ç†æ–¹å¼è®©å†™çš„åŒå­¦æ›´åŠ æ˜ç¡®çº¿ç¨‹æ± çš„è¿è¡Œè§„åˆ™ï¼Œè§„é¿èµ„æºè€—å°½çš„é£é™©ã€‚ æ–¹å¼ä¸€ï¼šé€šè¿‡æ„é€ æ–¹æ³•åˆ›å»ºï¼š ThreadPoolExecutor( int corePoolSize,//æŒ‡å®šçº¿ç¨‹æ± ä¸­çº¿ç¨‹çš„æ•°é‡ int maximumPoolSize,//æœ€å¤§çº¿ç¨‹æ•°é‡ long keepAliveTime,//ç©ºé—²çº¿ç¨‹æ•°é‡è¶…è¿‡corePoolSizeæ—¶ï¼Œå¤šä½™çº¿ç¨‹å¤šä¹…è¢«é”€æ¯ TimeUnit unit,//KeepAliveTimeçš„å•ä½ BlockingQueue&lt;Runnable&gt; workQueue,//ä»»åŠ¡é˜Ÿåˆ— ThreadFactory threadFactory,//çº¿ç¨‹å·¥å‚ RejectedExecutionHandler handler ) //æ‹’ç»ç­–ç•¥ æ–¹å¼äºŒï¼šé€šè¿‡Executorsåˆ›å»º FixedThreadPoolï¼šè¿”å›å›ºå®šçº¿ç¨‹æ•°é‡çš„çº¿ç¨‹æ± ã€‚ SingleThreadExecutorï¼šè¿”å›ä¸€ä¸ªåªæœ‰ä¸€ä¸ªçº¿ç¨‹çš„çº¿ç¨‹æ± ã€‚ CachedThreadPoolï¼šè¯¥æ–¹æ³•è¿”å›ä¸€ä¸ªå¯æ ¹æ®å®é™…æƒ…å†µè°ƒæ•´çº¿ç¨‹æ•°é‡çš„çº¿ç¨‹æ± ã€‚çº¿ç¨‹æ± çš„çº¿ç¨‹æ•°é‡ä¸ç¡®å®šï¼Œä½† è‹¥æœ‰ç©ºé—²çº¿ç¨‹å¯ä»¥å¤ç”¨ï¼Œåˆ™ä¼šä¼˜å…ˆä½¿ç”¨å¯å¤ç”¨çš„çº¿ç¨‹ã€‚è‹¥æ‰€æœ‰çº¿ç¨‹å‡åœ¨å·¥ä½œï¼Œåˆæœ‰æ–°çš„ä»»åŠ¡æäº¤ï¼Œåˆ™ä¼šåˆ›å»ºæ–° çš„çº¿ç¨‹å¤„ç†ä»»åŠ¡ã€‚æ‰€æœ‰çº¿ç¨‹åœ¨å½“å‰ä»»åŠ¡æ‰§è¡Œå®Œæ¯•åï¼Œå°†è¿”å›çº¿ç¨‹æ± è¿›è¡Œå¤ç”¨ã€‚ 3.8 AtomicåŸå­ç±» å¹¶å‘åŒ…java.util.concurrentçš„åŸå­ç±»éƒ½æ”¾åœ¨java.util.concurrent.atomicä¸‹ï¼ŒJUCåŒ…ä¸­çš„åŸå­ç±»åŒ…å«å››ç±»ï¼š 1. åŸºæœ¬ç±»å‹ï¼šä½¿ç”¨é™¢å­çš„æ–¹å¼æ›´æ–°åŸºæœ¬ç±»å‹ AtomicIntegerï¼šæ•´å½¢åŸå­ç±» AtomicLongï¼šé•¿æ•´å‹åŸå­ç±» AtomicBooleanï¼šå¸ƒå°”å‹åŸå­ç±» 2. æ•°ç»„ç±»å‹ï¼šä½¿ç”¨é™¢å­æ–¹å¼æ˜¯æ›´æ–°æ•°æ•°ç»„é‡Œçš„æŸä¸ªå…ƒç´  AtomicIntegerArrayï¼šæ•´å½¢æ•°ç»„åŸå­ç±» AtomicLongArrayï¼šé•¿æ•´å‹æ•°ç»„åŸå­ç±» AtomicReferenceArrayï¼šå¼•ç”¨ç±»å‹æ•°ç»„åŸå­ç±» 3. å¼•ç”¨ç±»å‹ï¼š AtomicReferenceï¼šå¼•ç”¨ç±»å‹é™¢å­ç±» AtomicStampedRerenceï¼šåŸå­æ›´æ–°å¼•ç”¨ç±»å‹ä¾‹çš„å­—æ®µåŸå­ç±» AtomICMarkableReferenceï¼šåŸå­æ›´æ–°å¸¦æœ‰æ ‡è®°çš„å¼•ç”¨ç±»å‹ï¼Œä¾‹ï¼šAtomicReferenceArray 4. å¯¹è±¡çš„å±æ€§ä¿®æ”¹ç±»å‹ï¼š AtomicIntegerFieldUpdater:åŸå­æ›´æ–°æ•´å½¢å­—æ®µçš„æ›´æ–°å™¨ AtomicLongFieldUpdaterï¼šåŸå­æ›´æ–°é•¿æ•´å½¢å­—æ®µçš„æ›´æ–°å™¨ AtomicStampedReference ï¼šåŸå­æ›´æ–°å¸¦æœ‰ç‰ˆæœ¬å·çš„å¼•ç”¨ç±»å‹ã€‚è¯¥ç±»å°†æ•´æ•°å€¼ä¸å¼•ç”¨å…³è”èµ·æ¥ï¼Œå¯ç”¨äºè§£å†³åŸ å­çš„æ›´æ–°æ•°æ®å’Œæ•°æ®çš„ç‰ˆæœ¬å·ï¼Œå¯ä»¥è§£å†³ä½¿ç”¨ CAS è¿›è¡ŒåŸå­æ›´æ–°æ—¶å¯èƒ½å‡ºç°çš„ ABA é—®é¢˜ã€‚ 5. AtomicInterç±»å¸¸ç”¨æ–¹æ³• å¸¸ç”¨æ–¹æ³•ï¼š public final int get() //è·å–å½“å‰çš„å€¼ public final int getAndSet(int newValue)//è·å–å½“å‰çš„å€¼ï¼Œå¹¶è®¾ç½®æ–°çš„ public final int getAndIncrement()//è·å–å½“å‰çš„å€¼ï¼Œå¹¶è‡ªå¢ public final int getAndDecrement() //è·å–å½“å‰çš„å€¼ï¼Œå¹¶è‡ªå‡ public final int getAndAdd(int delta) //è·å–å½“å‰çš„å€¼ï¼Œå¹¶åŠ ä¸Šé¢„æœŸçš„ boolean compareAndSet(int expect, int update) //å¦‚æœè¾“å…¥çš„æ•°å€¼ç­‰äºé¢„æœŸå€¼ï¼Œåˆ™ä»¥åŸå­æ–¹å¼å°†è¯¥å€¼è®¾ç½® ä¸ºè¾“å…¥å€¼ï¼ˆupdateï¼‰ public final void lazySet(int newValue)//ç»ˆè®¾ç½®ä¸ºnewValue,ä½¿ç”¨ lazySet è®¾ç½®ä¹‹åå¯èƒ½å¯¼è‡´å…¶ä»–çº¿ ç¨‹åœ¨ä¹‹åçš„ä¸€å°æ®µæ—¶é—´å†…è¿˜æ˜¯å¯ä»¥è¯»åˆ°æ—§çš„å€¼ã€‚ ä½¿ç”¨ç¤ºä¾‹ ï¼š class AtomicIntegerTest { private AtomicInteger count = new AtomicInteger(); //ä½¿ç”¨AtomicIntegerä¹‹åï¼Œä¸éœ€è¦å¯¹è¯¥æ–¹æ³•åŠ é”ï¼Œä¹Ÿå¯ä»¥å®ç°çº¿ç¨‹å®‰å…¨ã€‚ public void increment() { count.incrementAndGet(); } public int getCount() { return count.get(); } } 3.9 AQSåŸç† 1. ç®€ä»‹ï¼ˆAbstractQueuedSynchronizerï¼‰ AQSæ˜¯ä¸€ä¸ªç”¨æ¥æ„å»ºé”å’ŒåŒæ­¥å™¨çš„æ¡†æ¶ï¼Œä½¿ç”¨AQSèƒ½ç®€å•ä¸”é«˜æ•ˆçš„æ„å»ºå‡ºåº”ç”¨å¹¿æ³›çš„å¤§é‡çš„åŒæ­¥å™¨ï¼Œä¾‹å¦‚ReentrantLockï¼ŒSemaphoreï¼Œå…¶ä»–çš„æ³¨å…¥ReentrantReadWriteLockï¼ŒSynchronousQueueï¼ŒFutureTaskç­‰çš†æ˜¯åŸºäºAQSçš„ï¼Œåˆ©ç”¨AQSæˆ‘ä»¬èƒ½è½»æ¾çš„æ„å»ºå‡ºç¬¦åˆéœ€æ±‚çš„åŒæ­¥å™¨ã€‚ ####2. åŸ ç† AQSçš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼Œå¦‚æœè¢«è¯·æ±‚çš„å…±äº«èµ„æºç©ºé—²ï¼Œåˆ™å°†å½“å‰è¯·æ±‚èµ„æºçš„çº¿ç¨‹è®¾ç½®ä¸ºæœ‰æ•ˆå·¥ä½œçº¿ç¨‹ï¼Œå¹¶ä¸”å°†å…±äº«èµ„æºè®¾ç½®ä¸ºé”å®šçŠ¶æ€ã€‚å¦‚æœè¢«è¯·æ±‚çš„å…±äº«èµ„æºè¢«å ç”¨ï¼Œé‚£ä¹ˆå°±éœ€è¦ä¸€å¥—çº¿ç¨‹é˜»å¡ç­‰å¾…ä»¥åŠè¢«å”¤é†’æ—¶é”åˆ†é…çš„æœºåˆ¶ï¼Œè¿™ä¸ªæœºåˆ¶AQSæ˜¯ç”¨CLHé˜Ÿåˆ—é”å®ç°çš„ï¼Œå³å°†æš‚æ—¶è·å–ä¸åˆ°é”çš„çº¿ç¨‹åŠ å…¥åˆ°é˜Ÿåˆ—ä¸­ã€‚ CLH(Craig,Landin,and Hagerstenï¼‰é˜Ÿåˆ—æ˜¯ä¸€ä¸ªè™šæ‹Ÿçš„åŒå‘é˜Ÿåˆ—ï¼ˆè™šæ‹Ÿçš„åŒå‘é˜Ÿåˆ—å³ä¸å­˜åœ¨é˜Ÿåˆ—å®ä¾‹ï¼Œä»… å­˜åœ¨ç»“ç‚¹è¿™å‡ ä»¶çš„å…³è”å…³ç³»ï¼‰ã€‚AQSæ˜¯å°†æ¯æ¡è¯·æ±‚å…±äº«èµ„æºçš„çº¿ç¨‹å°è£…æˆä¸€ä¸ªCLHé”é˜Ÿåˆ—çš„ä¸€ä¸ªç»“ç‚¹ï¼ˆnodeï¼‰æ¥å®ç°é”çš„åˆ†é…ã€‚ï¼‰ AQSä½¿ç”¨ä¸€ä¸ªintæˆå‘˜å˜é‡æ¥è¡¨ç¤ºåŒæ­¥çŠ¶æ€ï¼Œé€šè¿‡å†…ç½®çš„FIFOé˜Ÿåˆ—æ¥å®Œæˆè·å–èµ„æºçº¿ç¨‹çš„æ’é˜Ÿå·¥ä½œã€‚AQSä½¿ç”¨CASå¯¹è¯¥åŒæ­¥çŠ¶æ€è¿›è¡ŒåŸå­æ“ä½œå®ç°å¯¹å…¶å€¼å¾—ä¿®æ”¹ã€‚ //volatileä¿®é¥°çš„é˜Ÿåˆ—å¤´èŠ‚ç‚¹ private transient volatile Node head; //volatileä¿®é¥°çš„é˜Ÿåˆ—å°¾èŠ‚ç‚¹ private transient volatile Node tail; //volatileä¿®é¥°çš„åŒæ­¥çŠ¶æ€ //state = 0 è¡¨ç¤ºåŒæ­¥çŠ¶æ€å¯ç”¨ï¼ˆå¦‚æœç”¨äºé”ï¼Œè¡¨ç¤ºé”å¯ç”¨ï¼‰ //state = 1 è¡¨ç¤ºåŒæ­¥çŠ¶æ€å·²è¢«å ç”¨ï¼ˆé”è¢«å ç”¨ï¼‰ private volatile int state; æ ¹æ®æºç å¯ä»¥æ˜¾ç„¶çœ‹åˆ°ï¼ŒAQS å†…éƒ¨å®ç°äº† Node å’Œ ConditionObject ä¸¤ä¸ªå†…éƒ¨ç±»ï¼Œå¹¶ä¸” Node æ˜¯ä½¿ç”¨ static finalä¿®é¥°çš„é™æ€å†…éƒ¨ç±»ï¼Œå¯ä»¥çœ‹åˆ°å…¶ç»“æ„å¦‚ä¸‹ï¼š Node çš„æºç å¦‚ä¸‹ï¼š static final class Node { //å…±äº«æ¨¡å¼ static final Node SHARED = new Node(); //ç‹¬å æ¨¡å¼ static final Node EXCLUSIVE = null; //å› ä¸ºè¶…æ—¶æˆ–è€…ä¸­æ–­ï¼ŒèŠ‚ç‚¹ä¼šè¢«è®¾ç½®ä¸ºå–æ¶ˆçŠ¶æ€ï¼Œè¢«å–æ¶ˆçš„èŠ‚ç‚¹æ—¶ä¸ä¼šå‚ä¸åˆ°ç«äº‰ä¸­çš„ï¼Œä»–ä¼šä¸€ç›´ä¿æŒå–æ¶ˆçŠ¶æ€ä¸ä¼šè½¬å˜ä¸ºå…¶ä»–çŠ¶æ€ï¼› static final int CANCELLED = 1; //åç»§èŠ‚ç‚¹çš„çº¿ç¨‹å¤„äºç­‰å¾…çŠ¶æ€ï¼Œè€Œå½“å‰èŠ‚ç‚¹çš„çº¿ç¨‹å¦‚æœé‡Šæ”¾äº†åŒæ­¥çŠ¶æ€æˆ–è€…è¢«å–æ¶ˆï¼Œå°†ä¼šé€šçŸ¥åç»§èŠ‚ç‚¹ï¼Œä½¿åç»§èŠ‚ç‚¹çš„çº¿ç¨‹å¾—ä»¥è¿è¡Œ static final int SIGNAL = -1; //èŠ‚ç‚¹åœ¨ç­‰å¾…é˜Ÿåˆ—ä¸­ï¼ŒèŠ‚ç‚¹çº¿ç¨‹ç­‰å¾…åœ¨Conditionä¸Šï¼Œå½“å…¶ä»–çº¿ç¨‹å¯¹Conditionè°ƒç”¨äº†signal()åï¼Œæ”¹èŠ‚ç‚¹å°†ä¼šä»ç­‰å¾…é˜Ÿåˆ—ä¸­è½¬ç§»åˆ°åŒæ­¥é˜Ÿåˆ—ä¸­ï¼ŒåŠ å…¥åˆ°åŒæ­¥çŠ¶æ€çš„è·å–ä¸­ static final int CONDITION = -2; //è¡¨ç¤ºä¸‹ä¸€æ¬¡å…±äº«å¼åŒæ­¥çŠ¶æ€è·å–å°†ä¼šæ— æ¡ä»¶åœ°ä¼ æ’­ä¸‹å» static final int PROPAGATE = -3; //ç­‰å¾…çŠ¶æ€ volatile int waitStatus; //å‰é©±èŠ‚ç‚¹ volatile Node prev; //åç»§èŠ‚ç‚¹ volatile Node next; //å½“å‰èŠ‚ç‚¹çš„çº¿ç¨‹ volatile Thread thread; } ç»„ä»¶ Semaphoreï¼ˆä¿¡å·é‡ï¼‰-å…è®¸å¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®ï¼šsynchronizedå’ŒReentrantLockéƒ½æ˜¯åªå…è®¸ä¸€ä¸ªçº¿ç¨‹è®¿é—®æŸä¸ªèµ„æºï¼ŒSemaphoreå¯ä»¥æŒ‡å®šå¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®æŸä¸ªèµ„æºã€‚ CountDownLatchï¼ˆå€’è®¡æ—¶å™¨ï¼‰ï¼šæ˜¯ä¸€ä¸ªåŒæ­¥å·¥å…·ç±»ï¼Œç”¨æ¥åè°ƒå¤šä¸ªçº¿ç¨‹ä¹‹é—´çš„åŒæ­¥ã€‚é€šå¸¸ç”¨æ¥æ§åˆ¶çº¿ç¨‹ç­‰å¾…ï¼Œå®ƒå¯ä»¥è®©æŸä¸€ä¸ªçº¿ç¨‹ç­‰å¾…ç›´åˆ°å€’è®¡æ—¶ç»“æŸï¼Œå†å¼€å§‹æ‰§è¡Œã€‚ CyclicBarrierï¼ˆå¾ªç¯æ …æ ï¼‰ï¼šCyclicBarrier å’Œ CountDownLatch éå¸¸ç±»ä¼¼ï¼Œå®ƒä¹Ÿå¯ä»¥å®ç°çº¿ç¨‹é—´çš„æŠ€æœ¯ç­‰å¾…ï¼Œ ä½†æ˜¯å®ƒçš„åŠŸèƒ½æ¯” CountDownLatch æ›´åŠ å¤æ‚å’Œå¼ºå¤§ã€‚ä¸»è¦åº”ç”¨åœºæ™¯å’Œ CountDownLatch ç±»ä¼¼ã€‚CyclicBarrier çš„å­—é¢æ„æ€æ˜¯å¯å¾ªç¯ä½¿ç”¨ï¼ˆCyclicï¼‰çš„å±éšœï¼ˆBarrierï¼‰ã€‚å®ƒè¦åšçš„äº‹æƒ…æ˜¯ï¼Œè®©ä¸€ç»„çº¿ç¨‹åˆ°è¾¾ä¸€ä¸ªå±éšœï¼ˆä¹Ÿå¯ä»¥å« åŒæ­¥ç‚¹ï¼‰æ—¶è¢«é˜»å¡ï¼Œç›´åˆ°åä¸€ä¸ªçº¿ç¨‹åˆ°è¾¾å±éšœæ—¶ï¼Œå±éšœæ‰ä¼šå¼€é—¨ï¼Œæ‰€æœ‰è¢«å±éšœæ‹¦æˆªçš„çº¿ç¨‹æ‰ä¼šç»§ç»­å¹²æ´»ã€‚ CyclicBarrieré»˜è®¤çš„æ„é€ æ–¹æ³•æ˜¯ CyclicBarrier(int parties)ï¼Œå…¶å‚æ•°è¡¨ç¤ºå±éšœæ‹¦æˆªçš„çº¿ç¨‹æ•°é‡ï¼Œæ¯ä¸ªçº¿ç¨‹è°ƒç”¨ awaitæ–¹æ³•å‘Šè¯‰ CyclicBarrier æˆ‘å·²ç»åˆ°è¾¾äº†å±éšœï¼Œç„¶åå½“å‰çº¿ç¨‹è¢«é˜»å¡ å®ç° äº†è§£äº†ä¸Šé¢çš„æ ¸å¿ƒç»“æ„ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç»§ç»­æ¥ç ”ç©¶ä¸€ä¸‹ AQS å†…éƒ¨å…·ä½“æ˜¯æ€ä¹ˆå®ç°çš„ã€‚ åŒæ­¥å™¨çš„è®¾è®¡æ˜¯åŸºäºæ¨¡æ¿æ–¹æ³•è®¾è®¡æ¨¡å¼çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä½¿ç”¨è€…éœ€è¦ç»§æ‰¿åŒæ­¥å™¨å¹¶é‡å†™æŒ‡å®šæ–¹æ³•ï¼Œç„¶åå°†åŒæ­¥å™¨ç»„åˆåœ¨è‡ªå®šä¹‰åŒæ­¥ç»„ä»¶çš„å®ç°ä¸­ï¼Œå¹¶è°ƒç”¨åŒæ­¥å™¨æä¾›çš„æ¨¡æ¿æ–¹æ³•ï¼Œè€Œè¿™äº›æ¨¡æ¿æ–¹æ³•å°†ä¼šè°ƒç”¨ä½¿ç”¨è€…é‡å†™çš„æ–¹æ³•ã€‚å¯èƒ½è¯´çš„æœ‰ç‚¹æŠ½è±¡ï¼Œåé¢åœ¨æ¢è®¨ ReentrantLock ç­‰åŸºäº AQS å®ç°çš„ç±»ä¸­ä¼šé€æ¸æ˜ç™½è¿™ä¸ªåŸç†ã€‚ é‡å†™åŒæ­¥å™¨æŒ‡å®šçš„æ–¹æ³•æ—¶ï¼Œéœ€è¦ä½¿ç”¨åŒæ­¥å™¨æä¾›çš„å¦‚ä¸‹3ä¸ªæ–¹æ³•æ¥è®¿é—®æˆ–è€…ä¿®æ”¹åŒæ­¥çŠ¶æ€ï¼š getState()ï¼šè·å–å½“å‰åŒæ­¥çŠ¶æ€ã€‚ setState(int newState)ï¼šè®¾ç½®å½“å‰åŒæ­¥çŠ¶æ€ã€‚ compareAndSetState(int expect,int update)ï¼šä½¿ç”¨ CAS è®¾ç½®å½“å‰çŠ¶æ€ï¼Œè¯¥æ–¹æ³•èƒ½å¤Ÿä¿è¯çŠ¶æ€è®¾ç½®çš„åŸå­æ€§ã€‚ å…¶æºç å®ç°ï¼š //è·å–åŒæ­¥çŠ¶æ€ protected final int getState() { return state; } //è®¾ç½®åŒæ­¥çŠ¶æ€ protected final void setState(int newState) { state = newState; } //ä»¥åŸå­æ–¹å¼è®¾ç½®åŒæ­¥çŠ¶æ€ protected final boolean compareAndSetState(int expect, int update) { return unsafe.compareAndSwapInt(this, stateOffset, expect, update); } ç”±äº AQS é‡Œé¢çš„æ–¹æ³•å¾ˆå¤šï¼Œä½†æ˜¯ç»å¤§å¤šæ•°æ–¹æ³•éƒ½æ˜¯ private å’Œ final çš„ï¼Œå³ä¸èƒ½è¢«ç»§æ‰¿å’Œå®ç°ã€‚åœ¨ç¬¬ä¸€ä¸ª AQS å›¾ä¸­çº¢æ¡†åœˆå‡ºæ¥çš„è¡¨ç¤ºçš„æ˜¯ç»§æ‰¿ AQS åèƒ½å¤Ÿé‡å†™çš„æ–¹æ³•ï¼Œå…¶æ–¹æ³•åç§°å’Œæ–¹æ³•æè¿°å¦‚ä¸‹ï¼š æ–¹æ³•åç§° æè¿° protected boolean tryAcquire(int args) ç‹¬å å¼è·å–åŒæ­¥çŠ¶æ€ï¼Œå®ç°è¯¥æ–¹æ³•éœ€è¦æŸ¥è¯¢å½“å‰çŠ¶æ€å¹¶åˆ¤æ–­åŒæ­¥çŠ¶æ€æ˜¯å¦ç¬¦åˆé¢„æœŸï¼Œç„¶åå†è¿›è¡ŒCASè®¾ç½®åŒæ­¥çŠ¶æ€ã€‚ protected boolean tryRelease(int arg) ç‹¬å å¼é‡Šæ”¾åŒæ­¥çŠ¶æ€ ï¼Œç­‰å¾…è·å–åŒæ­¥çŠ¶æ€çš„çº¿ç¨‹å°†æœ‰æœºä¼šè·å–åŒæ­¥çŠ¶æ€ protected int tryAcquireShared å…±äº«å¼è·å–åŒæ­¥çŠ¶æ€ï¼Œè¿”å›å¤§äºç­‰äº0çš„å€¼è¡¨ç¤ºè·å–æˆåŠŸï¼Œå¦åˆ™è·å–å¤±è´¥ protected boolean tryReleaseShared(int arg) å…±äº«å¼é‡Šæ”¾åŒæ­¥çŠ¶æ€ protected boolean isHeldExclusively() å½“å‰åŒæ­¥å™¨æ˜¯å¦åœ¨ç‹¬å æ¨¡å¼ä¸‹è¢«çº¿ç¨‹å ç”¨ï¼Œä¸€èˆ¬è¯¥æ–¹æ³•è¡¨ç¤ºæ˜¯å¦è¢«å½“å‰çº¿ç¨‹ç‹¬å  æºç ä¸­ä¸Šé¢æ–¹æ³•å¦‚ä¸‹ï¼š //å°è¯•è·å–ç‹¬å æ¨¡å¼ protected boolean tryAcquire(int arg) { throw new UnsupportedOperationException(); } //å°è¯•é‡Šæ”¾ç‹¬å æ¨¡å¼ protected boolean tryRelease(int arg) { throw new UnsupportedOperationException(); } //å…±äº«å¼è·å–åŒæ­¥çŠ¶æ€ //è¿”å›è´Ÿæ•°è¡¨ç¤ºå¤±è´¥;0è¡¨ç¤ºæˆåŠŸï¼Œä½†æ²¡æœ‰å‰©ä½™å¯ç”¨èµ„æº;æ­£æ•°è¡¨ç¤ºæˆåŠŸï¼Œä¸”æœ‰å‰©ä½™èµ„æºã€‚ protected int tryAcquireShared(int arg) { throw new UnsupportedOperationException(); } //å…±äº«å¼é‡Šæ”¾åŒæ­¥çŠ¶æ€;å¦‚æœé‡Šæ”¾åå…è®¸å”¤é†’åç»­ç­‰å¾…ç»“ç‚¹è¿”å›trueï¼Œå¦åˆ™è¿”å›falseã€‚ protected boolean tryReleaseShared(int arg) { throw new UnsupportedOperationException(); } //å½“å‰åŒæ­¥å™¨æ˜¯å¦åœ¨ç‹¬å æ¨¡å¼ä¸‹è¢«çº¿ç¨‹å ç”¨ï¼Œä¸€èˆ¬è¯¥æ–¹æ³•è¡¨ç¤ºæ˜¯å¦è¢«å½“å‰çº¿ç¨‹æ‰€ç‹¬å ;åªæœ‰ç”¨åˆ°conditionæ‰éœ€è¦å»å®ç°å®ƒã€‚ protected boolean isHeldExclusively() { throw new UnsupportedOperationException(); } æ ¹æ®ä¸Šé¢åˆ†æå¯çŸ¥ï¼ŒAQS åœ¨å†…éƒ¨å®šä¹‰äº†ä¸¤ç§èµ„æºå…±äº«æ–¹å¼ï¼š Exclusiveï¼ˆç‹¬å ï¼Œåªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½æ‰§è¡Œï¼Œå¦‚ReentrantLockï¼‰ Shareï¼ˆå…±äº«ï¼Œå¤šä¸ªçº¿ç¨‹å¯åŒæ—¶æ‰§è¡Œï¼Œå¦‚Semaphore/CountDownLatchï¼‰ ä¸‹é¢æˆ‘ä»¬å¯¹è¿™ä¸¤ç§æ–¹å¼ä¸€ä¸€æ¢è®¨ã€‚ 3.9.1 ç‹¬å æ¨¡å¼ ç‹¬å æ¨¡å¼å°±ç›¸å½“äºä½¿ç”¨äº†æ’ä»–é”ï¼Œæ¯æ¬¡åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½å¤Ÿæ‰§è¡Œï¼Œå…¶ä»–çº¿ç¨‹éœ€è¦åœ¨ CLH é˜Ÿåˆ—ä¸­æ’é˜Ÿã€‚ä¸‹é¢åˆ†æä¸€ä¸‹ AQS æºç ä¸­çš„ç‹¬å æ¨¡å¼æ–¹æ³•ã€‚ acquire()æ–¹æ³• è¯¥æ–¹æ³•ä»¥ç‹¬å æ¨¡å¼è·å–å…±äº«èµ„æºã€‚å¦‚æœè·å–åˆ°èµ„æºï¼Œçº¿ç¨‹ç›´æ¥è¿”å›ï¼Œå¦åˆ™è¿›å…¥ç­‰å¾…é˜Ÿåˆ—ï¼Œç›´åˆ°è·å–åˆ°èµ„æºä¸ºæ­¢ï¼Œä¸”æ•´ä¸ªè¿‡ç¨‹å¿½ç•¥ä¸­æ–­çš„å½±å“ã€‚ReentrantLockçš„lockæ–¹æ³•å°±æ˜¯è°ƒç”¨çš„è¯¥æ–¹æ³•æ¥è·å–é”ã€‚ æ–¹æ³•çš„æ‰§è¡Œæµç¨‹å¦‚ä¸‹ï¼š è°ƒç”¨è‡ªå®šä¹‰åŒæ­¥å™¨çš„tryAcquire()å°è¯•ç›´æ¥å»è·å–èµ„æºï¼Œå¦‚æœæˆåŠŸåˆ™ç›´æ¥è¿”å›ã€‚ æ²¡æˆåŠŸï¼Œåˆ™addWaiter()å°†è¯¥çº¿ç¨‹åŠ å…¥ç­‰å¾…é˜Ÿåˆ—çš„å°¾éƒ¨ï¼Œå¹¶æ ‡è®°ä¸ºç‹¬å æ¨¡å¼ã€‚ acquireQueued()ä½¿çº¿ç¨‹åœ¨ç­‰å¾…é˜Ÿåˆ—ä¸­ä¼‘æ¯ï¼Œæœ‰æœºä¼šæ—¶ï¼ˆè½®åˆ°è‡ªå·±ï¼Œä¼šè¢«unpark()ï¼‰ä¼šå»å°è¯•è·å–èµ„æºã€‚è·å–åˆ°èµ„æºåæ‰è¿”å›ã€‚å¦‚æœåœ¨æ•´ä¸ªç­‰å¾…è¿‡ç¨‹ä¸­è¢«ä¸­æ–­è¿‡ï¼Œåˆ™è¿”å›trueï¼Œå¦åˆ™è¿”å›falseã€‚ å¦‚æœçº¿ç¨‹åœ¨ç­‰å¾…è¿‡ç¨‹ä¸­è¢«ä¸­æ–­è¿‡ï¼Œå®ƒæ˜¯ä¸å“åº”çš„ã€‚åªæ˜¯è·å–èµ„æºåæ‰å†è¿›è¡Œè‡ªæˆ‘ä¸­æ–­selfInterrupt()ã€‚ /** * ç‹¬å æ¨¡å¼è·å–åŒæ­¥çŠ¶æ€ï¼Œå¦‚æœå½“å‰çº¿ç¨‹è·å–åŒæ­¥çŠ¶æ€æˆåŠŸï¼Œåˆ™ç›´æ¥è¿”å›ï¼Œå¦åˆ™ * å°†ä¼šè¿›å…¥åŒæ­¥é˜Ÿåˆ—ç­‰å¾…ï¼Œè¯¥æ–¹æ³•ä¼šè°ƒç”¨å®ç°ç±»é‡å†™çš„tryAcquire(int arg)æ–¹æ³• */ public final void acquire(int arg) { if (!tryAcquire(arg) &amp;&amp; acquireQueued(addWaiter(Node.EXCLUSIVE), arg)) selfInterrupt(); } tryAcquire()æ–¹æ³• æºç  doc ç¿»è¯‘ï¼šå°è¯•ä»¥ç‹¬å æ¨¡å¼è·å–ã€‚ å¦‚æœå¯¹è±¡çš„çŠ¶æ€å…è®¸ä»¥ç‹¬å æ¨¡å¼è·å–å®ƒï¼Œåˆ™æ­¤æ–¹æ³•åº”æŸ¥è¯¢ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è·å–å®ƒã€‚ æ‰§è¡Œ acquire çš„çº¿ç¨‹å§‹ç»ˆè°ƒç”¨æ­¤æ–¹æ³•ã€‚ å¦‚æœæ­¤æ–¹æ³•æŠ¥å‘Šå¤±è´¥ï¼Œåˆ™è·å–æ–¹æ³•å¯ä»¥å¯¹çº¿ç¨‹è¿›è¡Œæ’é˜Ÿï¼ˆå¦‚æœå®ƒå°šæœªæ’é˜Ÿï¼‰ï¼Œç›´åˆ°å®ƒé€šè¿‡æŸä¸ªå…¶ä»–çº¿ç¨‹çš„é‡Šæ”¾æ¥å‘å‡ºä¿¡å·ã€‚ è¿™å¯ç”¨äºLockç±»ä¸­å®ç°tryLock()æ–¹æ³•ã€‚ addWaiter()æ–¹æ³• æºç  doc ç¿»è¯‘ï¼šä¸ºå½“å‰çº¿ç¨‹å’Œç»™å®šæ¨¡å¼åˆ›å»ºèŠ‚ç‚¹å¹¶è¿›è¡Œæ’é˜Ÿã€‚ /** * å°†å½“å‰çº¿ç¨‹åŠ å…¥åˆ°ç­‰å¾…é˜Ÿåˆ—çš„é˜Ÿå°¾ï¼Œå¹¶è¿”å›å½“å‰çº¿ç¨‹æ‰€åœ¨çš„ç»“ç‚¹ */ private Node addWaiter(Node mode) { Node node = new Node(Thread.currentThread(), mode); // é¦–å…ˆå°è¯•åœ¨é“¾è¡¨çš„åé¢å¿«é€Ÿæ·»åŠ èŠ‚ç‚¹ Node pred = tail; if (pred != null) { node.prev = pred; // å°†è¯¥èŠ‚ç‚¹æ·»åŠ åˆ°é˜Ÿåˆ—å°¾éƒ¨ if (compareAndSetTail(pred, node)) { pred.next = node; return node; } } // å¦‚æœé¦–èŠ‚ç‚¹ä¸ºç©ºæˆ–è€…CASæ·»åŠ å¤±è´¥ï¼Œåˆ™è¿›å…¥enqæ–¹æ³•é€šè¿‡è‡ªæ—‹æ–¹å¼å…¥é˜Ÿåˆ—ï¼Œç¡®ä¿ä¸€å®šæˆåŠŸï¼Œè¿™æ˜¯ä¸€ä¸ªä¿åº•æœºåˆ¶ enq(node); return node; } enq()æ–¹æ³• æºç  doc ç¿»è¯‘ï¼šå°†èŠ‚ç‚¹æ’å…¥é˜Ÿåˆ—ï¼Œå¿…è¦æ—¶è¿›è¡Œåˆå§‹åŒ– ã€‚ é€šè¿‡è‡ªæ—‹é”çš„æ–¹å¼æ¥ä¿è¯èŠ‚ç‚¹å¯ä»¥æ­£ç¡®æ·»åŠ ï¼Œåªæœ‰æˆåŠŸæ·»åŠ åï¼Œå½“å‰çº¿ç¨‹æ‰ä¼šä»è¯¥æ–¹æ³•è¿”å›ï¼Œå¦åˆ™ä¼šä¸€ç›´æ‰§è¡Œä¸‹å» ã€‚ /** * å°†nodeåŠ å…¥é˜Ÿå°¾ */ private Node enq(final Node node) { // è‡ªæ—‹ for (;;) { Node t = tail; // å½“å‰æ²¡æœ‰èŠ‚ç‚¹ï¼Œæ„é€ ä¸€ä¸ªnew Node()ï¼Œå°†headå’ŒtailæŒ‡å‘å®ƒ if (t == null) { if (compareAndSetHead(new Node())) tail = head; } else { // å½“å‰æœ‰èŠ‚ç‚¹ï¼Œå°†ä¼ å…¥çš„Nodeæ”¾åœ¨é“¾è¡¨çš„æœ€å node.prev = t; if (compareAndSetTail(t, node)) { t.next = node; return t; } } } } acquireQueued()æ–¹æ³• æºç docç¿»è¯‘ï¼šå¯¹äºå·²ç»åœ¨é˜Ÿåˆ—ä¸­çš„çº¿ç¨‹ï¼Œä»¥ç‹¬å ä¸é—´æ–­æ¨¡å¼è·å–ã€‚ ç”±æ¡ä»¶ç­‰å¾…æ–¹æ³•ä½¿ç”¨ä»¥åŠè·å–ã€‚ é€šè¿‡tryAcquire()å’ŒaddWaiter()ï¼Œè¯¥çº¿ç¨‹è·å–èµ„æºå¤±è´¥ï¼Œå·²ç»è¢«æ”¾å…¥ç­‰å¾…é˜Ÿåˆ—å°¾éƒ¨äº†ã€‚ä¸‹ä¸€æ­¥éœ€è¦å¤„ç†çš„æ˜¯ï¼šè¿›å…¥ç­‰å¾…çŠ¶æ€ä¼‘æ¯ï¼Œç›´åˆ°å…¶ä»–çº¿ç¨‹å½»åº•é‡Šæ”¾èµ„æºåå”¤é†’è‡ªå·±ï¼Œè‡ªå·±å†æ‹¿åˆ°èµ„æºï¼Œç„¶åå°±å¯ä»¥å»å¹²è‡ªå·±æƒ³å¹²çš„äº‹äº†ã€‚å…¶å®å°±æ˜¯ä¸ªæ’é˜Ÿæ‹¿å·ï¼Œåœ¨ç­‰å¾…é˜Ÿåˆ—ä¸­æ’é˜Ÿæ‹¿å·ï¼Œç›´åˆ°æ‹¿åˆ°å·åå†è¿”å› ã€‚ final boolean acquireQueued(final Node node, int arg) { boolean failed = true; try { boolean interrupted = false; // æ ‡è®°ç­‰å¾…è¿‡ç¨‹ä¸­æ˜¯å¦è¢«ä¸­æ–­è¿‡ for (;;) { final Node p = node.predecessor(); // nodeçš„å‰ä¸€ä¸ªèŠ‚ç‚¹ // å¦‚æœå‰ä¸€ä¸ªèŠ‚ç‚¹æ˜¯headï¼Œè¯´æ˜å½“å‰nodeèŠ‚ç‚¹æ˜¯ç¬¬äºŒä¸ªèŠ‚ç‚¹ï¼Œæ¥ç€å°è¯•å»è·å–èµ„æº // å¯èƒ½æ˜¯headé‡Šæ”¾å®Œèµ„æºå”¤é†’è‡ªå·±çš„ï¼Œå½“ç„¶ä¹Ÿå¯èƒ½è¢«interruptäº† if (p == head &amp;&amp; tryAcquire(arg)) { setHead(node); p.next = null; // help GC failed = false; return interrupted; // è¿”å›ç­‰å¾…è¿‡ç¨‹ä¸­æ˜¯å¦è¢«ä¸­æ–­è¿‡ } // å¦‚æœè‡ªå·±å¯ä»¥ä¼‘æ¯äº†ï¼Œå°±è¿›å…¥waitingçŠ¶æ€ï¼Œç›´åˆ°è¢«unpark() if (shouldParkAfterFailedAcquire(p, node) &amp;&amp; parkAndCheckInterrupt()) interrupted = true; // å¦‚æœç­‰å¾…è¿‡ç¨‹ä¸­è¢«ä¸­æ–­è¿‡ï¼Œå“ªæ€•åªæœ‰é‚£ä¹ˆä¸€æ¬¡ï¼Œå°±å°†interruptedæ ‡è®°ä¸ºtrue } } finally { if (failed) cancelAcquire(node); } } shouldParkAfterFailedAcquire()æ–¹æ³• æºç  doc ç¿»è¯‘ï¼šæ£€æŸ¥å¹¶æ›´æ–°æ— æ³•è·å–çš„èŠ‚ç‚¹çš„çŠ¶æ€ã€‚ å¦‚æœçº¿ç¨‹åº”è¯¥é˜»å¡ï¼Œåˆ™è¿”å› trueã€‚ è¿™æ˜¯æ‰€æœ‰è·å–å¾ªç¯ä¸­çš„ä¸»è¦ä¿¡å·æ§åˆ¶ã€‚ éœ€è¦pred == node.prevã€‚ æ­¤æ–¹æ³•ä¸»è¦ç”¨äºæ£€æŸ¥çŠ¶æ€ï¼Œçœ‹çœ‹è‡ªå·±æ˜¯å¦çœŸçš„å¯ä»¥å»ä¼‘æ¯äº† å¦‚æœ pred çš„waitStatusæ˜¯SIGNALï¼Œç›´æ¥è¿”å›true å¦‚æœ pred çš„waitStatus&gt;0ï¼Œä¹Ÿå°±æ˜¯CANCELLEDï¼Œå‘å‰ä¸€ç›´æ‰¾åˆ°&lt;= 0çš„èŠ‚ç‚¹ï¼Œè®©èŠ‚ç‚¹çš„nextæŒ‡å‘node å¦‚æœ pred çš„waitStatus&lt;=0ï¼Œæ”¹æˆSIGNAL private static boolean shouldParkAfterFailedAcquire(Node pred, Node node) { int ws = pred.waitStatus; if (ws == Node.SIGNAL) // å¦‚æœå·²ç»å‘Šè¯‰å‰é©±æ‹¿å®Œå·åé€šçŸ¥è‡ªå·±ä¸€ä¸‹ï¼Œé‚£å°±å¯ä»¥ä¸€è¾¹ç©è›‹å»äº† return true; if (ws &gt; 0) { /* * å¦‚æœå‰èŠ‚ç‚¹æ”¾å¼ƒäº†ï¼Œé‚£å°±ä¸€ç›´å¾€å‰æ‰¾ï¼Œç›´åˆ°æ‰¾åˆ°æœ€è¿‘ä¸€ä¸ªæ­£å¸¸ç­‰å¾…çš„çŠ¶æ€ï¼Œå¹¶æ’åœ¨å®ƒçš„åè¾¹ã€‚ * æ³¨æ„ï¼šé‚£äº›æ”¾å¼ƒçš„ç»“ç‚¹ï¼Œç”±äºè¢«è‡ªå·±â€œåŠ å¡â€åˆ°å®ƒä»¬å‰è¾¹ï¼Œå®ƒä»¬ç›¸å½“äºå½¢æˆä¸€ä¸ªæ— å¼•ç”¨é“¾ï¼Œç¨åå°±ä¼šè¢«GCå›æ”¶ */ do { node.prev = pred = pred.prev; } while (pred.waitStatus &gt; 0); pred.next = node; } else { // å¦‚æœå‰èŠ‚ç‚¹æ­£å¸¸ï¼Œé‚£å°±æŠŠå‰èŠ‚ç‚¹çš„çŠ¶æ€è®¾ç½®æˆSIGNALï¼Œå‘Šè¯‰å®ƒæ‹¿å®Œå·åé€šçŸ¥ä¸‹ã€‚ compareAndSetWaitStatus(pred, ws, Node.SIGNAL); } return false; } parkAndCheckInterrupt()æ–¹æ³• /** * è®©çº¿ç¨‹å»ä¼‘æ¯ï¼ŒçœŸæ­£è¿›å…¥ç­‰å¾…çŠ¶æ€ */ private final boolean parkAndCheckInterrupt() { LockSupport.park(this); // è°ƒç”¨park()ä½¿çº¿ç¨‹è¿›å…¥waitingçŠ¶æ€ return Thread.interrupted(); // å¦‚æœè¢«å”¤é†’ï¼ŒæŸ¥çœ‹æ˜¯å¦è¢«ä¸­æ–­(è¯¥æ–¹æ³•ä¼šé‡ç½®æ ‡è¯†ä½) } acquireQueuedæ€»å…±åšäº†3ä»¶äº‹ï¼š ç»“ç‚¹è¿›å…¥é˜Ÿå°¾åï¼Œæ£€æŸ¥çŠ¶æ€ã€‚ è°ƒç”¨ park() è¿›å…¥waiting çŠ¶æ€ï¼Œç­‰å¾… unpark() æˆ– interrupt() å”¤é†’è‡ªå·±ã€‚ è¢«å”¤é†’åï¼Œçœ‹è‡ªå·±æ˜¯ä¸æ˜¯æœ‰èµ„æ ¼èƒ½æ‹¿åˆ°å·ã€‚å¦‚æœæ‹¿åˆ°ï¼Œhead æŒ‡å‘å½“å‰ç»“ç‚¹ï¼Œå¹¶è¿”å›ä»å…¥é˜Ÿåˆ°æ‹¿åˆ°å·çš„æ•´ä¸ªè¿‡ç¨‹ä¸­æ˜¯å¦è¢«ä¸­æ–­è¿‡ï¼›å¦‚æœæ²¡æ‹¿åˆ°ï¼Œç»§ç»­æµç¨‹ 1ã€‚ æµç¨‹å›¾å¦‚ä¸‹ï¼š release()æ–¹æ³• æ­¤æ–¹æ³•æ˜¯ç‹¬å æ¨¡å¼ä¸‹çº¿ç¨‹é‡Šæ”¾èµ„æºçš„é¡¶å±‚å…¥å£ã€‚å®ƒä¼šé‡Šæ”¾æŒ‡å®šé‡çš„èµ„æºï¼Œå¦‚æœå½»åº•é‡Šæ”¾äº†ï¼ˆå³ state=0ï¼‰,å®ƒä¼šå”¤é†’ç­‰å¾…é˜Ÿåˆ—é‡Œçš„å…¶ä»–çº¿ç¨‹æ¥è·å–èµ„æº ã€‚ /** * é‡Šæ”¾èµ„æº */ public final boolean release(int arg) { if (tryRelease(arg)) { Node h = head; if (h != null &amp;&amp; h.waitStatus != 0) unparkSuccessor(h); // å”¤é†’ç­‰å¾…é˜Ÿåˆ—é‡Œçš„ä¸‹ä¸€ä¸ªçº¿ç¨‹ return true; } return false; } tryRelease()æ–¹æ³• è·ŸtryAcquire()ä¸€æ ·ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¯éœ€è¦ç‹¬å æ¨¡å¼çš„è‡ªå®šä¹‰åŒæ­¥å™¨å»å®ç°çš„ã€‚æ­£å¸¸æ¥è¯´ï¼ŒtryRelease()éƒ½ä¼šæˆåŠŸçš„ï¼Œå› ä¸ºè¿™æ˜¯ç‹¬å æ¨¡å¼ï¼Œè¯¥çº¿ç¨‹æ¥é‡Šæ”¾èµ„æºï¼Œé‚£ä¹ˆå®ƒè‚¯å®šå·²ç»æ‹¿åˆ°ç‹¬å èµ„æºäº†ï¼Œç›´æ¥å‡æ‰ç›¸åº”é‡çš„èµ„æºå³å¯ï¼ˆstate-=argï¼‰ï¼Œä¹Ÿä¸éœ€è¦è€ƒè™‘çº¿ç¨‹å®‰å…¨çš„é—®é¢˜ã€‚ä½†è¦æ³¨æ„å®ƒçš„è¿”å›å€¼ï¼Œä¸Šé¢å·²ç»æåˆ°äº†ï¼Œrelease()æ˜¯æ ¹æ®tryRelease()çš„è¿”å›å€¼æ¥åˆ¤æ–­è¯¥çº¿ç¨‹æ˜¯å¦å·²ç»å®Œæˆé‡Šæ”¾æ‰èµ„æºäº†ï¼æ‰€ä»¥è‡ªä¹‰å®šåŒæ­¥å™¨åœ¨å®ç°æ—¶ï¼Œå¦‚æœå·²ç»å½»åº•é‡Šæ”¾èµ„æºï¼ˆstate=0ï¼‰ï¼Œè¦è¿”å› trueï¼Œå¦åˆ™è¿”å› falseã€‚ unparkSuccessor()æ–¹æ³• private void unparkSuccessor(Node node) { // è¿™é‡Œï¼Œnodeä¸€èˆ¬ä¸ºå½“å‰çº¿ç¨‹æ‰€åœ¨çš„ç»“ç‚¹ã€‚ int ws = node.waitStatus; if (ws &lt; 0) // ç½®é›¶å½“å‰çº¿ç¨‹æ‰€åœ¨çš„ç»“ç‚¹çŠ¶æ€ï¼Œå…è®¸å¤±è´¥ã€‚ compareAndSetWaitStatus(node, ws, 0); // æ‰¾åˆ°ä¸‹ä¸€ä¸ªéœ€è¦å”¤é†’çš„ç»“ç‚¹s Node s = node.next; if (s == null || s.waitStatus &gt; 0) { s = null; for (Node t = tail; t != null &amp;&amp; t != node; t = t.prev) if (t.waitStatus &lt;= 0) s = t; } if (s != null) LockSupport.unpark(s.thread); // å”¤é†’ } æ€»ç»“ä¸€ä¸‹ åœ¨ AQS ä¸­ç»´æŠ¤ç€ä¸€ä¸ª FIFO çš„åŒæ­¥é˜Ÿåˆ—ï¼Œå½“çº¿ç¨‹è·å–åŒæ­¥çŠ¶æ€å¤±è´¥åï¼Œåˆ™ä¼šåŠ å…¥åˆ°è¿™ä¸ª CLH åŒæ­¥é˜Ÿåˆ—çš„å¯¹å°¾å¹¶ä¸€ç›´ä¿æŒç€è‡ªæ—‹ã€‚åœ¨ CLH åŒæ­¥é˜Ÿåˆ—ä¸­çš„çº¿ç¨‹åœ¨è‡ªæ—‹æ—¶ä¼šåˆ¤æ–­å…¶å‰é©±èŠ‚ç‚¹æ˜¯å¦ä¸ºé¦–èŠ‚ç‚¹ï¼Œå¦‚æœä¸ºé¦–èŠ‚ç‚¹åˆ™ä¸æ–­å°è¯•è·å–åŒæ­¥çŠ¶æ€ï¼Œè·å–æˆåŠŸåˆ™é€€å‡º CLH åŒæ­¥é˜Ÿåˆ—ã€‚å½“çº¿ç¨‹æ‰§è¡Œå®Œé€»è¾‘åï¼Œä¼šé‡Šæ”¾åŒæ­¥çŠ¶æ€ï¼Œé‡Šæ”¾åä¼šå”¤é†’å…¶åç»§èŠ‚ç‚¹ã€‚ 3.9.2å…±äº«æ¨¡å¼ acquireShared()æ–¹æ³• æºç  doc ç¿»è¯‘:ä»¥å…±äº«æ¨¡å¼è·å–ï¼Œå¿½ç•¥ä¸­æ–­ã€‚ é€šè¿‡é¦–å…ˆè°ƒç”¨{@link #tryAcquireShared}æ¥å®ç°ï¼ŒæˆåŠŸè¿”å›ã€‚ å¦åˆ™çº¿ç¨‹æ’é˜Ÿï¼Œå¯èƒ½åå¤é˜»å¡å’Œè§£é™¤é˜»å¡ï¼Œè°ƒç”¨{@link #tryAcquireShared}ç›´åˆ°æˆåŠŸã€‚ ç®€å•ç‚¹è¯´å°±æ˜¯è¿™ä¸ªæ–¹æ³•ä¼šè·å–æŒ‡å®šé‡çš„èµ„æºï¼Œè·å–æˆåŠŸåˆ™ç›´æ¥è¿”å›ï¼Œè·å–å¤±è´¥åˆ™è¿›å…¥ç­‰å¾…é˜Ÿåˆ—ï¼Œç›´åˆ°è·å–åˆ°èµ„æºä¸ºæ­¢ï¼Œæ•´ä¸ªè¿‡ç¨‹å¿½ç•¥ä¸­æ–­ã€‚ public final void acquireShared(int arg) { if (tryAcquireShared(arg) &lt; 0) doAcquireShared(arg); } tryAcquireShared()æ–¹æ³• tryAcquireShared()ä¾ç„¶éœ€è¦è‡ªå®šä¹‰å®ç°ç±»å»å®ç°ã€‚ä½†æ˜¯ AQS å·²ç»æŠŠå…¶è¿”å›å€¼çš„è¯­ä¹‰å®šä¹‰å¥½äº†ï¼šè´Ÿå€¼ä»£è¡¨è·å–å¤±è´¥ï¼›0 ä»£è¡¨è·å–æˆåŠŸï¼Œä½†æ²¡æœ‰å‰©ä½™èµ„æºï¼›æ­£æ•°è¡¨ç¤ºè·å–æˆåŠŸï¼Œè¿˜æœ‰å‰©ä½™èµ„æºï¼Œå…¶ä»–çº¿ç¨‹è¿˜å¯ä»¥å»è·å–ã€‚ //å…±äº«å¼è·å–åŒæ­¥çŠ¶æ€ protected int tryAcquireShared(int arg) { throw new UnsupportedOperationException(); } doAcquireShared()æ–¹æ³• æºç  doc ç¿»è¯‘ï¼šä»¥å…±äº«ä¸é—´æ–­æ¨¡å¼è·å– æ­¤æ–¹æ³•ç”¨äºå°†å½“å‰çº¿ç¨‹åŠ å…¥ç­‰å¾…é˜Ÿåˆ—å°¾éƒ¨ä¼‘æ¯ï¼Œç›´åˆ°å…¶ä»–çº¿ç¨‹é‡Šæ”¾èµ„æºå”¤é†’è‡ªå·±ï¼Œè‡ªå·±æˆåŠŸæ‹¿åˆ°ç›¸åº”é‡çš„èµ„æºåæ‰è¿”å›ã€‚ private void doAcquireShared(int arg) { //é˜Ÿåˆ—å°¾éƒ¨æ·»åŠ å…±äº«æ¨¡å¼çš„èŠ‚ç‚¹ final Node node = addWaiter(Node.SHARED); boolean failed = true; try { boolean interrupted = false; for (;;) { final Node p = node.predecessor(); if (p == head) { //è·å–ä¸Šä¸€ä¸ªèŠ‚ç‚¹,å¦‚æœä¸Šä¸€ä¸ªèŠ‚ç‚¹æ—¶headï¼Œå°è¯•è·å–èµ„æº int r = tryAcquireShared(arg); if (r &gt;= 0) { setHeadAndPropagate(node, r);//æˆåŠŸæœ‰å‰©ä½™èµ„æºï¼Œå°†headæŒ‡å‘è‡ªå·±ï¼Œå”¤é†’ä¹‹åçš„çº¿ç¨‹ p.next = null; // help GC if (interrupted) selfInterrupt(); failed = false; return; } } if (shouldParkAfterFailedAcquire(p, node) &amp;&amp; parkAndCheckInterrupt()) interrupted = true; } } finally { if (failed) cancelAcquire(node); } } setHeadAndPropagate()æ–¹æ³• è®¾ç½®é˜Ÿåˆ—å¤´ï¼Œå¹¶æ£€æŸ¥åç»§è€…æ˜¯å¦åœ¨å…±äº«æ¨¡å¼ä¸‹ç­‰å¾…ï¼Œå¦‚æœæ˜¯ä¼ æ’­ï¼Œå¦‚æœä¼ æ’­&gt; 0æˆ–PROPAGATEçŠ¶æ€å·²è®¾ç½®ã€‚ è¿™ä¸ªæ–¹æ³•é™¤äº†é‡æ–°æ ‡è®° head æŒ‡å‘çš„èŠ‚ç‚¹å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªé‡è¦çš„ä½œç”¨ï¼Œé‚£å°±æ˜¯ propagateï¼ˆä¼ é€’ï¼‰ã€‚ private void setHeadAndPropagate(Node node, int propagate) { Node h = head; // Record old head for check below setHead(node); /* * Try to signal next queued node if: * Propagation was indicated by caller, * or was recorded (as h.waitStatus either before * or after setHead) by a previous operation * (note: this uses sign-check of waitStatus because * PROPAGATE status may transition to SIGNAL.) * and * The next node is waiting in shared mode, * or we don't know, because it appears null * * The conservatism in both of these checks may cause * unnecessary wake-ups, but only when there are multiple * racing acquires/releases, so most need signals now or soon * anyway. */ if (propagate &gt; 0 || h == null || h.waitStatus &lt; 0 || (h = head) == null || h.waitStatus &lt; 0) { Node s = node.next; if (s == null || s.isShared()) doReleaseShared(); } } doReleaseShared()æ–¹æ³• å…±äº«æ¨¡å¼çš„é‡Šæ”¾æ“ä½œ ï¼Œå‘å‡ºåç»­ä¿¡å·å¹¶ç¡®ä¿ä¼ æ’­ã€‚ ï¼ˆæ³¨æ„ï¼šå¯¹äºç‹¬å æ¨¡å¼ï¼Œå¦‚æœéœ€è¦ä¿¡å·ï¼Œåªéœ€è°ƒç”¨æ•°é‡æ¥è°ƒç”¨ head çš„ unparkSuccessorï¼‰ private void doReleaseShared() { /* * Ensure that a release propagates, even if there are other * in-progress acquires/releases. This proceeds in the usual * way of trying to unparkSuccessor of head if it needs * signal. But if it does not, status is set to PROPAGATE to * ensure that upon release, propagation continues. * Additionally, we must loop in case a new node is added * while we are doing this. Also, unlike other uses of * unparkSuccessor, we need to know if CAS to reset status * fails, if so rechecking. */ for (;;) { Node h = head; if (h != null &amp;&amp; h != tail) { int ws = h.waitStatus; if (ws == Node.SIGNAL) { if (!compareAndSetWaitStatus(h, Node.SIGNAL, 0)) continue; // loop to recheck cases unparkSuccessor(h); } else if (ws == 0 &amp;&amp; !compareAndSetWaitStatus(h, 0, Node.PROPAGATE)) continue; // loop on failed CAS } if (h == head) // loop if head changed break; } } acquireSharedæ€»ç»“ï¼š tryAcquireShared()å°è¯•è·å–èµ„æºï¼ŒæˆåŠŸåˆ™ç›´æ¥è¿”å›ã€‚ doAcquireShared()ä¼šå°†å½“å‰çº¿ç¨‹åŠ å…¥ç­‰å¾…é˜Ÿåˆ—å°¾éƒ¨ä¼‘æ¯ï¼Œç›´åˆ°å…¶ä»–çº¿ç¨‹é‡Šæ”¾èµ„æºå”¤é†’è‡ªå·±ã€‚å®ƒè¿˜ä¼šå°è¯•ç€è®©å”¤é†’ä¼ é€’åˆ°åé¢çš„èŠ‚ç‚¹ã€‚ releaseShared()æ–¹æ³• ä»¥å…±äº«æ¨¡å¼å‘å¸ƒã€‚, å¦‚æœ{@link #tryReleaseShared}è¿”å› trueï¼Œåˆ™é€šè¿‡è§£é™¤é˜»å¡ä¸€ä¸ªæˆ–å¤šä¸ªçº¿ç¨‹æ¥å®ç°ã€‚ public final boolean releaseShared(int arg) { if (tryReleaseShared(arg)) { doReleaseShared(); return true; } return false; } 4 javaè™šæ‹Ÿæœº 4.1 ç¨‹åºè®¡æ•°å™¨ çº¿ç¨‹ç§æœ‰ã€‚ç¨‹åºè®¡æ•°å™¨æ˜¯ä¸€å—è¾ƒå°çš„å†…å­˜ç©ºé—´ï¼Œä»–çš„ä½œç”¨å¯ä»¥çœ‹åšæ˜¯å½“å‰çº¿ç¨‹æ‰€æ‰§è¡Œçš„å­—èŠ‚ç çš„è¡Œå·æŒ‡ç¤ºå™¨ï¼Œåœ¨è™šæ‹Ÿæœºçš„æ¦‚å¿µæ¨¡å‹é‡Œï¼Œå­—èŠ‚ç è§£é‡Šå™¨å·¥ä½œæ—¶å°±æ˜¯é€šè¿‡æ”¹å˜è®¡æ•°å™¨çš„å€¼æ¥é€‰æ‹©ä¸‹ä¸€ä¸ªéœ€è¦æ‰§è¡Œçš„å­—èŠ‚ç æŒ‡ä»¤ï¼Œåˆ†æ”¯ã€å¾ªç¯ã€è·³è½¬ã€å¼‚å¸¸å¤„ç†ã€çº¿ç¨‹æ¢å¤ç­‰åŸºç¡€åŠŸèƒ½éƒ½éœ€è¦ä¾èµ–è®¡æ•°å™¨ã€‚ javaè™šæ‹Ÿæœºçš„å¤šçº¿ç¨‹æ˜¯é€šè¿‡çº¿ç¨‹è½®æµåˆ‡æ¢å¹¶åˆ†é…å¤„ç†å™¨æ‰§è¡Œæ—¶é—´çš„æ–¹å¼æ¥å®ç°çš„ï¼Œåœ¨ä»»ä½•ä¸€ä¸ªç¡®å®šçš„æ—¶åˆ»ï¼Œä¸€ä¸ªå¤„ç†å™¨åªä¼šæ‰§è¡Œä¸€æ¡çº¿ç¨‹ä¸­çš„æŒ‡ä»¤ã€‚å› æ­¤ï¼Œä¸ºäº†çº¿ç¨‹åˆ‡æ¢åèƒ½æ¢å¤åˆ°æ­£ç¡®çš„æ‰§è¡Œä½ç½®ï¼Œæ¯æ¡çº¿ç¨‹éƒ½éœ€è¦ä¸€ä¸ªç‹¬ç«‹çš„ç¨‹åºè®¡æ•°å™¨ã€‚ å¦‚æœçº¿ç¨‹æ‰§è¡Œçš„æ˜¯ä¸€ä¸ªjavaæ–¹æ³•ï¼Œè¿™ä¸ªè®¡æ•°å™¨è®°å½•çš„æ˜¯æ­£åœ¨æ‰§è¡Œçš„è™šæ‹Ÿæœºå­—èŠ‚ç æŒ‡ä»¤åœ°å€ï¼›å¦‚æœæ­£åœ¨æ‰§è¡Œçš„æ˜¯nativeæ–¹æ³•ï¼Œåˆ™è®¡æ•°å€¼ä¸ºç©ºï¼ˆundefinedï¼‰ 4.2 java è™šæ‹Ÿæœºæ ˆ çº¿ç¨‹ç§æœ‰ï¼Œæè¿°çš„æ˜¯javaæ–¹æ³•æ‰§è¡Œçš„å†…å­˜æ¨¡å‹ï¼Œç”Ÿå‘½å‘¨æœŸä¸çº¿ç¨‹å‘¨æœŸç›¸åŒã€‚æ¯ä¸ªæ–¹æ³•æ‰§è¡Œæ—¶éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ ˆå¸§ç”¨äºå­˜å‚¨å±€éƒ¨å˜é‡ã€æ“ä½œæ ˆã€åŠ¨æ€é“¾æ¥ã€æ–¹æ³•å‡ºå£ç­‰ä¿¡æ¯ï¼Œæ¯ä¸ªæ–¹æ³•è¢«è°ƒç”¨ç›´è‡³æ‰§è¡Œå®Œæˆè¿‡ç¨‹ï¼Œå¯¹åº”ä¸€ä¸ªæ ˆå¸§åœ¨è™šæ‹Ÿæœºæ ˆä¸­ä»å…¥æ ˆåˆ°å‡ºæ ˆçš„è¿‡ç¨‹ã€‚ 4.3 æœ¬åœ°æ–¹æ³•æ ˆ è·Ÿ4.2ç±»åŒ 4.4 javaå † å¯¹å¤§å¤šæ•°åº”ç”¨æ¥è¯´ï¼Œjavaå †æ˜¯javaè™šæ‹Ÿæœºæ‰€ç®¡ç†çš„å†…å­˜ä¸­æœ€å¤§çš„ä¸€å—ã€‚javaå †æ˜¯è¢«æ‰€æœ‰çº¿ç¨‹å…±äº«çš„ä¸€å—å†…å­˜åŒºåŸŸï¼Œåœ¨è™šæ‹Ÿæœºå¯åŠ¨æ—¶åˆ›å»ºã€‚æ­¤åŒºåŸŸçš„å”¯ä¸€ç›®çš„å°±æ˜¯å­˜æ”¾å¯¹è±¡å®ä¾‹ï¼Œå‡ ä¹æ‰€æœ‰çš„å¯¹è±¡å®ä¾‹éƒ½åœ¨è¿™é‡Œåˆ†é…å†…å­˜ã€‚ æ˜¯åƒåœ¾æ”¶é›†å™¨ç®¡ç†çš„ä¸»è¦åŒºåŸŸï¼Œå› æ­¤å¾ˆå¤šæ—¶å€™ä¹Ÿè¢«ç§°ä¸ºâ€œGCå †â€ï¼Œä»å†…å­˜ å›æ”¶çš„è§’åº¦çœ‹ï¼Œç°åœ¨æ”¶é›†å™¨åŸºæœ¬éƒ½æ˜¯é‡‡ç”¨åˆ†ä»£æ”¶é›†ç®—æ³•ï¼Œæ‰€ä»¥javaå †ä¸­è¿˜å¯ä»¥è¯¦ç»†åˆ†ä¸ºï¼šæ–°ç”Ÿä»£å’Œè€å¹´ä»£ç­‰ javaå †å‚»å¯ä»¥å¤„äºç‰©ç†ä¸Šä¸è¿ç»­çš„å†…å­˜ç©ºé—´ä¸­ï¼Œåªè¦é€»è¾‘ä¸Šæ˜¯è¿ç»­çš„å³å¯ï¼Œå½“å‰ä¸»æµè™šæ‹Ÿæœºéƒ½æ˜¯æŒ‰ç…§å¯æ‹“å±•æ¥å®ç°çš„ï¼Œé€šè¿‡è¯¥-Xmsåˆå§‹åŒ–å †ï¼Œ-Xmxæœ€å¤§å †ç©ºé—´ 4.5 æ–¹æ³•åŒº æ˜¯å„ä¸ªçº¿ç¨‹å…±äº«çš„å†…å­˜åŒºåŸŸï¼Œç”¨äºå­˜å‚¨å·²ç»è¢«è™šæ‹ŸæœºåŠ è½½çš„ç±»ä¿¡æ¯ï¼Œå¸¸é‡ï¼Œé™æ€å˜é‡ï¼Œå³æ—¶ç¼–è¯‘åçš„ä»£ç ç­‰æ•°æ®ã€‚ 4.6 è¿è¡Œæ—¶å¸¸é‡æ±  æ–¹æ³•åŒºçš„ä¸€éƒ¨åˆ†åˆ†ã€‚classæ–‡ä»¶ä¸­é™¤äº†æœ‰ç±»çš„ç‰ˆæœ¬ï¼Œæ–¹æ³•ï¼Œå­—æ®µï¼Œæ¥å£ç­‰æè¿°ä¿¡æ¯å¤–ï¼Œè¿˜æœ‰ä¸€é¡¹æ˜¯å¸¸é‡æ± ï¼Œç”¨äºå­˜æ”¾ç¼–è¯‘æœŸç”Ÿæˆçš„å„ç§å­—é¢é‡å’Œç¬¦å·å¼•ç”¨ï¼Œè¿™éƒ¨åˆ†å†…å®¹å°†åœ¨ç±»åŠ è½½åå­˜æ”¾åˆ°æ–¹æ³•åŒºçš„è¿è¡Œæ—¶å¸¸é‡æ± ä¸­ã€‚ è¿è¡Œæ—¶å¸¸é‡æ± ç›¸å¯¹äºClassæ–‡ä»¶å¸¸é‡æ± çš„å¦å¤–ä¸€ä¸ªé‡è¦ç‰¹å¾æ˜¯å…·å¤‡åŠ¨æ€æ€§, Javaè¯­è¨€å¹¶ä¸è¦æ±‚å¸¸é‡ä¸€å®šåªèƒ½åœ¨ç¼–è¯‘æœŸäº§ç”Ÿ, ä¹Ÿå°±æ˜¯å¹¶éé¢„ç½®å…¥Classæ–‡ä»¶ä¸­å¸¸é‡æ± çš„å†…å®¹æ‰èƒ½è¿›å…¥æ–¹æ³•åŒºè¿è¡Œæ—¶å¸¸é‡æ± , è¿è¡ŒæœŸé—´ä¹Ÿå¯èƒ½å°†æ–°çš„å¸¸é‡æ”¾å…¥ç¿…ä¸­, è¿™ç§ç‰¹æ€§è¢«å¼€å‘äººå‘˜åˆ©ç”¨çš„æ¯”è¾ƒå¤šçš„ä¾¿æ˜¯Stringç±»çš„intern() æ–¹æ³•.internæ–¹æ³•è¿˜æ˜¯ä¼šå…ˆå»æŸ¥è¯¢å¸¸é‡æ± ä¸­æ˜¯å¦æœ‰å·²ç»å­˜åœ¨ï¼Œå¦‚æœå­˜åœ¨ï¼Œåˆ™è¿”å›å¸¸é‡æ± ä¸­çš„å¼•ç”¨ï¼Œè¿™ä¸€ç‚¹ä¸ä¹‹å‰æ²¡æœ‰åŒºåˆ«ï¼ŒåŒºåˆ«åœ¨äºï¼Œå¦‚æœåœ¨å¸¸é‡æ± æ‰¾ä¸åˆ°å¯¹åº”çš„å­—ç¬¦ä¸²ï¼Œåˆ™ä¸ä¼šå†å°†å­—ç¬¦ä¸²æ‹·è´åˆ°å¸¸é‡æ± ï¼Œè€Œåªæ˜¯åœ¨å¸¸é‡æ± ä¸­ç”Ÿæˆä¸€ä¸ªå¯¹åŸå­—ç¬¦ä¸²çš„å¼•ç”¨ã€‚ 4.7 åƒåœ¾å›æ”¶æœºåˆ¶ 4.7.1 å¯¹è±¡å›æ”¶ç®—æ³• 1. å¼•ç”¨è®¡æ•°ç®—æ³•ã€‚ æ ¸å¿ƒæ€è·¯ä¸ºï¼Œç»™æ¯ä¸ªå¯¹è±¡æ·»åŠ ä¸€ä¸ªè¢«å¼•ç”¨è®¡æ•°å™¨ï¼Œè¢«å¼•ç”¨æ—¶+1ï¼Œå¼•ç”¨å¤±æ•ˆ-1ï¼Œç­‰äº0æ—¶è¡¨ç¤ºè¯¥å¯¹è±¡æ²¡æœ‰è¢«å¼•ç”¨ï¼Œå¯ä»¥è¢«å›æ”¶ã€‚FlashPlayer/Pythonä½¿ç”¨è¯¥ç®—æ³•ï¼Œç®€å•é«˜æ•ˆã€‚ä½†æ˜¯ï¼ŒJava/C#å¹¶ä¸é‡‡ç”¨è¯¥ç®—æ³•ï¼Œå› ä¸ºè¯¥ç®—æ³•æ²¡æœ‰è§£å†³å¯¹è±¡ç›¸äº’å¼•ç”¨çš„é—®é¢˜ï¼Œå³ï¼šå½“ä¸¤ä¸ªå¯¹è±¡ç›¸äº’å¼•ç”¨ä¸”ä¸è¢«å…¶å®ƒå¯¹è±¡å¼•ç”¨æ—¶ï¼Œå„è‡ªçš„å¼•ç”¨è®¡æ•°ä¸º1ï¼Œè™½ä¸ä¸º0ï¼Œä½†ä»ç„¶æ˜¯å¯è¢«å›æ”¶çš„åƒåœ¾å¯¹è±¡ã€‚ 2. å¯è¾¾åˆ†ææ³•ã€‚ ç¨‹åºæŠŠæ‰€æœ‰çš„å¼•ç”¨å…³ç³»çœ‹ä½œä¸€å¼ å›¾ï¼Œé€šè¿‡ä¸€ç³»åˆ—çš„åä¸ºGC Rootsçš„å¯¹è±¡ä½œä¸ºèµ·å§‹ç‚¹ï¼Œä»è¿™äº›èŠ‚ç‚¹å¼€å§‹å‘ä¸‹æœç´¢ï¼Œæœç´¢æ‰€èµ°è¿‡çš„è·¯å¾„ç§°ä¸ºå¼•ç”¨é“¾ã€‚å½“ä¸€ä¸ªå¯¹è±¡åˆ° GC Roots æ²¡æœ‰ä»»ä½•å¼•ç”¨é“¾ç›¸è¿ï¼ˆå°±æ˜¯ä» GC Roots åˆ°è¿™ä¸ªå¯¹è±¡ä¸å¯è¾¾ï¼‰æ—¶ï¼Œåˆ™è¯æ˜æ­¤å¯¹è±¡æ˜¯ä¸å¯ç”¨çš„ã€‚ 1ä¼šåœ¨cpuç©ºé—²çš„æ—¶å€™è‡ªåŠ¨è¿›è¡Œå›æ”¶ 2åœ¨å †å†…å­˜å­˜å‚¨æ»¡äº†ä¹‹å 3ä¸»åŠ¨è°ƒç”¨System.gc()åå°è¯•è¿›è¡Œå›æ”¶ 4.7.2 åƒåœ¾å›æ”¶ç®—æ³• 1. æ ‡è®°æ¸…é™¤ç®—æ³• æ ‡è®°-æ¸…é™¤ï¼ˆMark-Sweepï¼‰ç®—æ³•å¯ä»¥ç®—æ˜¯æœ€åŸºç¡€çš„åƒåœ¾æ”¶é›†ç®—æ³•ï¼Œè¯¥ç®—æ³•ä¸»è¦åˆ†ä¸ºâ€œæ ‡è®°â€å’Œâ€œæ¸…é™¤â€ä¸¤ä¸ªé˜¶æ®µã€‚å…ˆæ ‡è®°å¯ä»¥è¢«æ¸…é™¤çš„å¯¹è±¡ï¼Œç„¶åç»Ÿä¸€å›æ”¶è¢«æ ‡è®°è¦æ¸…é™¤çš„å¯¹è±¡ï¼Œè¿™ä¸ªæ ‡è®°è¿‡ç¨‹é‡‡ç”¨çš„å°±æ˜¯å¯è¾¾æ€§åˆ†æç®—æ³•ã€‚ æ ‡è®°æ¸…é™¤ç®—æ³•æœ€å¤§çš„ç¼ºç‚¹æ˜¯åœ¨åƒåœ¾å›æ”¶ä¹‹åä¼šäº§ç”Ÿå¤§é‡çš„å†…å­˜ç¢ç‰‡ï¼Œè€Œå¦‚æœå†…å­˜ç¢ç‰‡å¤šäº†ï¼Œå½“æˆ‘ä»¬å†åˆ›å»ºä¸€ä¸ªå ç”¨å†…å­˜æ¯”è¾ƒå¤§çš„å¯¹è±¡æ—¶å°±æ²¡æœ‰è¶³å¤Ÿçš„å†…å­˜æ¥åˆ†é…ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™è™šæ‹Ÿæœºå°±è¿˜è¦å†æ¬¡è§¦å‘GCæ¥æ¸…ç†å†…å­˜åæ¥ç»™æ–°çš„å¯¹è±¡åˆ†é…å†…å­˜ã€‚ 2. å¤åˆ¶ç®—æ³• ä¸ºäº†è§£å†³æ•ˆç‡é—®é¢˜åŠæ ‡è®°æ¸…é™¤ç®—æ³•çš„ç¼ºç‚¹ï¼Œä¸€ç§ç§°ä¸ºâ€œå¤åˆ¶â€ï¼ˆCopyingï¼‰çš„æ”¶é›†ç®—æ³•å‡ºç°äº†ï¼Œå®ƒå°†å¯ç”¨å†…å­˜æŒ‰å®¹é‡åˆ’åˆ†ä¸ºå¤§å°ç›¸ç­‰çš„ä¸¤å—ï¼Œæ¯æ¬¡åªä½¿ç”¨å…¶ä¸­ä¸€å—ï¼Œå½“è¿™ä¸€å—ç”¨å®Œäº†ï¼Œè§¦å‘GCæ“ä½œå°†å­˜æ´»çš„å¯¹è±¡å¤åˆ¶åˆ°å¦ä¸€ä¸ªåŒºåŸŸå½“ä¸­ï¼Œç„¶åå†æŠŠä½¿ç”¨è¿‡çš„å†…å­˜ç©ºé—´ä¸€æ¬¡æ¸…ç†æ‰ã€‚è¿™æ ·ä½¿å¾—æ¯æ¬¡éƒ½å¯¹æ•´ä¸ªåŠåŒºè¿›è¡Œå†…å­˜å›æ”¶ï¼Œå†…å­˜åˆ†é…ä¹Ÿä¸ç”¨è€ƒè™‘å†…å­˜ç¢ç‰‡çš„é—®é¢˜ï¼Œåªè¦ç§»åŠ¨å †é¡¶æŒ‡é’ˆï¼ŒæŒ‰é¡ºåºåˆ†é…å†…å­˜å³å¯ï¼Œå®ç°ç®€å•ï¼Œè¿è¡Œé«˜æ•ˆã€‚ è¿™ç§ç®—æ³•æœ€å¤§çš„ç¼ºç‚¹æ˜¯å°†åŸæœ‰å†…å­˜åˆ†æˆäº†ä¸¤å—ï¼Œæ¯æ¬¡åªèƒ½ä½¿ç”¨åŒºä¸­ä¸€å—ï¼Œä¹Ÿå°±æ˜¯æŸå¤±äº†50%çš„å†…å­˜ç©ºé—´ï¼Œä»£ä»·æœ‰ç‚¹å¤§ã€‚ 3. æ ‡è®°-æ•´ç†ç®—æ³• å¤åˆ¶ç®—æ³•åœ¨å¯¹è±¡å­˜æ´»ç‡è¾ƒé«˜çš„æƒ…å†µä¸‹éœ€è¦è¿›è¡Œè¾ƒå¤šçš„å¤åˆ¶æ“ä½œï¼Œè¿™æ ·æ•ˆç‡ä¹Ÿä¼šå˜ä½ï¼Œæ›´å…³é”®çš„æ˜¯è¿˜éœ€è¦æµªè´¹50%çš„å†…å­˜ç©ºé—´ï¼Œä¸ºäº†è§£å†³è¿™äº›é—®é¢˜ï¼Œäºæ˜¯â€œæ ‡è®°-æ•´ç†â€ï¼ˆMark-Compactï¼‰ç®—æ³•å°±å‡ºæ¥äº†ï¼Œæ ‡è®°è¿‡ç¨‹ä»ç„¶ä½¿ç”¨å¯è¾¾æ€§ç®—æ³•æ¥åˆ¤æ–­ï¼Œåç»­æ­¥éª¤ä¸æ˜¯ç›´æ¥å¯¹å¯å›æ”¶å¯¹è±¡è¿›è¡Œæ¸…ç†ï¼Œè€Œæ˜¯è®©æ‰€æœ‰å­˜æ´»çš„å¯¹è±¡å‘ä¸€ç«¯ç§»åŠ¨ï¼Œç„¶åç›´æ¥æ¸…ç†è¾¹ç•Œä»¥å¤–çš„å†…å­˜ã€‚æ ‡è®°-æ•´ç†ç®—æ³•æ¯”è¾ƒé€‚åˆå¹´è€ä»£çš„ç®—æ³•å®ç° 4. åˆ†ä»£æ”¶é›†ç®—æ³• å½“å‰å•†ä¸šè™šæ‹Ÿæœºçš„åƒåœ¾å›æ”¶éƒ½æ˜¯é‡‡ç”¨â€œåˆ†ä»£æ”¶é›†â€ï¼ˆGenerational Collectionï¼‰ç®—æ³•ï¼Œè¿™ç§ç®—æ³•å…¶å®å¹¶æ²¡æœ‰ä»€ä¹ˆæ–°çš„æ€æƒ³ï¼Œåªæ˜¯æ ¹æ®å¯¹è±¡çš„å­˜æ´»å‘¨æœŸçš„ä¸åŒå°†å†…å­˜åˆ’åˆ†ä¸ºå‡ å—ã€‚ä¸€èˆ¬æŠŠJavaå †åˆ†ä¸ºæ–°ç”Ÿä»£å’Œè€å¹´ä»£ï¼Œç„¶åæ ¹æ®ä¸åŒå¹´ä»£çš„ç‰¹ç‚¹é‡‡ç”¨é€‚å½“çš„æ”¶é›†ç®—æ³•ã€‚ 1ã€åœ¨æ–°ç”Ÿä»£ä¸­ï¼Œæ¯æ¬¡åƒåœ¾æ”¶é›†æ—¶éƒ½å‘ç°æœ‰å¤§æ‰¹å¯¹è±¡æ­»å»ï¼Œåªæœ‰å°‘é‡å­˜æ´»ï¼Œé‚£å°±é€‰ç”¨å¤åˆ¶ç®—æ³•ã€‚åªéœ€è¦ä»˜å‡ºå°‘é‡å­˜æ´»å¯¹è±¡çš„å¤åˆ¶æˆæœ¬å°±å¯ä»¥å®Œæˆæ”¶é›†ã€‚ 2ã€è€å¹´ä»£ä¸­å› ä¸ºå¯¹è±¡å­˜æ´»ç‡é«˜ã€æ²¡æœ‰é¢å¤–ç©ºé—´å¯¹ä»–è¿›è¡Œåˆ†é…æ‹…ä¿ï¼Œå°±å¿…é¡»ç”¨æ ‡è®°-æ¸…é™¤æˆ–è€…æ ‡è®°-æ•´ç†ã€‚ 4.7.3 åƒåœ¾æ”¶é›†å™¨ 1 Serialæ”¶é›†å™¨ ç‰¹æ€§: æœ€åŸºæœ¬ã€å‘å±•å†å²æœ€ä¹…çš„æ”¶é›†å™¨ï¼Œé‡‡ç”¨å¤åˆ¶ç®—æ³•çš„å•çº¿ç¨‹æ”¶é›†å™¨ï¼Œ**å•çº¿ç¨‹ä¸€æ–¹é¢æ„å‘³ç€å®ƒåªä¼šä½¿ç”¨ä¸€ä¸ªCPUæˆ–ä¸€æ¡çº¿ç¨‹å»å®Œæˆåƒåœ¾æ”¶é›†å·¥ä½œï¼Œå¦ä¸€æ–¹é¢ä¹Ÿæ„å‘³ç€åœ¨å®ƒè¿›è¡Œåƒåœ¾æ”¶é›†æ—¶ï¼Œå¿…é¡»æš‚åœå…¶ä»–æ‰€æœ‰çš„å·¥ä½œçº¿ç¨‹ï¼Œç›´åˆ°å®ƒæ”¶é›†ç»“æŸä¸ºæ­¢ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¹Ÿç§°ä¸º Stop The worldã€‚**åè€…æ„å‘³ç€ï¼Œåœ¨ç”¨æˆ·ä¸å¯è§çš„æƒ…å†µä¸‹è¦æŠŠç”¨æˆ·æ­£å¸¸å·¥ä½œçš„çº¿ç¨‹å…¨éƒ¨åœæ‰ï¼Œè¿™æ˜¾ç„¶å¯¹å¾ˆå¤šåº”ç”¨æ˜¯éš¾ä»¥æ¥å—çš„ã€‚ åº”ç”¨åœºæ™¯ï¼š Serialæ”¶é›†å™¨ä¾ç„¶æ˜¯è™šæ‹Ÿæœºè¿è¡Œåœ¨Clientæ¨¡å¼ä¸‹çš„é»˜è®¤æ–°ç”Ÿä»£æ”¶é›†å™¨ã€‚ åœ¨ç”¨æˆ·çš„æ¡Œé¢åº”ç”¨åœºæ™¯ä¸­ï¼Œå¯ç”¨å†…å­˜ä¸€èˆ¬ä¸å¤§ï¼ˆå‡ åMè‡³ä¸€ä¸¤ç™¾Mï¼‰ï¼Œå¯ä»¥åœ¨è¾ƒçŸ­æ—¶é—´å†…å®Œæˆåƒåœ¾æ”¶é›†ï¼ˆå‡ åMSè‡³ä¸€ç™¾å¤šMSï¼‰,åªè¦ä¸é¢‘ç¹å‘ç”Ÿï¼Œè¿™æ˜¯å¯ä»¥æ¥å—çš„ ä¼˜åŠ¿ï¼š ç®€å•è€Œé«˜æ•ˆï¼ˆä¸å…¶ä»–æ”¶é›†å™¨çš„å•çº¿ç¨‹ç›¸æ¯”ï¼‰ï¼Œå¯¹äºé™å®šå•ä¸ªCPUçš„ç¯å¢ƒæ¥è¯´ï¼ŒSerialæ”¶é›†å™¨ç”±äºæ²¡æœ‰çº¿ç¨‹äº¤äº’çš„å¼€é”€ï¼Œä¸“å¿ƒåšåƒåœ¾æ”¶é›†è‡ªç„¶å¯ä»¥è·å¾—æœ€é«˜çš„å•çº¿ç¨‹æ”¶é›†æ•ˆç‡ã€‚æ¯”å¦‚åœ¨ç”¨æˆ·çš„æ¡Œé¢åº”ç”¨åœºæ™¯ä¸­ï¼Œå¯ç”¨å†…å­˜ä¸€èˆ¬ä¸å¤§ï¼ˆå‡ åMè‡³ä¸€ä¸¤ç™¾Mï¼‰ï¼Œå¯ä»¥åœ¨è¾ƒçŸ­æ—¶é—´å†…å®Œæˆåƒåœ¾æ”¶é›†ï¼ˆå‡ åMSè‡³ä¸€ç™¾å¤šMSï¼‰,åªè¦ä¸é¢‘ç¹å‘ç”Ÿï¼Œè¿™æ˜¯å¯ä»¥æ¥å—çš„ã€‚ &quot;-XX:+UseSerialGC&quot;ï¼šæ·»åŠ è¯¥å‚æ•°æ¥æ˜¾å¼çš„ä½¿ç”¨ä¸²è¡Œåƒåœ¾æ”¶é›†å™¨ï¼› 2 ParNewæ”¶é›†å™¨ ç‰¹æ€§: ParNewæ”¶é›†å™¨å…¶å®å°±æ˜¯Serialæ”¶é›†å™¨çš„å¤šçº¿ç¨‹ç‰ˆæœ¬ï¼Œé™¤äº†ä½¿ç”¨å¤šæ¡çº¿ç¨‹è¿›è¡Œåƒåœ¾æ”¶é›†å¤–ï¼Œå…¶ä½™è¡Œä¸ºå’ŒSerialæ”¶é›†å™¨å®Œå…¨ä¸€æ ·ï¼ŒåŒ…æ‹¬Serialæ”¶é›†å™¨å¯ç”¨çš„æ‰€æœ‰æ§åˆ¶å‚æ•°ã€æ”¶é›†ç®—æ³•ã€Stop The worldã€å¯¹è±¡åˆ†é…è§„åˆ™ã€å›æ”¶ç­–ç•¥ç­‰éƒ½ä¸€æ ·ã€‚åœ¨å®ç°ä¸Šä¹Ÿå…±ç”¨äº†ç›¸å½“å¤šçš„ä»£ç ã€‚ åº”ç”¨åœºæ™¯ï¼š ParNewæ”¶é›†å™¨æ˜¯è®¸å¤šè¿è¡Œåœ¨Serveræ¨¡å¼ä¸‹çš„è™šæ‹Ÿæœºä¸­é¦–é€‰çš„æ–°ç”Ÿä»£æ”¶é›†å™¨ã€‚å¾ˆé‡è¦çš„åŸå› æ˜¯ï¼šé™¤äº†Serialæ”¶é›†å™¨ä¹‹å¤–ï¼Œç›®å‰åªæœ‰å®ƒèƒ½ä¸CMSæ”¶é›†å™¨é…åˆå·¥ä½œï¼ˆçœ‹å›¾ï¼‰ã€‚åœ¨JDK1.5æ—¶æœŸï¼ŒHotSpotæ¨å‡ºäº†ä¸€æ¬¾å‡ ä¹å¯ä»¥è®¤ä¸ºå…·æœ‰åˆ’æ—¶ä»£æ„ä¹‰çš„åƒåœ¾æ”¶é›†å™¨-----CMSæ”¶é›†å™¨ï¼Œè¿™æ¬¾æ”¶é›†å™¨æ˜¯HotSpotè™šæ‹Ÿæœºä¸­ç¬¬ä¸€æ¬¾çœŸæ­£æ„ä¹‰ä¸Šçš„å¹¶å‘æ”¶é›†å™¨ï¼Œå®ƒç¬¬ä¸€æ¬¡å®ç°äº†è®©åƒåœ¾æ”¶é›†çº¿ç¨‹ä¸ç”¨æˆ·çº¿ç¨‹åŒæ—¶å·¥ä½œã€‚ ä¼˜åŠ¿ï¼š åœ¨å•CPUä¸­çš„ç¯å¢ƒä¸­ï¼Œä¸ä¼šæ¯”Serailæ”¶é›†å™¨æœ‰æ›´å¥½çš„æ•ˆæœï¼Œå› ä¸ºå­˜åœ¨çº¿ç¨‹äº¤äº’å¼€é”€ï¼Œç”šè‡³ç”±äºçº¿ç¨‹äº¤äº’çš„å¼€é”€ï¼Œè¯¥æ”¶é›†å™¨åœ¨ä¸¤ä¸ªCPUçš„ç¯å¢ƒä¸­éƒ½ä¸èƒ½ç™¾åˆ†ç™¾ä¿è¯å¯ä»¥è¶…è¶ŠSerialæ”¶é›†å™¨ã€‚å½“ç„¶ï¼Œéšç€å¯ç”¨CPUæ•°é‡çš„å¢åŠ ï¼Œå®ƒå¯¹äºGCæ—¶ç³»ç»Ÿèµ„æºçš„æœ‰æ•ˆåˆ©ç”¨è¿˜æ˜¯å¾ˆæœ‰å¥½å¤„çš„ï¼Œå®ƒé»˜è®¤å¼€å¯çš„æ”¶é›†çº¿ç¨‹æ•°ä¸CPUæ•°é‡ç›¸åŒã€‚ è®¾ç½®å‚æ•°ï¼š****&quot;-XX:+UseConcMarkSweepGC&quot;ï¼šæŒ‡å®šä½¿ç”¨CMSåï¼Œä¼šé»˜è®¤ä½¿ç”¨ParNewä½œä¸ºæ–°ç”Ÿä»£æ”¶é›†å™¨ï¼›&quot;-XX:+UseParNewGC&quot;ï¼šå¼ºåˆ¶æŒ‡å®šä½¿ç”¨ParNewï¼› &quot;-XX:ParallelGCThreads&quot;ï¼šæŒ‡å®šåƒåœ¾æ”¶é›†çš„çº¿ç¨‹æ•°é‡ï¼ŒParNewé»˜è®¤å¼€å¯çš„æ”¶é›†çº¿ç¨‹ä¸CPUçš„æ•°é‡ç›¸åŒï¼› 3 Parallel Scavenge æ”¶é›†å™¨ ç‰¹æ€§: Parallel Scavengeæ”¶é›†å™¨æ˜¯ä¸€ä¸ªæ–°ç”Ÿä»£æ”¶é›†å™¨ï¼Œå®ƒä¹Ÿæ˜¯ä½¿ç”¨å¤åˆ¶ç®—æ³•çš„æ”¶é›†å™¨ï¼Œä¹Ÿæ˜¯å¹¶è¡Œçš„å¤šçº¿ç¨‹æ”¶é›†å™¨ã€‚ å¯¹æ¯”åˆ†æï¼š Parallel Scavengeæ”¶é›†å™¨ VS CMSç­‰æ”¶é›†å™¨ï¼š Parallel Scavengeæ”¶é›†å™¨çš„ç‰¹ç‚¹æ˜¯å®ƒçš„å…³æ³¨ç‚¹ä¸å…¶ä»–æ”¶é›†å™¨ä¸åŒï¼ŒCMSç­‰æ”¶é›†å™¨çš„å…³æ³¨ç‚¹æ˜¯å°½å¯èƒ½åœ°ç¼©çŸ­åƒåœ¾æ”¶é›†æ—¶ç”¨æˆ·çº¿ç¨‹çš„åœé¡¿æ—¶é—´ï¼Œè€ŒParallel Scavengeæ”¶é›†å™¨çš„ç›®æ ‡åˆ™æ˜¯è¾¾åˆ°ä¸€ä¸ªå¯æ§åˆ¶çš„ååé‡ï¼ˆThroughputï¼‰ã€‚ ç”±äºä¸ååé‡å…³ç³»å¯†åˆ‡ï¼ŒParallel Scavengeæ”¶é›†å™¨ä¹Ÿç»å¸¸ç§°ä¸ºâ€œååé‡ä¼˜å…ˆâ€æ”¶é›†å™¨ã€‚ Parallel Scavengeæ”¶é›†å™¨ VS ParNewæ”¶é›†å™¨ï¼š Parallel Scavengeæ”¶é›†å™¨ä¸ParNewæ”¶é›†å™¨çš„ä¸€ä¸ªé‡è¦åŒºåˆ«æ˜¯å®ƒå…·æœ‰è‡ªé€‚åº”è°ƒèŠ‚ç­–ç•¥ã€‚ åº”ç”¨åœºæ™¯ï¼š Parallel Scavengeæ”¶é›†å™¨æ˜¯è™šæ‹Ÿæœºè¿è¡Œåœ¨Serveræ¨¡å¼ä¸‹çš„é»˜è®¤åƒåœ¾æ”¶é›†å™¨ã€‚ åœé¡¿æ—¶é—´çŸ­é€‚åˆéœ€è¦ä¸ç”¨æˆ·äº¤äº’çš„ç¨‹åºï¼Œè‰¯å¥½çš„å“åº”é€Ÿåº¦èƒ½æå‡ç”¨æˆ·ä½“éªŒï¼›é«˜ååé‡åˆ™å¯ä»¥é«˜æ•ˆç‡åˆ©ç”¨CPUæ—¶é—´ï¼Œå°½å¿«å®Œæˆè¿ç®—ä»»åŠ¡ï¼Œä¸»è¦é€‚åˆåœ¨åå°è¿ç®—è€Œä¸éœ€è¦å¤ªå¤šäº¤äº’çš„ä»»åŠ¡ã€‚ è¯¥æ”¶é›†å™¨ä»¥é«˜ååé‡ä¸ºç›®æ ‡ï¼Œå°±æ˜¯å‡å°‘åƒåœ¾æ”¶é›†æ—¶é—´ï¼Œä»è€Œè®©ç”¨æˆ·ä»£ç è·å¾—æ›´é•¿çš„è¿è¡Œæ—¶é—´ã€‚æ‰€ä»¥é€‚åˆé‚£äº›è¿è¡Œåœ¨å¤šä¸ªCPUä¸Šï¼Œå¹¶ä¸”ä¸“æ³¨äºåå°è®¡ç®—çš„åº”ç”¨ç¨‹åºï¼Œä¾‹å¦‚ï¼šæ‰§è¡Œæ‰¹é‡å¤„ç†ä»»åŠ¡ã€è®¢å•å¤„ç†ï¼Œå·¥èµ„æ”¯ä»˜ï¼Œç§‘å­¦è®¡ç®—ç­‰ã€‚ è®¾ç½®å‚æ•°ï¼š è™šæ‹Ÿæœºæä¾›äº†-XX:MaxGCPauseMilliså’Œ-XX:GCTimeRatioä¸¤ä¸ªå‚æ•°æ¥ç²¾ç¡®æ§åˆ¶æœ€å¤§åƒåœ¾æ”¶é›†åœé¡¿æ—¶é—´å’Œååé‡å¤§å°ã€‚ä¸è¿‡ä¸è¦ä»¥ä¸ºå‰è€…è¶Šå°è¶Šå¥½ï¼ŒGCåœé¡¿æ—¶é—´çš„ç¼©çŸ­æ˜¯ä»¥ç‰ºç‰²ååé‡å’Œæ–°ç”Ÿä»£ç©ºé—´æ¢å–çš„ã€‚ &quot;-XX:+MaxGCPauseMillis&quot;ï¼šæ§åˆ¶æœ€å¤§åƒåœ¾æ”¶é›†åœé¡¿æ—¶é—´ï¼Œå¤§äº0çš„æ¯«ç§’æ•°ï¼›è¿™ä¸ªå‚æ•°è®¾ç½®çš„è¶Šå°ï¼Œåœé¡¿æ—¶é—´å¯èƒ½ä¼šç¼©çŸ­ï¼Œä½†ä¹Ÿä¼šå¯¼è‡´ååé‡ä¸‹é™ï¼Œå¯¼è‡´åƒåœ¾æ”¶é›†å‘ç”Ÿå¾—æ›´é¢‘ç¹ã€‚ â€‹ &quot;-XX:GCTimeRatio&quot;ï¼šè®¾ç½®åƒåœ¾æ”¶é›†æ—¶é—´å æ€»æ—¶é—´çš„æ¯”ç‡ï¼Œ0&lt;n&lt;100çš„æ•´æ•°ï¼Œå°±ç›¸å½“äºè®¾ç½®ååé‡çš„å¤§å°ã€‚åƒåœ¾æ”¶é›†æ‰§è¡Œæ—¶é—´å åº”ç”¨ç¨‹åºæ‰§è¡Œæ—¶é—´çš„æ¯”ä¾‹çš„è®¡ç®—æ–¹æ³•æ˜¯ï¼š 1 / (1 + n)ä¾‹å¦‚ï¼Œé€‰é¡¹-XX:GCTimeRatio=19ï¼Œè®¾ç½®äº†åƒåœ¾æ”¶é›†æ—¶é—´å æ€»æ—¶é—´çš„5%--1/(1+19)ï¼›é»˜è®¤å€¼æ˜¯1%--1/(1+99)ï¼Œå³n=99ï¼›åƒåœ¾æ”¶é›†æ‰€èŠ±è´¹çš„æ—¶é—´æ˜¯å¹´è½»ä¸€ä»£å’Œè€å¹´ä»£æ”¶é›†çš„æ€»æ—¶é—´ï¼› GCè‡ªé€‚åº”çš„è°ƒèŠ‚ç­–ç•¥ï¼š Parallel Scavengeæ”¶é›†å™¨æœ‰ä¸€ä¸ªå‚æ•°-XX:+UseAdaptiveSizePolicyã€‚å½“è¿™ä¸ªå‚æ•°æ‰“å¼€ä¹‹åï¼Œå°±ä¸éœ€è¦æ‰‹å·¥æŒ‡å®šæ–°ç”Ÿä»£çš„å¤§å°ã€Edenä¸SurvivoråŒºçš„æ¯”ä¾‹ã€æ™‹å‡è€å¹´ä»£å¯¹è±¡å¹´é¾„ç­‰ç»†èŠ‚å‚æ•°äº†ï¼Œè™šæ‹Ÿæœºä¼šæ ¹æ®å½“å‰ç³»ç»Ÿçš„è¿è¡Œæƒ…å†µæ”¶é›†æ€§èƒ½ç›‘æ§ä¿¡æ¯ï¼ŒåŠ¨æ€è°ƒæ•´è¿™äº›å‚æ•°ä»¥æä¾›æœ€åˆé€‚çš„åœé¡¿æ—¶é—´æˆ–è€…æœ€å¤§çš„ååé‡ï¼Œè¿™ç§è°ƒèŠ‚æ–¹å¼ç§°ä¸ºGCè‡ªé€‚åº”çš„è°ƒèŠ‚ç­–ç•¥ï¼ˆGC Ergonomicsï¼‰ã€‚å¦‚æœå¯¹äºåƒåœ¾æ”¶é›†å™¨è¿ä½œåŸç†ä¸å¤ªäº†è§£ï¼Œä»¥è‡³äºåœ¨ä¼˜åŒ–æ¯”è¾ƒå›°éš¾çš„æ—¶å€™ï¼Œä½¿ç”¨Parallelæ”¶é›†å™¨é…åˆè‡ªé€‚åº”è°ƒèŠ‚ç­–ç•¥ï¼ŒæŠŠå†…å­˜ç®¡ç†çš„è°ƒä¼˜ä»»åŠ¡äº¤ç»™è™šæ‹Ÿæœºå»å®Œæˆå°†æ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ã€‚ 4 CMSæ”¶é›†å™¨ CMSï¼ˆConcurrent Mark Sweepï¼‰æ”¶é›†å™¨æ˜¯ä¸€ç§ä»¥è·å–æœ€çŸ­å›æ”¶åœé¡¿æ—¶é—´ä¸ºç›®æ ‡çš„æ”¶é›†å™¨ã€‚ ç›®å‰å¾ˆå¤§ä¸€éƒ¨åˆ†çš„Javaåº”ç”¨é›†ä¸­åœ¨äº’è”ç½‘ç«™æˆ–è€…B/Sç³»ç»Ÿçš„æœåŠ¡ç«¯ä¸Šï¼Œè¿™ç±»åº”ç”¨å°¤å…¶é‡è§†æœåŠ¡çš„å“åº”é€Ÿåº¦ï¼Œå¸Œæœ›ç³»ç»Ÿåœé¡¿æ—¶é—´æœ€çŸ­ï¼Œä»¥ç»™ç”¨æˆ·å¸¦æ¥è¾ƒå¥½çš„ä½“éªŒã€‚CMSæ”¶é›†å™¨å°±éå¸¸ç¬¦åˆè¿™ç±»åº”ç”¨éœ€æ±‚ã€‚ ä»åå­—ï¼ˆåŒ…å«â€œMark Sweepâ€ï¼‰ä¸Šå°±å¯ä»¥çœ‹å‡ºï¼ŒCMSæ”¶é›†å™¨æ˜¯åŸºäºâ€œæ ‡è®°-æ¸…é™¤â€ç®—æ³•å®ç°çš„ï¼Œå®ƒçš„è¿ä½œè¿‡ç¨‹ç›¸å¯¹äºå‰é¢å‡ ç§æ”¶é›†å™¨æ¥è¯´æ›´å¤æ‚ä¸€äº›ï¼Œæ•´ä¸ªè¿‡ç¨‹åˆ†ä¸º4ä¸ªæ­¥éª¤ï¼ŒåŒ…æ‹¬ï¼š åˆå§‹æ ‡è®°ï¼ˆCMS initial markï¼‰ å¹¶å‘æ ‡è®°ï¼ˆCMS concurrent markï¼‰ é‡æ–°æ ‡è®°ï¼ˆCMS remarkï¼‰ å¹¶å‘æ¸…é™¤ï¼ˆCMS concurrent sweepï¼‰ å…¶ä¸­ï¼Œåˆå§‹æ ‡è®°ã€é‡æ–°æ ‡è®°è¿™ä¸¤ä¸ªæ­¥éª¤ä»ç„¶éœ€è¦â€œStop The Worldâ€ã€‚1.åˆå§‹æ ‡è®°ä»…ä»…åªæ˜¯æ ‡è®°ä¸€ä¸‹GC Rootsèƒ½ç›´æ¥å…³è”åˆ°çš„å¯¹è±¡ï¼Œé€Ÿåº¦å¾ˆå¿«ï¼›2.å¹¶å‘æ ‡è®°é˜¶æ®µå°±æ˜¯è¿›è¡ŒGC Roots Tracingçš„è¿‡ç¨‹ï¼›3.é‡æ–°æ ‡è®°é˜¶æ®µæ˜¯ä¸ºäº†ä¿®æ­£å¹¶å‘æ ‡è®°æœŸé—´å› ç”¨æˆ·ç¨‹åºç»§ç»­è¿ä½œè€Œå¯¼è‡´æ ‡è®°äº§ç”Ÿå˜åŠ¨çš„é‚£ä¸€éƒ¨åˆ†å¯¹è±¡çš„æ ‡è®°è®°å½•ï¼Œè¿™ä¸ªé˜¶æ®µçš„åœé¡¿æ—¶é—´ä¸€èˆ¬ä¼šæ¯”åˆå§‹æ ‡è®°é˜¶æ®µç¨é•¿ä¸€äº›ï¼Œä½†è¿œæ¯”å¹¶å‘æ ‡è®°çš„æ—¶é—´çŸ­ã€‚ ç”±äºæ•´ä¸ªè¿‡ç¨‹ä¸­è€—æ—¶æœ€é•¿çš„å¹¶å‘æ ‡è®°å’Œå¹¶å‘æ¸…é™¤è¿‡ç¨‹æ”¶é›†å™¨çº¿ç¨‹éƒ½å¯ä»¥ä¸ç”¨æˆ·çº¿ç¨‹ä¸€èµ·å·¥ä½œï¼Œæ‰€ä»¥ï¼Œä»æ€»ä½“ä¸Šæ¥è¯´ï¼ŒCMSæ”¶é›†å™¨çš„å†…å­˜å›æ”¶è¿‡ç¨‹æ˜¯ä¸ç”¨æˆ·çº¿ç¨‹ä¸€èµ·å¹¶å‘æ‰§è¡Œçš„ã€‚é€šè¿‡ä¸‹å›¾å¯ä»¥æ¯”è¾ƒæ¸…é™¤çœ‹è§CMSæ”¶é›†å™¨çš„è¿ä½œæ­¥éª¤ä¸­å¹¶å‘å’Œéœ€è¦åœé¡¿çš„æ—¶é—´ã€‚ **ä¼˜ç‚¹ï¼š**å¹¶å‘æ”¶é›†ã€ä½åœé¡¿ã€‚ ç¼ºç‚¹ï¼š CMSæ”¶é›†å™¨å¯¹CPUèµ„æºéå¸¸æ•æ„Ÿã€‚ å…¶å®ï¼Œé¢å‘å¹¶å‘è®¾è®¡çš„ç¨‹åºéƒ½å¯¹CUèµ„æºæ¯”è¾ƒæ•æ„Ÿã€‚åœ¨å¹¶å‘é˜¶æ®µï¼Œå®ƒè™½ç„¶ä¸ä¼šå¯¼è‡´ç”¨æˆ·çº¿ç¨‹åœé¡¿ï¼Œä½†æ˜¯ä¼šå› ä¸ºå ç”¨äº†ä¸€éƒ¨åˆ†çº¿ç¨‹ï¼ˆæˆ–è€…è¯´CPUèµ„æºï¼‰è€Œå¯¼è‡´åº”ç”¨ç¨‹åºå˜æ…¢ï¼Œæ€»ååé‡ä¼šé™ä½ã€‚ CMSé»˜è®¤å¯åŠ¨çš„å›æ”¶çº¿ç¨‹æ•°æ˜¯ï¼ˆCPUæ•°é‡+3ï¼‰/ 4ï¼Œä¹Ÿå°±æ˜¯å½“CPUåœ¨4ä¸ªä»¥ä¸Šæ—¶ï¼Œå¹¶å‘å›æ”¶æ—¶åƒåœ¾æ”¶é›†çº¿ç¨‹ä¸å°‘äº25%çš„CPUèµ„æºï¼Œå¹¶ä¸”éšç€CPUæ•°é‡çš„å¢åŠ è€Œä¸‹é™ã€‚ ä½†æ˜¯å½“CPUä¸è¶³4ä¸ªï¼ˆè­¬å¦‚2ä¸ªï¼‰æ—¶ï¼ŒCMSå¯¹ç”¨æˆ·ç¨‹åºçš„å½±å“å°±å¯èƒ½å˜å¾—æ›´å¤§ï¼Œå¦‚æœæœ¬æ¥CPUè´Ÿè½½æ¯”è¾ƒå¤§ï¼Œè¿˜åˆ†å‡ºä¸€åŠçš„è¿ç®—èƒ½åŠ›å»æ‰§è¡Œæ”¶é›†å™¨çº¿ç¨‹ï¼Œå°±å¯èƒ½å¯¼è‡´ç”¨æˆ·ç¨‹åºçš„æ‰§è¡Œé€Ÿåº¦å¿½ç„¶é™ä½äº†50%ï¼Œå…¶å®ä¹Ÿè®©äººæ— æ³•æ¥å—ã€‚ ä¸ºäº†åº”ä»˜è¿™ç§æƒ…å†µï¼Œè™šæ‹Ÿæœºæä¾›äº†ä¸€ç§ç§°ä¸ºâ€œå¢é‡å¼å¹¶å‘æ”¶é›†å™¨â€çš„CMSæ”¶é›†å™¨å˜ç§ï¼Œæ‰€åšçš„äº‹æƒ…å’Œå•CPUå¹´ä»£PCæœºæ“ä½œç³»ç»Ÿä½¿ç”¨æŠ¢å å¼æ¥æ¨¡æ‹Ÿå¤šä»»åŠ¡æœºåˆ¶çš„æ€æƒ³ä¸€æ ·ï¼Œå°±æ˜¯åœ¨å¹¶å‘æ ‡è®°ã€æ¸…ç†çš„æ—¶å€™è®©GCçº¿ç¨‹ã€ç”¨æˆ·çº¿ç¨‹äº¤æ›¿è¿è¡Œï¼Œå°½é‡å‡å°‘GCçº¿ç¨‹çš„ç‹¬å èµ„æºçš„æ—¶é—´ï¼Œè¿™æ ·æ•´ä¸ªåƒåœ¾æ”¶é›†çš„è¿‡ç¨‹ä¼šæ›´é•¿ï¼Œä½†å¯¹ç”¨æˆ·ç¨‹åºçš„å½±å“å°±ä¼šæ˜¾å¾—å°‘ä¸€äº›ï¼Œä¹Ÿå°±æ˜¯é€Ÿåº¦ä¸‹é™æ²¡æœ‰é‚£ä¹ˆæ˜æ˜¾ã€‚ å®è·µè¯æ˜ï¼Œå¢é‡æ—¶çš„CMSæ”¶é›†å™¨æ•ˆæœå¾ˆä¸€èˆ¬ï¼Œåœ¨ç›®å‰ç‰ˆæœ¬ä¸­ï¼Œi-CMSå·²ç»è¢«å£°æ˜ä¸ºâ€œdeprecatedâ€ï¼Œå³ä¸å†æå€¡ç”¨æˆ·ä½¿ç”¨ã€‚ CMSæ”¶é›†å™¨æ— æ³•å¤„ç†æµ®åŠ¨åƒåœ¾ï¼Œå¯èƒ½å‡ºç°â€œConcurrent Mode Failureâ€å¤±è´¥è€Œå¯¼è‡´å¦ä¸€æ¬¡Full GCçš„äº§ç”Ÿã€‚ ç”±äºCMSå¹¶å‘æ¸…ç†é˜¶æ®µç”¨æˆ·çº¿ç¨‹è¿˜åœ¨è¿è¡Œç€ï¼Œä¼´éšç¨‹åºè¿è¡Œè‡ªç„¶å°±è¿˜ä¼šæœ‰æ–°çš„åƒåœ¾ä¸æ–­äº§ç”Ÿï¼Œè¿™ä¸€éƒ¨åˆ†åƒåœ¾å‡ºç°åœ¨æ ‡è®°è¿‡ä¸€éƒ¨åˆ†åƒåœ¾å°±ç§°ä¸ºâ€œæµ®åŠ¨åƒåœ¾â€ã€‚ ä¹Ÿæ˜¯ç”±äºåƒåœ¾æ”¶é›†é˜¶æ®µç”¨æˆ·çº¿ç¨‹è¿˜éœ€è¦è¿è¡Œï¼Œé‚£ä¹Ÿå°±éœ€è¦é¢„ç•™æœ‰è¶³å¤Ÿçš„å†…å­˜ç©ºé—´ç»™ç”¨æˆ·çº¿ç¨‹ä½¿ç”¨ï¼Œå› æ­¤CMSæ”¶é›†å™¨ä¸èƒ½åƒå…¶ä»–æ”¶é›†å™¨é‚£æ ·ç­‰åˆ°è€å¹´ä»£å‡ ä¹å®Œå…¨è¢«å¡«æ»¡äº†å†è¿›è¡Œæ”¶é›†ï¼Œéœ€è¦é¢„ç•™ä¸€éƒ¨åˆ†ç©ºé—´æä¾›å¹¶å‘æ”¶é›†æ—¶çš„ç¨‹åºè¿ä½œä½¿ç”¨ã€‚ åœ¨JDK1.5çš„é»˜è®¤è®¾ç½®ä¸‹ï¼ŒCMSæ”¶é›†å™¨å½“è€å¹´ä»£ä½¿ç”¨äº†68%çš„ç©ºé—´åå°±ä¼šè¢«æ¿€æ´»ï¼Œè¿™æ˜¯ä¸€ä¸ªåä¿å®ˆçš„è®¾ç½®ï¼Œå¦‚æœåœ¨åº”ç”¨ä¸­è€å¹´ä»£å¢é•¿ä¸æ˜¯å¤ªå¿«ï¼Œå¯ä»¥é€‚å½“è°ƒé«˜å‚æ•°-XX:CMSInitiatingOccupancyFractionçš„å€¼æ¥æé«˜è§¦å‘ç™¾åˆ†æ¯”ï¼Œä»¥ä¾¿é™ä½å†…å­˜å›æ”¶æ¬¡æ•°ä»è€Œè·å–æ›´å¥½çš„æ€§èƒ½ã€‚ åœ¨JDK1.6ä¸­ï¼ŒCMSæ”¶é›†å™¨çš„å¯åŠ¨é˜ˆå€¼å·²ç»æå‡è‡³92%ã€‚è¦æ˜¯CMSè¿è¡ŒæœŸé—´é¢„ç•™çš„å†…å­˜æ— æ³•æ»¡è¶³ç¨‹åºéœ€è¦ï¼Œå°±ä¼šå‡ºç°ä¸€æ¬¡â€œConcurrent Mode Failureâ€å¤±è´¥ï¼Œè¿™æ—¶è™šæ‹Ÿæœºå°†å¯åŠ¨åå¤‡é¢„æ¡ˆï¼šä¸´æ—¶å¯åŠ¨Serial Olæ”¶é›†å™¨æ¥é‡æ–°è¿›è¡Œè€å¹´ä»£çš„åƒåœ¾æ”¶é›†ï¼Œè¿™æ ·åœé¡¿æ—¶é—´å°±å¾ˆé•¿äº†ã€‚æ‰€ä»¥è¯´å‚æ•°-XX:CMSInitiatingOccupancyFractionè®¾ç½®å¾—å¤ªé«˜å¾ˆå®¹æ˜“å¯¼è‡´å¤§é‡â€œConcurrent Mode Failureâ€å¤±è´¥ï¼Œæ€§èƒ½åè€Œé™ä½ã€‚ CMSæ˜¯ä¸€æ¬¾åŸºäºâ€œæ ‡è®°-æ¸…é™¤â€ç®—æ³•å®ç°çš„æ”¶é›†å™¨ï¼Œè¿™æ„å‘³ç€æ”¶é›†ç»“æŸæ—¶ä¼šæœ‰å¤§é‡ç©ºé—´ç¢ç‰‡äº§ç”Ÿã€‚ ç©ºé—´ç¢ç‰‡è¿‡å¤šæ—¶ï¼Œå°†ä¼šç»™å¤§å¯¹è±¡åˆ†é…å¸¦æ¥å¾ˆå¤§éº»çƒ¦ï¼Œå¾€å¾€ä¼šå‡ºç°è€å¹´ä»£è¿˜æœ‰å¾ˆå¤§ç©ºé—´å‰©ä½™ï¼Œä½†æ˜¯æ— æ³•æ‰¾åˆ°è¶³å¤Ÿå¤§çš„è¿ç»­ç©ºé—´æ¥åˆ†é…å½“å‰å¯¹è±¡ï¼Œä¸å¾—ä¸æå‰è§¦å‘ä¸€æ¬¡Full GCã€‚ ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒCMSæ”¶é›†å™¨æä¾›äº†ä¸€ä¸ª-XX:+UseCMSCompactAtFullCollectionå¼€å…³å‚æ•°ï¼ˆé»˜è®¤æ˜¯å¼€å¯çš„ï¼‰ï¼Œç”¨äºåœ¨CMSæ”¶é›†å™¨é¡¶ä¸ä½è¦è¿›è¡ŒFullGCæ—¶å¼€å¯å†…å­˜ç¢ç‰‡çš„åˆå¹¶æ•´ç†è¿‡ç¨‹ï¼Œå†…å­˜æ•´ç†çš„è¿‡ç¨‹æ˜¯æ— æ³•å¹¶å‘çš„ï¼Œç©ºé—´ç¢ç‰‡é—®é¢˜æ²¡æœ‰äº†ï¼Œä½†åœé¡¿æ—¶é—´ä¸å¾—ä¸å˜é•¿ã€‚ è™šæ‹Ÿæœºè®¾è®¡è€…è¿˜æä¾›äº†å¦å¤–ä¸€ä¸ªå‚æ•°-XX:CMSFullGCsBeforeCompactionï¼Œè¿™ä¸ªå‚æ•°æ˜¯ç”¨äºè®¾ç½®æ‰§è¡Œå¤šå°‘æ¬¡ä¸å‹ç¼©çš„Full GCåï¼Œè·Ÿç€æ¥ä¸€æ¬¡å¸¦å‹ç¼©çš„ï¼ˆé»˜è®¤å€¼ä¸º0ï¼Œè¡¨ç¤ºæ¯æ¬¡è¿›å…¥Full GCæ—¶éƒ½è¿›è¡Œç¢ç‰‡æ•´ç†ï¼‰ã€‚ 5 G1æ”¶é›†å™¨ G1ï¼ˆGarbage-Firstï¼‰ï¼Œå®ƒæ˜¯ä¸€æ¬¾é¢å‘æœåŠ¡ç«¯åº”ç”¨çš„åƒåœ¾æ”¶é›†å™¨ï¼Œåœ¨å¤š CPU å’Œå¤§å†…å­˜çš„åœºæ™¯ä¸‹æœ‰å¾ˆå¥½çš„æ€§èƒ½ã€‚HotSpot å¼€å‘å›¢é˜Ÿèµ‹äºˆå®ƒçš„ä½¿å‘½æ˜¯æœªæ¥å¯ä»¥æ›¿æ¢æ‰ CMS æ”¶é›†å™¨ã€‚ å †è¢«åˆ†ä¸ºæ–°ç”Ÿä»£å’Œè€å¹´ä»£ï¼Œå…¶å®ƒæ”¶é›†å™¨è¿›è¡Œæ”¶é›†çš„èŒƒå›´éƒ½æ˜¯æ•´ä¸ªæ–°ç”Ÿä»£æˆ–è€…è€å¹´ä»£ï¼Œè€Œ G1 å¯ä»¥ç›´æ¥å¯¹æ–°ç”Ÿä»£å’Œè€å¹´ä»£ä¸€èµ·å›æ”¶ã€‚ G1 æŠŠå †åˆ’åˆ†æˆå¤šä¸ªå¤§å°ç›¸ç­‰çš„ç‹¬ç«‹åŒºåŸŸï¼ˆRegionï¼‰ï¼Œæ–°ç”Ÿä»£å’Œè€å¹´ä»£ä¸å†ç‰©ç†éš”ç¦»ã€‚ é€šè¿‡å¼•å…¥ Region çš„æ¦‚å¿µï¼Œä»è€Œå°†åŸæ¥çš„ä¸€æ•´å—å†…å­˜ç©ºé—´åˆ’åˆ†æˆå¤šä¸ªçš„å°ç©ºé—´ï¼Œä½¿å¾—æ¯ä¸ªå°ç©ºé—´å¯ä»¥å•ç‹¬è¿›è¡Œåƒåœ¾å›æ”¶ã€‚è¿™ç§åˆ’åˆ†æ–¹æ³•å¸¦æ¥äº†å¾ˆå¤§çš„çµæ´»æ€§ï¼Œä½¿å¾—å¯é¢„æµ‹çš„åœé¡¿æ—¶é—´æ¨¡å‹æˆä¸ºå¯èƒ½ã€‚é€šè¿‡è®°å½•æ¯ä¸ª Region åƒåœ¾å›æ”¶æ—¶é—´ä»¥åŠå›æ”¶æ‰€è·å¾—çš„ç©ºé—´ï¼ˆè¿™ä¸¤ä¸ªå€¼æ˜¯é€šè¿‡è¿‡å»å›æ”¶çš„ç»éªŒè·å¾—ï¼‰ï¼Œå¹¶ç»´æŠ¤ä¸€ä¸ªä¼˜å…ˆåˆ—è¡¨ï¼Œæ¯æ¬¡æ ¹æ®å…è®¸çš„æ”¶é›†æ—¶é—´ï¼Œä¼˜å…ˆå›æ”¶ä»·å€¼æœ€å¤§çš„ Regionï¼Œè¿™ä¹Ÿæ˜¯ G1 (Garbage-First) åç§°çš„æ¥ç”±ã€‚æ¯ä¸ª Region éƒ½æœ‰ä¸€ä¸ª Remembered Setï¼Œç”¨æ¥è®°å½•è¯¥ Region å¯¹è±¡çš„å¼•ç”¨å¯¹è±¡æ‰€åœ¨çš„ Regionã€‚é€šè¿‡ä½¿ç”¨ Remembered Setï¼Œåœ¨åšå¯è¾¾æ€§åˆ†æçš„æ—¶å€™å°±å¯ä»¥é¿å…å…¨å †æ‰«æã€‚ å¦‚æœä¸è®¡ç®—ç»´æŠ¤ Remembered Set çš„æ“ä½œï¼ŒG1 æ”¶é›†å™¨çš„è¿ä½œå¤§è‡´å¯åˆ’åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š åˆå§‹æ ‡è®°ï¼šä»…ä»…åªæ˜¯æ ‡è®°ä¸€ä¸‹GC Rootsèƒ½ç›´æ¥å…³è”çš„å¯¹è±¡ï¼Œå¹¶ä¸”ä¿®æ”¹TAMS(Next Top at Mark Start)çš„å€¼ï¼Œè®©ä¸‹ä¸€é˜¶æ®µç”¨æˆ·ç¨‹åºå¹¶å‘æ‰§è¡Œè¿è¡Œæ—¶ï¼Œèƒ½åœ¨æ­£ç¡®å¯ç”¨çš„Tegionä¸­åˆ›å»ºæ–°å¯¹è±¡ï¼Œè¿™é˜¶æ®µéœ€è¦åœé¡¿çº¿ç¨‹ï¼Œå•è€—æ—¶å¾ˆçŸ­ã€‚ å¹¶å‘æ ‡è®°ï¼šä»GC Rootå¼€å§‹å¯¹å †ä¸­çš„å¯¹è±¡è¿›è¡Œå¯è¾¾æ€§æ€§åˆ†æï¼Œæ‰¾å‡ºå­˜æ´»çš„å¯¹è±¡ï¼Œè¿™é˜¶æ®µè€—æ—¶è¾ƒé•¿ï¼Œä½†å¯ä¸ç”¨æˆ·ç¨‹åºå§å¹¶å‘æ‰§è¡Œã€‚ æœ€ç»ˆæ ‡è®°ï¼šä¸ºäº†ä¿®æ­£åœ¨å¹¶å‘æ ‡è®°æœŸé—´å› ç”¨æˆ·ç¨‹åºç»§ç»­è¿ä½œè€Œå¯¼è‡´æ ‡è®°äº§ç”Ÿå˜åŠ¨çš„é‚£ä¸€éƒ¨åˆ†æ ‡è®°è®°å½•ï¼Œè™šæ‹Ÿæœºå°†è¿™æ®µæ—¶é—´å¯¹è±¡å˜åŒ–è®°å½•åœ¨çº¿ç¨‹çš„ Remembered Set Logs é‡Œé¢ï¼Œæœ€ç»ˆæ ‡è®°é˜¶æ®µéœ€è¦æŠŠ Remembered Set Logs çš„æ•°æ®åˆå¹¶åˆ° Remembered Set ä¸­ã€‚è¿™é˜¶æ®µéœ€è¦åœé¡¿çº¿ç¨‹ï¼Œä½†æ˜¯å¯å¹¶è¡Œæ‰§è¡Œã€‚ ç­›é€‰å›æ”¶ï¼šé¦–å…ˆå¯¹å„ä¸ª Region ä¸­çš„å›æ”¶ä»·å€¼å’Œæˆæœ¬è¿›è¡Œæ’åºï¼Œæ ¹æ®ç”¨æˆ·æ‰€æœŸæœ›çš„ GC åœé¡¿æ—¶é—´æ¥åˆ¶å®šå›æ”¶è®¡åˆ’ã€‚æ­¤é˜¶æ®µå…¶å®ä¹Ÿå¯ä»¥åšåˆ°ä¸ç”¨æˆ·ç¨‹åºä¸€èµ·å¹¶å‘æ‰§è¡Œï¼Œä½†æ˜¯å› ä¸ºåªå›æ”¶ä¸€éƒ¨åˆ† Regionï¼Œæ—¶é—´æ˜¯ç”¨æˆ·å¯æ§åˆ¶çš„ï¼Œè€Œä¸”åœé¡¿ç”¨æˆ·çº¿ç¨‹å°†å¤§å¹…åº¦æé«˜æ”¶é›†æ•ˆç‡ã€‚ å…·å¤‡å¦‚ä¸‹ç‰¹ç‚¹ï¼š å¹¶è¡Œä¸å¹¶å‘ï¼šG1 èƒ½å¤Ÿåˆ©ç”¨å¤šCPUã€å¤šæ ¸ä¼˜åŠ¿ï¼Œç¼©çŸ­ STWï¼ˆStop The Worldï¼‰çš„æ—¶é—´ï¼Œéƒ¨åˆ†å…¶å®ƒæ”¶é›†å™¨åŸæœ¬éœ€è¦åœé¡¿ Java çº¿ç¨‹æ‰§è¡Œçš„ GC æ“ä½œï¼ŒG1 æ”¶é›†å™¨ä»ç„¶å¯ä»¥é€šè¿‡å¹¶å‘çš„æ–¹å¼è®© Java ç¨‹åºç»§ç»­æ‰§è¡Œã€‚ åˆ†ä»£æ”¶é›†ï¼š åˆ†ä»£æ¦‚å¿µåœ¨ G1 ä¸­ä»ç„¶ä¿ç•™ï¼Œè™½ç„¶ G1 å¯ä»¥ä¸éœ€è¦å…¶ä»–æ”¶é›†å™¨é…åˆå°±èƒ½ç‹¬ç«‹ç®¡ç†æ•´ä¸ª GC å †ï¼Œä½†å®ƒä»ç„¶èƒ½å¤Ÿé‡‡å–ä¸åŒçš„æ–¹å¼å»å¤„ç†æ–°åˆ›å»ºçš„å¯¹è±¡å’Œå·²ç»å­˜æ´»äº†ä¸€æ®µæ—¶é—´ã€ç†¬è¿‡å¤šæ¬¡ GC çš„æ—§å¯¹è±¡ä»¥è·å–æ›´å¥½çš„æ•ˆæœã€‚ ç©ºé—´æ•´åˆï¼šæ•´ä½“æ¥çœ‹æ˜¯åŸºäº æ ‡è®° - æ•´ç† ç®—æ³•å®ç°çš„æ”¶é›†å™¨ï¼Œä»å±€éƒ¨ï¼ˆä¸¤ä¸ª Region ä¹‹é—´ï¼‰ä¸Šæ¥çœ‹æ˜¯åŸºäº å¤åˆ¶ ç®—æ³•å®ç°çš„ï¼Œè¿™æ„å‘³ç€è¿è¡ŒæœŸé—´ä¸ä¼šäº§ç”Ÿå†…å­˜ç©ºé—´ç¢ç‰‡ã€‚ å¯é¢„æµ‹çš„åœé¡¿ï¼šèƒ½è®©ä½¿ç”¨è€…æ˜ç¡®æŒ‡å®šåœ¨ä¸€ä¸ªé•¿åº¦ä¸º M æ¯«ç§’çš„æ—¶é—´ç‰‡æ®µå†…ï¼Œæ¶ˆè€—åœ¨ GC ä¸Šçš„æ—¶é—´ä¸å¾—è¶…è¿‡ N æ¯«ç§’ã€‚ 4.7.4 å†…å­˜åˆ†é…ä¸å›æ”¶ç­–ç•¥ 1. Minor GCä¸Full GC Minor GCï¼šæŒ‡å‘ç”Ÿåœ¨æ–°ç”Ÿä»£ä¸Šçš„åƒåœ¾æ”¶é›†åŠ¨ä½œï¼Œå› ä¸ºæ–°ç”Ÿä»£å¯¹è±¡å­˜æ´»æ—¶é—´å¾ˆçŸ­ï¼Œå› æ­¤ Minor GC ä¼šé¢‘ç¹æ‰§è¡Œï¼Œæ‰§è¡Œçš„é€Ÿåº¦ä¸€èˆ¬ä¹Ÿä¼šæ¯”è¾ƒå¿«ã€‚ Full GCï¼ˆMajor GCï¼‰ï¼šæŒ‡å‘ç”Ÿåœ¨è€å¹´ä»£çš„GCï¼Œå‡ºç°äº†Major GCï¼Œç»å¸¸ä¼šä¼´éšè‡³å°‘ä¸€æ¬¡çš„Minor GCï¼ˆä½†éç»å¯¹ï¼Œåœ¨Parallel Scavengeæ”¶é›†å™¨çš„æ”¶é›†ç­–ç•¥ä¸­å°±æœ‰ç›´æ¥è¿›è¡ŒMajor GCçš„ç­–ç•¥é€‰æ‹©è¿‡ç¨‹ï¼‰ã€‚Major GCçš„é€Ÿåº¦ä¸€èˆ¬ä¼šæ¯”Minor GCæ…¢10å€ä»¥ä¸Šã€‚ 2.å†…å­˜åˆ†é…ç­–ç•¥ å¯¹è±¡ä¼˜å…ˆåœ¨Edenåˆ†é…ã€‚å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå¯¹è±¡åœ¨æ–°ç”Ÿä»£ Eden åŒºåˆ†é…ï¼Œå½“ Eden åŒºç©ºé—´ä¸å¤Ÿæ—¶ï¼Œå‘èµ· Minor GCã€‚ å¤§å¯¹è±¡ç›´æ¥è¿›å…¥è€å¹´ä»£ã€‚å¤§å¯¹è±¡æ˜¯æŒ‡éœ€è¦è¿ç»­å†…å­˜ç©ºé—´çš„å¯¹è±¡ï¼Œæœ€å…¸å‹çš„å¤§å¯¹è±¡æ˜¯é‚£ç§å¾ˆé•¿çš„å­—ç¬¦ä¸²ä»¥åŠæ•°ç»„ã€‚ç»å¸¸å‡ºç°å¤§å¯¹è±¡ä¼šæå‰è§¦å‘åƒåœ¾æ”¶é›†ä»¥è·å–è¶³å¤Ÿçš„è¿ç»­ç©ºé—´åˆ†é…ç»™å¤§å¯¹è±¡ã€‚-XX:PretenureSizeThresholdï¼Œå¤§äºæ­¤å€¼çš„å¯¹è±¡ç›´æ¥åœ¨è€å¹´ä»£åˆ†é…ï¼Œé¿å…åœ¨ Eden åŒºå’Œ Survivor åŒºä¹‹é—´çš„å¤§é‡å†…å­˜å¤åˆ¶ã€‚ é•¿æœŸå­˜æ´»çš„å¯¹è±¡è¿›å…¥è€å¹´ä»£ã€‚ä¸ºå¯¹è±¡å®šä¹‰å¹´é¾„è®¡æ•°å™¨ï¼Œå¯¹è±¡åœ¨ Eden å‡ºç”Ÿå¹¶ç»è¿‡ Minor GC ä¾ç„¶å­˜æ´»ï¼Œå°†ç§»åŠ¨åˆ° Survivor ä¸­ï¼Œå¹´é¾„å°±å¢åŠ  1 å²ï¼Œå¢åŠ åˆ°ä¸€å®šå¹´é¾„åˆ™ç§»åŠ¨åˆ°è€å¹´ä»£ä¸­ã€‚-XX:MaxTenuringThreshold ç”¨æ¥å®šä¹‰å¹´é¾„çš„é˜ˆå€¼ã€‚ åŠ¨æ€å¯¹è±¡å¹´é¾„åˆ¤å®šã€‚è™šæ‹Ÿæœºå¹¶ä¸æ˜¯æ°¸è¿œåœ°è¦æ±‚å¯¹è±¡çš„å¹´é¾„å¿…é¡»è¾¾åˆ° MaxTenuringThreshold æ‰èƒ½æ™‹å‡è€å¹´ä»£ï¼Œå¦‚æœåœ¨ Survivor ä¸­ç›¸åŒå¹´é¾„æ‰€æœ‰å¯¹è±¡å¤§å°çš„æ€»å’Œå¤§äº Survivor ç©ºé—´çš„ä¸€åŠï¼Œåˆ™å¹´é¾„å¤§äºæˆ–ç­‰äºè¯¥å¹´é¾„çš„å¯¹è±¡å¯ä»¥ç›´æ¥è¿›å…¥è€å¹´ä»£ï¼Œæ— éœ€ç­‰åˆ° MaxTenuringThreshold ä¸­è¦æ±‚çš„å¹´é¾„ã€‚ ç©ºé—´åˆ†é…æ‹…ä¿ã€‚åœ¨å‘ç”Ÿ Minor GC ä¹‹å‰ï¼Œè™šæ‹Ÿæœºå…ˆæ£€æŸ¥è€å¹´ä»£æœ€å¤§å¯ç”¨çš„è¿ç»­ç©ºé—´æ˜¯å¦å¤§äºæ–°ç”Ÿä»£æ‰€æœ‰å¯¹è±¡æ€»ç©ºé—´ï¼Œå¦‚æœæ¡ä»¶æˆç«‹çš„è¯ï¼Œé‚£ä¹ˆ Minor GC å¯ä»¥ç¡®è®¤æ˜¯å®‰å…¨çš„ã€‚å¦‚æœä¸æˆç«‹çš„è¯è™šæ‹Ÿæœºä¼šæŸ¥çœ‹ HandlePromotionFailure è®¾ç½®å€¼æ˜¯å¦å…è®¸æ‹…ä¿å¤±è´¥ï¼Œå¦‚æœå…è®¸é‚£ä¹ˆå°±ä¼šç»§ç»­æ£€æŸ¥è€å¹´ä»£æœ€å¤§å¯ç”¨çš„è¿ç»­ç©ºé—´æ˜¯å¦å¤§äºå†æ¬¡æ™‹å‡åˆ°è€å¹´ä»£å¯¹è±¡çš„å¹³å‡å¤§å°ï¼Œå¦‚æœå¤§äºï¼Œå°†å°è¯•ç€è¿›è¡Œä¸€æ¬¡ Minor GCï¼›å¦‚æœå°äºï¼Œæˆ–è€… HandlePromotionFailure è®¾ç½®ä¸å…è®¸å†’é™©ï¼Œé‚£ä¹ˆå°±è¦è¿›è¡Œä¸€æ¬¡ Full GCã€‚ 3.Full GCçš„è§¦å‘æ¡ä»¶ å¯¹äº Minor GCï¼Œå…¶è§¦å‘æ¡ä»¶éå¸¸ç®€å•ï¼Œå½“ Eden ç©ºé—´æ»¡æ—¶ï¼Œå°±å°†è§¦å‘ä¸€æ¬¡ Minor GCã€‚è€Œ Full GC åˆ™ç›¸å¯¹å¤æ‚ï¼Œæœ‰ä»¥ä¸‹æ¡ä»¶ï¼š è°ƒç”¨System.gc( )ã€‚åªæ˜¯å»ºè®®è™šæ‹Ÿæœºæ‰§è¡Œ Full GCï¼Œä½†æ˜¯è™šæ‹Ÿæœºä¸ä¸€å®šçœŸæ­£å»æ‰§è¡Œã€‚ä¸å»ºè®®ä½¿ç”¨è¿™ç§æ–¹å¼ï¼Œè€Œæ˜¯è®©è™šæ‹Ÿæœºç®¡ç†å†…å­˜ã€‚ è€å¹´ä»£ç©ºé—´ä¸è¶³ã€‚è€å¹´ä»£ç©ºé—´ä¸è¶³çš„å¸¸è§åœºæ™¯ä¸ºå‰æ–‡æ‰€è®²çš„å¤§å¯¹è±¡ç›´æ¥è¿›å…¥è€å¹´ä»£ã€é•¿æœŸå­˜æ´»çš„å¯¹è±¡è¿›å…¥è€å¹´ä»£ç­‰ã€‚ä¸ºäº†é¿å…ä»¥ä¸ŠåŸå› å¼•èµ·çš„ Full GCï¼Œåº”å½“å°½é‡ä¸è¦åˆ›å»ºè¿‡å¤§çš„å¯¹è±¡ä»¥åŠæ•°ç»„ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œå¯ä»¥é€šè¿‡ -Xmn è™šæ‹Ÿæœºå‚æ•°è°ƒå¤§æ–°ç”Ÿä»£çš„å¤§å°ï¼Œè®©å¯¹è±¡å°½é‡åœ¨æ–°ç”Ÿä»£è¢«å›æ”¶æ‰ï¼Œä¸è¿›å…¥è€å¹´ä»£ã€‚è¿˜å¯ä»¥é€šè¿‡ -XX:MaxTenuringThresholdè°ƒå¤§å¯¹è±¡è¿›å…¥è€å¹´ä»£çš„å¹´é¾„ï¼Œè®©å¯¹è±¡åœ¨æ–°ç”Ÿä»£å¤šå­˜æ´»ä¸€æ®µæ—¶é—´ã€‚ ç©ºé—´åˆ†é…æ‹…ä¿å¤±è´¥ã€‚ä½¿ç”¨å¤åˆ¶ç®—æ³•çš„ Minor GC éœ€è¦è€å¹´ä»£çš„å†…å­˜ç©ºé—´ä½œæ‹…ä¿ï¼Œå¦‚æœæ‹…ä¿å¤±è´¥ä¼šæ‰§è¡Œä¸€æ¬¡ Full GCã€‚å…·ä½“å†…å®¹è¯·å‚è€ƒä¸Šé¢çš„ç¬¬äº”å°èŠ‚ã€‚ JDK1.7åŠä»¥å‰çš„æ°¸ä¹…ä»£ç©ºé—´ä¸è¶³ã€‚åœ¨ JDK 1.7 åŠä»¥å‰ï¼ŒHotSpot è™šæ‹Ÿæœºä¸­çš„æ–¹æ³•åŒºæ˜¯ç”¨æ°¸ä¹…ä»£å®ç°çš„ï¼Œæ°¸ä¹…ä»£ä¸­å­˜æ”¾çš„ä¸ºä¸€äº› Class çš„ä¿¡æ¯ã€å¸¸é‡ã€é™æ€å˜é‡ç­‰æ•°æ®ã€‚å½“ç³»ç»Ÿä¸­è¦åŠ è½½çš„ç±»ã€åå°„çš„ç±»å’Œè°ƒç”¨çš„æ–¹æ³•è¾ƒå¤šæ—¶ï¼Œæ°¸ä¹…ä»£å¯èƒ½ä¼šè¢«å æ»¡ï¼Œåœ¨æœªé…ç½®ä¸ºé‡‡ç”¨ CMS GC çš„æƒ…å†µä¸‹ä¹Ÿä¼šæ‰§è¡Œ Full GCã€‚å¦‚æœç»è¿‡ Full GC ä»ç„¶å›æ”¶ä¸äº†ï¼Œé‚£ä¹ˆè™šæ‹Ÿæœºä¼šæŠ›å‡º java.lang.OutOfMemoryErrorã€‚ä¸ºé¿å…ä»¥ä¸ŠåŸå› å¼•èµ·çš„ Full GCï¼Œå¯é‡‡ç”¨çš„æ–¹æ³•ä¸ºå¢å¤§æ°¸ä¹…ä»£ç©ºé—´æˆ–è½¬ä¸ºä½¿ç”¨ CMS GCã€‚ Concurrent Mode Failureã€‚æ‰§è¡Œ CMS GC çš„è¿‡ç¨‹ä¸­åŒæ—¶æœ‰å¯¹è±¡è¦æ”¾å…¥è€å¹´ä»£ï¼Œè€Œæ­¤æ—¶è€å¹´ä»£ç©ºé—´ä¸è¶³ï¼ˆå¯èƒ½æ˜¯ GC è¿‡ç¨‹ä¸­æµ®åŠ¨åƒåœ¾è¿‡å¤šå¯¼è‡´æš‚æ—¶æ€§çš„ç©ºé—´ä¸è¶³ï¼‰ï¼Œä¾¿ä¼šæŠ¥ Concurrent Mode Failure é”™è¯¯ï¼Œå¹¶è§¦å‘ Full GCã€‚ 5 è®¾è®¡æ¨¡å¼ é¢å‘å¯¹è±¡å¼€å‘çš„å…­åŸåˆ™ä¸€æ³•åˆ™: å•ä¸€åŸåˆ™:å°±ä¸€ä¸ªç±»è€Œè¨€ï¼Œåº”è¯¥åªä¸“æ³¨äºåšä¸€ä»¶äº‹å’Œä»…æœ‰ä¸€ä¸ªå¼•èµ·å®ƒå˜åŒ–çš„åŸå› ï¼Œå®ç°é«˜å†…èšã€‚ å¼€æ”¾å°é—­:è½¯ä»¶å®ä½“åº”å½“å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­ã€‚è¦åšåˆ°å¼€é—­æœ‰ä¸¤ä¸ªè¦ç‚¹ï¼šâ‘ æŠ½è±¡æ˜¯å…³é”®ï¼Œä¸€ä¸ªç³»ç»Ÿä¸­å¦‚æœæ²¡æœ‰æŠ½è±¡ç±»æˆ–æ¥å£ç³»ç»Ÿå°±æ²¡æœ‰æ‰©å±•ç‚¹ï¼›â‘¡å°è£…å¯å˜æ€§ï¼Œå°†ç³»ç»Ÿä¸­çš„å„ç§å¯å˜å› ç´ å°è£…åˆ°ä¸€ä¸ªç»§æ‰¿ç»“æ„ä¸­ï¼Œå¦‚æœå¤šä¸ªå¯å˜å› ç´ æ··æ‚åœ¨ä¸€èµ·ï¼Œç³»ç»Ÿå°†å˜å¾—å¤æ‚è€Œæ¢ä¹±ã€‚ ä¾èµ–å€’ç½®åŸåˆ™: é«˜å±‚æ¨¡å—ä¸åº”è¯¥ä¾èµ–äºä½å±‚æ¨¡å—ï¼ŒäºŒè€…éƒ½åº”è¯¥ä¾èµ–äºæŠ½è±¡ï¼›æŠ½è±¡ä¸åº”è¯¥ä¾èµ–äºç»†èŠ‚ï¼Œç»†èŠ‚åº”è¯¥ä¾èµ–äºæŠ½è±¡ã€‚å³é¢å‘æ¥å£ç¼–ç¨‹ã€‚è¯¥åŸåˆ™è¯´å¾—ç›´ç™½å’Œå…·ä½“ä¸€äº›å°±æ˜¯å£°æ˜æ–¹æ³•çš„å‚æ•°ç±»å‹ã€æ–¹æ³•çš„è¿”å›ç±»å‹ã€å˜é‡çš„å¼•ç”¨ç±»å‹æ—¶ï¼Œå°½å¯èƒ½ä½¿ç”¨æŠ½è±¡ç±»å‹è€Œä¸ç”¨å…·ä½“ç±»å‹ï¼Œå› ä¸ºæŠ½è±¡ç±»å‹å¯ä»¥è¢«å®ƒçš„ä»»ä½•ä¸€ä¸ªå­ç±»å‹æ‰€æ›¿ä»£ã€‚ ä»»ä½•å˜é‡éƒ½ä¸åº”è¯¥æŒæœ‰ä¸€ä¸ªæŒ‡å‘å…·ä½“ç±»çš„æŒ‡é’ˆæˆ–è€…å¼•ç”¨ï¼› ä»»ä½•ç±»éƒ½ä¸åº”è¯¥ä»å…·ä½“ç±»æ´¾ç”Ÿï¼› ä»»ä½•æ–¹æ³•éƒ½ä¸åº”è¯¥è¦†å†™å®ƒçš„ä»»ä½•åŸºç±»ä¸­çš„å·²ç»å®ç°çš„æ–¹æ³•ã€‚ é‡Œæ°æ›¿æ¢åŸåˆ™ï¼šå­ç±»å¯¹è±¡å¿…é¡»èƒ½å¤Ÿæ›¿æ¢æ‰æ‰€æœ‰çˆ¶ç±»å¯¹è±¡ã€‚ç®€å•çš„è¯´å°±æ˜¯èƒ½ç”¨çˆ¶ç±»å‹çš„åœ°æ–¹å°±ä¸€å®šèƒ½ä½¿ç”¨å­ç±»å‹ï¼Œå­ç±»ä¸€å®šæ˜¯å¢åŠ çˆ¶ç±»çš„èƒ½åŠ›è€Œä¸æ˜¯å‡å°‘çˆ¶ç±»çš„èƒ½åŠ›ï¼Œå› ä¸ºå­ç±»æ¯”çˆ¶ç±»çš„èƒ½åŠ›æ›´å¤šï¼ŒæŠŠèƒ½åŠ›å¤šçš„å¯¹è±¡å½“æˆèƒ½åŠ›å°‘çš„å¯¹è±¡æ¥ç”¨å½“ç„¶æ²¡æœ‰ä»»ä½•é—®é¢˜ã€‚ æ¥å£éš”ç¦»åŸåˆ™:æ¥å£è¦å°è€Œä¸“ï¼Œç»ä¸èƒ½å¤§è€Œå…¨.è‡ƒè‚¿çš„æ¥å£æ˜¯å¯¹æ¥å£çš„æ±¡æŸ“ï¼Œæ—¢ç„¶æ¥å£è¡¨ç¤ºèƒ½åŠ›ï¼Œé‚£ä¹ˆä¸€ä¸ªæ¥å£åªåº”è¯¥æè¿°ä¸€ç§èƒ½åŠ›ï¼Œæ¥å£ä¹Ÿåº”è¯¥æ˜¯é«˜åº¦å†…èšçš„ã€‚ åˆæˆèšåˆå¤ç”¨åŸåˆ™:ä¼˜å…ˆä½¿ç”¨èšåˆæˆ–åˆæˆå…³ç³»å¤ç”¨ä»£ç ã€‚ è¿ªç±³ç‰¹æ³•åˆ™:è¿ªç±³ç‰¹æ³•åˆ™åˆå«æœ€å°‘çŸ¥è¯†åŸåˆ™ï¼Œä¸€ä¸ªå¯¹è±¡åº”å½“å¯¹å…¶ä»–å¯¹è±¡æœ‰å°½å¯èƒ½å°‘çš„äº†è§£ã€‚è¿ªç±³ç‰¹æ³•åˆ™ç®€å•çš„è¯´å°±æ˜¯å¦‚ä½•åšåˆ°&quot;ä½è€¦åˆ&quot;ï¼Œé—¨é¢æ¨¡å¼å’Œè°ƒåœè€…æ¨¡å¼å°±æ˜¯å¯¹è¿ªç±³ç‰¹æ³•åˆ™çš„è·µè¡Œã€‚ ä»‹ç»ï¼šä¸­æ–‡è¯‘åï¼šè®¾è®¡æ¨¡å¼ - å¯å¤ç”¨çš„é¢å‘å¯¹è±¡è½¯ä»¶å…ƒç´ ï¼‰ ä¸­æ‰€æåˆ°çš„ï¼Œæ€»å…±æœ‰ 23 ç§è®¾è®¡æ¨¡å¼ã€‚è¿™äº›æ¨¡å¼å¯ä»¥åˆ†ä¸ºä¸‰å¤§ç±»ï¼šåˆ›å»ºå‹æ¨¡å¼ï¼ˆCreational Patternsï¼‰ã€ç»“æ„å‹æ¨¡å¼ï¼ˆStructural Patternsï¼‰ã€è¡Œä¸ºå‹æ¨¡å¼ï¼ˆBehavioral Patternsï¼‰ã€‚å½“ç„¶ï¼Œæˆ‘ä»¬è¿˜ä¼šè®¨è®ºå¦ä¸€ç±»è®¾è®¡æ¨¡å¼ï¼šJ2EE è®¾è®¡æ¨¡å¼ã€‚ 5.1 å•ä¾‹æ¨¡å¼ å•ä¾‹æ¨¡å¼æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼šå•ä¾‹æ¨¡å¼çš„å®šä¹‰ï¼Œå®˜æ–¹çš„å®šä¹‰æ€»ç»“èµ·æ¥å°±ä¸¤å¥è¯ï¼Œç¡®ä¿ä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼ˆä¹Ÿå°±æ˜¯ç±»çš„å¯¹è±¡ï¼‰ï¼Œå¹¶ä¸”æä¾›ä¸€ä¸ªå…¨å±€çš„è®¿é—®ç‚¹ï¼ˆå¤–éƒ¨é€šè¿‡è¿™ä¸ªè®¿é—®ç‚¹æ¥è®¿é—®è¯¥ç±»çš„å”¯ä¸€å®ä¾‹ï¼‰ã€‚ å•ä¾‹ç±»åªèƒ½æœ‰ä¸€ä¸ªå®ä¾‹ã€‚ å•ä¾‹ç±»å¿…é¡»è‡ªå·±åˆ›å»ºè‡ªå·±çš„å”¯ä¸€å®ä¾‹ï¼Œå¹¶ç»™æ‰€æœ‰å…¶ä»–å¯¹è±¡æä¾›è¿™ä¸€å®ä¾‹ã€‚ ä¼˜ç‚¹ï¼š 1ã€åœ¨å†…å­˜é‡Œåªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå‡å°‘äº†å†…å­˜çš„å¼€é”€ï¼Œå°¤å…¶æ˜¯é¢‘ç¹çš„åˆ›å»ºå’Œé”€æ¯å®ä¾‹ï¼ˆæ¯”å¦‚ç®¡ç†å­¦é™¢é¦–é¡µé¡µé¢ç¼“å­˜ï¼‰ã€‚ â€‹ 2ã€é¿å…å¯¹èµ„æºçš„å¤šé‡å ç”¨ï¼ˆæ¯”å¦‚å†™æ–‡ä»¶æ“ä½œï¼‰ã€‚ ç¼ºç‚¹ï¼š æ²¡æœ‰æ¥å£ï¼Œä¸èƒ½ç»§æ‰¿ï¼Œä¸å•ä¸€èŒè´£åŸåˆ™å†²çªï¼Œä¸€ä¸ªç±»åº”è¯¥åªå…³å¿ƒå†…éƒ¨é€»è¾‘ï¼Œè€Œä¸å…³å¿ƒå¤–é¢æ€ä¹ˆæ ·æ¥å®ä¾‹åŒ–ã€‚ ä½¿ç”¨åœºæ™¯ï¼š 1ã€è¦æ±‚ç”Ÿäº§å”¯ä¸€åºåˆ—å·ã€‚ 2ã€WEB ä¸­çš„è®¡æ•°å™¨ï¼Œä¸ç”¨æ¯æ¬¡åˆ·æ–°éƒ½åœ¨æ•°æ®åº“é‡ŒåŠ ä¸€æ¬¡ï¼Œç”¨å•ä¾‹å…ˆç¼“å­˜èµ·æ¥ã€‚ 3ã€åˆ›å»ºçš„ä¸€ä¸ªå¯¹è±¡éœ€è¦æ¶ˆè€—çš„èµ„æºè¿‡å¤šï¼Œæ¯”å¦‚ I/O ä¸æ•°æ®åº“çš„è¿æ¥ç­‰ã€‚ 5.1.1 é¥¿æ±‰å¼å®ç° public class Singleton{ private static Singleton singleton=new Singleton();//ä¸»åŠ¨åˆ›å»º private Singleton(){}//ç§æœ‰æ„é€ æ–¹æ³• public static Singleton getInstance(){//æä¾›å…¨å±€çš„è·å–æ–¹æ³• return singleton; } } 5.1.2 æ‡’æ±‰å®ç° public class Singleton{ private static Singleton singleton;//å…ˆå®šä¹‰ private Singleton(){}//ç§æœ‰æ„é€ æ–¹æ³• public static Singleton getInstance(){ if(singleton==null){//éœ€è¦ç”¨çš„æ—¶å€™æ‰å»åˆ›å»º singleton=new Singleton(); } return singleton; } } 5.1.3æ‡’æ±‰å¼çº¿ç¨‹å®‰å…¨å®ç° public class Singleton{ private static Singleton singleton;//å…ˆå®šä¹‰ private Singleton(){}//ç§æœ‰æ„é€ æ–¹æ³• public static synchronized Singleton getInstance(){ if(singleton==null){ singleton=new Singleton(); } return singleton; } } public class Singleton{ private static Singleton singleton;//å…ˆå®šä¹‰ private Singleton(){}//ç§æœ‰æ„é€ æ–¹æ³• public static Singleton getInstance(){ synchronizedï¼ˆSingleton.classï¼‰{ if(singleton==null){ singleton=new Singleton(); } } return singleton; } } 5.1.4 åŒæ£€é”/åŒé‡æ ¡éªŒé”ï¼ˆDCLï¼Œå³double-checked lockingï¼‰ public class Singleton{ private static Singleton singleton;//å…ˆå®šä¹‰ private Singleton(){}//ç§æœ‰æ„é€ æ–¹æ³• public static Singleton getInstance(){ if(singleton==null){//åœ¨çº¿ç¨‹å®‰å…¨çš„æ‡’æ±‰å¼ä¸Šå¢åŠ ä¸€ä¸ªåˆ¤ç©º synchronizedï¼ˆSingleton.classï¼‰{ if(singleton==null){ singleton=new Singleton(); } } } return singleton; } 5.1.5 ç™»è®°å¼/é™æ€å†…éƒ¨ç±» è¿™ç§æ–¹å¼èƒ½è¾¾åˆ°åŒæ£€é”æ–¹å¼ä¸€æ ·çš„åŠŸæ•ˆï¼Œä½†å®ç°æ›´ç®€å•ã€‚å¯¹é™æ€åŸŸä½¿ç”¨å»¶è¿Ÿåˆå§‹åŒ–ï¼Œåº”ä½¿ç”¨è¿™ç§æ–¹å¼è€Œä¸æ˜¯åŒæ£€é”æ–¹å¼ã€‚è¿™ç§æ–¹å¼åªé€‚ç”¨äºé™æ€åŸŸçš„æƒ…å†µï¼ŒåŒæ£€é”æ–¹å¼å¯åœ¨å®ä¾‹åŸŸéœ€è¦å»¶è¿Ÿåˆå§‹åŒ–æ—¶ä½¿ç”¨ã€‚ è¿™ç§æ–¹å¼åŒæ ·åˆ©ç”¨äº† classloader æœºåˆ¶æ¥ä¿è¯åˆå§‹åŒ– instance æ—¶åªæœ‰ä¸€ä¸ªçº¿ç¨‹ï¼Œå®ƒè·Ÿç¬¬ 3 ç§æ–¹å¼ä¸åŒçš„æ˜¯ï¼šç¬¬ 3 ç§æ–¹å¼åªè¦ Singleton ç±»è¢«è£…è½½äº†ï¼Œé‚£ä¹ˆ instance å°±ä¼šè¢«å®ä¾‹åŒ–ï¼ˆæ²¡æœ‰è¾¾åˆ° lazy loading æ•ˆæœï¼‰ï¼Œè€Œè¿™ç§æ–¹å¼æ˜¯ Singleton ç±»è¢«è£…è½½äº†ï¼Œinstance ä¸ä¸€å®šè¢«åˆå§‹åŒ–ã€‚å› ä¸º SingletonHolder ç±»æ²¡æœ‰è¢«ä¸»åŠ¨ä½¿ç”¨ï¼Œåªæœ‰é€šè¿‡æ˜¾å¼è°ƒç”¨ getInstance æ–¹æ³•æ—¶ï¼Œæ‰ä¼šæ˜¾å¼è£…è½½ SingletonHolder ç±»ï¼Œä»è€Œå®ä¾‹åŒ– instanceã€‚ public class Singleton{ private static class SingletonHolder{//åˆ›å»ºå†…éƒ¨ç±»ï¼Œæä¾›å”¯ä¸€å®ä¾‹ private static final Singleton INSTANCE=new Singleton(); } private Singleton(){} public static final Singleton getInstance(){ return SingleonHolder.INSTANCE;//è¿”å›å†…éƒ¨ç±»å”¯ä¸€é™æ€å‚æ•° } } 5.1.6 æšä¸¾ è¿™ç§å®ç°æ–¹å¼è¿˜æ²¡æœ‰è¢«å¹¿æ³›é‡‡ç”¨ï¼Œä½†è¿™æ˜¯å®ç°å•ä¾‹æ¨¡å¼çš„æœ€ä½³æ–¹æ³•ã€‚å®ƒæ›´ç®€æ´ï¼Œè‡ªåŠ¨æ”¯æŒåºåˆ—åŒ–æœºåˆ¶ï¼Œç»å¯¹é˜²æ­¢å¤šæ¬¡å®ä¾‹åŒ–ã€‚ è¿™ç§æ–¹å¼æ˜¯ Effective Java ä½œè€… Josh Bloch æå€¡çš„æ–¹å¼ï¼Œå®ƒä¸ä»…èƒ½é¿å…å¤šçº¿ç¨‹åŒæ­¥é—®é¢˜ï¼Œè€Œä¸”è¿˜è‡ªåŠ¨æ”¯æŒåºåˆ—åŒ–æœºåˆ¶ï¼Œé˜²æ­¢ååºåˆ—åŒ–é‡æ–°åˆ›å»ºæ–°çš„å¯¹è±¡ï¼Œç»å¯¹é˜²æ­¢å¤šæ¬¡å®ä¾‹åŒ–ã€‚ public enum Singleton{ INSTANCE; public viod whateverMethod(){ } } 5.2 å·¥å‚æ¨¡å¼ **æ„å›¾ï¼š**å®šä¹‰ä¸€ä¸ªåˆ›å»ºå¯¹è±¡çš„æ¥å£ï¼Œè®©å…¶å­ç±»è‡ªå·±å†³å®šå®ä¾‹åŒ–å“ªä¸€ä¸ªå·¥å‚ç±»ï¼Œå·¥å‚æ¨¡å¼ä½¿å…¶åˆ›å»ºè¿‡ç¨‹å»¶è¿Ÿåˆ°å­ç±»è¿›è¡Œã€‚ **ä¸»è¦è§£å†³ï¼š**ä¸»è¦è§£å†³æ¥å£é€‰æ‹©çš„é—®é¢˜ã€‚ **ä½•æ—¶ä½¿ç”¨ï¼š**æˆ‘ä»¬æ˜ç¡®åœ°è®¡åˆ’ä¸åŒæ¡ä»¶ä¸‹åˆ›å»ºä¸åŒå®ä¾‹æ—¶ã€‚ **å¦‚ä½•è§£å†³ï¼š**è®©å…¶å­ç±»å®ç°å·¥å‚æ¥å£ï¼Œè¿”å›çš„ä¹Ÿæ˜¯ä¸€ä¸ªæŠ½è±¡çš„äº§å“ã€‚ **å…³é”®ä»£ç ï¼š**åˆ›å»ºè¿‡ç¨‹åœ¨å…¶å­ç±»æ‰§è¡Œã€‚ //æ­¥éª¤ä¸€ï¼šåˆ›å»ºä¸€ä¸ªæ¥å£ //Shape.java public interface Shap{ void draw(); } //æ­¥éª¤äºŒï¼šåˆ›å»ºå®ç°æ¥å£çš„å®ä½“ç±» //Rectangle.java public class Rectangle implements Shape{ @Override public void draw() { System.out.println(&quot;Inside Rectangle::draw() method.&quot;); } } //Square,java public class Square implements Shape{ @Override public void draw() { System.out.println(&quot;Inside Square::draw() method.&quot;); } } //Circle.java public class Circle implements Shape { @Override public void draw() { System.out.println(&quot;Inside Circle::draw() method.&quot;); } } //æ­¥éª¤ä¸‰ï¼šåˆ›å»ºä¸€ä¸ªå·¥å‚ï¼Œç”ŸæˆåŸºäºç»™å®šä¿¡æ¯çš„å®ä½“ç±»çš„å¯¹è±¡ public calss ShapeFactory{ public Shape getShape(String shapeType){ if(shapeType==null) return null; } if(shapeType.equalsIgnoreCase(&quot;CIRCLE&quot;)){ return new Circle(); } else if(shapeType.equalsIgnoreCase(&quot;RECTANGLE&quot;)){ return new Rectangle(); } else if(shapeType.equalsIgnoreCase(&quot;SQUARE&quot;)){ return new Square(); } return null; } //æ­¥éª¤å››ï¼šä½¿ç”¨å·¥å‚ï¼Œé€šè¿‡ä¼ é€’ç±»å‹ä¿¡æ¯æ¥è·å–å®ä½“ç±»çš„å¯¹è±¡ public class FactoryPatternDemo { public static void main(String[] args) { ShapeFactory shapeFactory = new ShapeFactory(); //è·å– Circle çš„å¯¹è±¡ï¼Œå¹¶è°ƒç”¨å®ƒçš„ draw æ–¹æ³• Shape shape1 = shapeFactory.getShape(&quot;CIRCLE&quot;); //è°ƒç”¨ Circle çš„ draw æ–¹æ³• shape1.draw(); Shape shape2 = shapeFactory.getShape(&quot;RECTANGLE&quot;); shape2.draw(); Shape shape3 = shapeFactory.getShape(&quot;SQUARE&quot;); shape3.draw(); } } 5.3 æŠ½è±¡å·¥å‚æ¨¡å¼ æŠ½è±¡å·¥å‚æ¨¡å¼ï¼ˆAbstract Factory Patternï¼‰æ˜¯å›´ç»•ä¸€ä¸ªè¶…çº§å·¥å‚åˆ›å»ºå…¶ä»–å·¥å‚ã€‚è¯¥è¶…çº§å·¥å‚åˆç§°ä¸ºå…¶ä»–å·¥å‚çš„å·¥å‚ã€‚è¿™ç§ç±»å‹çš„è®¾è®¡æ¨¡å¼å±äºåˆ›å»ºå‹æ¨¡å¼ï¼Œå®ƒæä¾›äº†ä¸€ç§åˆ›å»ºå¯¹è±¡çš„æœ€ä½³æ–¹å¼ã€‚ åœ¨æŠ½è±¡å·¥å‚æ¨¡å¼ä¸­ï¼Œæ¥å£æ˜¯è´Ÿè´£åˆ›å»ºä¸€ä¸ªç›¸å…³å¯¹è±¡çš„å·¥å‚ï¼Œä¸éœ€è¦æ˜¾å¼æŒ‡å®šå®ƒä»¬çš„ç±»ã€‚æ¯ä¸ªç”Ÿæˆçš„å·¥å‚éƒ½èƒ½æŒ‰ç…§å·¥å‚æ¨¡å¼æä¾›å¯¹è±¡ã€‚ **æ„å›¾ï¼š**æä¾›ä¸€ä¸ªåˆ›å»ºä¸€ç³»åˆ—ç›¸å…³æˆ–ç›¸äº’ä¾èµ–å¯¹è±¡çš„æ¥å£ï¼Œè€Œæ— éœ€æŒ‡å®šå®ƒä»¬å…·ä½“çš„ç±»ã€‚ **ä¸»è¦è§£å†³ï¼š**ä¸»è¦è§£å†³æ¥å£é€‰æ‹©çš„é—®é¢˜ã€‚ **ä½•æ—¶ä½¿ç”¨ï¼š**ç³»ç»Ÿçš„äº§å“æœ‰å¤šäºä¸€ä¸ªçš„äº§å“æ—ï¼Œè€Œç³»ç»Ÿåªæ¶ˆè´¹å…¶ä¸­æŸä¸€æ—çš„äº§å“ã€‚ **å¦‚ä½•è§£å†³ï¼š**åœ¨ä¸€ä¸ªäº§å“æ—é‡Œé¢ï¼Œå®šä¹‰å¤šä¸ªäº§å“ã€‚ **å…³é”®ä»£ç ï¼š**åœ¨ä¸€ä¸ªå·¥å‚é‡Œèšåˆå¤šä¸ªåŒç±»äº§å“ã€‚ **ä¼˜ç‚¹ï¼š**å½“ä¸€ä¸ªäº§å“æ—ä¸­çš„å¤šä¸ªå¯¹è±¡è¢«è®¾è®¡æˆä¸€èµ·å·¥ä½œæ—¶ï¼Œå®ƒèƒ½ä¿è¯å®¢æˆ·ç«¯å§‹ç»ˆåªä½¿ç”¨åŒä¸€ä¸ªäº§å“æ—ä¸­çš„å¯¹è±¡ã€‚ **ç¼ºç‚¹ï¼š**äº§å“æ—æ‰©å±•éå¸¸å›°éš¾ï¼Œè¦å¢åŠ ä¸€ä¸ªç³»åˆ—çš„æŸä¸€äº§å“ï¼Œæ—¢è¦åœ¨æŠ½è±¡çš„ Creator é‡ŒåŠ ä»£ç ï¼Œåˆè¦åœ¨å…·ä½“çš„é‡Œé¢åŠ ä»£ç ã€‚ ä½¿ç”¨åœºæ™¯ï¼š 1ã€QQ æ¢çš®è‚¤ï¼Œä¸€æ•´å¥—ä¸€èµ·æ¢ã€‚ 2ã€ç”Ÿæˆä¸åŒæ“ä½œç³»ç»Ÿçš„ç¨‹åºã€‚ **æ³¨æ„äº‹é¡¹ï¼š**äº§å“æ—éš¾æ‰©å±•ï¼Œäº§å“ç­‰çº§æ˜“æ‰©å±•ã€‚ //æ­¥éª¤ä¸€ï¼šä¸ºå½¢çŠ¶åˆ›å»ºä¸€ä¸ªæ¥å£ //Shap.java public interface Shap{ void draw(); } //æ­¥éª¤äºŒï¼šåˆ›å»ºå®ç°æ¥å£çš„å®ä½“ç±» //Rectangle.java public class Rectangle implements Shape{ @Override public void draw() { System.out.println(&quot;Inside Rectangle::draw() method.&quot;); } } //Square,java public class Square implements Shape{ @Override public void draw() { System.out.println(&quot;Inside Square::draw() method.&quot;); } } //Circle.java public class Circle implements Shape { @Override public void draw() { System.out.println(&quot;Inside Circle::draw() method.&quot;); } } //æ­¥éª¤ä¸‰ï¼šä¸ºé¢œè‰²åˆ›å»ºä¸€ä¸ªæ¥å£ //Color.java public interface Color{ void fill(); } //æ­¥éª¤å››ï¼šåˆ›å»ºå®ç°æ¥å£çš„å®ä½“ç±» //Red.java public class Red implements Color { @Override public void fill() { System.out.println(&quot;Inside Red::fill() method.&quot;); } } //Green.java public class Green implements Color { @Override public void fill() { System.out.println(&quot;Inside Green::fill() method.&quot;); } } //Blue.java public class Blue implements Color { @Override public void fill() { System.out.println(&quot;Inside Blue::fill() method.&quot;); } } //æ­¥éª¤äº”ï¼šä¸ºColorå’ŒShapeå¯¹è±¡åˆ›å»ºæŠ½è±¡ç±»æ¥è·å–å·¥å‚ //AbstractFactory.java public abstract class AbstractFactory { public abstract Color getColor(String color); public abstract Shape getShape(String shape); } //æ­¥éª¤å…­ï¼šåˆ›å»ºæ‰©å±•äº† AbstractFactory çš„å·¥å‚ç±»ï¼ŒåŸºäºç»™å®šçš„ä¿¡æ¯ç”Ÿæˆå®ä½“ç±»çš„å¯¹è±¡ã€‚ //ShapeFactory.java public class ShapeFactory extends AbstractFactory { @Override public Shape getShape(String shapeType){ if(shapeType == null){ return null; } if(shapeType.equalsIgnoreCase(&quot;CIRCLE&quot;)){ return new Circle(); } else if(shapeType.equalsIgnoreCase(&quot;RECTANGLE&quot;)){ return new Rectangle(); } else if(shapeType.equalsIgnoreCase(&quot;SQUARE&quot;)){ return new Square(); } return null; } @Override public Color getColor(String color) { return null; } } //ColorFactory.java public class ColorFactory extends AbstractFactory { @Override public Shape getShape(String shapeType){ return null; } @Override public Color getColor(String color) { if(color == null){ return null; } if(color.equalsIgnoreCase(&quot;RED&quot;)){ return new Red(); } else if(color.equalsIgnoreCase(&quot;GREEN&quot;)){ return new Green(); } else if(color.equalsIgnoreCase(&quot;BLUE&quot;)){ return new Blue(); } return null; } } //æ­¥éª¤ä¸ƒï¼šåˆ›å»ºä¸€ä¸ªå·¥å‚åˆ›é€ å™¨/ç”Ÿæˆå™¨ç±»ï¼Œé€šè¿‡ä¼ é€’å½¢çŠ¶æˆ–é¢œè‰²ä¿¡æ¯æ¥è·å–å·¥å‚ //FactoryProducer.java public class FactoryProducer { public static AbstractFactory getFactory(String choice){ if(choice.equalsIgnoreCase(&quot;SHAPE&quot;)){ return new ShapeFactory(); } else if(choice.equalsIgnoreCase(&quot;COLOR&quot;)){ return new ColorFactory(); } return null; } } //æ­¥éª¤å…«ï¼šä½¿ç”¨ FactoryProducer æ¥è·å– AbstractFactoryï¼Œé€šè¿‡ä¼ é€’ç±»å‹ä¿¡æ¯æ¥è·å–å®ä½“ç±»çš„å¯¹è±¡ã€‚ //AbstractFactoryPatternDemo.java public class AbstractFactoryPatternDemo { public static void main(String[] args) { //è·å–å½¢çŠ¶å·¥å‚ AbstractFactory shapeFactory = FactoryProducer.getFactory(&quot;SHAPE&quot;); //è·å–å½¢çŠ¶ä¸º Circle çš„å¯¹è±¡ Shape shape1 = shapeFactory.getShape(&quot;CIRCLE&quot;); //è°ƒç”¨ Circle çš„ draw æ–¹æ³• shape1.draw(); //è·å–å½¢çŠ¶ä¸º Rectangle çš„å¯¹è±¡ Shape shape2 = shapeFactory.getShape(&quot;RECTANGLE&quot;); //è°ƒç”¨ Rectangle çš„ draw æ–¹æ³• shape2.draw(); //è·å–å½¢çŠ¶ä¸º Square çš„å¯¹è±¡ Shape shape3 = shapeFactory.getShape(&quot;SQUARE&quot;); //è°ƒç”¨ Square çš„ draw æ–¹æ³• shape3.draw(); //è·å–é¢œè‰²å·¥å‚ AbstractFactory colorFactory = FactoryProducer.getFactory(&quot;COLOR&quot;); //è·å–é¢œè‰²ä¸º Red çš„å¯¹è±¡ Color color1 = colorFactory.getColor(&quot;RED&quot;); //è°ƒç”¨ Red çš„ fill æ–¹æ³• color1.fill(); //è·å–é¢œè‰²ä¸º Green çš„å¯¹è±¡ Color color2 = colorFactory.getColor(&quot;Green&quot;); //è°ƒç”¨ Green çš„ fill æ–¹æ³• color2.fill(); //è·å–é¢œè‰²ä¸º Blue çš„å¯¹è±¡ Color color3 = colorFactory.getColor(&quot;BLUE&quot;); //è°ƒç”¨ Blue çš„ fill æ–¹æ³• color3.fill(); } } 5.4 å»ºé€ è€…æ¨¡å¼ å»ºé€ è€…æ¨¡å¼ï¼ˆBuilder Patternï¼‰ä½¿ç”¨å¤šä¸ªç®€å•çš„å¯¹è±¡ä¸€æ­¥ä¸€æ­¥æ„å»ºæˆä¸€ä¸ªå¤æ‚çš„å¯¹è±¡ã€‚è¿™ç§ç±»å‹çš„è®¾è®¡æ¨¡å¼å±äºåˆ›å»ºå‹æ¨¡å¼ï¼Œå®ƒæä¾›äº†ä¸€ç§åˆ›å»ºå¯¹è±¡çš„æœ€ä½³æ–¹å¼ã€‚ä¸€ä¸ª Builder ç±»ä¼šä¸€æ­¥ä¸€æ­¥æ„é€ æœ€ç»ˆçš„å¯¹è±¡ã€‚è¯¥ Builder ç±»æ˜¯ç‹¬ç«‹äºå…¶ä»–å¯¹è±¡çš„ã€‚ **æ„å›¾ï¼š**å°†ä¸€ä¸ªå¤æ‚çš„æ„å»ºä¸å…¶è¡¨ç¤ºç›¸åˆ†ç¦»ï¼Œä½¿å¾—åŒæ ·çš„æ„å»ºè¿‡ç¨‹å¯ä»¥åˆ›å»ºä¸åŒçš„è¡¨ç¤ºã€‚ **ä¸»è¦è§£å†³ï¼š**ä¸»è¦è§£å†³åœ¨è½¯ä»¶ç³»ç»Ÿä¸­ï¼Œæœ‰æ—¶å€™é¢ä¸´ç€&quot;ä¸€ä¸ªå¤æ‚å¯¹è±¡&quot;çš„åˆ›å»ºå·¥ä½œï¼Œå…¶é€šå¸¸ç”±å„ä¸ªéƒ¨åˆ†çš„å­å¯¹è±¡ç”¨ä¸€å®šçš„ç®—æ³•æ„æˆï¼›ç”±äºéœ€æ±‚çš„å˜åŒ–ï¼Œè¿™ä¸ªå¤æ‚å¯¹è±¡çš„å„ä¸ªéƒ¨åˆ†ç»å¸¸é¢ä¸´ç€å‰§çƒˆçš„å˜åŒ–ï¼Œä½†æ˜¯å°†å®ƒä»¬ç»„åˆåœ¨ä¸€èµ·çš„ç®—æ³•å´ç›¸å¯¹ç¨³å®šã€‚ **ä½•æ—¶ä½¿ç”¨ï¼š**ä¸€äº›åŸºæœ¬éƒ¨ä»¶ä¸ä¼šå˜ï¼Œè€Œå…¶ç»„åˆç»å¸¸å˜åŒ–çš„æ—¶å€™ã€‚ **å¦‚ä½•è§£å†³ï¼š**å°†å˜ä¸ä¸å˜åˆ†ç¦»å¼€ã€‚ **å…³é”®ä»£ç ï¼š**å»ºé€ è€…ï¼šåˆ›å»ºå’Œæä¾›å®ä¾‹ï¼Œå¯¼æ¼”ï¼šç®¡ç†å»ºé€ å‡ºæ¥çš„å®ä¾‹çš„ä¾èµ–å…³ç³»ã€‚ åº”ç”¨å®ä¾‹ï¼š 1ã€å»è‚¯å¾·åŸºï¼Œæ±‰å ¡ã€å¯ä¹ã€è–¯æ¡ã€ç‚¸é¸¡ç¿…ç­‰æ˜¯ä¸å˜çš„ï¼Œè€Œå…¶ç»„åˆæ˜¯ç»å¸¸å˜åŒ–çš„ï¼Œç”Ÿæˆå‡ºæ‰€è°“çš„&quot;å¥—é¤&quot;ã€‚ 2ã€JAVA ä¸­çš„ StringBuilderã€‚ ä¼˜ç‚¹ï¼š 1ã€å»ºé€ è€…ç‹¬ç«‹ï¼Œæ˜“æ‰©å±•ã€‚ 2ã€ä¾¿äºæ§åˆ¶ç»†èŠ‚é£é™©ã€‚ ç¼ºç‚¹ï¼š 1ã€äº§å“å¿…é¡»æœ‰å…±åŒç‚¹ï¼ŒèŒƒå›´æœ‰é™åˆ¶ã€‚ 2ã€å¦‚å†…éƒ¨å˜åŒ–å¤æ‚ï¼Œä¼šæœ‰å¾ˆå¤šçš„å»ºé€ ç±»ã€‚ ä½¿ç”¨åœºæ™¯ï¼š 1ã€éœ€è¦ç”Ÿæˆçš„å¯¹è±¡å…·æœ‰å¤æ‚çš„å†…éƒ¨ç»“æ„ã€‚ 2ã€éœ€è¦ç”Ÿæˆçš„å¯¹è±¡å†…éƒ¨å±æ€§æœ¬èº«ç›¸äº’ä¾èµ–ã€‚ **æ³¨æ„äº‹é¡¹ï¼š**ä¸å·¥å‚æ¨¡å¼çš„åŒºåˆ«æ˜¯ï¼šå»ºé€ è€…æ¨¡å¼æ›´åŠ å…³æ³¨ä¸é›¶ä»¶è£…é…çš„é¡ºåºã€‚ 5.5 åŸå‹æ¨¡å¼ ","link":"https://kily-007.github.io/post/ç¬”è®°-javaåŸºç¡€/"},{"title":"ç¬”è®°-è®¡ç®—æœºç½‘ç»œ","content":"1 ä¸ƒå±‚ç½‘ç»œæ¨¡å‹ 2 TCP(ä¼ è¾“å±‚)ä¸UDPåè®® UDP åœ¨ä¼ é€æ•°æ®ä¹‹å‰ä¸éœ€è¦å…ˆå»ºç«‹è¿æ¥ï¼Œè¿œåœ°ä¸»æœºåœ¨æ”¶åˆ° UDP æŠ¥æ–‡åï¼Œä¸éœ€è¦ç»™å‡ºä»»ä½•ç¡®è®¤ã€‚è™½ç„¶ UDP ä¸æä¾›å¯ é äº¤ä»˜ï¼Œä½†åœ¨æŸäº›æƒ…å†µä¸‹ UDP ç¡®æ˜¯ä¸€ç§æœ‰æ•ˆçš„å·¥ä½œæ–¹å¼ï¼ˆä¸€èˆ¬ç”¨äºå³æ—¶é€šä¿¡ï¼‰ï¼Œæ¯”å¦‚ï¼š QQ è¯­ éŸ³ã€ QQ è§†é¢‘ ã€ç›´ æ’­ç­‰ç­‰ã€‚ TCP æä¾›é¢å‘è¿æ¥çš„æœåŠ¡ã€‚åœ¨ä¼ é€æ•°æ®ä¹‹å‰å¿…é¡»å…ˆå»ºç«‹è¿æ¥ï¼Œæ•°æ®ä¼ é€ç»“æŸåè¦é‡Šæ”¾è¿æ¥ã€‚ TCP ä¸æä¾›å¹¿æ’­æˆ–å¤šæ’­ æœåŠ¡ã€‚ç”±äº TCP è¦æä¾›å¯é çš„ï¼Œé¢å‘è¿æ¥çš„è¿è¾“æœåŠ¡ï¼ˆTCPçš„å¯é ä½“ç°åœ¨TCPåœ¨ä¼ é€’æ•°æ®ä¹‹å‰ï¼Œä¼šæœ‰ä¸‰æ¬¡æ¡æ‰‹æ¥å»ºç«‹ è¿æ¥ï¼Œè€Œä¸”åœ¨æ•°æ®ä¼ é€’æ—¶ï¼Œæœ‰ç¡®è®¤ã€çª—å£ã€é‡ä¼ ã€æ‹¥å¡æ§åˆ¶æœºåˆ¶ï¼Œåœ¨æ•°æ®ä¼ å®Œåï¼Œè¿˜ä¼šæ–­å¼€è¿æ¥ç”¨æ¥èŠ‚çº¦ç³»ç»Ÿèµ„ æºï¼‰ï¼Œè¿™ä¸€éš¾ä»¥é¿å…å¢åŠ äº†è®¸å¤šå¼€é”€ï¼Œå¦‚ç¡®è®¤ï¼Œæµé‡æ§åˆ¶ï¼Œè®¡æ—¶å™¨ä»¥åŠè¿æ¥ç®¡ç†ç­‰ã€‚è¿™ä¸ä»…ä½¿åè®®æ•°æ®å•å…ƒçš„é¦–éƒ¨å¢ å¤§å¾ˆå¤šï¼Œè¿˜è¦å ç”¨è®¸å¤šå¤„ç†æœºèµ„æºã€‚TCP ä¸€èˆ¬ç”¨äºæ–‡ä»¶ä¼ è¾“ã€å‘é€å’Œæ¥æ”¶é‚®ä»¶ã€è¿œç¨‹ç™»å½•ç­‰åœºæ™¯ã€‚ 3 æµè§ˆå™¨ä¸­è¾“å…¥urlåœ°å€æ˜¾ç¤ºä¸»é¡µçš„å…¨è¿‡ç¨‹ 1 URL RLï¼ˆUniform Resource Locatorï¼‰ï¼Œç»Ÿä¸€èµ„æºå®šä½ç¬¦ï¼Œç”¨äºå®šä½äº’è”ç½‘ä¸Šèµ„æºï¼Œä¿—ç§°ç½‘å€ã€‚ è¯­æ³•ï¼šscheme://host.domain:port/path/filename ä¾‹å­ï¼š https:// www.baidu.com:80 2 åŸŸåè§£æ åŸŸåè§£æï¼šDNS åè®®æä¾›é€šè¿‡åŸŸåæŸ¥æ‰¾ IP åœ°å€ï¼Œæˆ–é€†å‘ä» IP åœ°å€åæŸ¥åŸŸåçš„æœåŠ¡ã€‚DNS æ˜¯ä¸€ä¸ªç½‘ç»œæœåŠ¡å™¨ï¼Œæˆ‘ä»¬çš„åŸŸåè§£æç®€å•æ¥è¯´å°±æ˜¯åœ¨ DNS ä¸Šè®°å½•ä¸€æ¡ä¿¡æ¯è®°å½•ã€‚ ç›®çš„ï¼š æµè§ˆå™¨æ˜¯ä¸èƒ½é€šè¿‡urlåœ°å€æŸ¥æ‰¾åˆ°å¯¹åº”çš„æœåŠ¡å™¨ï¼Œéœ€é€šè¿‡ipåœ°å€ã€‚ é€šè¿‡åŸŸåæŸ¥æ‰¾IPåœ°å€çš„è¿‡ç¨‹ï¼š æµè§ˆå™¨ç¼“å­˜ æ“ä½œç³»ç»Ÿç¼“å­˜ è·¯ç”±ç¼“å­˜ ISP çš„ DNS æœåŠ¡å™¨ï¼šISP æ˜¯äº’è”ç½‘æœåŠ¡æä¾›å•†(Internet Service Provider)çš„ç®€ç§°ï¼ŒISP æœ‰ä¸“é—¨çš„ DNS æœåŠ¡å™¨åº”å¯¹ DNS æŸ¥è¯¢è¯·æ±‚ã€‚ æ ¹æœåŠ¡å™¨ ä¾‹å¦‚ï¼Œè¦æŸ¥è¯¢www.baidu.comçš„IPåœ°å€ï¼ˆDNSè§£æurlï¼‰ï¼š æµè§ˆå™¨æœç´¢è‡ªå·±çš„DNSç¼“å­˜ï¼ˆç»´æŠ¤ä¸€å¼ åŸŸåä¸IPåœ°å€çš„å¯¹åº”è¡¨ï¼‰ è‹¥æ²¡æœ‰ï¼Œåˆ™æœç´¢æ“ä½œç³»ç»Ÿä¸­çš„DNSç¼“å­˜ï¼ˆç»´æŠ¤ä¸€å¼ åŸŸåä¸IPåœ°å€çš„å¯¹åº”è¡¨ï¼‰ è‹¥æ²¡æœ‰ï¼Œåˆ™æœç´¢æ“ä½œç³»ç»Ÿçš„hostsæ–‡ä»¶ï¼ˆWindowsç¯å¢ƒä¸‹ï¼Œç»´æŠ¤ä¸€å¼ åŸŸåä¸IPåœ°å€çš„å¯¹åº”è¡¨ï¼Œä½ç½®ä¸€èˆ¬åœ¨ C:\\Windows\\System32\\drivers\\etc\\hostsï¼‰ è‹¥æ²¡æœ‰ï¼Œåˆ™æ“ä½œç³»ç»Ÿå°†åŸŸåå‘é€è‡³ æœ¬åœ°åŸŸåæœåŠ¡å™¨- -ï¼ˆé€’å½’æŸ¥è¯¢æ–¹å¼ï¼‰ï¼Œæœ¬åœ°åŸŸåæœåŠ¡å™¨ æŸ¥è¯¢è‡ªå·±çš„DNSç¼“å­˜ï¼ŒæŸ¥æ‰¾æˆåŠŸåˆ™è¿”å›ç»“æœï¼Œå¦åˆ™ï¼Œï¼ˆä»¥ä¸‹æ˜¯è¿­ä»£æŸ¥è¯¢æ–¹å¼ï¼‰ æœ¬åœ°åŸŸåæœåŠ¡å™¨ å‘æ ¹åŸŸåæœåŠ¡å™¨ï¼ˆå…¶è™½ç„¶æ²¡æœ‰æ¯ä¸ªåŸŸåçš„å…·ä½“ä¿¡æ¯ï¼Œä½†å­˜å‚¨äº†è´Ÿè´£æ¯ä¸ªåŸŸï¼Œå¦‚comã€netã€orgç­‰çš„è§£æçš„é¡¶çº§åŸŸåæœåŠ¡å™¨çš„åœ°å€ï¼‰å‘èµ·è¯·æ±‚ï¼Œæ­¤å¤„ï¼Œæ ¹åŸŸåæœåŠ¡å™¨è¿”å›comåŸŸçš„é¡¶çº§åŸŸåæœåŠ¡å™¨çš„åœ°å€ æœ¬åœ°åŸŸåæœåŠ¡å™¨ å‘comåŸŸçš„é¡¶çº§åŸŸåæœåŠ¡å™¨å‘èµ·è¯·æ±‚ï¼Œè¿”å›baidu.comæƒé™åŸŸåæœåŠ¡å™¨ï¼ˆæƒé™åŸŸåæœåŠ¡å™¨ï¼Œç”¨æ¥ä¿å­˜è¯¥åŒºä¸­çš„æ‰€æœ‰ä¸»æœºåŸŸååˆ°IPåœ°å€çš„æ˜ å°„ï¼‰åœ°å€ æœ¬åœ°åŸŸåæœåŠ¡å™¨ å‘baidu.comæƒé™åŸŸåæœåŠ¡å™¨å‘èµ·è¯·æ±‚ï¼Œå¾—åˆ°www.baidu.comçš„IPåœ°å€æœ¬åœ°åŸŸåæœåŠ¡å™¨ å°†å¾—åˆ°çš„IPåœ°å€è¿”å›ç»™æ“ä½œç³»ç»Ÿï¼ŒåŒæ—¶è‡ªå·±ä¹Ÿå°†IPåœ°å€ç¼“å­˜èµ·æ¥ æ“ä½œç³»ç»Ÿå°† IP åœ°å€è¿”å›ç»™æµè§ˆå™¨ï¼ŒåŒæ—¶è‡ªå·±ä¹Ÿå°†IPåœ°å€ç¼“å­˜èµ·æ¥ è‡³æ­¤ï¼Œæµè§ˆå™¨å·²ç»å¾—åˆ°äº†åŸŸåå¯¹åº”çš„IPåœ°å€ 3 TCPè¿æ¥ï¼ˆä¸‰æ¬¡æ¡æ‰‹ï¼‰ å®¢æˆ·ç«¯â€“å‘é€å¸¦æœ‰ SYN æ ‡å¿—çš„æ•°æ®åŒ…â€“ä¸€æ¬¡æ¡æ‰‹â€“æœåŠ¡ç«¯ æœåŠ¡ç«¯â€“å‘é€å¸¦æœ‰ SYN/ACK æ ‡å¿—çš„æ•°æ®åŒ…â€“äºŒæ¬¡æ¡æ‰‹â€“å®¢æˆ·ç«¯ å®¢æˆ·ç«¯â€“å‘é€å¸¦æœ‰å¸¦æœ‰ ACK æ ‡å¿—çš„æ•°æ®åŒ…â€“ä¸‰æ¬¡æ¡æ‰‹â€“æœåŠ¡ç«¯ ç®€å•æ¥è¯´ï¼Œ å®¢æˆ·ç«¯ï¼šå…„dieï¼Œå¬å¾—åˆ°å—ï¼Ÿ æœåŠ¡å™¨ï¼šæˆ‘æ”¶åˆ°ï¼Œä½ æ”¶åˆ°å—ï¼Ÿ å®¢æˆ·ç«¯ï¼šæˆ‘ä¹Ÿæ”¶åˆ°ã€‚ ä¸ºä»€ä¹ˆè¦ä¼ å› SYN ï¼Ÿ Â·æ¥æ”¶ç«¯ä¼ å›å‘é€ç«¯æ‰€å‘é€çš„ SYN æ˜¯ä¸ºäº†å‘Šè¯‰å‘é€ç«¯ï¼Œæˆ‘æ¥æ”¶åˆ°çš„ä¿¡æ¯ç¡®å®å°±æ˜¯ä½ æ‰€å‘é€çš„ä¿¡å·äº†ã€‚ SYN æ˜¯ TCP/IP å»ºç«‹è¿æ¥æ—¶ä½¿ç”¨çš„æ¡æ‰‹ä¿¡å·ã€‚åœ¨å®¢æˆ·æœºå’ŒæœåŠ¡å™¨ä¹‹é—´å»ºç«‹æ­£å¸¸çš„ TCP ç½‘ç»œè¿æ¥æ—¶ï¼Œå®¢æˆ·æœºé¦–å…ˆ å‘å‡ºä¸€ä¸ª SYN æ¶ˆæ¯ï¼ŒæœåŠ¡å™¨ä½¿ç”¨ SYN-ACK åº”ç­”è¡¨ç¤ºæ¥æ”¶åˆ°äº†è¿™ä¸ªæ¶ˆæ¯ï¼Œåå®¢æˆ·æœºå†ä»¥ ACK(Acknowledgement[æ±‰è¯‘ï¼šç¡®è®¤å­—ç¬¦ ,åœ¨æ•°æ®é€šä¿¡ä¼ è¾“ä¸­ï¼Œæ¥æ”¶ç«™å‘ç»™å‘é€ç«™çš„ä¸€ç§ä¼ è¾“æ§åˆ¶å­—ç¬¦ã€‚å®ƒè¡¨ ç¤ºç¡®è®¤å‘æ¥çš„æ•°æ®å·²ç»æ¥å—æ— è¯¯ã€‚ ]ï¼‰æ¶ˆæ¯å“åº”ã€‚è¿™æ ·åœ¨å®¢æˆ·æœºå’ŒæœåŠ¡å™¨ä¹‹é—´æ‰èƒ½å»ºç«‹èµ·å¯é çš„TCPè¿æ¥ï¼Œæ•°æ® æ‰å¯ä»¥åœ¨å®¢æˆ·æœºå’ŒæœåŠ¡å™¨ä¹‹é—´ä¼ é€’ã€‚ ä¼ äº† SYN,ä¸ºå•¥è¿˜è¦ä¼  ACK ï¼Ÿ åŒæ–¹é€šä¿¡æ— è¯¯å¿…é¡»æ˜¯ä¸¤è€…äº’ç›¸å‘é€ä¿¡æ¯éƒ½æ— è¯¯ã€‚ä¼ äº† SYNï¼Œè¯æ˜å‘é€æ–¹åˆ°æ¥æ”¶æ–¹çš„é€šé“æ²¡æœ‰é—®é¢˜ï¼Œä½†æ˜¯æ¥æ”¶æ–¹åˆ°å‘é€ æ–¹çš„é€šé“è¿˜éœ€è¦ ACK ä¿¡å·æ¥è¿›è¡ŒéªŒè¯ã€‚ 4 å‘é€httpè¯·æ±‚ å®¢æˆ·ç«¯å‘é€ä¸€ä¸ªHTTPè¯·æ±‚åˆ°æœåŠ¡å™¨çš„è¯·æ±‚æ¶ˆæ¯åŒ…æ‹¬ä»¥ä¸‹æ ¼å¼ï¼šè¯·æ±‚è¡Œï¼ˆrequest lineï¼‰ã€è¯·æ±‚å¤´éƒ¨ï¼ˆheaderï¼‰ã€ç©ºè¡Œå’Œè¯·æ±‚æ•°æ®å››ä¸ªéƒ¨åˆ†ç»„æˆ è¯·æ±‚æ–¹æ³•ï¼šåŒ…å« 8 ç§ï¼šGETã€POSTã€PUTã€DELETEã€PATCHã€HEADã€OPTIONSã€TRACE åºå· æ–¹æ³• æè¿° 1 GET è¯·æ±‚æŒ‡å®šçš„é¡µé¢ä¿¡æ¯ï¼Œå¹¶è¿”å›å®ä½“ä¸»ä½“ã€‚ 2 HEAD ç±»ä¼¼äº GET è¯·æ±‚ï¼Œåªä¸è¿‡è¿”å›çš„å“åº”ä¸­æ²¡æœ‰å…·ä½“çš„å†…å®¹ï¼Œç”¨äºè·å–æŠ¥å¤´ 3 POST å‘æŒ‡å®šèµ„æºæäº¤æ•°æ®è¿›è¡Œå¤„ç†è¯·æ±‚ï¼ˆä¾‹å¦‚æäº¤è¡¨å•æˆ–è€…ä¸Šä¼ æ–‡ä»¶ï¼‰ã€‚æ•°æ®è¢«åŒ…å«åœ¨è¯·æ±‚ä½“ä¸­ã€‚POST è¯·æ±‚å¯èƒ½ä¼šå¯¼è‡´æ–°çš„èµ„æºçš„å»ºç«‹å’Œ/æˆ–å·²æœ‰èµ„æºçš„ä¿®æ”¹ã€‚ 4 PUT ä»å®¢æˆ·ç«¯å‘æœåŠ¡å™¨ä¼ é€çš„æ•°æ®å–ä»£æŒ‡å®šçš„æ–‡æ¡£çš„å†…å®¹ã€‚ 5 DELETE è¯·æ±‚æœåŠ¡å™¨åˆ é™¤æŒ‡å®šçš„é¡µé¢ã€‚ 6 CONNECT HTTP/1.1 åè®®ä¸­é¢„ç•™ç»™èƒ½å¤Ÿå°†è¿æ¥æ”¹ä¸ºç®¡é“æ–¹å¼çš„ä»£ç†æœåŠ¡å™¨ã€‚ 7 OPTIONS å…è®¸å®¢æˆ·ç«¯æŸ¥çœ‹æœåŠ¡å™¨çš„æ€§èƒ½ã€‚ 8 TRACE å›æ˜¾æœåŠ¡å™¨æ”¶åˆ°çš„è¯·æ±‚ï¼Œä¸»è¦ç”¨äºæµ‹è¯•æˆ–è¯Šæ–­ã€‚ 9 PATCH æ˜¯å¯¹ PUT æ–¹æ³•çš„è¡¥å……ï¼Œç”¨æ¥å¯¹å·²çŸ¥èµ„æºè¿›è¡Œå±€éƒ¨æ›´æ–° ã€‚ 5 å¤„ç†è¯·æ±‚å¹¶è¿”å›httpæŠ¥æ–‡ httpå“åº”æŠ¥æ–‡ åŒ…å«ï¼š å“åº”è¡Œã€å“åº”å¤´ã€å“åº”ä¸»ä½“ã€‚ HTTPçŠ¶æ€ç ç”±ä¸‰ä¸ªåè¿›åˆ¶æ•°å­—ç»„æˆï¼Œç¬¬ä¸€ä¸ªåè¿›åˆ¶æ•°å­—å®šä¹‰äº†çŠ¶æ€ç çš„ç±»å‹ï¼Œåä¸¤ä¸ªæ•°å­—æ²¡æœ‰åˆ†ç±»çš„ä½œç”¨ã€‚HTTPçŠ¶æ€ç å…±åˆ†ä¸º5ç§ç±»å‹ï¼š åˆ†ç±» åˆ†ç±»æè¿° 1** ä¿¡æ¯ï¼ŒæœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚ï¼Œéœ€è¦è¯·æ±‚è€…ç»§ç»­æ‰§è¡Œæ“ä½œ 2** æˆåŠŸï¼Œæ“ä½œè¢«æˆåŠŸæ¥æ”¶å¹¶å¤„ç† 3** é‡å®šå‘ï¼Œéœ€è¦è¿›ä¸€æ­¥çš„æ“ä½œä»¥å®Œæˆè¯·æ±‚ 4** å®¢æˆ·ç«¯é”™è¯¯ï¼Œè¯·æ±‚åŒ…å«è¯­æ³•é”™è¯¯æˆ–æ— æ³•å®Œæˆè¯·æ±‚ 5** æœåŠ¡å™¨é”™è¯¯ï¼ŒæœåŠ¡å™¨åœ¨å¤„ç†è¯·æ±‚çš„è¿‡ç¨‹ä¸­å‘ç”Ÿäº†é”™è¯¯ å®ä¾‹ï¼š ä¸‹é¢å®ä¾‹æ˜¯ä¸€ç‚¹å…¸å‹çš„ä½¿ç”¨GETæ¥ä¼ é€’æ•°æ®çš„å®ä¾‹ï¼š å®¢æˆ·ç«¯è¯·æ±‚ï¼š GET /hello.txt HTTP/1.1 User-Agent: curl/7.16.3 libcurl/7.16.3 OpenSSL/0.9.7l zlib/1.2.3 Host: www.example.com Accept-Language: en, mi æœåŠ¡ç«¯å“åº”: HTTP/1.1 200 OK Date: Mon, 27 Jul 2009 12:28:53 GMT Server: Apache Last-Modified: Wed, 22 Jul 2009 19:15:56 GMT ETag: &quot;34aa387-d-1568eb00&quot; Accept-Ranges: bytes Content-Length: 51 Vary: Accept-Encoding Content-Type: text/plain è¾“å‡ºç»“æœï¼š Hello World! My payload includes a trailing CRLF. 6 TCPé‡Šæ”¾è¿æ¥ï¼ˆå››æ¬¡æŒ¥æ‰‹ï¼‰ æµè§ˆå™¨æ‰€åœ¨ä¸»æœºå‘æœåŠ¡å™¨å‘å‡ºè¿æ¥é‡Šæ”¾æŠ¥æ–‡ï¼Œç„¶ååœæ­¢å‘é€æ•°æ®ï¼› æœåŠ¡å™¨æ¥æ”¶åˆ°é‡Šæ”¾æŠ¥æ–‡åå‘å‡ºç¡®è®¤æŠ¥æ–‡ï¼Œç„¶åå°†æœåŠ¡å™¨ä¸Šæœªä¼ é€å®Œçš„æ•°æ®å‘é€å®Œï¼› æœåŠ¡å™¨æ•°æ®ä¼ è¾“å®Œæ¯•åï¼Œå‘å®¢æˆ·æœºå‘é€è¿æ¥é‡Šæ”¾æŠ¥æ–‡ï¼› å®¢æˆ·æœºæ¥æ”¶åˆ°æŠ¥æ–‡åï¼Œå‘å‡ºç¡®è®¤ï¼Œç„¶åç­‰å¾…ä¸€æ®µæ—¶é—´åï¼Œé‡Šæ”¾TCPè¿æ¥ï¼› å³ä¸ºå››æ¬¡æŒ¥æ‰‹è¿‡ç¨‹ï¼š æ–­å¼€ä¸€ä¸ª TCP è¿æ¥åˆ™éœ€è¦â€œå››æ¬¡æŒ¥æ‰‹â€ï¼š å®¢æˆ·ç«¯-å‘é€ä¸€ä¸ª FINï¼Œç”¨æ¥å…³é—­å®¢æˆ·ç«¯åˆ°æœåŠ¡å™¨çš„æ•°æ®ä¼ é€ æœåŠ¡å™¨-æ”¶åˆ°è¿™ä¸ª FINï¼Œå®ƒå‘å›ä¸€ ä¸ª ACKï¼Œç¡®è®¤åºå·ä¸ºæ”¶åˆ°çš„åºå·åŠ 1 ã€‚å’Œ SYN ä¸€æ ·ï¼Œä¸€ä¸ª FIN å°†å ç”¨ä¸€ä¸ªåºå· æœåŠ¡å™¨-å…³é—­ä¸å®¢æˆ·ç«¯çš„è¿æ¥ï¼Œå‘é€ä¸€ä¸ªFINç»™å®¢æˆ·ç«¯ å®¢æˆ·ç«¯-å‘å› ACK æŠ¥æ–‡ç¡®è®¤ï¼Œå¹¶å°†ç¡®è®¤åºå·è®¾ç½®ä¸ºæ”¶åˆ°åºå·åŠ 1 ç®€å•æ¥è¯´ï¼š å®¢æˆ·ç«¯ï¼šæˆ‘è¯´å®Œäº†ï¼› æœåŠ¡ç«¯ï¼šæˆ‘çŸ¥é“äº†ï¼Œç»§ç»­æŠŠæˆ‘è¦è¯´çš„è¯´å®Œï¼› æœåŠ¡ç«¯ï¼šè¯´å®Œåï¼Œé€šçŸ¥å®¢æˆ·ç«¯æˆ‘è¦ç»“æŸäº†ï¼› å®¢æˆ·ç«¯ï¼šæ”¶åˆ°ï¼ï¼ 4 http(åº”ç”¨å±‚åè®®)é•¿è¿æ¥ä¸çŸ­è¿æ¥ 4.1 httpçŸ­è¿æ¥ åœ¨HTTP/1.0ä¸­é»˜è®¤ä½¿ç”¨çŸ­è¿æ¥ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨æ¯è¿›è¡Œä¸€æ¬¡HTTPæ“ä½œï¼Œå°±å»ºç«‹ä¸€æ¬¡è¿æ¥ï¼Œä»»åŠ¡ç»“æŸå°±ä¸­ æ–­è¿æ¥ã€‚å½“å®¢æˆ·ç«¯æµè§ˆå™¨è®¿é—®çš„æŸä¸ªHTMLæˆ–å…¶ä»–ç±»å‹çš„Webé¡µä¸­åŒ…å«æœ‰å…¶ä»–çš„Webèµ„æºï¼ˆå¦‚JavaScriptæ–‡ä»¶ã€å›¾åƒ æ–‡ä»¶ã€CSSæ–‡ä»¶ç­‰ï¼‰ï¼Œæ¯é‡åˆ°è¿™æ ·ä¸€ä¸ªWebèµ„æºï¼Œæµè§ˆå™¨å°±ä¼šé‡æ–°å»ºç«‹ä¸€ä¸ªHTTPä¼šè¯ã€‚ 4.2 httpé•¿è¿æ¥ HTTPçš„é•¿è¿æ¥å’ŒçŸ­è¿æ¥æœ¬è´¨ä¸Šæ˜¯TCPé•¿è¿æ¥å’ŒçŸ­è¿æ¥ã€‚ è€Œä»HTTP/1.1èµ·ï¼Œé»˜è®¤ä½¿ç”¨é•¿è¿æ¥ï¼Œç”¨ä»¥ä¿æŒè¿æ¥ç‰¹æ€§ã€‚ä½¿ç”¨é•¿è¿æ¥çš„HTTPåè®®ï¼Œä¼šåœ¨å“åº”å¤´åŠ å…¥è¿™è¡Œä»£ç ï¼š åœ¨ä½¿ç”¨é•¿è¿æ¥çš„æƒ…å†µä¸‹ï¼Œå½“ä¸€ä¸ªç½‘é¡µæ‰“å¼€å®Œæˆåï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´ç”¨äºä¼ è¾“HTTPæ•°æ®çš„TCPè¿æ¥ä¸ä¼šå…³é—­ï¼Œå®¢ æˆ·ç«¯å†æ¬¡è®¿é—®è¿™ä¸ªæœåŠ¡å™¨æ—¶ï¼Œä¼šç»§ç»­ä½¿ç”¨è¿™ä¸€æ¡å·²ç»å»ºç«‹çš„è¿æ¥ã€‚Keep-Aliveä¸ä¼šæ°¸ä¹…ä¿æŒè¿æ¥ï¼Œå®ƒæœ‰ä¸€ä¸ªä¿æŒæ—¶ é—´ï¼Œå¯ä»¥åœ¨ä¸åŒçš„æœåŠ¡å™¨è½¯ä»¶ï¼ˆå¦‚Apacheï¼‰ä¸­è®¾å®šè¿™ä¸ªæ—¶é—´ã€‚å®ç°é•¿è¿æ¥éœ€è¦å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯éƒ½æ”¯æŒé•¿è¿æ¥ã€‚ 4.3 httpä¸TCP/IPåè®®çš„å…³ç³» HTTPå±äºåº”ç”¨å±‚åè®®ï¼Œåœ¨ä¼ è¾“å±‚ä½¿ç”¨TCPåè®®ï¼Œåœ¨ç½‘ç»œå±‚ä½¿ç”¨IPåè®®ã€‚ IPåè®®ä¸»è¦è§£å†³ç½‘ç»œè·¯ç”±å’Œå¯»å€é—®é¢˜ï¼ŒTCPåè®®ä¸»è¦è§£å†³å¦‚ä½•åœ¨IPå±‚ä¹‹ä¸Šå¯é åœ°ä¼ é€’æ•°æ®åŒ…ï¼Œä½¿å¾—ç½‘ç»œä¸Šæ¥æ”¶ç«¯æ”¶åˆ°å‘é€ç«¯æ‰€å‘å‡ºçš„æ‰€æœ‰åŒ…ï¼Œå¹¶ä¸”é¡ºåºä¸å‘é€é¡ºåºä¸€è‡´ã€‚TCPåè®®æ˜¯å¯é çš„ã€é¢å‘è¿æ¥çš„ã€‚ 4.4 å¦‚ä½•ç†è§£httpæ˜¯æ—  çŠ¶æ€çš„ HTTPåè®®æ˜¯æ— çŠ¶æ€çš„ï¼ŒæŒ‡çš„æ˜¯åè®®å¯¹äºäº‹åŠ¡å¤„ç†æ²¡æœ‰è®°å¿†èƒ½åŠ›ï¼ŒæœåŠ¡å™¨ä¸çŸ¥é“å®¢æˆ·ç«¯æ˜¯ä»€ä¹ˆçŠ¶æ€ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ‰“å¼€ä¸€ä¸ªæœåŠ¡å™¨ä¸Šçš„ç½‘é¡µå’Œä¸Šä¸€æ¬¡æ‰“å¼€è¿™ä¸ªæœåŠ¡å™¨ä¸Šçš„ç½‘é¡µä¹‹é—´æ²¡æœ‰ä»»ä½•è”ç³»ã€‚HTTPæ˜¯ä¸€ä¸ªæ— çŠ¶æ€çš„é¢å‘è¿æ¥çš„åè®®ï¼Œæ— çŠ¶æ€ä¸ä»£è¡¨HTTPä¸èƒ½ä¿æŒTCPè¿æ¥ï¼Œæ›´ä¸èƒ½ä»£è¡¨HTTPä½¿ç”¨çš„æ˜¯UDPåè®®ï¼ˆæ— è¿æ¥ï¼‰ã€‚ 4.5 TCPçŸ­è¿æ¥ æ¨¡æ‹Ÿä¸€ä¸‹TCPçŸ­è¿æ¥çš„æƒ…å†µï¼šclientå‘serverå‘èµ·è¿æ¥è¯·æ±‚ï¼Œserveræ¥åˆ°è¯·æ±‚ï¼Œç„¶ååŒæ–¹å»ºç«‹è¿æ¥ï¼ˆä¸‰æ¬¡æ¡æ‰‹ï¼‰ã€‚clientå‘serverå‘é€æ¶ˆæ¯ï¼Œserverå›åº”clientï¼Œç„¶åä¸€æ¬¡è¯·æ±‚å°±å®Œæˆäº†ã€‚è¿™æ—¶å€™åŒæ–¹ä»»æ„éƒ½å¯ä»¥å‘èµ·closeæ“ä½œï¼Œä¸è¿‡ä¸€èˆ¬éƒ½æ˜¯clientå…ˆå‘èµ·closeæ“ä½œã€‚ä¸Šè¿°å¯çŸ¥ï¼ŒçŸ­è¿æ¥ä¸€èˆ¬åªä¼šåœ¨ client/serveré—´ä¼ é€’ä¸€æ¬¡è¯·æ±‚æ“ä½œã€‚ çŸ­è¿æ¥çš„ä¼˜ç‚¹æ˜¯ï¼šç®¡ç†èµ·æ¥æ¯”è¾ƒç®€å•ï¼Œå­˜åœ¨çš„è¿æ¥éƒ½æ˜¯æœ‰ç”¨çš„è¿æ¥ï¼Œä¸éœ€è¦é¢å¤–çš„æ§åˆ¶æ‰‹æ®µã€‚ 4.6 TCPé•¿è¿æ¥ æˆ‘ä»¬å†æ¨¡æ‹Ÿä¸€ä¸‹é•¿è¿æ¥çš„æƒ…å†µï¼šclientå‘serverå‘èµ·è¿æ¥ï¼Œserveræ¥å—clientè¿æ¥ï¼ŒåŒæ–¹å»ºç«‹è¿æ¥ï¼ˆä¸‰æ¬¡æ¡æ‰‹ï¼‰ã€‚clientä¸serverå®Œæˆä¸€æ¬¡è¯·æ±‚åï¼Œå®ƒä»¬ä¹‹é—´çš„è¿æ¥å¹¶ä¸ä¼šä¸»åŠ¨å…³é—­ï¼Œåç»­çš„è¯»å†™æ“ä½œä¼šç»§ç»­ä½¿ç”¨è¿™ä¸ªè¿æ¥ã€‚TCPçš„ä¿æ´»åŠŸèƒ½ä¸»è¦ä¸ºæœåŠ¡å™¨åº”ç”¨æä¾›ã€‚å¦‚æœå®¢æˆ·ç«¯å·²ç»æ¶ˆå¤±è€Œè¿æ¥æœªæ–­å¼€ï¼Œåˆ™ä¼šä½¿å¾—æœåŠ¡å™¨ä¸Šä¿ç•™ä¸€ä¸ªåŠå¼€æ”¾çš„è¿æ¥ï¼Œè€ŒæœåŠ¡å™¨åˆåœ¨ç­‰å¾…æ¥è‡ªå®¢æˆ·ç«¯çš„æ•°æ®ï¼Œæ­¤æ—¶æœåŠ¡å™¨å°†æ°¸è¿œç­‰å¾…å®¢æˆ·ç«¯çš„æ•°æ®ã€‚ä¿æ´»åŠŸèƒ½å°±æ˜¯è¯•å›¾åœ¨æœåŠ¡ç«¯å™¨ç«¯æ£€æµ‹åˆ°è¿™ç§åŠå¼€æ”¾çš„è¿æ¥ã€‚ å¦‚æœä¸€ä¸ªç»™å®šçš„è¿æ¥åœ¨ä¸¤å°æ—¶å†…æ²¡æœ‰ä»»ä½•åŠ¨ä½œï¼ŒæœåŠ¡å™¨å°±å‘å®¢æˆ·å‘é€ä¸€ä¸ªæ¢æµ‹æŠ¥æ–‡æ®µï¼Œæ ¹æ®å®¢æˆ·ç«¯ä¸»æœºå“åº”æ¢æµ‹4ä¸ªå®¢æˆ·ç«¯çŠ¶æ€ï¼š å®¢æˆ·ä¸»æœºä¾ç„¶æ­£å¸¸è¿è¡Œï¼Œä¸”æœåŠ¡å™¨å¯è¾¾ã€‚æ­¤æ—¶å®¢æˆ·çš„TCPå“åº”æ­£å¸¸ï¼ŒæœåŠ¡å™¨å°†ä¿æ´»å®šæ—¶å™¨å¤ä½ã€‚ å®¢æˆ·ä¸»æœºå·²ç»å´©æºƒï¼Œå¹¶ä¸”å…³é—­æˆ–è€…æ­£åœ¨é‡æ–°å¯åŠ¨ã€‚ä¸Šè¿°æƒ…å†µä¸‹å®¢æˆ·ç«¯éƒ½ä¸èƒ½å“åº”TCPã€‚æœåŠ¡ç«¯å°†æ— æ³•æ”¶åˆ°å®¢æˆ·ç«¯å¯¹æ¢æµ‹çš„å“åº”ã€‚æœåŠ¡å™¨æ€»å…±å‘é€10ä¸ªè¿™æ ·çš„æ¢æµ‹ï¼Œæ¯ä¸ªé—´éš”75ç§’ã€‚è‹¥æœåŠ¡å™¨æ²¡æœ‰æ”¶åˆ°ä»»ä½•ä¸€ä¸ªå“åº”ï¼Œå®ƒå°±è®¤ä¸ºå®¢æˆ·ç«¯å·²ç»å…³é—­å¹¶ç»ˆæ­¢è¿æ¥ã€‚ å®¢æˆ·ç«¯å´©æºƒå¹¶å·²ç»é‡æ–°å¯åŠ¨ã€‚æœåŠ¡å™¨å°†æ”¶åˆ°ä¸€ä¸ªå¯¹å…¶ä¿æ´»æ¢æµ‹çš„å“åº”ï¼Œè¿™ä¸ªå“åº”æ˜¯ä¸€ä¸ªå¤ä½ï¼Œä½¿å¾—æœåŠ¡å™¨ç»ˆæ­¢è¿™ä¸ªè¿æ¥ã€‚ å®¢æˆ·æœºæ­£å¸¸è¿è¡Œï¼Œä½†æ˜¯æœåŠ¡å™¨ä¸å¯è¾¾ã€‚è¿™ç§æƒ…å†µä¸ç¬¬äºŒç§çŠ¶æ€ç±»ä¼¼ã€‚ 4.7 é•¿è¿æ¥ä¸çŸ­è¿æ¥çš„ä¼˜ç¼ºç‚¹ é•¿è¿æ¥å¯ä»¥çœå»è¾ƒå¤šçš„TCPå»ºç«‹å’Œå…³é—­çš„æ“ä½œï¼Œå‡å°‘æµªè´¹ï¼ŒèŠ‚çº¦æ—¶é—´ã€‚å¯¹äºé¢‘ç¹è¯·æ±‚èµ„æºçš„å®¢æˆ·ç«¯é€‚åˆä½¿ç”¨é•¿è¿æ¥ã€‚åœ¨é•¿è¿æ¥çš„åº”ç”¨åœºæ™¯ä¸‹ï¼Œclientç«¯ä¸€èˆ¬ä¸ä¼šä¸»åŠ¨å…³é—­è¿æ¥ï¼Œå½“clientä¸serverä¹‹é—´çš„è¿æ¥ä¸€ç›´ä¸å…³é—­ï¼Œéšç€å®¢æˆ·ç«¯è¿æ¥è¶Šæ¥è¶Šå¤šï¼Œserverä¼šä¿æŒè¿‡å¤šè¿æ¥ã€‚è¿™æ—¶å€™serverç«¯éœ€è¦é‡‡å–ä¸€äº›ç­–ç•¥ï¼Œå¦‚å…³é—­ä¸€äº›é•¿æ—¶é—´æ²¡æœ‰è¯·æ±‚å‘ç”Ÿçš„è¿æ¥ï¼Œè¿™æ ·å¯ä»¥é¿å…ä¸€äº›æ¶æ„è¿æ¥å¯¼è‡´serverç«¯æœåŠ¡å—æŸï¼›å¦‚æœæ¡ä»¶å…è®¸åˆ™å¯ä»¥é™åˆ¶æ¯ä¸ªå®¢æˆ·ç«¯çš„æœ€å¤§é•¿è¿æ¥æ•°ï¼Œè¿™æ ·å¯ä»¥å®Œå…¨é¿å…æ¶æ„çš„å®¢æˆ·ç«¯æ‹–å®æ•´ä½“åç«¯æœåŠ¡ã€‚ çŸ­è¿æ¥å¯¹äºæœåŠ¡å™¨æ¥è¯´ç®¡ç†è¾ƒä¸ºç®€å•ï¼Œå­˜åœ¨çš„è¿æ¥éƒ½æ˜¯æœ‰ç”¨çš„è¿æ¥ï¼Œä¸éœ€è¦é¢å¤–çš„æ§åˆ¶æ‰‹æ®µã€‚ä½†å¦‚æœå®¢æˆ·è¯·æ±‚é¢‘ç¹ï¼Œå°†åœ¨TCPçš„å»ºç«‹å’Œå…³é—­æ“ä½œä¸Šæµªè´¹è¾ƒå¤šæ—¶é—´å’Œå¸¦å®½ã€‚ é•¿è¿æ¥å’ŒçŸ­è¿æ¥çš„äº§ç”Ÿåœ¨äºclientå’Œserveré‡‡å–çš„å…³é—­ç­–ç•¥ã€‚ä¸åŒçš„åº”ç”¨åœºæ™¯é€‚åˆé‡‡ç”¨ä¸åŒçš„ç­–ç•¥ã€‚ 4.8 é€‚ç”¨åœºæ™¯ **é•¿è¿æ¥ï¼š**å¤šç”¨äºæ“ä½œé¢‘ç¹ï¼Œç‚¹å¯¹ç‚¹çš„é€šè®¯ï¼Œè€Œä¸”è¿æ¥æ•°ä¸èƒ½å¤ªå¤šæƒ…å†µã€‚æ¯ä¸ªTCPè¿æ¥éƒ½éœ€è¦ä¸‰æ­¥æ¡æ‰‹ï¼Œè¿™éœ€è¦æ—¶é—´ï¼Œå¦‚æœæ¯ä¸ªæ“ä½œéƒ½æ˜¯å…ˆè¿æ¥ï¼Œå†æ“ä½œçš„è¯é‚£ä¹ˆå¤„ç†é€Ÿåº¦ä¼šé™ä½å¾ˆå¤šï¼Œæ‰€ä»¥æ¯ä¸ªæ“ä½œå®Œåéƒ½ä¸æ–­å¼€ï¼Œæ¬¡å¤„ç†æ—¶ç›´æ¥å‘é€æ•°æ®åŒ…å°±OKäº†ï¼Œä¸ç”¨å»ºç«‹TCPè¿æ¥ã€‚ä¾‹å¦‚ï¼šæ•°æ®åº“çš„è¿æ¥ç”¨é•¿è¿æ¥ï¼Œ å¦‚æœç”¨çŸ­è¿æ¥é¢‘ç¹çš„é€šä¿¡ä¼šé€ æˆsocketé”™è¯¯ï¼Œè€Œä¸”é¢‘ç¹çš„socket åˆ›å»ºä¹Ÿæ˜¯å¯¹èµ„æºçš„æµªè´¹ã€‚ **çŸ­é“¾æ¥ï¼š**è€ŒåƒWEBç½‘ç«™çš„httpæœåŠ¡ä¸€èˆ¬éƒ½ç”¨çŸ­é“¾æ¥ï¼Œå› ä¸ºé•¿è¿æ¥å¯¹äºæœåŠ¡ç«¯æ¥è¯´ä¼šè€—è´¹ä¸€å®šçš„èµ„æºï¼Œè€ŒåƒWEBç½‘ç«™è¿™ä¹ˆé¢‘ç¹çš„æˆåƒä¸Šä¸‡ç”šè‡³ä¸Šäº¿å®¢æˆ·ç«¯çš„è¿æ¥ç”¨çŸ­è¿æ¥ä¼šæ›´çœä¸€äº›èµ„æºï¼Œå¦‚æœç”¨é•¿è¿æ¥ï¼Œè€Œä¸”åŒæ—¶æœ‰æˆåƒä¸Šä¸‡çš„ç”¨æˆ·ï¼Œå¦‚æœæ¯ä¸ªç”¨æˆ·éƒ½å ç”¨ä¸€ä¸ªè¿æ¥çš„è¯ï¼Œé‚£å¯æƒ³è€ŒçŸ¥å§ã€‚æ‰€ä»¥å¹¶å‘é‡å¤§ï¼Œä½†æ¯ä¸ªç”¨æˆ·æ— éœ€é¢‘ç¹æ“ä½œæƒ…å†µä¸‹éœ€ç”¨çŸ­è¿å¥½ã€‚ ","link":"https://kily-007.github.io/post/ç¬”è®°-è®¡ç®—æœºç½‘ç»œ/"},{"title":"å‰‘æŒ‡offer-å­—ç¬¦ä¸²è½¬æ•´æ•°","content":" å°†ä¸€ä¸ªå­—ç¬¦ä¸²è½¬æ¢æˆä¸€ä¸ªæ•´æ•°(å®ç°Integer.valueOf(string)çš„åŠŸèƒ½ï¼Œä½†æ˜¯stringä¸ç¬¦åˆæ•°å­—è¦æ±‚æ—¶è¿”å›0)ï¼Œè¦æ±‚ä¸èƒ½ä½¿ç”¨å­—ç¬¦ä¸²è½¬æ¢æ•´æ•°çš„åº“å‡½æ•°ã€‚ æ•°å€¼ä¸º0æˆ–è€…å­—ç¬¦ä¸²ä¸æ˜¯ä¸€ä¸ªåˆæ³•çš„æ•°å€¼åˆ™è¿”å›0ã€‚ public int StrToInt(String str) { if(str.equals(&quot;&quot;)) return 0; if(str==&quot;-2147483648&quot;) return -2147483648; if(str.charAt(0)=='+'||str.charAt(0)=='-') { for (int i = 1; i &lt; str.length(); i++) { if(str.charAt(i)&gt;'9'||str.charAt(i)&lt;'0') return 0; } int rs=0; for (int i = 0; i &lt; str.length()-1; i++) { rs+=(str.charAt(i+1)-48)*(Math.pow(10, str.length()-(i+2))); } if(str.charAt(0)=='-') { return -rs; } return rs; }else if(str.charAt(0)&lt;='9'&amp;&amp;str.charAt(0)&gt;='0'){//ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸ºæ•°å­— for (int i = 1; i &lt; str.length(); i++) { if(str.charAt(i)&gt;'9'||str.charAt(i)&lt;'0') return 0; } int rs=0; for (int i = 0; i &lt; str.length(); i++) { rs+=(str.charAt(i)-48)*(Math.pow(10, str.length()-(i+1))); } return rs; }else {//ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸ºå…¶ä»– return 0; } } ","link":"https://kily-007.github.io/post/ç®—æ³•-å‰‘æŒ‡offer-å­—ç¬¦ä¸²è½¬æ•´æ•°/"},{"title":"å‰‘æŒ‡offer-é™¤æ³•è¿ç®—","content":"ç»™å®šä¸€ä¸ªæ•°ç»„A[0,1,...,n-1],è¯·æ„å»ºä¸€ä¸ªæ•°ç»„B[0,1,...,n-1],å…¶ä¸­Bä¸­çš„å…ƒç´ B[i]=A[0]A[1]...*A[i-1]A[i+1]...*A[n-1]ã€‚ä¸èƒ½ä½¿ç”¨é™¤æ³•ã€‚ public int[] multiply(int[] A) { if (A.length != 0) { int[] B = new int[A.length]; for (int i = 0; i &lt; B.length; i++) { B[i]=1; } for (int i = 0; i &lt; B.length; i++) { for (int j = 0; j &lt; A.length; j++) { if(j!=i) B[i]*=A[j]; } } return B; }else { return new int [] {}; } } ","link":"https://kily-007.github.io/post/ç®—æ³•-å‰‘æŒ‡offer-é™¤æ³•è¿ç®—/"},{"title":"Hello Gridea","content":"ğŸ‘ æ¬¢è¿ä½¿ç”¨ Gridea ï¼ âœï¸ Gridea ä¸€ä¸ªé™æ€åšå®¢å†™ä½œå®¢æˆ·ç«¯ã€‚ä½ å¯ä»¥ç”¨å®ƒæ¥è®°å½•ä½ çš„ç”Ÿæ´»ã€å¿ƒæƒ…ã€çŸ¥è¯†ã€ç¬”è®°ã€åˆ›æ„... ... Github Gridea ä¸»é¡µ ç¤ºä¾‹ç½‘ç«™ ç‰¹æ€§ğŸ‘‡ ğŸ“ ä½ å¯ä»¥ä½¿ç”¨æœ€é…·çš„ Markdown è¯­æ³•ï¼Œè¿›è¡Œå¿«é€Ÿåˆ›ä½œ ğŸ¤¡ ğŸŒ‰ ä½ å¯ä»¥ç»™æ–‡ç« é…ä¸Šç²¾ç¾çš„å°é¢å›¾å’Œåœ¨æ–‡ç« ä»»æ„ä½ç½®æ’å…¥å›¾ç‰‡ ğŸ·ï¸ ä½ å¯ä»¥å¯¹æ–‡ç« è¿›è¡Œæ ‡ç­¾åˆ†ç»„ ğŸ“‹ ä½ å¯ä»¥è‡ªå®šä¹‰èœå•ï¼Œç”šè‡³å¯ä»¥åˆ›å»ºå¤–éƒ¨é“¾æ¥èœå• ğŸ’» ä½ å¯ä»¥åœ¨ Windowsï¼ŒMacOS æˆ– Linux è®¾å¤‡ä¸Šä½¿ç”¨æ­¤å®¢æˆ·ç«¯ ğŸŒ ä½ å¯ä»¥ä½¿ç”¨ ğ–¦ğ—‚ğ—ğ—ğ—ğ–» ğ–¯ğ–ºğ—€ğ–¾ğ—Œ æˆ– Coding Pages å‘ä¸–ç•Œå±•ç¤ºï¼Œæœªæ¥å°†æ”¯æŒæ›´å¤šå¹³å° ğŸ’¬ ä½ å¯ä»¥è¿›è¡Œç®€å•çš„é…ç½®ï¼Œæ¥å…¥ Gitalk æˆ– DisqusJS è¯„è®ºç³»ç»Ÿ ğŸ‡¬ğŸ‡§ ä½ å¯ä»¥ä½¿ç”¨ä¸­æ–‡ç®€ä½“æˆ–è‹±è¯­ ğŸŒ ä½ å¯ä»¥ä»»æ„ä½¿ç”¨åº”ç”¨å†…é»˜è®¤ä¸»é¢˜æˆ–ä»»æ„ç¬¬ä¸‰æ–¹ä¸»é¢˜ï¼Œå¼ºå¤§çš„ä¸»é¢˜è‡ªå®šä¹‰èƒ½åŠ› ğŸ–¥ ä½ å¯ä»¥è‡ªå®šä¹‰æºæ–‡ä»¶å¤¹ï¼Œåˆ©ç”¨ OneDriveã€ç™¾åº¦ç½‘ç›˜ã€iCloudã€Dropbox ç­‰è¿›è¡Œå¤šè®¾å¤‡åŒæ­¥ ğŸŒ± å½“ç„¶ Gridea è¿˜å¾ˆå¹´è½»ï¼Œæœ‰å¾ˆå¤šä¸è¶³ï¼Œä½†è¯·ç›¸ä¿¡ï¼Œå®ƒä¼šä¸åœå‘å‰ ğŸƒ æœªæ¥ï¼Œå®ƒä¸€å®šä¼šæˆä¸ºä½ ç¦»ä¸å¼€çš„ä¼™ä¼´ å°½æƒ…å‘æŒ¥ä½ çš„æ‰åå§ï¼ ğŸ˜˜ Enjoy~ ","link":"https://kily-007.github.io/post/gridea-hello gridea/"}]}